;try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/view-in-jira.js' */
AJS.bind("add-handler.property-panel",function(b,a){AJS.log("add-handler.property-panel: panel name = "+a.name);if(a.name!="macro"){return}a.registerButtonHandler("view-in-jira",function(d,j){if(AJS.Editor.JiraConnector.servers){var s=AJS.Editor.JiraConnector.servers;var l=AJS.$(j);var g=l.attr("data-macro-default-parameter");var k=l.attr("data-macro-parameters")||"";var t=Confluence.MacroParameterSerializer.deserialize(k);var n=/=|!=|~|>|<|!~| is | in /i;var h=function(u){var i=u.indexOf("|");if(i>=0){return u.substring(0,i)}return u};var f=g||t.jqlQuery||t.key||h(k);var c=t.server;var q=t.serverId;var p=f.match(n);var m=null;for(var o=0;o<s.length;o++){if((q&&s[o].id==q)){m=s[o];break}if((c&&s[o].name==c)||(!c&&s[o].selected)){m=s[o];break}}if(m!=null){var e=(typeof m.displayUrl!=="undefined")?m.displayUrl:m.url;if(e.charAt(e.length-1)=="/"){e=e.substr(0,e.length-1)}var r=tinymce.isIE?"_blank":"confluence-goto-jiralink-"+AJS.params.pageId;if(!p){window.open(e+"/browse/"+encodeURIComponent(f),r)}else{window.open(e+"/secure/IssueNavigator.jspa?reset=true&jqlQuery="+encodeURIComponent(f),r)}}}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:macro-browser-resources', location = 'templates/extra/jira/show-summary.js' */
AJS.bind("init.rte",function(){if(!AJS.Confluence&&!AJS.Confluence.PropertyPanel&&!AJS.Confluence.PropertyPanel.Macro){AJS.logError("JIRA Issues Macro : can't register property panel init handler since AJS.Confluence.PropertyPanel.Macro is undefined");return}var a="showSummary";var f="jira";var e="jiraissues";var d="show-summary";AJS.Confluence.PropertyPanel.Macro.registerInitHandler(c,f);AJS.Confluence.PropertyPanel.Macro.registerInitHandler(c,e);function c(g,m,j){var l=AJS.$.grep(m,function(i){return i.parameterName==d})[0];if(!l){AJS.logError("JIRA Issues Macro - Show-summary : The system cannot find SummaryButton, all buttons are: ");for(var k in m){AJS.logError(m[k].text)}return}if(b(g)){var h=AJS.SummaryHelper.getParam(g,a);if(h=="false"){l.text="Show summary"}else{l.text="Hide summary"}}else{l.className+=" hidden"}}function b(g){var i=AJS.$(g);var j=i.attr("src");if(!j){return true}var h=AJS.SummaryHelper.getParam(g,"count");if(j.indexOf("confluence.extra.jira/jira-table")==-1&&h!="true"){return true}return false}});AJS.bind("add-handler.property-panel",function(b,a){if(a.name!="macro"){return}a.registerButtonHandler("show-summary",function(e,c){var d=AJS.SummaryHelper.getParam(c,"showSummary");AJS.SummaryHelper.updateMacro("jira",c,"showSummary",d=="false"?"true":"false")})});AJS.SummaryHelper=(function(){return{getCurrentParams:function(a){return Confluence.MacroParameterSerializer.deserialize(a.attr("data-macro-parameters"))},getParam:function(a,d){var c=AJS.$(a);var b=AJS.SummaryHelper.getCurrentParams(c);return b[d]},updateMacro:function(b,a,c,g){var e=AJS.$(a);AJS.Rte.getEditor().selection.select(e[0]);AJS.Rte.BookmarkManager.storeBookmark();var d=AJS.SummaryHelper.getCurrentParams(e);d[c]=g;var f={contentId:Confluence.Editor.getContentId(),macro:{name:b,params:d,defaultParameterValue:e.attr("data-macro-default-parameter")}};tinymce.confluence.MacroUtils.insertMacro(f)}}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:files-upload-analytics', location = 'js/analytics/files-upload-analytics.js' */
define("conf/confluence-drag-and-drop/analytics/files-upload-analytics",["ajs","underscore"],function(d,e){return{triggerEvent:function(b,a,c){a&&a.length&&(a={multiple:1<a.length,number:a.length,isAllImage:void 0===c?this._isAllImages(a):c},d.trigger("analyticsEvent",{name:b,data:a}))},_isAllImages:function(b){return e.every(b,function(a){return a.nativeFile&&a.nativeFile.type&&0===a.nativeFile.type.indexOf("image/")})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item.soy' */
// This file was automatically generated from file-item.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.fileDialogListItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="attached-file loading" data-attachment-id="', soy.$$escapeHtml(opt_data.file.id), '" data-owner-id="', soy.$$escapeHtml(opt_data.file.ownerId), '" data-file-name="', soy.$$escapeHtml(opt_data.file.fileName), '"><div class="file-container" title="', soy.$$escapeHtml(opt_data.tooltip), '">', (opt_data.file.isImage) ? '<img class="thumbnail hidden" src="' + soy.$$escapeHtml(opt_data.file.nonceUrl) + '" ><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : (opt_data.file.isPreviewable) ? '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span><a href="' + soy.$$escapeHtml(opt_data.file.downloadUrl) + '" class="abs-icon zoom">Zoom</a><p class="hidden image-preview-throbber">&nbsp;</p>' : '<span class="thumbnail ' + soy.$$escapeHtml(opt_data.file.iconClass) + '" ><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>', '<i class="abs-icon select">Select</i></div><span class="caption filename" title="', soy.$$escapeHtml(opt_data.file.fileName), '">', opt_data.highlightedImageNameContent, '</span>', (opt_data.highlightedParentTitleContent) ? '<span class="caption owner-title" title="' + soy.$$escapeHtml(opt_data.file.parentTitle) + '">' + opt_data.highlightedParentTitleContent + '</span>' : '', '</li>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.File.fileDialogListItemPlaceHolder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="attached-file loading" data-attachment-id="', soy.$$escapeHtml(opt_data.file.id), '" data-file-name="', soy.$$escapeHtml(opt_data.file.fileName), '"><div class="file-container" title="', soy.$$escapeHtml(opt_data.file.fileName), '">', (opt_data.file.isImage && opt_data.file.url) ? '<img class="thumbnail" src="' + soy.$$escapeHtml(opt_data.file.url) + '">' : '<span class="thumbnail"><i class="aui-icon size-48 svg-icon ' + soy.$$escapeHtml(opt_data.file.iconAUIClass) + '">File</i></span>', '<div id="docs-progress-bar-', soy.$$escapeHtml(opt_data.file.fileId), '" class="aui-progress-indicator"><span class="aui-progress-indicator-value"></span></div><div class="overlay"></div><i class="aui-icon aui-icon-small aui-iconfont-close-dialog abs-icon cancel">Cancel</i></div><span class="caption filename" title="', soy.$$escapeHtml(opt_data.file.fileName), '">', soy.$$escapeHtml(opt_data.file.fileName), '</span><span class="caption owner-title hidden" title=""></span></li>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-model.js' */
(function(d,b){var c=Backbone.Model.extend({defaults:{id:-1,ownerId:-1,fileName:"",nonceUrl:"",isImage:!1,isFilePlaceHolder:!1,isSelect:!1,thumbnailUrl:"",downloadUrl:""},initialize:function(){var a=this;this._findDownloadUrl();this._findThumbnailUrl();this.set("fileName",this.getFileName());this.set("nonceUrl",this.getNonceUrl());this.set("isImage",this.isImage());this.set("isPreviewable",this.isPreviewable());this.get("attachmentId")&&this.set("id",this.get("attachmentId"));this.get("isFilePlaceHolder")&&
this.set("id",this.get("fileId"));this.listenTo(this,"change:link",function(){a.set("nonceUrl",a.getNonceUrl());a._findDownloadUrl()});this.set("iconAUIClass",this._parseFileNameToAuiIconClass(this.get("fileName")))},isImage:function(){return this.get("isImage")?!0:!!this.get("thumbnailUrl")},isPreviewable:function(){return"pdf document"===(this.get("niceType")||"").toLocaleLowerCase()||this.isImage()},getFileName:function(){return this.get("fileName")||this.get("name")||""},getDestinationUrl:function(){return AJS.REST.wikiLink(this.attributes).destination},
getNonceUrl:function(){var a=this.get("thumbnailUrl");if(0<=a.indexOf("modificationDate"))return a;var b=this.get("lastModifiedDate"),b=b?b.date:+new Date,b=encodeURIComponent(b);a&&(b=(a.indexOf("?")+1?"&":"?")+"nonce="+b,a+=b);return a},getRelativeUrl:function(a){if(!a)return a;0===a.indexOf(b.getBaseUrl())&&(a=a.replace(b.getBaseUrl(),""),a=b.getContextPath()+a);return a},_findThumbnailUrl:function(){!this.get("thumbnailUrl")&&this.get("thumbnailLink")&&this.set("thumbnailUrl",this.getRelativeUrl(this.get("thumbnailLink").href))},
_findDownloadUrl:function(){var a=this.get("link");!this.get("downloadUrl")&&a&&(a=_.findWhere(a,{rel:"download"}).href,this.set("downloadUrl",this.getRelativeUrl(a)))},_getFileExtension:function(a){return a.substr(a.lastIndexOf(".")+1)},_parseFileNameToAuiIconClass:function(a){a="undefined"!==typeof plupload?plupload.mimeTypes[this._getFileExtension(a)]:"";return AJS.Confluence.FileTypesUtils.getAUIIconFromMime(a)}});b.Editor=b.Editor||{};b.Editor.FileDialog=b.Editor.FileDialog||{};b.Editor.FileDialog.FileItemModel=
c})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-item-view.js' */
(function(e,d){var f=Backbone.View.extend({template:d.Templates.File.fileDialogListItem,model:null,initialize:function(a){var b=this;this.eventListener=a.eventListener;this.model=a.model;this.showContainerInfo=a.showContainerInfo;this.highlighter=a.highlighter;this.listenTo(this.model,"change:isSelect",function(){b.$el.toggleClass("selected",b.model.get("isSelect"))})},render:function(){var a=this.highlighter||new d.Highlighter,b=this.model.get("space"),c=this.model.getFileName(),a={file:this.model.attributes,
tooltip:this.showContainerInfo&&b?c+" ("+b.name+")":c,highlightedImageNameContent:a.highlight(c),highlightedParentTitleContent:this.showContainerInfo?a.highlight(this.model.attributes.parentTitle):null};this.$el=e(this.template(a));this.el=this.$el[0];this.delegateEvents();this.$el.find(".file-container").tooltip({aria:!0});this.$el.attr("data-destination",this.model.getDestinationUrl());this.model.get("isImage")?this._renderLoadingSpinner():this.$el.removeClass("loading");this.model.get("isPreviewable")&&
this._renderPreviewButton();return this},_renderPreviewButton:function(){this.$(".zoom").on("click",_.bind(function(a){a.preventDefault();a={src:this.model.get("downloadUrl"),thumbnail:this.model.get("nonceUrl")||this.model.get("downloadUrl"),type:this.model.get("contentType"),rank:0,title:this.model.getFileName(),id:this.model.get("id"),ownerId:this.model.get("ownerId"),version:this.model.get("version")};this._setupAndShowPreviewer(a)},this))},_setupAndShowPreviewer:function(a){var b={viewMode:"simple",
openPreviewCallback:function(){e("#insert-image-dialog").hide();e(".aui-blanket").hide()},closePreviewCallback:function(){e("#insert-image-dialog").show();e(".aui-blanket").show()}},c=_.bind(function(a,b){this.loader=require("cp/confluence/file-preview-loader");var c=this.loader.setupPreviewForSingleFile([a],b);c.on("fv.open",b.openPreviewCallback);c.on("fv.close",b.closePreviewCallback);c.open();c.showFileWhere()},this);this.dfd?this.dfd.done(_.partial(c,a,b)):this.dfd=WRM.require("wr!com.atlassian.confluence.plugins.confluence-previews:confluence-previews-resources",
_.partial(c,a,b))},_renderLoadingSpinner:function(){var a=this,b=this.$el.find(".image-preview-throbber").removeClass("hidden"),c=Raphael.spinner(b[0],8,"#666"),d=this.$el.find("img").load(function(){c();b.remove();d.removeClass("hidden");a.$el.removeClass("loading")})}});d.Editor=d.Editor||{};d.Editor.FileDialog=d.Editor.FileDialog||{};d.Editor.FileDialog.FileItemView=f})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-item/file-placeholder-view.js' */
(function(b,a){var d=Backbone.View.extend({model:null,template:a.Templates.File.fileDialogListItemPlaceHolder,initialize:function(a){this.model=a.model;this.eventListener=a.eventListener;this.eventListener.on("file.placeholder.process",_.bind(this._setUploadInProgress,this))},events:{"click .cancel":"_cancelUpload"},render:function(){this.$el=b(this.template({file:this.model.attributes}));this.el=this.$el[0];this.delegateEvents();return this},_setUploadInProgress:function(a,b){var c=this.$el.find("#docs-progress-bar-"+
b||"");c.length&&(1===a&&this.$(".cancel").hide(),c.show(),AJS.progressBars.update(c,a))},_cancelUpload:function(){this.eventListener.trigger("uploadingfile.cancelled",this.model.get("fileId"))}});a.Editor=a.Editor||{};a.Editor.FileDialog=a.Editor.FileDialog||{};a.Editor.FileDialog.FilePlaceHolderView=d})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-collection.js' */
(function(d,b){var c=Backbone.Collection.extend({model:b.Editor.FileDialog.FileItemModel,clearSelection:function(){this.each(function(a){a.get("isSelect")&&a.set("isSelect",!1)});this.trigger("clear.selection")},getAllSelectItems:function(){return this.filter(function(a){return a.get("isSelect")})},setSelection:function(a){_.each(a,function(a){return a.set("isSelect",!0)})},resetFiles:function(a){this.reset();for(var b=0;b<a.length;b++)this.addFile(a[b])},addFile:function(a){a=this.add(a);this.trigger("add-file",
a.at(a.length-1))},removeFile:function(a){this.remove(a);this.trigger("remove-file",a)},replaceFile:function(a,b){this.remove(a);this.add(b);this.trigger("replace-file",a,b)}});b.Editor=b.Editor||{};b.Editor.FileDialog=b.Editor.FileDialog||{};b.Editor.FileDialog.FileListCollection=c})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-list/file-list-view.js' */
(function(d,c){var e=c.Editor.FileDialog.FileItemView,g=c.Editor.FileDialog.FileItemModel,h=c.Editor.FileDialog.FilePlaceHolderView,i=Backbone.View.extend({eventListener:null,events:{click:"_clearSelection","click li.attached-file":"_clickItem","dblclick li.attached-file":"_doubleClickItem"},initialize:function(a){var b=this;this.collection=a.collection;a.eventListener&&(this.eventListener=a.eventListener,this.listenTo(this.eventListener,"uploadingfile.completed",this._addUploadedFile),this.listenTo(this.eventListener,
"uploadingfile.cancelled",this._cancelUploadingFile));this.listenTo(this.collection,"reset",this._clearFileList);this.listenTo(this.collection,"add-file",this._renderNewItem);this.listenTo(this.collection,"remove-file",this._removeItem);this.listenTo(this.collection,"replace-file",this._replaceItem);this.listenTo(this.collection,"change:isSelect",function(){this.context.setSelectItems(this.collection.getAllSelectItems())});this.listenTo(this.collection,"change:link",function(a){b.collection.removeFile(a);
b.collection.addFile(a)});this.updateDialogContext(a.context);this.updatePanelContext(a.panelContext)},_addUploadedFile:function(a,b){var c=this,f=this.collection.get(a);if(f){var e=AJS.contextPath()+"/rest/prototype/1/attachment/"+b+".json";d.get(e).done(function(a){a=new g(a);c.collection.replaceFile(f,a)})}},_cancelUploadingFile:function(a){(a=this.collection.get(a))&&(a.get("previousUploadedFile")?this.collection.replaceFile(a,a.get("previousUploadedFile")):this.collection.removeFile(a))},render:function(){return this},
resetFileList:function(a,b){b=b||{};this.$el.find(".loading-message").addClass("hidden");this.$el.find(".no-files").remove();this.collection.resetFiles(a);0===this.collection.length&&this.$fileList.before(d("<p></p>").addClass("no-files").text(this.noFileMessage));b.shouldClearSelection&&this.collection.clearSelection();this._checkError(b.errors);this.$el.sizeToFit()},_getViewFromModel:function(a){return a.get("isFilePlaceHolder")?(new h({model:a,eventListener:this.eventListener})).render():(new e({model:a,
showContainerInfo:this.showContainerInfo,highlighter:this.highlighter,eventListener:this.eventListener})).render()},_renderNewItem:function(a){if(this.$fileList&&this.$fileList.length){var b=this._getViewFromModel(a);this.$fileList.prepend(b.el);a.get("isFilePlaceHolder")||a.set("isSelect",!0)}},_removeItem:function(a){this.$fileList&&this.$fileList.length&&(a=this._getDomElementByFileName(a.get("fileName")))&&a.remove()},_replaceItem:function(a,b){if(this.$fileList&&this.$fileList.length){var c=
this._getViewFromModel(b),d=this._getDomElementByFileName(a.get("fileName"));d&&d.length?d.replaceWith(c.el):this.$fileList.prepend(c.el);b.set("isSelect",!0)}},_getDomElementByFileName:function(a){var b=null;this.$fileList.find("li").each(function(){var c=d(this);c.attr("data-file-name")===a&&(b=c)});return b},updatePanelContext:function(a){a&&(this.panelContext=a,this.errors=this.panelContext.errors||[],this.$el=this.fileContainer=this.panelContext.fileContainer,this.el=this.$el[0],this.$fileList=
this.$el.find(".file-list"),this.delegateEvents(),this.noFileMessage=this.panelContext.noFileMessage,this.showContainerInfo=this.panelContext.showContainerInfo,this.highlighter=this.panelContext.highlighter,this.displayErrors=this.panelContext.displayErrors)},updateDialogContext:function(a){a&&(this.context=a,this.contextOptions=this.context.options)},_checkError:function(a){(a=a||[])&&a.length&&this.displayErrors(a)},_clearSelection:function(a){a=a&&d(a.target);if(!a||!a.hasClass("close-tip"))this.collection.clearSelection(),
this.$el.find(".current").removeClass("current")},_clearFileList:function(){this.$fileList&&this.$fileList.empty()},_clickItem:function(a){a.stopPropagation();a.preventDefault();var b=d(a.target);b.closest(".zoom").length||(a.isTrigger||this.$fileList.find(".current").removeClass("current"),a=b.closest("li").attr("data-attachment-id"),(a=this.collection.get(a))&&!a.get("isFilePlaceHolder")&&a.set("isSelect",!a.get("isSelect")))},_doubleClickItem:function(a){var a=d(a.target).closest("li"),b=a.attr("data-attachment-id");
if((b=this.collection.get(b))&&!b.get("isFilePlaceHolder"))a.click(),this.context.insert()}});c.Editor=c.Editor||{};c.Editor.FileDialog=c.Editor.FileDialog||{};c.Editor.FileDialog.FileListView=i})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/base-panel/base-panel-view.js' */
(function(b,a){var d=Backbone.View.extend({context:null,cssContainer:"",cssPanel:"",textErrorSearch:"Error searching for attachments from Confluence. The server may be unavailable.",textErrorRetrieving:"Error retrieving attachments from Confluence. The server may be unavailable.",textDefaultErrorMessage:"Could not upload the file to Confluence. The server may be unavailable.",textUploading:"Image uploading...",initialize:function(){},createPanel:function(c){this.context=c;this.render();var a=this;if(c=this.context.getPanel(this.panelId))c.onselect=
function(){a.context.clearSelection();a.focus&&a.focus()}},render:function(){return this},getPanelElement:function(){return b(this.cssPanel,this.context.baseElement)},getContainer:function(){return b(this.cssContainer)},getForm:function(){return b("form",this.getPanelElement())},clearContainer:function(){var a=this.getContainer();a.find(".loading-message").removeClass("hidden");a.find(".warning").addClass("hidden")},clearErrors:function(){this.messenger.clearMessages()},displayErrors:function(a){this.uploader.displayErrors(a);
this.getContainer().sizeToFit()},getNoFileContainer:function(){return this.getPanelElement().find(".no-files")},getFileListContainer:function(){return this.getPanelElement().find("ul.file-list")}});a.Editor=a.Editor||{};a.Editor.FileDialog=a.Editor.FileDialog||{};a.Editor.FileDialog.BasePanel=d;a.Editor.FileDialog.eventListener=_.extend({},Backbone.Events)})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel.soy' */
// This file was automatically generated from attachments-panel.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.uploadFileForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.hasAttachPermission) ? '<div id="upload-attachment">' + ((opt_data.isNonSupportDragDrop) ? '<form action="' + soy.$$escapeHtml("/confluence") + '/pages/attachfile.action" method="post" enctype="multipart/form-data">' : '<form>') + '<label id="upload-files-button" class="aui-button upload-files"><span class="file-upload-icon">' + soy.$$escapeHtml("Upload files") + '</span>&nbsp;&nbsp;' + soy.$$escapeHtml("Upload files") + ((opt_data.isNonSupportDragDrop) ? '<input name="file_0" type="file" class="upfile invisible">' : '') + '</label>' + ((opt_data.isNonSupportDragDrop) ? '<input type="hidden" name="minorEdit_0" value="true" /><input type="hidden" name="atl_token" value="' + soy.$$escapeHtml(opt_data.atlToken) + '" />' : '') + '</form>' + ((opt_data.isNonSupportDragDrop) ? '<div class="upload-in-progress hidden">' + soy.$$escapeHtml("Image uploading...") + '</div>' : '') + '</div>' : '', (opt_data.hasAttachPermission) ? '<div class="divider"></div>' : '');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.File.attachedFilesPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="attached-files" class="scroll-wrapper">');
  aui.message.warning({title: '', closeable: 'true', content: ''}, output);
  output.append('<div class="loading-message hidden">', soy.$$escapeHtml("Loading\u2026"), '</div><ul class="file-list"></ul></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/attachments-panel/attachments-panel-view.js' */
(function(e,c){var i=c.Editor.FileDialog.FileListView,f=c.Editor.FileDialog.FileItemModel,j=c.Editor.FileDialog.FileListCollection,g=c.Editor.FileDialog.BasePanel,k=g.extend({id:"attachments",panelId:"",cssPanel:".attachments-panel",cssContainer:"#attached-files",textNoFileMessage:"There are no files attached to this page.",textPanelTitle:"Attached to this page",initialize:function(a){g.prototype.initialize.call(this);this.eventListener=a.eventListener;this.context=null;
this.collection=new j;this.fileListView=new i({collection:this.collection,eventListener:this.eventListener});this.xhrCount=0},render:function(){var a=this;this.eventListener.trigger("AttachmentsPanelView.render",this);this.fileListView.updateDialogContext(this.context);this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"attachments-panel");this.el=this.getPanelElement();this.$el=e(this.el);this.delegateEvents();this.fileListView.updatePanelContext({fileContainer:this.getContainer(),
noFileMessage:this.textNoFileMessage,showContainerInfo:!1,errors:[],displayErrors:function(b){a.uploader.clearErrors();a.uploader.displayErrors(b)}});this.uploader=this.getUploaderController(this.context);this.messenger=this.uploader.getMessageHandler();this.collection.reset();this._canAttachFiles()?this.refresh({shouldClearSelection:!0}):this.refresh({errors:["You\'ll need to ask permission to insert files here."],shouldClearSelection:!0});return this},getPanel:function(){return c.Templates.File.uploadFileForm({isNonSupportDragDrop:!this._hasXhrSupport(),
atlToken:AJS.Meta.get("atl-token"),hasAttachPermission:this._canAttachFiles()})+c.Templates.File.attachedFilesPanel()},_overideUploaderClientForNonDragDropSupport:function(){var a=this;return{onUploadSuccess:function(b){for(var c=0;c<b.length;c++){var d=b[c].id,h=a.collection.get(d);h&&a.collection.removeFile(h);d=AJS.contextPath()+"/rest/prototype/1/attachment/"+d+".json";e.get(d).done(function(b){b=new f(b);a.collection.addFile(b)})}},pack:function(){a.getContainer().sizeToFit()},getDefaultErrorMessage:function(){return a.textDefaultErrorMessage},
getDefaultUploadingMessage:function(){return a.textUploading},displayErrors:function(b){this.getMessageHandler().displayMessages(b);a._showErrorIconInMessageBox();this.pack()}}},getUploaderController:function(){return c.AttachmentUploader({baseElement:this.getPanelElement()},_.bind(this._overideUploaderClientForNonDragDropSupport,this))},refresh:function(a){var b=this,c=a.shouldClearSelection?this.getPanelElement().find(".loading-message"):!1,d=this.xhrCount+=1;AJS.getJSONWrap({url:this._getUrlREST(),
messageHandler:this.messenger,loadingElement:c,errorMessage:this.textErrorRetrieving,successCallback:function(c){d===b.xhrCount&&(a.data=c,b._onSuccessLoadFiles(a))},errorCallback:_.bind(this._onErrorLoadFiles,this)})},_onSuccessLoadFiles:function(a){this.fileListView.resetFileList(a.data.attachment?a.data.attachment:a.data.images,a)},_onErrorLoadFiles:function(){this._showErrorIconInMessageBox()},_showErrorIconInMessageBox:function(){var a=this.messenger.getMessageContainer().find("ul");a.toggleClass("one-message",
1===a.find("li").length);a.closest(".aui-message").append("<span class='aui-icon icon-warning'></span>")},setUploadInProgress:function(a,b){this.eventListener.trigger("file.placeholder.process",a,b)},attachmentUploaded:function(a,b){this.eventListener.trigger("uploadingfile.completed",a,b)},attachmentUploadingCancelled:function(a){this.eventListener.trigger("uploadingfile.cancelled",a)},_hasXhrSupport:function(){var a,b;try{a=new XMLHttpRequest,b=!(!a.sendAsBinary&&!a.upload)&&!(jQuery.browser.mozilla&&
-1<jQuery.browser.version.indexOf("1.9.1"))}catch(c){b=!1}return b},addPreviewImage:function(a){if(window.File&&window.FileReader&&window.FileList&&window.Blob){var b=this,c=tinymce.isIE?1048576:5242880;a.isImage=a.nativeFile&&a.nativeFile.type&&this._isImageType(a.nativeFile.type);if(a.isImage&&a.nativeFile.size<c){var d=new FileReader;d.onload=function(){b._addFilePlaceHolderToCollection(a,d.result)};d.readAsDataURL(a.nativeFile)}else this._addFilePlaceHolderToCollection(a,null)}},_addFilePlaceHolderToCollection:function(a,
b){var c=null,d=this.collection.findWhere({fileName:a.name});d&&(this.collection.removeFile(d),d.get("isFilePlaceHolder")?d.get("previousUploadedFile")&&(c=d.get("previousUploadedFile")):c=d);this.collection.addFile(new f({isFilePlaceHolder:!0,fileName:a.name,fileId:a.id,fileNative:a.nativeFile,url:b?b:"",isImage:a.isImage,niceType:a.isImage?"Image":"",fileType:a.nativeFile.type,thumbnailUrl:b?b:"",previousUploadedFile:c}))},_isImageType:function(a){return AJS.Confluence.FileTypesUtils.isImage(a)},
_canAttachFiles:function(){return AJS.Meta.getBoolean("can-attach-files")},_getUrlREST:function(){var a=parseInt(AJS.Meta.get("attachment-source-content-id"),10);return AJS.REST.makeUrl("content/"+a+"/attachments.json")},focus:function(){this.collection.clearSelection()}});c.Editor=c.Editor||{};c.Editor.FileDialog=c.Editor.FileDialog||{};c.Editor.FileDialog.AttachmentsPanelView=k})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel.soy' */
// This file was automatically generated from external-panel.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.webPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="insert-web-image"><form id="insert-web-image-form" action="#" class="aui"><fieldset class="inline"><div class="web-image-input"><label for="insert-web-image-image-url" id="insert-web-image-image-url-label">', soy.$$escapeHtml("Image URL:"), '</label><input type="text" class="text image-url" id="insert-web-image-image-url" name="insert-web-image-image-url"></div><input type="submit" class="image-preview aui-button" value="', soy.$$escapeHtml("Preview"), '"></fieldset></form><p class="faraway image-preview-area"></p><p class="hidden image-preview-error">', soy.$$escapeHtml("This image couldn\x27t be loaded for preview. Please check the URL."), '</p><p class="hidden image-preview-throbber">&nbsp;</p></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/external-panel/external-panel-view.js' */
(function(c,a){var e=a.Editor.FileDialog.BasePanel,f=a.Editor.FileDialog.BasePanel.extend({id:"external",panelId:"",cssPanel:".web-image-panel",cssContainer:".insert-web-image",textPanelTitle:"Images from the web",template:a.Templates.File.searchPanel,events:{"submit form":"_submit","keyup input.image-url":"_checkAllowInsert","click input.image-url":"_checkAllowInsert","blur input.image-url":"_checkAllowInsert"},initialize:function(){e.prototype.initialize.call(this);this.context=
null;this.token=0},render:function(){this.panelId=this.context.addPanel(this.textPanelTitle,this.getPanel(),"web-image-panel");this.container=this.getContainer();this.preview=this.container.find(".image-preview-area");this.throbber=this.container.find(".image-preview-throbber");this.killSpinner=null;this.error=this.container.find(".image-preview-error")},focus:function(){this._getImageInput().focus();this._checkAllowInsert()},getPanel:function(){this.$el=c(a.Templates.File.webPanel());this.el=this.$el[0];
this.delegateEvents();return this.el},_getImageInput:function(){return c("input.image-url",this.context.baseElement)},_submit:function(a){a.preventDefault();a.stopPropagation();var b=this,a=this._getImageInput().val();if("http://"===a)return!1;this.token++;var d=this.token;this.preview.addClass("faraway").html("");this.throbber.removeClass("hidden");this.killSpinner||(this.killSpinner=Raphael.spinner(this.throbber[0],60,"#666"));this.error.addClass("hidden");c("<img>").load(function(){if(d===b.token){b.killSpinner();
b.killSpinner=null;b.throbber.addClass("hidden");b.preview.removeClass("faraway");b._checkAllowInsert()}}).error(function(){if(d===b.token){b.killSpinner();b.killSpinner=null;b.throbber.addClass("hidden");b.error.removeClass("hidden");b._checkAllowInsert()}}).appendTo(this.preview).attr("src",a)},_checkAllowInsert:function(){var a=this.$el.find("input.image-url").val();this.context.setSelectItems(""!==a&&"http://"!==a?a:[])}});a.Editor=a.Editor||{};a.Editor.FileDialog=a.Editor.FileDialog||{};a.Editor.FileDialog.ExternalPanelView=
f})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel.soy' */
// This file was automatically generated from search-panel.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.searchPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="search-panel-wrapper"><div id="search-image"><form class="aui search-form" id="search-image-form" action="#"><fieldset class="inline"><div class="search-input"><label for="search-image" class="assistive">', soy.$$escapeHtml("Search"), '</label><input autofocus type="text" class="text search-image-text" size="50" autocomplete="off"></div><select class="search-space select" id="search-image-space-select"><option value="">', soy.$$escapeHtml("All Spaces"), '</option><option value="', soy.$$escapeHtml(opt_data.spaceKey), '">', soy.$$escapeHtml(opt_data.spaceName), '</option></select><button type="submit" class="aui-button search-button">', soy.$$escapeHtml("Search"), '</button></fieldset></form></div><div id="searched-images" class="scroll-wrapper"><div class="loading-message hidden">', soy.$$escapeHtml("Searching\u2026"), '</div><ul class="file-list"></ul></div></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/search-panel/search-panel-view.js' */
(function(b,a){var d=a.Editor.FileDialog.FileListView,e=a.Editor.FileDialog.FileListCollection,f=a.Editor.FileDialog.BasePanel,g=a.Editor.FileDialog.BasePanel.extend({id:"search",panelId:"",cssPanel:".search-panel",cssContainer:"#searched-images",template:a.Templates.File.searchPanel,events:{"submit form":"_submit"},initialize:function(){f.prototype.initialize.call(this);this.context=null;this.collection=new e;this.fileListView=new d({collection:this.collection})},getPanel:function(){this.$el=b(this.template({spaceKey:AJS.Meta.get("space-key"),
spaceName:AJS.Meta.get("space-name")}));this.el=this.$el[0];this.delegateEvents();return this.el},render:function(){this.fileListView.updateDialogContext(this.context);this.panelId=this.context.addPanel("Search on other pages",this.getPanel(),"search-panel");this.fileListView.updatePanelContext({fileContainer:this.getContainer(),noFileMessage:"No search results found.",showContainerInfo:!0})},_submit:function(a){a.preventDefault();a.stopPropagation();
this._getQuery()&&(this.clearContainer(),this.collection.reset(),this._loadImages().then(_.bind(this._onSuccessLoadFiles,this),_.bind(this._onErrorLoadFiles,this)))},_loadImages:function(){return b.ajax({type:"GET",dataType:"json",url:a.getContextPath()+AJS.REST.getBaseUrl()+"search.json",data:{spaceKey:this.getForm().find(".search-space").val(),query:this._getQuery(),search:"name",type:"attachment",attachmentType:[],groupResults:!0,maxResultsPerGroup:50,searchParentName:!0,pageSize:a.Defaults.maxResults}})},
_onSuccessLoadFiles:function(c){var b={result:[]};c.result&&0<c.result.length?b=c:c.group&&c.group[0]&&(b=c.group[0]);this.fileListView.highlighter=new a.Highlighter(this._getQuery().split(" "));this.fileListView.resetFileList(b.result,{shouldClearSelection:!0})},_onErrorLoadFiles:function(){var a=this.getContainer();a.find(".loading-message").addClass("hidden");a.append(b("<p class='warning'>"+b(this.textErrorSearch).text()+"</p>"))},_getSearchText:function(){return b("input.search-image-text",this.getForm())},
_getQuery:function(){return this._getSearchText().val()||""},focus:function(){this.collection.clearSelection();this._getSearchText().focus()}});a.Editor=a.Editor||{};a.Editor.FileDialog=a.Editor.FileDialog||{};a.Editor.FileDialog.SearchPanelView=g})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog.soy' */
// This file was automatically generated from file-dialog.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.File == 'undefined') { Confluence.Templates.File = {}; }


Confluence.Templates.File.helpLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="dialog-help-link"><a href="', soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-58/Displaying+Files+and+Images"), '" target="_blank">', soy.$$escapeHtml("Help"), '</a></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:panel-components', location = 'files/file-dialog/file-dialog-view.js' */
(function(d,e){var h=Backbone.View.extend({dialogId:"insert-image-dialog",ESC_KEY_CODE:27,width:840,height:530,initialize:function(a){this.urlExternalImg="";this.selectItems=[];this.submitCallback=a.submitCallback;this.cancelCallback=a.cancelCallback;this.beforeShowListeners=a.beforeShowListeners;this.panelComponents=a.panelComponents},render:function(){this._createDialog();this.clearSelection();d(document).on("keydown.insert-image",_.bind(this._onNavigationByKey,this));return this},_createDialog:function(){var a=
new AJS.Dialog(this.width,this.height,this.dialogId),j="Insert files and images",b="Insert";this.dialog=a;a.addHeader(j);a.addButton(b,_.bind(this._submitDialog,this),"insert");a.addCancel("Close",_.bind(this._killDialog,this));this.el=a.popup.element;this.$el=d(this.el);this.baseElement=this.el;this.$el.attr("data-tab-default","0");this.$insertButton=this.$el.find(".dialog-button-panel .insert");d("#"+this.dialogId+
" .dialog-components .dialog-title").prepend(e.Templates.File.helpLink());this.$el.find(".dialog-button-panel").append(d("<div></div>").addClass("dialog-tip").html("Hint: type \"\u003cstrong\u003e!\u003c/strong\u003e\" in the Editor to insert attached images on the page."));this._createPanels();d(document).on("hideLayer",_.bind(function(c,b,d){"popup"===b&&d===a.popup&&(d.remove(),this.teardown(),"function"===typeof this.cancelCallback&&this.cancelCallback())},this));AJS.bind("remove.dialog",_.bind(function(a,b){b.dialog.id===this.dialog.id&&this.teardown()},
this));a.show();return a},_createPanels:function(){var a=this;d.each(this.panelComponents,function(){this&&"function"===typeof this.createPanel&&this.createPanel(a)});AJS.debug(this.beforeShowListeners.length+" beforeShow listeners registered.");d.each(this.beforeShowListeners,function(){"function"===typeof this&&this()})},teardown:function(){d(document).unbind(".insert-image");d(".tipsy").remove();this.undelegateEvents()},_killDialog:function(){this.dialog.remove();this.clearSelection();"function"===
typeof this.cancelCallback&&this.cancelCallback()},_submitDialog:function(){var a={url:this.urlExternalImg,contentId:AJS.Meta.get("attachment-source-content-id"),selectItems:this.selectItems};this.dialog.remove();"function"===typeof this.submitCallback&&this.submitCallback(a)},setSelectItems:function(a){"string"===typeof a?(this.urlExternalImg=a,this.selectItems=[]):(this.urlExternalImg="",this.selectItems=a);a=0<this.selectItems.length||this.urlExternalImg;this.$insertButton&&(this.$insertButton.prop("disabled",
!a),this.$insertButton.attr("aria-disabled",!a))},clearSelection:function(){this.setSelectItems([])},insert:function(){this.$insertButton&&(!this.$insertButton.is(":disabled")||!this.$insertButton.attr("aria-disabled"))&&this.$insertButton.click()},addPanel:function(a,d,b,c){var e=this.dialog.getPage(0).panel.length;this.dialog.addPanel(a,d,b,c);return e},getPanel:function(a){return this.dialog.getPanel(a)},_onNavigationByKey:function(a){if(!d("#"+this.dialog.id).is(":hidden")){var e=this.dialog.getCurrentPanel().body,
b=e.find(".attached-file");if(!(0===b.length||d(document.activeElement).is("input[type=text], select, button"))){var c=window.tinymce.VK;switch(a.which){case c.LEFT:case c.UP:case c.RIGHT:case c.DOWN:var i=a.which,f;f=b.filter(".current");f.length||(f=b.filter(".selected"));if(f.length){f=b.index(f);var h=b.length,g={};g[c.LEFT]=-1;g[c.RIGHT]=1;g[c.UP]=-4;g[c.DOWN]=4;c=f+(g[i]?g[i]:0);b=b.eq(0>c||c>=h?f:c)}else b=b.first();b.parent().find("li.attached-file.current").removeClass("current");b.addClass("current");
b.length&&e.find(".scroll-wrapper").simpleScrollTo(b);return AJS.stopEvent(a);case c.SPACEBAR:return e.find("li.attached-file.current").click(),AJS.stopEvent(a);case c.ENTER:return this.insert(),AJS.stopEvent(a)}}}}});e.Editor=e.Editor||{};e.Editor.FileDialog=e.Editor.FileDialog||{};e.Editor.FileDialog.FileDialogView=h})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-resolver.js' */
define("confluence-ui-components/js/internal/space-resolver",["underscore","jquery","ajs"],function(i,b,h){var g={conf_all:"All spaces",conf_current:"Current space",conf_favorites:"Favourite spaces",conf_global:"Site spaces",conf_personal:"Personal spaces"};function e(j){var k=i.map(j,function(l){return"spaceKey="+encodeURI(l)});return k.join("&")}function f(k,l){var j=typeof l==="undefined";var m=i.escape(j?k:l);return{id:k,text:m,idOnly:j}}function a(m,p){var n={};var o=[];i.each(m,function(r){var q=d(r);if(q){n[r]=f(r,q)}else{o.push(r)}});var k;if(o.length){var l=h.contextPath()+"/rest/api/space?"+e(o);k=b.getJSON(l)}else{k=new b.Deferred();k.resolve({results:[]})}function j(r){var q=r.results;i.each(q,function(t){n[t.key]=f(t.key,t.name)});var s=i.map(m,function(t){return n[t]||f(t)});p(s)}k.done(j)}function d(j){return g[j]}var c=["conf_favorites","conf_global","conf_personal"];return{getSpaceDisplayItems:a,getSpaceCategoryDisplayName:d,getSpaceTypeKeys:function(){return c}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/space-picker.js' */
define("confluence-ui-components/js/space-picker",["underscore","ajs","jquery","confluence-ui-components/js/internal/space-resolver"],function(r,f,b,d){var a={data:null,suggestCategories:null};var p=function(s){return function(t){var u={id:t.spaceKey,text:t.spaceName};if(typeof s==="function"){return s(u)}return u}};var k;var c=function(s){return function(t,x){var w=b(t).val();if(w===""){return}var u=w.split(",");function v(y){if(!s.multiple){y=y[0]}x(y)}d.getSpaceDisplayItems(u,v)}};var e=function(t){var s;if(t.suggestCategories){var u={text:"Select a suggestion or type to search",children:r.map(t.suggestCategories,function(v){return{id:v,text:d.getSpaceCategoryDisplayName(v)}})}}return function(w){if(s){w.callback(s);return}function v(x){var y={results:[]};if(u){y.results.push(u)}if(x.length>0){y.results.push({text:"Suggested spaces",children:r.map(x,function(z){return{id:z.key,text:r.escape(z.name)}})})}s=y;w.callback(s)}b.getJSON(f.contextPath()+"/rest/recentlyviewed/1.0/recent/spaces").done(v).fail(function(){f.log("Couldn't fetch recent spaces");var x={results:[]};if(u){x.results.push(u)}w.callback(x)})}};var n=function(){return window.Select2.query.ajax({url:f.contextPath()+"/rest/quicknav/1/search?type=spacedesc&type=personalspacedesc",data:function(s){return{query:s,maxPerCategory:25}},quietMillis:250,results:function(u){var t=u.contentNameMatches;if(t.length<=1){return{results:[]}}else{var s=r.map(t[0],k);return{results:[{text:"Search results",children:s}]}}}})};function g(t){var s=n();var u=e(t);return function(v,x,w){if(v.term.length<2){return u(v)}else{if(typeof x==="function"){v.term=x(v.term)}k=p(w);return s(v)}}}function h(){var s=b(".select2-container-active").next("input");var t=s.val().trim();return(t!=="")?t.split(","):[]}function i(s){var t=r.intersection(s,d.getSpaceTypeKeys());return t.length>0}function j(s){return(typeof s.id!=="undefined")&&r.contains(d.getSpaceTypeKeys(),s.id)}function q(t,u,v){var s=[];t.forEach(function(w){if(w.children){var x=q(w.children,u,v);if(x.length){s.push(b.extend({},w,{children:x}))}}else{var y=j(w);if((u&&y)||(!u&&!y)){if(!r.contains(v,w.id)){s.push(w)}}}});return s}function m(t,v){if(!t.length||!v.length){return t}var u=i(v);var s=q(t,u,v);if(!s.length){s.push({text:"Can\'t filter by space types AND spaces",disabled:true})}return s}function o(s){var t=h();return m(s,t)}function l(t){t=r.extend({},a,t);var s={placeholder:"Select a space",formatResult:function(u,v,w){v.attr("title",b("<div/>").html(u.text).text());return b.fn.select2.defaults.formatResult.apply(this,arguments)},escapeMarkup:function(u){return u},multiple:t.multiple===true};if(t.disableMixedSpaceTypes){s.sortResults=o}if(t.data){return r.extend(s,{data:t.data})}else{return r.extend(s,{initSelection:c(t),query:g(t)})}}return{build:l,filterMixedTypesForValues:m}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:space-picker', location = '/js/internal/space-picker-legacy.js' */
window.Confluence.UI.Components.SpacePicker=require("confluence-ui-components/js/space-picker");AJS.deprecate.prop(window.Confluence.UI.Components.SpacePicker,"build",{sinceVersion:"1.4.22",extraInfo:"Use require('confluence-ui-components/js/space-picker')"});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:page-picker', location = '/js/page-picker.js' */
(function(b,a){a.build=function(c){c.placeholder="Select a page";c.contentType=["page"];c.showRecentlyViewedSpaces=false;c.spaceCatKeys=[];c.spaceKeys=[];return window.Confluence.UI.Components.SpacePagePicker.build(c)}}(AJS.$,window.Confluence.UI.Components.PagePicker));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:include-exclude-picker', location = '/js/include-exclude-picker.js' */
define("confluence-ui-components/js/include-exclude-picker",["jquery","underscore"],function(d,j){var e="";function c(k){var l=k.charAt(0);if(j.contains(["-"],l)){e=l;k=k.substring(1)}else{e=""}return k}function h(k){var l=d.extend({},k);if(l.children){l.children=j.map(l.children,h)}else{l.id=e+l.id;l.text=e+l.text}return l}function b(k){return function(l){l=c(l);return k(l)}}function f(k){return function(m){var l=k?k(m):m;if(e){l.results=j.map(l.results,h)}return l}}function a(k){return function(l){return k(l,c,h)}}function g(k){var l=k.text.charAt(0);if(l==="-"){return"cql-exclude"}return}function i(l){var k=d.extend({formatSelectionCssClass:g},l);if(k.query){k.query=a(k.query);return k}else{k.ajax=d.extend({},k.ajax);k.ajax.data=b(k.ajax.data);k.ajax.results=f(k.ajax.results);return k}}return{build:i}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-component.soy' */
// This file was automatically generated from cql-component.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.Templates == 'undefined') { Confluence.UI.Components.CQL.Templates = {}; }


Confluence.UI.Components.CQL.Templates.container = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cql-container"><div class="cql-error-container"></div><div class="cql-fields"></div></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-field.soy' */
// This file was automatically generated from cql-filter-field.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQLFilters == 'undefined') { Confluence.UI.Components.CQLFilters = {}; }
if (typeof Confluence.UI.Components.CQLFilters.Templates == 'undefined') { Confluence.UI.Components.CQLFilters.Templates = {}; }


Confluence.UI.Components.CQLFilters.Templates.baseFilterField = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cql-filter cql-field-', soy.$$escapeHtml(opt_data.field.fieldName), ' cql-type-', soy.$$escapeHtml(opt_data.field.valueType), '">');
  var id__soy8 = new soy.StringBuilder('cql-field-', soy.$$escapeHtml(opt_data.field.fieldName), '-', soy.$$escapeHtml(opt_data.counter));
  id__soy8 = id__soy8.toString();
  output.append('<label for="', soy.$$escapeHtml(id__soy8), '">', soy.$$escapeHtml(opt_data.label), (! opt_data.field.fixed) ? '<span class="aui-icon aui-icon-small aui-iconfont-remove" title="' + soy.$$escapeHtml("Remove field") + '"></span>' : '', '</label><input type="text" class="cql-field-input text" id="', soy.$$escapeHtml(id__soy8), '"></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'soy/cql/cql-filter-select.soy' */
// This file was automatically generated from cql-filter-select.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.UI == 'undefined') { Confluence.UI = {}; }
if (typeof Confluence.UI.Components == 'undefined') { Confluence.UI.Components = {}; }
if (typeof Confluence.UI.Components.CQL == 'undefined') { Confluence.UI.Components.CQL = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect == 'undefined') { Confluence.UI.Components.CQL.FilterSelect = {}; }
if (typeof Confluence.UI.Components.CQL.FilterSelect.Templates == 'undefined') { Confluence.UI.Components.CQL.FilterSelect.Templates = {}; }


Confluence.UI.Components.CQL.FilterSelect.Templates.container = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cql-add-filter-container"><button type="button" class="aui-button aui-button-link">', soy.$$escapeHtml("Add a field"), '</button><div class="input-wrapper hidden"><input class="select2-input" type="text" /></div></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-special-spaces.js' */
define("confluence-ui-components/js/cql/internal/cql-special-spaces",["underscore"],function(c){var e={conf_current:"currentSpace()",conf_favorites:"favourite",conf_global:"global",conf_personal:"personal"};var b=c.invert(e);var a=c.keys(e);function d(){return e}function g(){return a}function f(h){return b[h]}return{getMap:d,getKeys:g,getUIValue:f}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-ajax.js' */
define("confluence-ui-components/js/cql/internal/cql-ajax",["jquery","underscore","ajs"],function(e,d,b){var h;var c={equality:["ancestor","contributor","creator","label","mention","parent","space","type"],text:["title","text"]};function g(){if(!h){h=e.Deferred();var j=function(m){var l=m.equality;var n=m.text;if(!l||!n){throw Error("Unknown CQL field data returned from server - cannot initialise CQL fields.")}l=d.filter(l,function(o){return d.contains(c.equality,o.fieldName)});n=d.filter(n,function(o){return d.contains(c.text,o.fieldName)});var k=l.concat(n);k=d.sortBy(k,"fieldName");h.resolve(k)};var i=function(){h.reject()};e.getJSON(b.contextPath()+"/rest/cql/fields").done(j).fail(i)}return h.promise()}function f(i){return e.getJSON(b.contextPath()+"/rest/cql/expressions?cql="+encodeURIComponent(i))}function a(){return e.getJSON(b.contextPath()+"/rest/cql/contenttypes")}return{getFields:g,parseClauses:f,getContentTypes:a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-content-type-picker.js' */
define("confluence-ui-components/js/cql/internal/cql-content-type-picker",["jquery","underscore","ajs","confluence-ui-components/js/cql/internal/cql-ajax"],function(f,c,b,e){var h;var d=[];function a(i){d=c.map(i,function(j){return{id:j.type,text:j.label}})}function g(){if(!h){h=e.getContentTypes();h.done(a)}var i={query:function(j,m,l){m(j.term);var k=window.Select2.query.local({results:c.map(d,l)});k(j)},initSelection:function(k,n){var j=k.val().split(",");var m="";var l=c.map(j,function(o){var p=o.charAt(0);if(p==="-"){m="-";return o.substring(1)}return o});h.done(function(){var o=c.filter(d,function(p){return c.contains(l,p.id)});n(c.map(o,function(p){return{id:m+p.id,text:m+p.text}}))})},multiple:true,placeholder:"All content types"};return{select2Options:i,setDeferredValues:function(j){h.done(j)}}}return{build:g}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-field-model.js' */
define("confluence-ui-components/js/cql/internal/cql-field-model",[],function(){function b(d){try{return d.displayName.translation}catch(c){return a(d)}}function a(c){var d=c.fieldName;return d.charAt(0).toUpperCase()+d.substring(1)}return{getLabel:b}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-adjuster.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-adjuster",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(c,a){function b(f){var e=f.functionValues;if(!e||!e.length){return f}var d=[];c.each(e,function(g){if(g.functionName==="currentSpace"){d.push(a.getUIValue("currentSpace()"))}else{throw new Error(g.functionName+" is not a known function")}});f.values=d.concat(f.values);return f}return{convertFunctionValues:b}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-field.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-field",["jquery","underscore","ajs","confluence-ui-components/js/cql/internal/cql-content-type-picker","confluence-ui-components/js/cql/internal/cql-field-model","confluence-ui-components/js/cql/internal/cql-expression-builder","confluence-ui-components/js/cql/internal/cql-space-expression-builder","confluence-ui-components/js/cql/internal/cql-space-expression-adjuster","confluence-ui-components/js/cql/internal/cql-special-spaces","confluence-ui-components/js/label-picker","confluence-ui-components/js/include-exclude-picker","confluence-ui-components/js/page-picker","confluence-ui-components/js/space-picker"],function(d,r,g,p,n,k,j,i,o,q,l,e,f){var b=window.Confluence.Binder.autocompleteMultiUser;var a=window.Confluence.UI.Components.CQLFilters.Templates;var h=0;function c(y,w,v){var u=n.getLabel(y);var x=d(w({label:u,field:y,counter:h++}));var t=x.find("input");var s=r.bind(v,t);x.data("fieldName",y.fieldName);return d.extend({element:x,onChange:function(z){t.change(z)},asCql:s},y)}function m(y,t){var u=y.valueType;var A=y.fieldName;if(!u){throw new Error("Can't create filter without valueType.")}if(!A){throw new Error("Can't create filter without fieldName.")}var x,z;function v(){return k.buildEqualityExpressionFromValuesString(A,this.val())}if(u==="label"){x=c(y,a.baseFilterField,v);z=x.element.find("input");z.auiSelect2(l.build(q.build({createSearchChoice:false,noMatches:"No matching labels found"})));x.setValues=function(C){z.select2("val",C.values)}}else{if(u==="user"){x=c(y,a.baseFilterField,v);z=x.element.find("input");z.addClass("select2-input autocomplete-multiuser");var s=function(D){var C=D[0].result[0];return{id:C.username,text:C.title,imgSrc:C.thumbnailLink.href}};x.setValues=function(F){var D=F.values;if(!D||!D[0]){return}var E=r.map(D,function(G){return d.getJSON(g.contextPath()+"/rest/prototype/1/search/user.json?query="+encodeURI(G))});function C(){var H=E.length>1?arguments:[arguments];var G=r.map(H,s);z.auiSelect2("data",G)}d.when.apply(d,E).done(C)};b(x.element)}else{if(u==="space"){x=c(y,a.baseFilterField,function(){return j.buildExpressionFromValuesString(this.val())});z=x.element.find("input");z.auiSelect2(l.build(f.build({multiple:true,suggestCategories:o.getKeys(),disableMixedSpaceTypes:true})));x.setValues=function(C){i.convertFunctionValues(C);z.select2("val",C.values)}}else{if(u==="contentId"){x=c(y,a.baseFilterField,function(){var D=this.val().trim();if(!D){return undefined}var C=D.replace(/[a-z]+:/g,"");return k.buildEqualityExpressionFromValuesString(A,C)});z=x.element.find("input");var B={multiple:A!=="parent"};z.auiSelect2(e.build(B));x.setValues=function(E){function D(F){return"page:"+F}var C=r.map(E.values,D);z.select2("val",C)}}else{if(u==="contentType"){x=c(y,a.baseFilterField,v);z=x.element.find("input");var w=p.build();z.auiSelect2(l.build(w.select2Options));x.setValues=function(C){w.setDeferredValues(function(){z.select2("val",C.values)})}}else{if(y.type==="text"){x=c(y,a.baseFilterField,function(){return k.buildTextExpression(A,this.val())});z=x.element.find("input");x.setValues=function(C){z.val(C.values.join(","))}}else{x=c(y,a.baseFilterField,v);z=x.element.find("input");x.setValues=function(C){z.val(C.values.join(","))}}}}}}}x.element.find(".aui-iconfont-remove").click(function(){x.element.remove();t.removeField(x)});return x}return{build:m}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-filter-select.js' */
define("confluence-ui-components/js/cql/internal/cql-filter-select",["jquery","underscore","ajs","confluence-ui-components/js/cql/internal/cql-ajax","confluence-ui-components/js/cql/internal/cql-field-model"],function(f,c,a,e,b){var d=window.Confluence.UI.Components.CQL.FilterSelect.Templates;function g(t){var r=t.cqlContainer;var m=r.find(".cql-fields");var i=t.onSelection;if(!i){throw Error("An onSelection callback must be provided to the FilterSelect.")}var s=f(d.container());var n=s.children("button");var q=s.find(".input-wrapper");var p=s.find("input");function j(u){u.preventDefault();q.removeClass("hidden");n.hide();s.find(".select2-choice").mousedown()}n.click(j);function h(){q.addClass("hidden");n.show()}p.bind("select2-close",function(){a.debug("CQL Field selector closed");h();setTimeout(function(){a.log("Checking CQL Field selector focus");if(!f(document.activeElement).closest(".cql-filter").length){a.debug("Setting CQL Field selector focus");n.focus()}},1)});r.append(s);function o(u){if(!u.added){return}p.auiSelect2("val","");i(u.added);a.debug("CQL Field selection made");h()}function k(u){function v(){if(!m[0]){throw new Error("Why no cql-container?")}var x=m.find(".cql-filter").map(function(){return f(this).data("fieldName")});var w=c.reject(u,function(y){return c.contains(x,y.fieldName)&&!c.contains(["label","space"],y.fieldName)});return{results:w,text:b.getLabel}}p.auiSelect2({id:"fieldName",data:v,formatResult:b.getLabel,formatSelection:b.getLabel,placeholder:"Add a field"}).change(o)}function l(){a.log("Couldn't fetch CQL fields - unable to initialise CQL field picker")}e.getFields().done(k).fail(l);return p}return{build:g}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-builder",["jquery","underscore","confluence-ui-components/js/cql/internal/cql-special-spaces","confluence-ui-components/js/cql/internal/cql-expression-builder"],function(d,c,b,a){function e(k){var l=k.trim();if(!l){return undefined}var g=l.split(",");var m=b.getKeys();var f=[];var j=[];c.each(g,function(n){if(n==="conf_current"){f.push("currentSpace()")}else{if(c.contains(m,n)){j.push(n)}else{f.push(n)}}});var h=[];if(j.length){var i=b.getMap();j=c.map(j,function(n){return i[n]});h.push(a.buildEqualityExpressionFromValuesArray("space.type",j))}if(f.length){h.push(a.buildEqualityExpressionFromValuesArray("space",f))}if(h.length===1){return h[0]}return"("+h.join(" or ")+")"}return{buildExpressionFromValuesString:e}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-expression-builder.js' */
define("confluence-ui-components/js/cql/internal/cql-expression-builder",["jquery","underscore"],function(e,i){function c(m){if(m==="currentSpace()"){return m}return'"'+a(m)+'"'}function a(m){return m.replace(/"/g,'\\"')}function h(m,o){var n=o.trim();if(!n){return undefined}return m+" ~ "+c(n)}function f(m){var n={"+":[],"-":[],"":[]};i.each(m,function(p){var o=p.charAt(0);if(o==="+"){n["+"].push(p.substring(1))}else{if(o==="-"){n["-"].push(p.substring(1))}else{n[""].push(p)}}});return n}function d(o,m){var n=i.map(m,function(p){return o+" = "+c(p)});return n.join(" AND ")}function l(r,o,m){if(o.length===0){return""}var p=i.map(o,c);var n;if(p.length===1){n=m?" = ":" != ";return r+n+p[0]}var q=p.join(",");n=m?" in ":" not in ";return r+n+"("+q+")"}function k(n,m){return l(n,m,false)}function g(n,m){return l(n,m,true)}function j(s,p){var q=f(p);var m=[];var r=d(s,q["+"]);if(r){m.push(r)}var n=g(s,q[""]);if(n){m.push(n)}var o=k(s,q["-"]);if(o){m.push(o)}return m.join(" AND ")}function b(p,n){var o=n.trim();if(!o){return undefined}var m=o.split(",");m=i.map(m,function(q){return q.trim()});return j(p,m)}return{buildTextExpression:h,buildEqualityExpressionFromValuesString:b,buildEqualityExpressionFromValuesArray:j,makeValueMap:f,makePlusCql:d,makeMinusCql:k,makeRegularCql:g}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-type-expression-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-space-type-expression-converter",["underscore","confluence-ui-components/js/cql/internal/cql-special-spaces"],function(b,a){function c(g,d){var e=b.clone(d);var f=b.map(g.values,a.getUIValue);return{field:e,values:f,negate:g.negate}}return{convert:c}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-space-expression-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-space-expression-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-space-type-expression-converter"],function(b,d){function c(h,f){var g=b.filter(h,function(j){return j.field.fieldName==="space.type"});if(g.length===0){return h}if(g.length>1){throw Error("Only a single space.type expression is supported.")}var e=d.convert(g[0],f);var i=b.filter(h,function(j){return j.field.fieldName==="space"});h=b.difference(h,g);if(i.length){i[0]=a(i[0],e)}else{h.push(e)}return h}function a(f,e){f.values=f.values.concat(e.values);return f}return{aggregate:c,combineSpaceExpressions:a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-converter.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-converter",["underscore"],function(a){function b(d){d.values=a.map(d.values,function(e){return"-"+e})}function c(e){var d=$.extend({},e);if(d.field.type==="equality"){if(d.operator==="!="){d.operator="=";b(d)}else{if(d.operator==="notin"){d.operator="in";b(d)}}}return d}return{convert:c}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/internal/cql-negation-aggregator.js' */
define("confluence-ui-components/js/cql/internal/cql-negation-aggregator",["underscore","confluence-ui-components/js/cql/internal/cql-negation-converter"],function(a,d){function b(i){var h=[];var g={};var f={};i.forEach(function(k){var l=k.field.fieldName;if(!a.contains(h,l)){h.push(l);g[l]=[];f[l]=[]}var j=d.convert(k);if(j.operator!==k.operator){f[l].push(j)}else{g[l].push(j)}});var e=[];h.forEach(function(k){var j=c(g[k],f[k]);e=e.concat(j)});return e}function c(g,e){if(!e.length){return g}var f=g[0];if(!f){f=e[0];e=a.rest(e)}e.forEach(function(h){f.values=f.values.concat(h.values)});if(f.operator==="="&&f.values.length>1){f.operator="in"}return[f].concat(a.rest(g))}return{aggregate:b}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-ui-components:cql', location = 'js/cql/cql-component.js' */
define("confluence-ui-components/js/cql/cql-component",["jquery","underscore","ajs","confluence-ui-components/js/cql/internal/cql-ajax","confluence-ui-components/js/cql/internal/cql-filter-field","confluence-ui-components/js/cql/internal/cql-filter-select","confluence-ui-components/js/cql/internal/cql-space-expression-aggregator","confluence-ui-components/js/cql/internal/cql-negation-aggregator"],function(b,k,h,a,e,l,c,g){var i=window.Confluence.UI.Components.CQL.Templates;function d(m){var n=[];k.each(m,function(o){o.forEach(function(q){if(!q){return}var p=q.asCql();if(p){n.push(p)}})});return n.join(" and ")}function f(m,n){return k.find(m,function(o){return o.fieldName===n})}function j(p){var B=p.defaultFieldNames;if(!B){B=p.defaultFields?p.defaultFields.split(","):[]}var s=b(i.container());if(p.container){b(p.container).append(s)}var C=s.find(".cql-fields");var y;var D=p.value||p.defaultValue;if(D){y=a.parseClauses(D)}else{y=new b.Deferred();y.resolve()}var r={};var q=new b.Deferred();function m(t){var F=t.fieldName;r[F]=k.without(r[F],t);if(r[F].length===0){delete r[F]}}var x={element:s,loading:q,getValue:function(){return d(r)},removeField:m,fieldArrays:r,fieldRegistry:r};function w(G){var F=e.build(G,x);var H=G.fieldName;r[H]=r[H]||[];r[H].push(F);s.trigger("cql-field-adding",F);var t=C.find(".cql-field-"+H+":last");if(t.length){t.after(F.element)}else{C.append(F.element)}return F}function A(F,t){t=t||0;var G=F.fieldName;return r[G]&&r[G][t]}var z;function v(H){if(!H){return}var G={};function F(J){var I=G[J];if(typeof I==="number"){G[J]=I+1}else{G[J]=0}return G[J]}var t=k.findWhere(z,{fieldName:"space"});H=c.aggregate(H,t);H=g.aggregate(H);k.each(H,function(L){var M=L.field.fieldName;var K=f(z,M);var J=F(M);var I=A(K,J)||w(K);I.setValues(L)})}function o(F){var G,t;if(F){var H=k.escape(F);G="We can\'t load your fields";t=h.format("Curses! We had trouble with \"{0}\". Try refreshing the page, but you may need to re-enter your macro parameters.",H)}else{G="We couldn\'t load the macro";t="If you refresh your page, we\'ll give it another shot."}h.messages.error(".cql-error-container",{title:G,body:t,closeable:true})}function E(t){var F;if(t.element.find(".select2-container-multi").length!=0){F=t.element.find("input.select2-input");F.focus().click()}else{F=t.element.find("a.select2-choice.select2-default");if(!F.length){F=b(":input:visible",t.element).first()}if(!F.length){h.log("Unable to focus CQL field: "+t.fieldName)}F.focus().mousedown()}}function u(G){var F=b.extend({},G,{fixed:false});var t=w(F);E(t)}function n(t){z=t;B.forEach(function(H){var G=f(z,H);if(!G){throw Error("Unknown fieldname: "+H)}var F=b.extend({fixed:true},G);w(F)});l.build({onSelection:u,cqlContainer:s});y.done(v).fail(function(){o(p.value)}).always(function(){q.resolve()})}a.getFields().done(n).fail(function(){o()});return x}return{build:j}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-parameter-serializer.js' */
(function(f){var d=function(c){return c.replace(/\\/g,"\\\\").replace(/=/g,"\\=").replace(/[|]/g,"\\|")};Confluence.MacroParameterSerializer={serialize:function(c){var a=[];for(paramName in c)a.push(d(paramName)+"="+d(c[paramName]));return a.join("|")},deserialize:function(c){function a(e,c){for(var b=[],d=[],a,e=e||"",g=0,f=e.length;g<f;g++)a=e[g],"\\"==a?b.push(a+(g+1!=e.length?e[++g]:"")):a==c?(d.push(b.join("")),b=[]):b.push(a);d.push(b.join(""));return d}var d={};f.each(a(c||"","|"),function(c,
f){var b=a(f,"=");2==b.length&&b[0]&&(d[b[0].replace(/\\(.)/g,"$1")]=b[1].replace(/\\(.)/g,"$1"))});return d}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-rest.js' */
AJS.MacroBrowser=AJS.MacroBrowser||{};
AJS.MacroBrowser.Rest=function(b){function c(a){AJS.logError(a)}var e=WRM.data.claim("confluence.macro.metadata.provider:macro-browser-metadata-resources.macro-meta-client-cache-key");return{loadMacroMetadata:function(a){a.data=a.data||{};a.data.macroMetadataClientCacheKey=e;return b.ajax({type:"GET",cache:!0,timeout:a.timeout||3E4,dataType:"json",url:(a.context||AJS.params.contextPath)+"/plugins/macrobrowser/browse-macros.action",data:a.data,success:a.successCallback,error:a.errorCallback||c}).promise()},
fetchMacroMetadataDetails:function(a){var d={id:a.id};a.alternateId&&(d.alternateId=a.alternateId);b.ajax({type:"GET",dataType:"json",url:(a.context||AJS.params.contextPath)+"/plugins/macrobrowser/browse-macros-details.action",data:d,success:a.successCallback,error:a.errorCallback||c})},fetchMacroPreviewData:function(a){if(!a.contentId||!a.macroName)return(a.errorCallback||c)("invalid parameters");b.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:(a.context||AJS.params.contextPath)+
"/rest/tinymce/1/macro/preview",data:b.toJSON({contentId:a.contentId,macro:{name:a.macroName,body:a.body,params:a.params,defaultParameterValue:a.defaultParameterValue}}),dataType:"html",success:a.successCallback,error:a.errorCallback||c})}}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-editor.js' */
AJS.MacroBrowser=AJS.MacroBrowser||{};
AJS.MacroBrowser.Editor=function(d){function n(g){var b=d("#macro-insert-container").find(".macro-name").val(),a,c=AJS.MacroBrowser,h={},i;i={};for(var e=0,k=g.formDetails.parameters.length;e<k;e++){var j=g.formDetails.parameters[e],f;if(j.type&&"cql"===j.type.name)f=d(".macro-input-fields form").data("cqlComponent").getValue();else{f=d("#macro-param-"+j.name);var l=f.val();"checkbox"==f.attr("type")&&(l=""+f.prop("checked"));f=l}if(f&&(j.shared&&(h[j.name]=f),j.hidden||!j.defaultValue||j.defaultValue!=
f))i[j.name]=f}i[""]&&(a=i[""]);d.extend(i,c.unknownParams);(e=AJS.MacroBrowser.getMacroJsOverride(b))&&"function"==typeof e.beforeParamsRetrieved&&(i=e.beforeParamsRetrieved(i,g,h));return{name:b,bodyHtml:c.getMacroBody(),params:i,defaultParameterValue:a}}function q(g,b,a){var c=AJS.MacroBrowser,h,i=b.type.name;if(a){var e=a.fields&&a.fields[i];e&&"function"!=typeof e&&(e=e[b.name]);"function"==typeof e&&(h=e.call(a,b))}h||(i in c.ParameterFields&&"function"==typeof c.ParameterFields[i]||(i="string"),
h=c.ParameterFields[i](b));c.fields[b.name]=h;a=h.paramDiv;c=h.input;h="macro-param-"+b.name;a.attr("id","macro-param-div-"+b.name);c.addClass("macro-param-input").attr("id",h);b.hidden&&a.hide();c=g.pluginKey;b.displayName==AJS.MacroBrowser.Utils.makeDefaultKey(c,g.macroName,"param",b.name,"label")&&(b.displayName=b.name);b.description==AJS.MacroBrowser.Utils.makeDefaultKey(c,g.macroName,"param",b.name,"desc")&&(b.description="");d("label",a).attr("for",h).text(b.displayName);b.required&&p(a);b.description&&
a.append(Confluence.Templates.MacroBrowser.macroParameterDesc({description:b.description}));return a}function p(d){var b=d.find("label"),a=b.text()+" *";b.text(a);d.addClass("required")}return{loadMacroInBrowser:function(g){if(!g||!g.formDetails)AJS.trigger("analytics",{name:"macro-browser.unknown-macro-error"}),alert("Could not load unknown macro in the macro browser.");else{var b=AJS.MacroBrowser,a=g.formDetails,c=a.macroName,h=b.jsOverrides[c],i=b.settings.selectedMacro,e=tinymce.confluence.macrobrowser.editedMacroDiv;
if(h&&"function"===typeof h.opener)b.close(),h.opener({name:c});else{var k=a.parameters,j=_.find(k,function(b){return"cql"===b.type.name});d("#save-warning-span").addClass("hidden");d("#macro-insert-container .macro-name").val(c);var f=d("#macro-insert-container .macro-input-fields form");f.empty();var l=g.extendedDescription||g.description;if(j)a.documentationLink&&b.UI.setHelpLink(b.dialog,{href:a.documentationLink});else if(l||a.documentationLink)l=d(Confluence.Templates.MacroBrowser.macroDescription({descriptionHtml:l,
documentationLink:a.documentationLink})),f.append(l);a.body&&("NONE"!=a.body.bodyType&&e&&d(e).hasClass("editor-inline-macro"))&&(e=g.pluginKey,a.body.label==AJS.MacroBrowser.Utils.makeDefaultKey(e,c,"body","label")&&(a.body.label=""),a.body.description==AJS.MacroBrowser.Utils.makeDefaultKey(e,c,"body","desc")&&(a.body.description=""),a=a.body,e=b.selectedMacroDefinition,l=AJS.MacroBrowser,c=d(Confluence.Templates.MacroBrowser.macroBody()),e=e?e.body:l.settings.selectedText,d("textarea",c).val(e||
""),a.label&&d("label",c).text(a.label),a.description&&c.append(Confluence.Templates.MacroBrowser.macroParameterDesc({description:a.description})),a.hidden&&c.hide(),c&&f.append(c));var m=i?d.extend({},i.params):{},n=f;if(j){k=_.without(k,j);a=m.cql;delete m.cql;c=d(Confluence.Templates.MacroBrowser.cqlSections());f.append(c);n=c.filter(".cql-render-fields");f.bind("cql-field-adding",function(b,a){a.element.addClass("macro-param-div");a.element.find(".cql-field-input").addClass("macro-param-input")});
f.addClass("loading");c.filter(".cql-render-heading").find("button").click(function(){var b=d(this),a=b.closest(".cql-render-heading").next(),c=a.is(":visible");c?a.slideUp(300):(a.removeClass("hidden").show(),a=d(".cql-render-heading").position().top,d(".macro-input-fields").animate({scrollTop:a},300));c=c?"Show":"Hide";b.text(c)});var e=j.options.requiredFields,l=j.options.defaultFields,
r=e?e.split(","):[],e=l?l.split(","):[],j=d.extend({},j.options,{defaultFieldNames:e,value:a,container:c.filter(".cql-filter-fields")}),o=require("confluence-ui-components/js/cql/cql-component").build(j);f.data("cqlComponent",o);o.loading.done(function(){_.each(o.fieldRegistry||o.fieldArrays,function(a){var c=!1;_.each(a,function(a){!c&&_.contains(r,a.fieldName)&&(p(a.element),c=!0,a.onChange(b.paramChanged))})});f.removeClass("loading");b.paramChanged();AJS.MacroBrowser.Preview.previewMacro(g,i);
AJS.MacroBrowser.UI.focusOnMacroDetailsFirstInput()})}d(k).each(function(){n.append(q(g,this,h))});h&&"function"==typeof h.beforeParamsSet&&(m=h.beforeParamsSet(m,!i));d(k).each(function(){var a;a=""==this.name?b.selectedMacroDefinition?b.selectedMacroDefinition.defaultParameterValue:this.defaultValue:m[this.name];null!=a?delete m[this.name]:d(this.aliases).each(function(){m[this]&&(a=m[this],delete m[this])});null==a&&(a=this.defaultValue);null!=a&&b.fields[this.name].setValue(a)});b.unknownParams=
m;d("a",f).click(function(){window.open(this.href,"_blank").focus();return!1});d("#macro-browser-dialog:visible").length||b.showBrowserDialog();k={};d.extend(!0,k,g);k.formDetails||(k.formDetails={});k.formDetails.body||(k.formDetails.body={});b.dialog.activeMetadata=k;k.formDetails.body.content=b.settings.selectedMacro?b.settings.selectedMacro.body:k.formDetails.body.bodyType&&"plain_text"==k.formDetails.body.bodyType.toLowerCase()?b.settings.selectedText:b.settings.selectedHtml}}},getMacroParametersFromForm:function(d){return n(d).params},
getMacroDefinitionFromForm:n,processRequiredParameters:function(){if(d(".macro-input-fields form").is(".loading"))return AJS.log("Form still loading - cannot processRequiredParameters"),!1;var g=0==d("#macro-insert-container .macro-param-div.required .macro-param-input").not(".select2-container").filter(function(){var a=d(this).val();return null===a||""===a}).length,b=g?"":"disabled",a=b?"addClass":"removeClass";d("#macro-browser-dialog button.ok").prop("disabled",b);d("#macro-browser-dialog .macro-preview-header .refresh-link").prop("disabled",
b)[a]("disabled");return g}}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-model.js' */
AJS.MacroBrowser=AJS.MacroBrowser||{};
AJS.MacroBrowser.Model=function(){function f(a){a.title==AJS.MacroBrowser.Utils.makeDefaultKey(a.pluginKey,a.macroName,"label")&&(a.title=a.macroName.charAt(0).toUpperCase()+a.macroName.substring(1).replace(/-/g," "));a.description==AJS.MacroBrowser.Utils.makeDefaultKey(a.pluginKey,a.macroName,"desc")&&(a.description="");a.id="macro-"+(a.alternateId||a.macroName);var b=[a.macroName,a.title].concat(a.aliases||[]);a.keywordsNoDesc=b.join(",");var d=a.description&&a.description.replace(/,/g," ")||"";
b.push(d);a.keywords=b.join(",");return a}return{loadMacros:function(a){if(a){var b=AJS.MacroBrowser;b.metadataList=[];b.aliasMap={};for(var d=0,g=a.length;d<g;d++){var c=a[d],c=f(c);if(c.aliases)for(var e=0,h=c.aliases.length;e<h;e++)c.aliases[e]=c.aliases[e].toLowerCase(),b.aliasMap[c.aliases[e]]=c.macroName.toLowerCase();b.metadataList.push(c)}b.metadataList.sort(function(a,b){return a.title.toLowerCase()>b.title.toLowerCase()?1:-1})}else AJS.log("AJS.MacroBrowser.loadModel - no macro data, aborting")},
transformMetaDataDefault:f}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preview.js' */
AJS.MacroBrowser=AJS.MacroBrowser||{};
AJS.MacroBrowser.Preview=function(d){function g(){return d("#macro-insert-container .macro-preview")}function j(){g().html("")}function h(c){c?(AJS.MacroBrowser.UI.showPreviewSpinner(!0),k.disable()):(AJS.MacroBrowser.UI.showPreviewSpinner(!1),k.enable())}var k={disable:function(){d("#macro-browser-preview-link").attr("disabled",!0).addClass("disabled")},enable:function(){d("#macro-browser-preview-link").removeAttr("disabled").removeClass("disabled")}};return{previewMacro:function(c,e){var f=AJS.MacroBrowser;
j();if(!AJS.MacroBrowser.Editor.processRequiredParameters())return AJS.trigger("analytics",{name:"macro-browser.missing-params-error"}),AJS.log("previewMacro: missing required params"),!1;"object"!==typeof e&&(e=AJS.MacroBrowser.Editor.getMacroDefinitionFromForm(c));var a=e.params,i=f.getMacroJsOverride(c.macroName);i&&"function"==typeof i.updateMacroParametersForPreview&&(a=i.updateMacroParametersForPreview(a));a[""]&&delete a[""];f={contentId:Confluence.getContentId(),macroName:c.macroName,params:a,
body:f.getMacroBody(),defaultParameterValue:e.defaultParameterValue,successCallback:function(a){var b=g().find("iframe")[0],b=b.contentDocument||b.contentWindow.document;b.write(a);b.close();d("div.error span.error",b).length&&AJS.logError("Error rendering macro definition : ");setTimeout(function(){h(!1)},1E3)},errorCallback:function(a){AJS.logError(a);h(!1)}};a=AJS.params.staticResourceUrlPrefix+"/blank.html";g().html('<iframe src="'+a+'" frameborder="0" name="macro-browser-preview-frame" id="macro-preview-iframe"></iframe>');
h(!0);AJS.MacroBrowser.Rest.fetchMacroPreviewData(f)},removePreviewContainer:j}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-UI.js' */
AJS.MacroBrowser=AJS.MacroBrowser||{};
AJS.MacroBrowser.UI=function(e){function j(a){return e(Confluence.Templates.MacroBrowser.macroSummaryList({category:a}))}function m(a,b){var f=e(Confluence.Templates.MacroBrowser.macroSummaryItem());if(a.icon){var c=(a.icon.relative?AJS.params.staticResourceUrlPrefix:"")+a.icon.location;!a.icon.relative&&AJS.$.browser.msie&&!window.location.href.indexOf("https")&&c.indexOf("https")?f.prepend("<span class='macro-icon-holder icon-"+a.macroName+"'></span>"):f.prepend("<img src='"+c+"' alt='icon' width='"+
a.icon.width+"' height='"+a.icon.height+"' title='"+a.title+"'/>")}else f.prepend("<span class='macro-icon-holder icon-"+a.macroName+"'></span>");e(".macro-title",f).text(a.title);e(".macro-desc",f).prepend(a.description);if("gadget"==a.macroName&&(c=a.gadgetUrl))c.match("^https?://.*")||(c=AJS.params.contextPath+"/"+c),e(".macro-title",f).after(Confluence.Templates.MacroBrowser.gadgetLink({url:c}));f.click(function(c){b(c,a)});return f}function n(a,b){var e;e=b?Confluence.Templates.Dialog.helpLink(b):
Confluence.Templates.MacroBrowser.helpLink();a.getPage(a.curpage).element.find(".dialog-title").prepend(e)}return{createDialog:function(a){for(var b=a.macros,f=a.onClickMacroSummary,c={all:j("all")},k=0,o=b.length;k<o;k++){var g=b[k];if(g.hidden)if(AJS.MacroBrowser.isHiddenMacroShown(g))g.categories.push("hidden-macros");else continue;c.all.append(m(g,f).attr("id",g.id));for(var l=0,p=g.categories.length;l<p;l++){var h=g.categories[l];c[h]=c[h]||j(h);c[h].append(m(g,f).attr("id",h+"-"+g.id))}}var d=
AJS.ConfluenceDialog({width:a.width||865,height:a.height||530,id:"macro-browser-dialog",onSubmit:a.onSubmit,onCancel:a.onCancel});d.popup.element.on("keydown",".aui-button",function(a){a.stopPropagation()});d.getPage(0).element.attr("id","select-macro-page");d.addHeader(a.title);d.addPanel("All",c.all,"all","category-button-all");i=0;for(ii=a.categories.length;i<ii;i++)b=a.categories[i],d.addPanel(b.displayName,c[b.name]||j(b.name),b.name,"category-button-"+
b.name).getPanel(i).setPadding(0);d.addCancel("Cancel",a.onCancel);n(d);"VANILLA"==AJS.Meta.get("confluence-flavour")?d.addHelpText("<a href='{0}' id='marketplace-link'><span class='icon icon-marketplace'/>{1}</a>",[AJS.params.contextPath+"/plugins/servlet/upm/marketplace/featured?category=Macros&source=macro_browser","Find more macros..."]):d.addHelpText("Hint: type \"\u003cstrong\u003e{\u003c/strong\u003e\" in the Editor to insert macros on the page.");c=AJS.$(Confluence.Templates.MacroBrowser.insertMacroPanel());
c.find("form").submit(function(a){AJS.MacroBrowser.complete();return AJS.stopEvent(a)});e("#macro-browser-preview-link",c).click(function(a){e(this).prop("disabled")||AJS.MacroBrowser.previewMacro(d.activeMetadata);return AJS.stopEvent(a)});d.addPage().addPanel("X",c,"macro-input-panel").addLink("Select macro",function(a){a.prevPage();a.searcher.focus()},"dialog-back-link").addButton("insert.name",function(){AJS.MacroBrowser.complete()},"ok").addCancel("Cancel",
function(){return a.onCancel()}).getPanel(0).setPadding(0);d.getPage(1).element.attr("id","macro-details-page");e("#macro-browser-dialog .dialog-button-panel .ok").before("<span id='save-warning-span' class='hidden'/>");d.searcher=Confluence.DomFilterField({items:"#macro-browser-dialog .dialog-panel-body #category-all .macro-list-item",formId:"macro-browser-search-form",inputId:"macro-browser-search",searcher:function(a,b){var c=null;if(""!=b){d.getCurrentPanel()!=d.getPanel(0)&&d.gotoPanel(0);var f=
AJS.MacroBrowser.searchSummaries(b),c={};e.each(f,function(){c[this.id]=this})}a.each(function(){!c||this.id in c?e(this).show():e(this).hide()})},submitCallback:function(a,b){""!=b&&1==a.length&&a.click()}});d.page[0].header.append(d.searcher.form);d.page[0].ontabchange=function(a){a!=d.getPanel(0,0)&&d.searcher.reset()};c=AJS.$(Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel({showAdminMessage:AJS.Meta.getBoolean("is-admin")}));d.addPage().addPanel("No macro metadata",
c,"missing-metadata-panel").addLink("Back",function(a){a.gotoPage(0);a.searcher.focus()},"dialog-back-link").addCancel("Cancel",function(){return a.onCancel()});d.gotoPage(2);d.addHeader("No macro metadata");d.gotoPanel(0,0);d.ready=!0;return d},showBrowserSpinner:function(a){var b=e("#macro-browser-dialog");a?b.spin("large"):b.spinStop()},showPreviewSpinner:function(a){var b=e("#macro-browser-preview");
a?b.spin("large"):b.spinStop()},updateButtonText:function(a){var b=e("#macro-browser-dialog .dialog-button-panel .ok");"edit"==a?b.text("Save"):b.text("Insert")},enableSaveButton:function(a){e("#macro-browser-dialog .dialog-button-panel .ok").prop("disabled",!a)},focusOnMacroDetailsFirstInput:function(){var a=e("#macro-insert-container").find(".macro-input-fields :input:visible:not(button,.select2-offscreen)").first();if(a.length){if(a.hasClass("select2-input")){var b=
a.closest(".select2-container").parent().find(".select2-offscreen");if("function"!==typeof b.select2){AJS.log("select2Hidden is not a select2 hidden input, skipping focus attempt.");return}b.select2("open");b.select2("close")}else a.focus();!AJS.MacroBrowser.selectedMacroDefinition&&""!==a.val()&&a.select()}else AJS.log("No input to focus")},setHelpLink:n}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-utils.js' */
AJS.MacroBrowser=AJS.MacroBrowser||{};AJS.MacroBrowser.Utils=function(a){return{makeDefaultKey:function(){return a.makeArray(arguments).join(".")}}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser.js' */
AJS.MacroBrowser=AJS.MacroBrowser||{};
(function(f){var g={},d,i=function(a,b){var j={id:a.macroName,successCallback:function(a){a&&a.details&&(a.details=AJS.MacroBrowser.Model.transformMetaDataDefault(a.details));AJS.MacroBrowser.Editor.loadMacroInBrowser(a.details,b);i.displayDetails();AJS.MacroBrowser.Preview.previewMacro(a.details)},errorCallback:function(){AJS.trigger("analytics",{name:"macro-browser.fetch-metadata-error"});alert("There has been an error loading the macro browser. Please try again or see your system administrator.");i.displayDetails()}};a.alternateId&&(j.alternateId=
a.alternateId);i.setUI(b,a.title);AJS.MacroBrowser.Rest.fetchMacroMetadataDetails(j)};i.setUI=function(a,b){var j="edit"==a?c.editTitle:c.insertTitle;f("#macro-insert-container").hide();AJS.MacroBrowser.UI.updateButtonText(a);AJS.MacroBrowser.UI.enableSaveButton(!1);AJS.MacroBrowser.dialog.gotoPage(1).addHeader(j.replace(/\{0\}/,b));AJS.MacroBrowser.dialog.show();AJS.MacroBrowser.UI.showBrowserSpinner(!0)};i.displayDetails=function(){AJS.MacroBrowser.UI.showBrowserSpinner(!1);AJS.MacroBrowser.UI.enableSaveButton(!1);
f("#macro-insert-container").show();AJS.MacroBrowser.UI.focusOnMacroDetailsFirstInput()};var c=AJS.MacroBrowser;c.reset=function(){d&&d.resolve&&d.resolve();this.initData=this.initMacroBrowserAfterRequest=d=null;this.hasInit=!1;this.metadataList=[];this.aliasMap={};this.fields={};this.Macros=g={}};c.jsOverrides=g;c.Macros=g;c.getMacroJsOverride=function(a){return g[a]};c.setMacroJsOverride=function(a,b){return g[a]=b};c.hasInit=!1;c.metadataList=[];c.aliasMap={};c.fields={};c.processRequiredParameters=
function(){return AJS.MacroBrowser.Editor.processRequiredParameters()};c.paramChanged=function(){AJS.MacroBrowser.Editor.processRequiredParameters()};c.loadMacroInBrowser=function(a,b){AJS.MacroBrowser.Editor.loadMacroInBrowser(a,b)};c.getMacroDefinitionFromForm=function(a){AJS.MacroBrowser.Editor.getMacroDefinitionFromForm(a)};c.getMacroParametersFromForm=function(a){AJS.MacroBrowser.Editor.getMacroParametersFromForm(a)};c.previewMacro=function(a){AJS.MacroBrowser.Preview.previewMacro(a)};c.previewOnload=
function(a){var b=g[AJS.MacroBrowser.dialog.activeMetadata.macroName];b&&b.postPreview&&b.postPreview(AJS.$("#macro-preview-iframe")[0],AJS.MacroBrowser.dialog.activeMetadata);AJS.Editor.disableFrame(a);f(a).click(function(a){if("a"===a.target.tagName.toLowerCase())return(a=f(a.target).attr("href"))&&(0!=a.indexOf("#")&&-1==a.indexOf(window.location))&&window.open(a,"_blank").focus(),!1})};c.getMacroMetadata=function(a){for(var b=0,c=this.metadataList.length;b<c;b++){var e=this.metadataList[b];if(e.macroName==
a)return e}return null};c.getMetadataPromise=function(){return d};c.open=function(a){a||(a={},AJS.log("No settings to open the macro browser."));var b=AJS.MacroBrowser,c=a.selectedMacro;!c&&a.presetMacroMetadata&&(c={name:a.presetMacroMetadata.macroName});if(c&&c.name){var e=b.getMacroJsOverride(c.name);if(e&&"function"==typeof e.opener){e.opener(c);return}}if(!b.hasInit){AJS.debug("init macro browser");AJS.MacroBrowser.UI.showBrowserSpinner(!0);if(null!==b.initData&&f.isEmptyObject(b.initData)){AJS.trigger("analytics",
{name:"macro-browser.init-reattempt"});AJS.logError("Macro browser preload failed. Trying again...");b.initMacroBrowserAfterRequest=a;b.preLoadMacro();return}if(b.initData)b.initBrowser();else{AJS.trigger("analytics",{name:"macro-browser.init-overlap"});AJS.debug("Waiting for macro browser preloading...");b.initMacroBrowserAfterRequest=a;return}}b.openMacroBrowser(a)};c.openMacroBrowser=function(a){var b=AJS.MacroBrowser;b.settings=a;b.selectedMacroDefinition=a.selectedMacro;var c=b.selectedMacroDefinition&&
b.selectedMacroDefinition.name||a.presetMacroName;a.presetMacroName&&(a.presetMacroMetadata=b.getMacroMetadata(a.presetMacroName));var e=a.presetMacroMetadata;if(!e){var h=a.selectedMacro;if(h){var c=h.name.toLowerCase(),c=b.aliasMap[c]||c,d=g[c];d&&("function"==typeof d.updateSelectedMacro&&d.updateSelectedMacro(h),"function"==typeof d.getMacroDetailsFromSelectedMacro&&(e=d.getMacroDetailsFromSelectedMacro(b.metadataList,h)));e||(e=b.getMacroMetadata(c))}}h=f("#macro-browser-dialog").find("button.back");
e?(AJS.debug("Open macro browser to edit macro: "+e.macroName),h.hide(),b.replicateSelectMacro(e,a.mode||"edit")):c?(h.show(),b.dialog.overrideLastTab(),b.dialog.gotoPage(2),b.showBrowserDialog()):(h.show(),a.selectedCategory?(c=f("#select-macro-page .dialog-page-menu button").index(f("#category-button-"+a.selectedCategory)),0>c&&(c=0),b.dialog.overrideLastTab(),b.dialog.gotoPanel(0,c)):b.dialog.gotoPage(0),b.showBrowserDialog(),b.dialog.searcher.focusAndSearch(a.searchText))};c.showBrowserDialog=
function(){AJS.MacroBrowser.dialog.show();AJS.MacroBrowser.UI.showBrowserSpinner(!1)};c.complete=function(){if(f("#macro-browser-dialog .dialog-button-panel .ok").is(":visible:not(:disabled)")){var a=AJS.MacroBrowser,b=a.dialog.activeMetadata,c=g[b.macroName];c&&c.manipulateMarkup&&c.manipulateMarkup(b);b=AJS.MacroBrowser.Editor.getMacroDefinitionFromForm(b);a.close();if(a.settings.onComplete)a.settings.onComplete(b)}};c.cancel=function(){var a=AJS.MacroBrowser;a.close();if("function"==typeof a.settings.onCancel)a.settings.onCancel();
return!1};c.close=function(){this.unknownParams={};this.fields={};AJS.MacroBrowser.Preview.removePreviewContainer();this.dialog.hide()};c.replicateSelectMacro=function(a,b){i(a,b)};c.initBrowser=function(){var a=AJS.MacroBrowser,b=a.initData;if(!b.categories||!AJS.MacroBrowser.metadataList.length)return AJS.trigger("analytics",{name:"macro-browser.init-browser-error"}),alert("There has been an error loading the macro browser. Please try again or see your system administrator."),AJS.MacroBrowser.UI.showBrowserSpinner(!1),!1;a.editTitle=b.editTitle;
a.insertTitle=b.insertTitle;var c;b.categories=f.map(b.categories,function(a){return"hidden-macros"==a.name?(c=a,null):a});b.categories.sort(function(a,b){return a.displayName.toLowerCase()>b.displayName.toLowerCase()?1:-1});c&&AJS.params.showHiddenUserMacros&&b.categories.push(c);a.dialog=AJS.MacroBrowser.UI.createDialog({title:b.title,categories:b.categories,macros:a.metadataList,onClickMacroSummary:function(a,b){a.preventDefault();i(b,"insert")},onSubmit:a.complete,onCancel:a.cancel});return a.hasInit=
!0};c.searchSummaries=function(a,b){b=f.extend({splitRegex:/[\s\-]+/},b);return AJS.filterBySearch(this.metadataList,a,b)};c.getMacroBody=function(){var a=AJS.MacroBrowser,b="";f("#macro-insert-container .macro-body-div textarea").length?b=f("#macro-insert-container .macro-body-div textarea").val():a.selectedMacroDefinition?a.selectedMacroDefinition.body&&(b=a.selectedMacroDefinition.body):a.dialog.activeMetadata&&(b=a.dialog.activeMetadata.formDetails.body.content);return b};c.isHiddenMacroShown=
function(a){return AJS.params.showHiddenUserMacros&&"_-user-macro-_"==a.pluginKey};c.hasRequiredParameters=function(a){return a.anyParameterRequired};c.setWhitelist=function(a){AJS.MacroBrowser.whitelist=a};c.preLoadMacro=function(){var a=AJS.MacroBrowser;a.initData=null;if(d&&"pending"===d.state())return d;d=AJS.MacroBrowser.Rest.loadMacroMetadata({data:a.whitelist?{whitelist:a.whitelist}:{detailed:!1},successCallback:function(b){a.initData=b;AJS.MacroBrowser.Model.loadMacros(b.macros);a.initMacroBrowserAfterRequest&&
(a.initBrowser(),a.openMacroBrowser(a.initMacroBrowserAfterRequest))},errorCallback:function(b){AJS.trigger("analytics",{name:"macro-browser.preload-error"});AJS.logError("Error requesting macro browser metadata:");AJS.logError(b);a.initData={}}})}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-fields.js' */
AJS.MacroBrowser.Field=function(e,g,b){var b=b||{},a=b.setValue||function(a){g.val(a)},d=b.getValue||function(){return g.val()};g.change(b.onchange||AJS.MacroBrowser.paramChanged);return{paramDiv:e,input:g,setValue:a,getValue:d}};
AJS.MacroBrowser.ParameterFields=function(e){var g=function(b,a,d){if(a&&a.length)for(var c=0,f=a.length;c<f;c++)AJS.MacroBrowser.fields[a[c]]&&AJS.MacroBrowser.fields[a[c]].dependencyUpdated(b,d)};return{updateDependencies:g,username:function(b,a){var a=a||{},d=b.multiple?"autocomplete-multiuser":"autocomplete-user",c=e(Confluence.Templates.MacroBrowser.macroParameter()),f=AJS.$("input[type='text']",c);f.addClass(d).attr("data-none-message","Not found");
b.required&&f.keyup(AJS.MacroBrowser.processRequiredParameters);b.multiple?(Confluence.Binder.autocompleteMultiUser(c),a.setValue=function(a){f.val(a);for(var a=a.split(","),c=[],b=[],d=0,g=a.length;d<g;d++)c.push(function(a){return e.getJSON(Confluence.getContextPath()+"/rest/prototype/1/user/non-system/"+a).done(function(a){a&&a.name&&b.push({id:a.name,text:a.displayName,imgSrc:a.avatarUrl})}).fail(function(c){AJS.logError("Cannot parse user data for macro browser field with: "+c);b.push({id:a,
text:AJS.format("Unknown User ({0})",a),imgSrc:Confluence.getContextPath()+"/images/icons/profilepics/default.png"})})}(a[d]));e.when.apply(e,_.map(c,function(a){var c=e.Deferred();a.always(function(){c.resolve()});return c.promise()})).done(function(){b.length&&f.auiSelect2("data",b)})}):(f.bind("selected.autocomplete-content",function(c,d){if(a.onselect)a.onselect(d.selection);else a.setValue?a.setValue(d.content.username):(g(b.name,a.dependencies,f.val()),"function"==typeof a.onchange&&a.onchange.apply(f))}),
AJS.Confluence.Binder.autocompleteUserOrGroup(c));return AJS.MacroBrowser.Field(c,f,a)},spacekey:function(b,a){if(b.multiple)return AJS.MacroBrowser.ParameterFields.string(b,a);var a=a||{},d=e(Confluence.Templates.MacroBrowser.macroParameter()),c=AJS.$("input[type='text']",d);c.addClass("autocomplete-space").attr("data-template","{key}").attr("data-none-message","Not found");b.required&&c.keyup(AJS.MacroBrowser.processRequiredParameters);c.bind("selected.autocomplete-content",
function(d,e){if(a.onselect)a.onselect(e.selection);else a.setValue?a.setValue(e.content.key):(g(b.name,a.dependencies,c.val()),"function"===typeof a.onchange&&a.onchange.apply(c))});AJS.Confluence.Binder.autocompleteSpace(d);return AJS.MacroBrowser.Field(d,c)},attachment:attachmentHandler=function(b,a){if(b.multiple)return AJS.MacroBrowser.ParameterFields.string(b,a);var d=e(Confluence.Templates.MacroBrowser.macroParameterSelect()),c=AJS.$("select",d),a=a||{};a.setValue=a.setValue||function(a){var b=
!1;c.find("option").each(function(){if(this.value==a)return b=!0,!1});b?delete c.tempValue:(c.append(AJS.$("<option/>").attr("value",a).text(a+" ("+"Not found"+")")),c.tempValue=a);try{c.val(a)}catch(d){AJS.logError(d)}c.change()};d=AJS.MacroBrowser.Field(d,c,a);d.updateDependencies=g;d.getData=function(b){if(b.title&&b.spaceKey||b.pageId||b.draftId){var d=c.tempValue||c.val();a.fileTypes&&(b.fileTypes=a.fileTypes);e.getJSON(AJS.params.contextPath+(b.draftId?
"/json/draftattachmentsearch.action":"/json/attachmentsearch.action"),b,function(b){if(!b.error){e("option",c).remove();b=b.attachments;if(!b||!b.length){c.append(AJS.$("<option/>").attr("value","").html("No appropriate attachments"));c.tempValue&&a.setValue(c.tempValue)}else{for(var f=0,g=b.length;f<g;f++)c.append(AJS.$("<option/>").attr("value",b[f].name).text(b[f].name));d=d||c.tempValue;a.setValue(d||b[0].name)}c.attr("style","")}})}else AJS.log("Not enough parameters to send attachmentsearch request")};
return d},full_attachment:attachmentHandler,"confluence-content":function(b,a){if(b.multiple)return AJS.MacroBrowser.ParameterFields.string(b,a);a=a||{};b.options=b.options||{};var d=e(Confluence.Templates.MacroBrowser.macroParameter()),c=AJS.$("input[type='text']",d).attr("data-none-message","Not found").attr("data-template","");b.required&&c.keyup(AJS.MacroBrowser.processRequiredParameters);a.onchange=a.onchange||function(){var d=c.val();g(b.name,a.dependencies,
d)};a.setValue=a.setValue||function(b){c.val(b);"function"==typeof a.onchange&&a.onchange.apply(c)};c.bind("selected.autocomplete-content",function(d,e){var f="";"true"==b.options.includeDatePath&&"blogpost"==e.content.type&&(f=e.content.createdDate.date.split("-"),f="/"+f[0]+"/"+f[1]+"/"+f[2].substring(0,2)+"/");var g=e.content.space&&e.content.space.key,h=g&&g!=AJS.Meta.get("space-key");-1!=e.content.title.indexOf(":")&&(h=!0);f=(h?g+":":"")+f+e.content.title;c.val(f);if(a.onselect)a.onselect(e.selection);
else a.setValue(f,c)});b.options.spaceKey&&("@self"==b.options.spaceKey.toLowerCase()&&(b.options.spaceKey=AJS.Meta.get("space-key")),c.attr("data-spacekey",b.options.spaceKey));var f=b.options.type;if("string"==typeof f)if("page"==f)c.addClass("autocomplete-page"),AJS.Confluence.Binder.autocompletePage(d);else if("blogpost"==f)c.addClass("autocomplete-blogpost"),AJS.Confluence.Binder.autocompleteBlogpost(d);else{if("attachment"===f||"full_attachment"===f)c.addClass("autocomplete-attachment"),AJS.Confluence.Binder.autocompleteAttachment(d)}else c.addClass("autocomplete-confluence-content"),
AJS.Confluence.Binder.autocompleteConfluenceContent(d);return AJS.MacroBrowser.Field(d,c,a)},string:function(b,a){var d=e(Confluence.Templates.MacroBrowser.macroParameter()),c=e("input",d);b.required&&c.keyup(AJS.MacroBrowser.processRequiredParameters);return AJS.MacroBrowser.Field(d,c,a)},"boolean":function(b,a){var d=e(Confluence.Templates.MacroBrowser.macroParameterBoolean()),c=e("input",d),a=a||{};a.setValue=a.setValue||function(a){(/true/i.test(a)||/true/i.test(b.defaultValue)&&!/false/i.test(a))&&
c.prop("checked",!0)};return AJS.MacroBrowser.Field(d,c,a)},"enum":function(b,a){if(b.multiple)return AJS.MacroBrowser.ParameterFields.string(b,a);var d=e(Confluence.Templates.MacroBrowser.macroParameterSelect()),c=e("select",d);!b.required&&!b.defaultValue&&c.append(AJS.$("<option/>").attr("value",""));e(b.enumValues).each(function(){c.append(AJS.$("<option/>").attr("value",this).html(""+this))});return AJS.MacroBrowser.Field(d,c,a)},_hidden:function(b,a){var d=e(Confluence.Templates.MacroBrowser.macroParameterHidden()).hide(),
c=e("input",d);return AJS.MacroBrowser.Field(d,c,a)}}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-smartfields.js' */
(function(){var c=function(a){this.fileTypes=a};c.prototype.beforeParamsSet=function(a){!a.page&&(!a.date&&!a.space)&&("page"==AJS.params.contentType||"blogpost"==AJS.params.contentType?a.page=AJS.Editor.getCurrentTitle():"comment"==AJS.params.contentType&&(a.page=AJS.params.pageTitle));if(a.date){var b=a.date.split("/");a.page=["",b[2],b[0],b[1],a.page].join("/")}a.space&&(a.page=a.space+":"+a.page);return a};c.prototype.beforeParamsRetrieved=function(a){if(a.page){var b=a.page.split(":");1<b.length&&
(a.space=b[0],a.page=b[1]);b=a.page.split("/");1<b.length&&(a.date=[b[2],b[3],b[1]].join("/"),a.page=b[4]);(("page"==AJS.params.contentType||"blogpost"==AJS.params.contentType)&&a.page==AJS.Editor.getCurrentTitle()||"comment"==AJS.params.contentType&&a.page==AJS.params.pageTitle)&&delete a.page}return a};c.prototype.fields={attachment:function(a){a=AJS.MacroBrowser.ParameterFields.attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=function(a,d){AJS.debug("attachment:dependencyUpdated called: "+
a+", "+d);var e=c.prototype.fields._parsePageLink(d);this.getData(e)};return a},full_attachment:function(a){a=AJS.MacroBrowser.ParameterFields.full_attachment(a,{fileTypes:this.fileTypes});a.dependencyUpdated=function(a,d){AJS.debug("attachment:dependencyUpdated called: "+a+", "+d);var e=c.prototype.fields._parsePageLink(d);this.getData(e)};return a},"confluence-content":function(a){return AJS.MacroBrowser.ParameterFields["confluence-content"](a,{dependencies:["name"]})},_parsePageLink:function(a){var b=
{},a=a.split(":",2);b.spaceKey=2===a.length&&a[0]||AJS.Meta.get("space-key");b.title=a[a.length-1];0===b.title.indexOf("/")&&(b.postingDay=b.title.substr(1,10),b.title=b.title.substr(12));b.title===AJS.Editor.getCurrentTitle()&&(b.title="");b.title||(AJS.params.newPage?b.draftId=AJS.Meta.get("content-id"):b.pageId=AJS.params.pageId);return b}};AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage=function(a,b){AJS.MacroBrowser.setMacroJsOverride(a,new c(b))}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'soy/macro-browser.soy' */
// This file was automatically generated from macro-browser.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.MacroBrowser == 'undefined') { Confluence.Templates.MacroBrowser = {}; }


Confluence.Templates.MacroBrowser.macroSummaryList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ol id="category-', soy.$$escapeHtml(opt_data.category), '" class="macro-list"></ol>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.macroSummaryItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="macro-list-item"><h4 class="macro-title"></h4>');
  Confluence.Templates.MacroBrowser.macroDescription({description: ''}, output);
  output.append('</li>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.macroDescription = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="macro-desc">', (opt_data.descriptionHtml) ? opt_data.descriptionHtml : '', (opt_data.documentationLink) ? ' <a href="' + soy.$$escapeHtml(opt_data.documentationLink) + '" class="macro-doco-link">' + soy.$$escapeHtml("Documentation") + '</a>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.insertMacroPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="macro-insert-container"><input class="macro-name" type="hidden"/><div class="macro-input-fields dialog-panel"><form action="#" class="aui"></form></div><div class="macro-preview-container dialog-panel"><div class="macro-preview-header"><ul class="macro-preview-links"><li><a id="macro-browser-preview-link" class="refresh-link icon icon-refresh" href="#">', soy.$$escapeHtml("Refresh"), '</a></li></ul><span>', soy.$$escapeHtml("Preview"), '</span></div><div id="macro-browser-preview" class="macro-preview"></div></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.missingUserMacroMetadataPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="macro-missing-metadata-container"><p>', "There is no metadata configured for this macro which means no configuration screen can be presented here.", '</p>', (opt_data.showAdminMessage) ? '<p>' + AJS.format("If this is a user macro then you can add metadata to the template using the \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3eUser Macro Administration\x3c/a\x3e console.","/confluence" + '/admin/usermacros.action') + '</p>' : '<p>' + "You must contact an administrator to configure metadata for this macro." + '</p>', '</div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.macroParameter = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="macro-param-div"><label></label><input type="text" class="text"/></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.macroParameterBoolean = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="checkbox macro-param-div boolean-param"><input class="checkbox" type="checkbox" value="true"/><label></label></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.macroParameterSelect = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="macro-param-div"><label></label><select class="select"></select></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.macroParameterHidden = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="macro-param-div"><input type="hidden"/></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.macroParameterDesc = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="macro-param-desc">', opt_data.description, '</div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.macroBody = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="macro-body-div"><label>', soy.$$escapeHtml("Body text"), '</label><textarea class="monospaceInput textarea" type="text" rows="10"></textarea></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.helpLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-58/Working+with+Macros"}, output);
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.gadgetLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a class=\'macro-uri\' href="', soy.$$escapeHtml(opt_data.url), '" title="', soy.$$escapeHtml(opt_data.url), '" target=\'_blank\'>', soy.$$escapeHtml("Gadget URL"), '</a>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.MacroBrowser.cqlSections = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cql-filter-fields"></div><h4 class="cql-render-heading"><span>', soy.$$escapeHtml("Options"), '</span>');
  aui.buttons.button({type: 'link', text: "Show", extraAttributes: {'type': 'button'}}, output);
  output.append('</h4><div class="cql-render-fields hidden"></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-macro-browser:macro-browser-js', location = 'js/macro-browser-preload.js' */
AJS.toInit(function(a){a(window).bind("render-content-loaded",function(c,b){a("#macro-preview-iframe").contents().find("body")[0]==b&&AJS.MacroBrowser.previewOnload(b)});AJS.MacroBrowser.preLoadMacro()});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.js' */
Confluence.Editor=$.extend(Confluence.Editor||{},function(b){function p(a){b("#editpageform").find("input[name='atl_token']").val(a);AJS.Meta.set("atl-token",a);AJS.Meta.set("atlassian-token",a);b("#atlassian-token").attr("content",a)}var i=[],g=[],k=[],q=!1,f=1,u=function(){for(var a=0;a<i.length;a++)Confluence.Editor.UI.cancelButton.click(i[a]);for(a=0;a<g.length;a++)Confluence.Editor.UI.saveButton.click(g[a]);for(var b=AJS.$(Confluence.Editor.getCurrentForm()),a=0;a<k.length;a++)b.submit(k[a]);
AJS.$.unbind("init.rte",this)},m=function(a,b,d,e){e.push(d);AJS.Rte&&AJS.Rte.BootstrapManager&&AJS.Rte.BootstrapManager.isInitComplete()?a.bind(b,d):q||(q=!0,AJS.$.bind("init.rte",u))},n=function(a,b,d){var e=null;AJS.Rte&&(AJS.Rte.BootstrapManager&&AJS.Rte.BootstrapManager.isInitComplete())&&(e=function(a,b,c){a.unbind(b,c)});for(var j=d.pop();j;)e&&e(a,b,j),j=d.pop()},r=function(a,b){if(l!==a||!o)AJS.debug("Changing heartbeat period to "+b+" (recoveryMode = "+a+")"),clearInterval(o),l=a,o=setInterval(Confluence.Editor.heartbeat,
b)},l=!1,o,s=+AJS.Meta.get("heartbeat-interval")||3E4,v=Math.max(s/5,5E3),t={normal:function(){r(!1,s)},recovery:function(){r(!0,v)},isNormal:function(){return!l},reset:function(){l=!0;t.normal()}};return{bookmark:"",MODE_RICHTEXT:"richtext",MODE_SOURCE:"source",MODE_PREVIEW:"preview",PREVIEW_OUTPUT_TYPE:"PREVIEW",currentEditMode:null,contentHasChangedSinceLastSave:!1,sourceInitialValue:!1,isSubmitting:!1,isCancelling:!1,getNumConcurrentEditors:function(){return f},addCancelHandler:function(a){m(Confluence.Editor.UI.cancelButton,
"click",a,i)},addSaveHandler:function(a){m(Confluence.Editor.UI.saveButton,"click",function(b){return Confluence.Editor.UI.isButtonEnabled(Confluence.Editor.UI.saveButton)?a(b):!1},g)},addSubmitHandler:function(a){m(AJS.$(Confluence.Editor.getCurrentForm()),"submit",a,k)},removeAllCancelHandlers:function(){n(Confluence.Editor.UI.cancelButton,"click",i)},removeAllSaveHandlers:function(){n(Confluence.Editor.UI.saveButton,"click",g)},removeAllSubmitHandlers:function(){n(AJS.$(Confluence.Editor.getCurrentForm()),
"submit",k)},hasContentChanged:function(){return!this.inRichTextMode()&&!this.contentHasChangedSinceLastSave?!1:this.editorHasContentChanged()},editorHasContentChanged:function(){return null==AJS.Rte.getEditor()?(AJS.debug("Confluence.Editor: editorHasContentChanged - No active editor present. Returning false."),!1):AJS.Rte.Content.editorHasContentChanged()},isEmpty:function(){var a=b(AJS.Rte.getEditor().getContent()).text();return!b.trim(a)},getResumeDraftUrl:function(){var a=[];a.push(Confluence.getContextPath());
a.push("/pages/"+(AJS.params.newPage?"create":"edit")+AJS.params.draftType+".action");a.push("?useDraft=true");a.push("&pageId="+AJS.params.pageId);a.push("&contentChanged="+this.hasContentChanged());this.getCurrentForm().spaceKey&&a.push("&spaceKey="+AJS.Meta.get("space-key"));return a.join("")},getCurrentTitle:function(){return b("#content-title")&&b("#content-title").val()},contentFormSubmit:function(){Confluence.Editor.Drafts.unBindUnloadMessage();AJS.$(".editable-title #content-title").prop("disabled",
!0);return!0},heartbeat:function(){var a={dataType:"json",contentId:Confluence.Editor.Drafts.isNewContent()?AJS.params.draftId:AJS.params.pageId,draftType:AJS.params.draftType,spaceKey:AJS.params.spaceKey},c=AJS.Meta.getBoolean("shared-drafts"),d="page"===AJS.Meta.get("content-type")||"blogpost"===AJS.Meta.get("content-type"),e="0"!==AJS.params.pageId;!d||!e&&!c?AJS.safe.post(AJS.params.contextPath+"/json/heartbeat.action",{},function(a){a&&a.atlToken&&p(a.atlToken)}):AJS.safe.post(AJS.params.contextPath+
"/json/startheartbeatactivity.action",a,function(a){if(!a||!a.atlToken||!(a.activityResponses instanceof Array))AJS.trigger("rte.heartbeat-error","Invalid server response"),AJS.logError("Unexpected server response for heartbeat:"),AJS.log(a);else{var c=a.activityResponses;p(a.atlToken);Confluence.Editor.heartbeatType.normal();AJS.trigger("rte.heartbeat",c);f=(c.length||0)+1;if(1<f){var d=b("#other-users-span");d.empty();for(var e=0;e<f-1;++e){0<e&&d.append(", ");var h=c[e];d.append(AJS("a").attr("href",
AJS.params.contextPath+"/display/~"+encodeURIComponent(h.userName)).text(h.fullName));null!=h.lastEditMessage&&d.append(" ").append(AJS("span").addClass("smalltext").text(h.lastEditMessage))}AJS.isVisible("#heartbeat-div")||AJS.Confluence.Analytics.publish("rte.notification.concurrent-editing",{numEditors:f,pageId:AJS.params.pageId,draftType:AJS.params.draftType})}AJS.setVisible("#heartbeat-div",1<f);b(document).trigger("resize.resizeplugin");AJS.trigger("editor-heartbeat",a)}},"json").fail(function(a,
b,c){(503===a.status||0===a.status)&&Confluence.Editor.heartbeatType.recovery();403===a.status||401===a.status?AJS.logError("Heartbeat error: Unauthorized"):(AJS.logError("Server error on heartbeat request:"),AJS.log(c));AJS.trigger("rte.heartbeat-error",a)})},heartbeatType:t,disableFrame:function(a){AJS.$("form",a).each(function(){AJS.$(this).unbind();this.onsubmit=function(){return!1}});AJS.$("a",a).each(function(){AJS.$(this).attr("target","_top").unbind()});AJS.$("input, img",a).each(function(){AJS.$(this).unbind()})},
previewFrameOnload:function(a,c){Confluence.Editor.setMode(Confluence.Editor.MODE_PREVIEW);tinyMCE.activeEditor.setProgressState(!1);Confluence.Editor.disableFrame(a);var d=AJS.$("#main",a)[0];if("comment"!=AJS.Meta.get("content-type")&&0==AJS.$(d).find("#main-header").length){var e=AJS.$("#title-heading"),j=e.attr("class");AJS.$(d).prepend('<div id="preview-header"><div id="title-heading" class="'+j+'">'+e.html()+"</div></div>")}AJS.$("a",a).attr("target","_parent");if(b(AJS.Rte.getEditor().getBody()).hasClass("resizable")){var f=
b(c||"#previewArea iframe"),i=0,g=0,h,k=f.height();d&&function(){var a=b(d).outerHeight(!0);i!=a?(a!=f.height()&&f.height(0).height(Math.max(a,k)),i=a,g=0):g++;500>g&&(h=setTimeout(arguments.callee,500))}();b(document).one("mode-changed.resize-editor",function(a,b){b!=Confluence.Editor.MODE_PREVIEW&&h&&clearTimeout(h)})}else if(tinymce.isIE||tinymce.isOpera){var e=b(window).height(),j=b("#header-precursor").height()+b("#header").height()+b("#editor-precursor").height(),l=b("#savebar-container").height();
b("#preview iframe").height(e-j-l-4);b("#content.edit").height("auto")}},showRichText:function(a){AJS.setVisible("#wysiwyg",a);b(".toolbar-group-preview").toggleClass("assistive",!a);b(".toolbar-group-edit").toggleClass("assistive",a);b("#main").toggleClass("active-richtext",a);tinymce.isGecko&&a&&AJS.Rte.fixEditorFocus(Confluence.Editor.bookmark)},showPreview:function(a){if("comment"!==AJS.Meta.get("content-type")){var c=b("#content-title");c.hasClass("placeholded")?(b("#preview-title-text").text(""),
b("#title-text").text("")):(b("#preview-title-text").text(c.val()),b("#title-text").text(c.val()))}AJS.setVisible("#preview",a);b(".toolbar-group-preview").toggleClass("assistive",a);b(".toolbar-group-edit").toggleClass("assistive",!a);b("#main").toggleClass("active-preview",a);b("#full-height-container").length&&b("#full-height-container").toggleClass("active-preview",a)},showSource:function(a){a?this.showSourceArea():this.hideSourceArea();b("#main")[a?"addClass":"removeClass"]("active-source")},
setMode:function(a){AJS.debug("Set mode: "+a);a==Confluence.Editor.MODE_RICHTEXT?(this.showRichText(!0),this.showPreview(!1),this.showSource(!1)):a==Confluence.Editor.MODE_SOURCE?(this.showSource(!0),this.showRichText(!1),this.showPreview(!1)):a==Confluence.Editor.MODE_PREVIEW&&(this.showPreview(!0),this.showRichText(!1),this.showSource(!1),Confluence.Editor.UI.spinner.removeClass("aui-icon-wait"));setTimeout(function(){var a=b(".toolbar-group-preview");a.height(0);a.height();a.height("auto")},1);
this.currentEditMode=a;b(document).trigger("mode-changed",[a])},getContentId:function(){return Confluence.getContentId()},addErrorMessage:function(a,c,d){var e=b("#"+a),d=d?"#all-messages":"#editor-messages";e.length?e.empty():e=b("<div></div>").attr("id",a).appendTo(d);AJS.messages.error(e,{closeable:!0,body:c})},changeMode:function(a,c){AJS.debug("Change mode: "+a);c=c||{};if(this.inRichTextMode()&&!AJS.Rte.BootstrapManager.isInitComplete()||this.currentEditMode==a)return!1;var d=this.currentEditMode;
AJS.trigger("rte-changeMode",a);if(a==Confluence.Editor.MODE_PREVIEW){var e=AJS.Rte.getEditor();d==Confluence.Editor.MODE_SOURCE&&Confluence.Editor.transferSourceToEditor();tinyMCE.isGecko&&(d==Confluence.Editor.MODE_RICHTEXT&&!Confluence.Editor.bookmark)&&(Confluence.Editor.bookmark=tinymce.activeEditor.selection.getBookmark());this.currentEditMode=a;e={contentId:Confluence.getContentId(),contentType:AJS.Meta.get("content-type"),spaceKey:AJS.Meta.get("space-key"),xHtml:e.getContent(),outputType:Confluence.Editor.PREVIEW_OUTPUT_TYPE};
AJS.safe.ajax({type:"POST",url:AJS.params.contextPath+"/pages/rendercontent.action",data:e,success:Confluence.Editor.replysetPreviewArea,timeout:2E4,error:function(){Confluence.Editor.addErrorMessage("preview-error","There was an error loading preview. Please try again later.");Confluence.Editor.currentEditMode=d;c.errorCallback&&c.errorCallback()}})}else this.setMode(a);a==Confluence.Editor.MODE_RICHTEXT&&b(document).trigger("resize.resizeplugin");return!1},replysetPreviewArea:function(a){b("#preview-error").remove();
var c=AJS.params.staticResourceUrlPrefix+"/blank.html";tinyMCE.activeEditor.setProgressState(!0);AJS.$("#previewArea").html('<iframe id="editor-preview-iframe" src="'+c+'" scrolling="yes" frameborder="0"></iframe>');c=AJS.$("#previewArea iframe")[0];c=c.contentDocument||c.contentWindow.document;c.write(a);c.close()},inRichTextMode:function(){return this.currentEditMode==Confluence.Editor.MODE_RICHTEXT},isNewPage:function(){return 0<AJS.$("#createpageform, #createpagetemplate").length},onInit:function(){Confluence.Editor.setMode(Confluence.Editor.MODE_RICHTEXT);
tinyMCE.activeEditor.onClick.add(function(){var a=Confluence.Editor.UI.postingDatePicker;a&&a.hide()})},contentChangeHandler:function(){this.contentHasChangedSinceLastSave=!0},getCurrentForm:function(){return tinyMCE.activeEditor.formElement},transferSourceToEditor:function(){var a=Confluence.Editor;if(a.sourceInitialValue){var b=a.getSourceAreaVal();if(b!=a.sourceInitialValue){var d=tinyMCE.activeEditor;d.setContent(b);d.setDirty(b)}}a.sourceInitialValue=!1},hideSourceArea:function(){AJS.$("#editor-html-source-container").addClass("hidden");
this.setToolBarInactive(!1);this.transferSourceToEditor();b("#rte-button-source-mode").removeClass("active");b("#rte-button-publish").unbind("click.source-save")},showSourceArea:function(){AJS.$("#editor-html-source-container").removeClass("hidden");this.setSourceAreaHeight();this.setToolBarInactive(!0);this.sourceInitialValue=tinyMCE.activeEditor.getContent();this.setSourceAreaVal(this.sourceInitialValue);b("#rte-button-source-mode").addClass("active");b("#rte-button-publish").bind("click.source-save",
Confluence.Editor.transferSourceToEditor)},getSourceAreaVal:function(){return AJS.$("#editor-html-source").val()},setSourceAreaVal:function(a){AJS.$("#editor-html-source").val(a)},setSourceAreaHeight:function(){var a=AJS.Rte.getTinyMceEditorMinHeight();AJS.debug("HTML source height= "+a);var c=b("#editor-html-source")[0].scrollHeight;c>a&&(a=c,AJS.debug("ACTUAL HEIGHT "+c));b("#editor-html-source-container").height(a+"px")},setToolBarInactive:function(a){b("#rte-toolbar").toggleClass("disabled",a)},
isVisible:function(){return 0<b("#wysiwyg:visible").length||0<b("#editor-html-source-container:visible").length||0<b("#preview:visible").length}}}($));AJS.toInit(function(){AJS.bind("init.rte",Confluence.Editor.onInit)});AJS.Editor=Confluence.Editor;
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-ui.js' */
AJS.bind("init.rte",function(){var c=function(b){for(var a=0;a<Confluence.Editor.UI.buttons.length;a++)h(b,Confluence.Editor.UI.buttons[a])},h=function(b,a){a&&(b?a.removeAttr("aria-disabled"):a.attr("aria-disabled","true"))},i=function(b){return b.length&&"true"!==b.attr("aria-disabled")},g=function(){return AJS.Meta.get("new-page")},j=function(){var b="";g()||(b="Edit"+" - ");return b},e=Confluence.Editor,l=$("#rte-spinner"),f;f=Confluence.Templates.Editor.Page.saveButton({contentType:AJS.Meta.get("content-type")});
$("#rte-button-publish").replaceWith(f);f=$("#rte-button-publish");e.UI={spinner:l,saveButton:f,overwriteButton:$("#rte-button-overwrite"),editButton:$("#rte-button-edit"),previewButton:$("#rte-button-preview"),cancelButton:$("#rte-button-cancel"),watchPageCheckbox:$("#watchPage"),watchPageToolbarGroup:$(".toolbar-group-watch-page"),setButtonsState:c,setButtonState:h,isButtonEnabled:i,registerFormButton:function(b,a){Confluence.Editor.UI[b]=a;Confluence.Editor.UI.buttons.push(a)},postingDatePicker:null,
isFormEnabled:function(){for(var a=0;a<Confluence.Editor.UI.buttons.length;a++)if(i(Confluence.Editor.UI.buttons[a]))return!0;return!1},toggleSavebarBusy:function(a){if(a){if(!Confluence.Editor.UI.isFormEnabled())return!1;Confluence.Editor.UI.spinner.addClass("aui-icon-wait");c(!1)}else Confluence.Editor.UI.spinner.removeClass("aui-icon-wait"),c(!0);return!0},toggleWatchPage:function(a){a&&"comment"===AJS.Meta.get("content-type")?(Confluence.Editor.UI.watchPageToolbarGroup.show(),Confluence.Editor.UI.watchPageCheckbox.length&&
(Confluence.Editor.UI.watchPageCheckbox[0].checked=!1)):Confluence.Editor.UI.watchPageToolbarGroup.hide()}};AJS.trigger("rte.init.ui");Confluence.Editor.UI.buttons=[Confluence.Editor.UI.saveButton,Confluence.Editor.UI.overwriteButton,Confluence.Editor.UI.editButton,Confluence.Editor.UI.previewButton,Confluence.Editor.UI.cancelButton];var a=Confluence.Editor,k=Confluence.Editor.UI.cancelButton;a.isNewPage()&&$("#content-title").focus().select();a.addCancelHandler(function(){1<a.getNumConcurrentEditors()&&
AJS.Confluence.Analytics.publish("rte.notification.concurrent-editing.cancel",{numEditors:a.getNumConcurrentEditors(),pageId:AJS.params.pageId,draftType:AJS.params.draftType})});"comment"===AJS.Meta.get("content-type")&&Confluence.Editor.addSaveHandler(function(){if(AJS.Rte.Content.isEmpty())return AJS.Confluence.EditorNotification.notify("warning","Comment text is empty. Cannot create empty comments."),!1});("comment"===AJS.Meta.get("content-type")||"template"===AJS.Meta.get("content-type"))&&a.addCancelHandler(function(){if(Confluence.Editor.UI.isFormEnabled()&&
Confluence.Editor.hasContentChanged()&&!Confluence.Editor.isEmpty()){var a="comment"===AJS.Meta.get("content-type")?"Your comment will be lost.":"Your unsaved template changes will be lost.";if(!confirm(a))return!1}});a.addSaveHandler(function(){1<a.getNumConcurrentEditors()&&AJS.Confluence.Analytics.publish("rte.notification.concurrent-editing.save",{numEditors:a.getNumConcurrentEditors(),pageId:AJS.params.pageId,draftType:AJS.params.draftType})});a.addSubmitHandler(function(b){return Confluence.Editor.UI.toggleSavebarBusy(!0)?
a.contentFormSubmit(b):!1});this.currentEditMode=this.MODE_RICHTEXT;a.UI.editButton.click(function(b){Confluence.Editor.UI.isFormEnabled()&&(Confluence.Editor.changeMode(a.MODE_RICHTEXT),setTimeout(function(){AJS.Rte.getEditor().focus();tinymce.isGecko&&Confluence.Editor.bookmark&&AJS.Rte.getEditor().selection.moveToBookmark(Confluence.Editor.bookmark)},0),k.enable());b.preventDefault()});a.UI.previewButton.click(function(b){Confluence.Editor.UI.isFormEnabled()&&a.currentEditMode!==a.MODE_PREVIEW&&
(c(!1),Confluence.Editor.UI.spinner.addClass("aui-icon-wait"),tinymce.isGecko&&!Confluence.Editor.bookmark&&(Confluence.Editor.bookmark=tinymce.activeEditor.selection.getBookmark()),a.changeMode(a.MODE_PREVIEW,{errorCallback:function(){c(true);Confluence.Editor.UI.spinner.removeClass("aui-icon-wait")}}),k.disable());b.preventDefault()});$("#editor-html-source").change(a.setSourceAreaHeight).keyup(a.setSourceAreaHeight);$("#rte-button-labels").bind("updateLabel",function(){var a=+AJS.Meta.get("num-labels")||
0,d="Labels";1===a?d=AJS.format("{0} Label",a):1<a&&(d=AJS.format("{0} Labels",a));$("#rte-button-labels").attr("data-tooltip",d)});e=$("#PostingDate");e.length&&(e.attr("max",moment().format("YYYY-MM-DD")),a.UI.postingDatePicker=e.datePicker({overrideBrowserDefault:!0}),a.UI.postingDatePicker.hide());$(".mceProgress, .mceBlocker",$("#wysiwygTextarea_parent")[0]).live("click",function(){AJS.Rte.getEditor().focus()});$(window).bind("render-content-loaded",
function(b,d){var c=$("#previewArea iframe");if(c.contents().find("body")[0]==d){a.previewFrameOnload(d,c);a.UI.setButtonsState(true);c.focus();window.focus();$(document).trigger("iframeAppended",c)}});AJS.Meta.get("heartbeat")&&(a.heartbeat(),Confluence.Editor.heartbeatType.normal());AJS.bind("watchpage.pageoperation",function(){Confluence.Editor.UI.toggleWatchPage(false)});AJS.bind("unwatchpage.pageoperation",function(){Confluence.Editor.UI.toggleWatchPage(true)});g()&&"inlinecommentform"===AJS.Meta.get("form-name")&&
(document.title="Edit"+document.title);var m=document.title;g()&&$.trim($("input#content-title").val())&&(document.title=j()+$("input#content-title").val()+" - "+AJS.Meta.get("space-name")+" - "+AJS.Meta.get("site-title"));$("input#content-title").on("change input",function(){if(AJS.Meta.get("content-type")!=="template"){var a=j();document.title=$.trim(this.value)?a+this.value+" - "+AJS.Meta.get("space-name")+" - "+AJS.Meta.get("site-title"):m}});AJS.trigger("init.rte-control")});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'tinymce3/plugins/insertwiki/insert-wiki-markup.soy' */
// This file was automatically generated from insert-wiki-markup.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.InsertWiki == 'undefined') { Confluence.Templates.InsertWiki = {}; }


Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><textarea class=\'monospaceInput textarea originalDefault\' id=\'insert-wiki-textarea\' name=\'wikitext\'/></form>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.InsertWiki.previewWikiIframeContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<!DOCTYPE html><html class="insert-wiki-markup-dialog"><head></head><body class="wiki-content previewWiki"></body></html>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.InsertWiki.wikiMarkupDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p id="insert-wiki-info-title">', soy.$$escapeHtml("Enter wiki markup or markdown below. Confluence will convert your content to editor format and insert it into your page."), '</p><form action=\'#\' method=\'post\' id="insert-wiki-markup-form" class="aui"><h3 class="wiki-title"><span id="insert-wiki-insert-title">', soy.$$escapeHtml("Insert"), '</span><span id="insert-wiki-preview-title">', soy.$$escapeHtml("Preview"), '</span></h3><textarea class=\'monospaceInput textarea\' id=\'insert-wiki-textarea\' name=\'wikitext\'/><!-- --><div class=\'example-container\' id=\'insert-wiki-textarea-preview\'></div></form>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.InsertWiki.wikiErrorSubDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p class=\'warning\'>', soy.$$escapeHtml(opt_data.warningMessage), '</p><p class=\'exception-report\'><span class=\'exceptionMessage\'>', soy.$$escapeHtml(opt_data.exceptionMessage), '</span></p>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.InsertWiki.wikiParserSelector = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="wiki-parser-selector"><form action="#" method="post" id="d" class="aui"><select class="select medium-field" id="wiki-parser-selection-tool" name="wiki-parser-selection-tool" title="wiki parser selector"><option value="', soy.$$escapeHtml(opt_data.DEFAULT.val), '">', soy.$$escapeHtml(opt_data.DEFAULT.label), '</option>');
  var wikiLangList26 = soy.$$getMapKeys(opt_data.WIKI);
  var wikiLangListLen26 = wikiLangList26.length;
  for (var wikiLangIndex26 = 0; wikiLangIndex26 < wikiLangListLen26; wikiLangIndex26++) {
    var wikiLangData26 = wikiLangList26[wikiLangIndex26];
    output.append((opt_data.WIKI[wikiLangData26].val != opt_data.DEFAULT.val) ? '<option value="' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].val) + '">' + soy.$$escapeHtml(opt_data.WIKI[wikiLangData26].label) + '</option>' : '');
  }
  output.append('</select></form></span>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor.soy' */
// This file was automatically generated from page-editor.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Page == 'undefined') { Confluence.Templates.Editor.Page = {}; }


Confluence.Templates.Editor.Page.saveButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<button id="rte-button-publish" class="aui-button aui-button-primary" type="submit" name="confirm" value="Save"', (opt_data.contentType == 'blogpost') ? 'title="' + soy.$$escapeHtml("Publish your blog post") + '"' : (opt_data.contentType == 'page') ? 'title="' + soy.$$escapeHtml("Save your page") + '"' : 'title="' + soy.$$escapeHtml("Save") + '"', 'tabindex="101">', (opt_data.contentType == 'blogpost') ? '<span class="trigger-text">' + soy.$$escapeHtml("Publish") + '</span>' : '<span class="trigger-text">' + soy.$$escapeHtml("Save") + '</span>', '</button>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'insert-image-dialog/insert-image-dialog.js' */
(function(e){e.fn.sizeToFit=function(){var a=jQuery;this.each(function(){var b=this,c=a(this).parent(),d=c.height();c.children().each(function(){this!==b&&a(this).is(":visible")&&(d-=a(this).outerHeight())});c=a(this).outerHeight()-a(this).height();a(this).css("height",Math.max(0,d-c)+"px")});return this};Confluence.Editor.ImageDialog={beforeShowListeners:[],panelComponent:[]};Confluence.Editor.defaultInsertImageDialog=function(){AJS.Rte.BookmarkManager.storeBookmark();Confluence.Editor.insertImageDialog(function(a){AJS.Rte.BookmarkManager.restoreBookmark();
var b={};if(a.url)b={url:a.url,filename:a.url,contentId:a.contentId},tinymce.confluence.ImageUtils.insertFromProperties(b);else{var c=!0,d=1<a.selectItems.length;_.each(a.selectItems,function(a){a.isImage()?(b={filename:a.getFileName(),contentId:a.get("ownerId")},tinymce.confluence.ImageUtils.insertFromProperties(b,d)):(c=!1,AJS.MacroBrowser.getMacroMetadata("view-file")?Confluence.Editor.ImageDialog._insertFilePlaceholderToEditor(a):Confluence.Editor.ImageDialog._insertLinkToEditor(a))});require(["conf/confluence-drag-and-drop/analytics/files-upload-analytics"],
function(b){b.triggerEvent("confluence.insert-files-dialog.insert",a.selectItems,c)})}e("#comments-section").length&&AJS.Rte.fixEditorFocus()},function(){AJS.Rte.BookmarkManager.restoreBookmark()})};Confluence.Editor.ImageDialog.findPanelComponentById=function(a){for(var b=Confluence.Editor.ImageDialog.panelComponent,c=0,d=b.length;c<d;c++)if(b[c].id==a)return b[c]};Confluence.Editor.insertImageDialog=function(a,b){var c=new Confluence.Editor.FileDialog.FileDialogView({submitCallback:a,cancelCallback:b,
beforeShowListeners:Confluence.Editor.ImageDialog.beforeShowListeners,panelComponents:Confluence.Editor.ImageDialog.panelComponent});c.render();return c};Confluence.Editor.ImageDialog._insertLinkToEditor=function(a){var b=Confluence.Link.fromREST(a.attributes);b.attrs["data-linked-resource-container-id"]=a.get("ownerId");b.attrs.href=a.get("downloadUrl");b.insert()};Confluence.Editor.ImageDialog._insertFilePlaceholderToEditor=function(a){var b={name:a.get("fileName"),page:a.get("parentTitle"),space:a.get("space")?
a.get("space").key:"",date:a.get("datePath"),ownerId:a.get("ownerId")};require(["confluence-editor/utils/attachments-insert"],function(a){a.insertFilePlaceholder(b)})}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'panel-components/panel-components-init.js' */
(function(g,a){AJS.toInit(function(){if(a.Editor&&a.Editor.ImageDialog&&a.Editor.ImageDialog.panelComponent){var b=a.Editor.FileDialog.eventListener,d=a.Editor.FileDialog.ExternalPanelView,e=a.Editor.FileDialog.SearchPanelView,f=a.Editor.FileDialog.AttachmentsPanelView,c=a.Editor.ImageDialog.panelComponent;"template"!==AJS.Meta.get("content-type")&&(b=new f({eventListener:b}),c.push(b));c.push(new d);c.push(new e)}})})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'drafts/page-editor-drafts.js' */
Confluence.Editor.Drafts=function(c){var i=!1,h=!1,f=function(b,a,j){c("<input>").attr({type:"hidden",name:b,value:a}).appendTo(j)};return{isDraftSaved:function(){return i},isDraftManuallySaved:function(){return h},isDraftBlank:function(){return AJS.Rte.Content.isEmpty()&&!c.trim(Confluence.Editor.getCurrentTitle())},isNewContent:function(){return AJS.Rte.getEditor()&&0==AJS.Meta.get("page-id")&&0<AJS.Meta.get("draft-id")},unloadMessage:function(){var b=function(){Confluence.Editor.Drafts.isDraftBlank()?
Confluence.Editor.Drafts.discardDraft(AJS.Meta.get("draft-id")):Confluence.Editor.Drafts.save({skipErrorHandler:!0})};if("undefined"!==typeof seleniumAlert)b();else if(Confluence.Editor.hasContentChanged()||Confluence.Editor.Drafts.isDraftSaved()&&!Confluence.Editor.Drafts.isDraftManuallySaved())return b(),"A draft will be saved. You can resume editing this draft the next time you open the editor or view all your drafts in your profile."},bindUnloadMessage:function(){c(window).bind("beforeunload.editor",Confluence.Editor.Drafts.unloadMessage)},unBindUnloadMessage:function(){c(window).unbind("beforeunload.editor")},
useDraft:function(){var b=AJS.Meta.get("existing-draft-id");Confluence.Editor.Drafts.unBindUnloadMessage();var a=Confluence.Editor.getCurrentForm();f("useDraft","true",a);f("contentChanged",""+Confluence.Editor.hasContentChanged(),a);f("pageId",AJS.params.pageId,a);c("#draftId",Confluence.Editor.getCurrentForm()).val(b);a.spaceKey||f("spaceKey",AJS.Meta.get("space-key"),a);a.action=AJS.Confluence.getContextPath()+"/pages/"+(AJS.params.newPage?"create":"edit")+AJS.params.draftType+".action";a.submit()},
discardDraft:function(b){AJS.safeAjax({url:Confluence.getContextPath()+"/json/deletedraft.action",type:"GET",dataType:"json",data:{draftId:b},success:function(a){if(a.actionErrors){for(var b=["<ul>"],a=a.actionErrors,d=0;d<a.length;d++)AJS.log("error: "+a[d]),b.push("<li>"+a[d]+"</li>");b.push("</ul>");AJS.messages.error("#editor-messages",{title:"Error",body:"There were errors discarding your draft: "+b.join("\n")})}else c("#draft-messages").remove(),AJS.messages.success("#editor-messages",{body:"Your draft has been discarded."})},
error:function(a){AJS.messages.error({title:"Error",body:a.errors||"An unknown error has occurred. Please check your logs."})}})},save:function(b){b=b||{};if(Confluence.Editor.isSubmitting||!Confluence.Editor.hasContentChanged()&&!b.forceSave)AJS.debug("skipping draft save");else{AJS.debug("preparing to save editor draft");var a=c("#content-title"),f=c("#newSpaceKey"),d=c("#originalVersion"),k=Confluence.Editor.inRichTextMode(),a={draftId:AJS.Meta.get("draft-id"),pageId:AJS.params.pageId,type:AJS.params.draftType,
title:a.hasClass("placeholded")?"":a.val(),spaceKey:f.length?f.val():encodeURIComponent(AJS.Meta.get("space-key")),content:AJS.Rte.getEditor().getContent()};d.length&&(a.pageVersion=parseInt(d.val(),10));c.ajax({type:"POST",url:AJS.params.contextPath+"/rest/tinymce/1/drafts",data:c.toJSON(a),contentType:"application/json",dataType:"text json",success:function(a){if(a!=null){Confluence.Editor.contentHasChangedSinceLastSave=false;k&&AJS.Rte.Content.editorResetContentChanged();i=true;h=!!b.manualSave;
AJS.Meta.set("draft-id",a.draftId);AJS.Meta.set("draft-share-id",a.draftId);c("#draftId",Confluence.Editor.getCurrentForm()).val(a.draftId);c("#draft-error").remove();var f=c("#draft-status"),e;if(!(e=a.time)){var g=new Date;e=g.getHours();var g=g.getMinutes(),d=e>11?"PM":"AM";e=e%12;e=(e==0?"12":e)+":"+(g<10?"0":"")+g+" "+d}g=h?AJS.format("Draft saved at {0}",e):AJS.format("Draft autosaved at {0}",e);d=AJS.params.newPage?g:"<a id='view-diff-link-heartbeat' class='view-diff-link' href='#'>"+
g+"</a>";f.attr("data-tooltip",g);f.html(d);+AJS.Meta.get("content-id")||AJS.Meta.set("content-id",a.pageId);if(c.isFunction(b.onSuccessHandler))b.onSuccessHandler(a);Confluence.Editor.Drafts.lastSaveTime=e;AJS.trigger("rte-draft-saved",{draftId:a.draftId,draftShareId:a.draftShareId})}},error:function(a,d){if(!b.skipErrorHandler){Confluence.Editor.addErrorMessage("draft-error",Confluence.Editor.Drafts.lastSaveTime?AJS.format("Error saving draft. Last draft saved at {0}",Confluence.Editor.Drafts.lastSaveTime):
"Error saving draft. No draft has been saved.",true);if(c.isFunction(b.onErrorHandler))b.onErrorHandler(d)}},timeout:3E4})}}}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:page-editor-js', location = 'editor/page-editor-permissions.js' */
AJS.PagePermissions=AJS.PagePermissions||{};
AJS.toInit(function(e){var g=function(c,a){var b=e("#rte-button-restrictions"),f=b.find(".icon"),d="";c||a?(f.removeClass("icon-restricted icon-restricted-inherited icon-unrestricted").addClass(c?"icon-restricted":"icon-restricted-inherited"),d="Restricted"):(f.removeClass("icon-restricted icon-restricted-inherited icon-unrestricted").addClass("icon-unrestricted"),d="Unrestricted");b.attr("data-tooltip",d);b.data("explicit-restrictions",
c);b.data("inherited-restrictions",a)};AJS.bind("editor-heartbeat",function(c,a){if("undefined"!==typeof a.restrictionsHash){var b=e("#rte-button-restrictions");if(b.data("restrictionsHash")!==a.restrictionsHash){var f=e("#update-page-restrictions-dialog"),d=""!==a.restrictionsHash,h=!!b.data("inherited-restrictions");f.is(":visible")&&AJS.PagePermissions.updateRestrictionsDialog?AJS.PagePermissions.updateRestrictionsDialog():g(d,h);b.data("restrictionsHash",a.restrictionsHash)}}});AJS.bind("edit-page-restrictions-updated",
function(c,a){g(a.hasExplicitRestrictions,a.hasInheritedRestrictions)});e.extend(AJS.PagePermissions,{updateEditPageRestrictions:g})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.auiplugin:aui-experimental-progress-indicator', location = 'js/aui-experimental-progress-indicator.js' */
(function(){function A(B,D,C){AJS._internal.animation.recomputeStyle(B);B.css("width",C*100+"%");D.attr("data-value",C)}AJS.progressBars={update:function(G,M){var C=AJS.$(G).first();var F=C.children(".aui-progress-indicator-value");var L=F.attr("data-value")||0;var K="aui-progress-indicator-after-update";var I="aui-progress-indicator-before-update";var D="transitionend webkitTransitionEnd";var E=!C.attr("data-value");if(E){F.css("width",0)}if(typeof M==="number"&&M<=1&&M>=0){C.trigger(I,[L,M]);var H=document.body||document.documentElement;var B=H.style;var J="transition";if(typeof B.transition==="string"||typeof B.WebkitTransition==="string"){F.one(D,function(){C.trigger(K,[L,M])});A(F,C,M)}else{A(F,C,M);C.trigger(K,[L,M])}}return C},setIndeterminate:function(D){var C=AJS.$(D).first();var B=C.children(".aui-progress-indicator-value");C.removeAttr("data-value");AJS._internal.animation.recomputeStyle(C);B.css("width","100%")}}}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/js/draft-changes.js' */
AJS.toInit(function(e){var b,i=function(b){var g="Are you sure you want to discard this draft?";return confirm(g)?(AJS.safeAjax({url:Confluence.getContextPath()+"/json/deletedraft.action",type:"GET",dataType:"json",data:{draftId:b},success:function(c){if(c.actionErrors){for(var d=["<ul>"],c=c.actionErrors,a=0;a<c.length;a++)AJS.log("error: "+c[a]),d.push("<li>"+c[a]+"</li>");d.push("</ul>");AJS.messages.error("#errors",{title:"Error",body:"There were errors discarding your draft."+
" "+d.join("\n")})}else d=e("#draft-"+b),c=d.closest("table"),a=c.closest(".drafts-container"),d.remove(),0==c.find("tbody tr").length&&a.append('<span id="no-drafts-message">'+"No drafts found."+"</span>")},error:function(b){AJS.messages.error({title:"Error",body:b.errors||"An unknown error has occurred. Please check your logs."})}}),!0):!1};e("body").on("click",".view-diff-link",function(j){var g=this.id,c=e(this);if(!b){var d="view-diff-link-notification"===g;b=new AJS.Dialog(860,530,"view-diff-draft-dialog");
var a="Unpublished Changes for \'{0}\'";b.addHeader(a.replace(/\{0\}/,""));a=e(Confluence.Templates.DraftChanges.dialogContent());b.addPanel("Diff",a);d&&(b.addButton("Edit",function(){b.hide();Confluence.Editor&&Confluence.Editor.Drafts?Confluence.Editor.Drafts.useDraft():window.location=e(this).attr("data-href")},"resume-diff-link"),b.addButton("Discard",function(){if(Confluence.Editor&&Confluence.Editor.Drafts)b.hide(),Confluence.Editor.Drafts.discardDraft(AJS.Meta.get("existing-draft-id")),
AJS.Confluence.Analytics.publish("rte.notification.draft.discard");else{var a=e(this).data("draftid");i(a)&&b.hide()}},"discard-diff-link"));b.addCancel("Close",function(){b.hide();return false});a.removeClass("hidden")}b.addHeader("Loading");e("#diff-view").html("<tr><td id='draft-changes-waiting-icon'>Loading...</td></tr>");var h,a=c.attr("class"),f=/draftPageId:([^ ]*)/.exec(a),c=f?f[1]:AJS.Meta.get("page-id"),d=(f=/username:([^ ]*)/.exec(a))?f[1]:
AJS.Meta.get("remote-user");h=(f=/draftId:([^ ]*)/.exec(a))?f[1]:null;AJS.safeAjax({url:Confluence.getContextPath()+"/draftchanges/viewdraftchanges.action",type:"GET",dataType:"json",data:{pageId:c,username:d},success:function(a){if(a.actionErrors){for(var c="",a=a.actionErrors,d=0;d<a.length;d++)AJS.log("error: "+a[d]),c=c+"<div>"+a[d]+"</div>";e("#diff-view").html(c)}else e("#diff-view").html(a.htmlDiff),c=AJS.format("Unpublished Changes for \'\'{0}\'\'",AJS.escapeHtml(a.title)),b.addHeader(c),b.popup.element.find(".dialog-title").prepend(Confluence.Templates.DraftChanges.helpLink()),
c=Confluence.getContextPath(),e(".resume-diff-link").attr("data-href",c+"/pages/resumedraft.action?draftId="+h),e(".discard-diff-link").data("draftid",h),AJS.setVisible("#merge-warning",a.isMergeRequired)},error:function(a){a=a.errors||"An unknown error has occurred. Please check your logs";e("#diff-view").html(a)}});b.show();AJS.trigger("analytics",{name:"confluence.editor.view-diff-dialog.open",data:{elementTriggerId:g}});return AJS.stopEvent(j)});e("#draft-space-list").on("click",".discard-draft-link",
function(b){b.preventDefault();AJS.Confluence.Analytics.publish("confluence.draft-list.discard");b=e(this).data("draftid");i(b)}).on("click",".resume-draft-link",function(){AJS.Confluence.Analytics.publish("confluence.draft-list.resume")})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:draft-changes-js', location = '/includes/soy/draft-changes-dialog.soy' */
// This file was automatically generated from draft-changes-dialog.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.DraftChanges == 'undefined') { Confluence.Templates.DraftChanges = {}; }


Confluence.Templates.DraftChanges.dialogContent = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="draft-changes-dialog" class="hidden"><div id="diff-view" class="wiki-content"></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.DraftChanges.helpLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  Confluence.Templates.Dialog.helpLink({href: "https://docs.atlassian.com/confluence/docs-58/Working+with+Drafts#viewchange"}, output);
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/tinymce.js' */
(function(g){var k=/^\s*|\s*$/g,l="$1"==="B".replace(/A(.)|B/,"$1"),h={majorVersion:"3",minorVersion:"4.9-atlassian-11",releaseDate:"2012-03-06",_init:function(){function a(a){var c=/editor/.test(a);if(a&&/tiny_mce(|_gzip|_jquery|_prototype|_full)(_dev|_src)?.js/.test(a)||c){/_(src|dev)\.js/g.test(a)&&(b.suffix="_src");if(-1!=(j=a.indexOf("?")))b.query=a.substring(j+1);b.baseURL=c?a.substring(0,a.indexOf("/download/")):a.substring(0,a.lastIndexOf("/"));f&&(-1==b.baseURL.indexOf("://")&&0!==b.baseURL.indexOf("/"))&&
(b.baseURL=f+b.baseURL);c&&(b.baseURL+="/download/resources/com.atlassian.plugins.editor/tinymcesource");return b.baseURL}return null}var b=this,d=document,c=navigator,e=c.userAgent,f,j,i;b.isOpera=g.opera&&opera.buildNumber;b.isWebKit=/WebKit/.test(e);b.isChrome=b.isWebKit&&/Chrome/.test(e);b.isIE11=!!(-1!=e.indexOf("Trident/")&&(-1!=e.indexOf("rv:")||-1!=c.appName.indexOf("Netscape")));b.isIE=!b.isWebKit&&!b.isOpera&&/MSIE/gi.test(e)&&/Explorer/gi.test(c.appName);b.isIE=b.isIE&&/MSIE (\w+)\./.exec(e)[1];
b.isIE=b.isIE||b.isIE11;b.isIE6=b.isIE&&/MSIE [56]/.test(e);b.isIE7=b.isIE&&/MSIE [7]/.test(e);b.isIE8=b.isIE&&/MSIE [8]/.test(e);b.isIE9=b.isIE&&/MSIE [9]/.test(e);b.isIE10=b.isIE&&/MSIE \d\d/.test(e);b.isIE10up=b.isIE&&/MSIE \d\d/.test(e)||b.isIE11;b.isGecko=!b.isWebKit&&!b.isIE11&&/Gecko/.test(e);b.isMac=-1!=e.indexOf("Mac");b.isAir=/adobeair/i.test(e);b.isIDevice=/(iPad|iPhone)/.test(e);b.isIOS5=b.isIDevice&&534<=e.match(/AppleWebKit\/(\d*)/)[1];if(g.tinyMCEPreInit)b.suffix=tinyMCEPreInit.suffix,
b.baseURL=tinyMCEPreInit.base,b.query=tinyMCEPreInit.query;else{b.suffix="";e=d.getElementsByTagName("base");for(c=0;c<e.length;c++)if(i=e[c].href)/^https?:\/\/[^\/]+$/.test(i)&&(i+="/"),f=i?i.match(/.*\//)[0]:"";f||(c=document.location,f=c.protocol+"//"+c.hostname+(c.port?":"+c.port:""));if(c=AJS.Meta.get("rte.src.url"))a(c);else{e=d.getElementsByTagName("script");for(c=0;c<e.length;c++)if(a(e[c].src))return;if(d=d.getElementsByTagName("head")[0]){e=d.getElementsByTagName("script");for(c=0;c<e.length&&
!a(e[c].src);c++);}}}},is:function(a,b){return!b?void 0!==a:"array"==b&&a.hasOwnProperty&&a instanceof Array?!0:typeof a==b},makeMap:function(a,b,d){a=a||[];"string"==typeof a&&(a=a.split(b||","));d=d||{};for(b=a.length;b--;)d[a[b]]={};return d},each:function(a,b,d){var c,e;if(!a)return 0;d=d||a;if(void 0!==a.length){c=0;for(e=a.length;c<e;c++)if(!1===b.call(d,a[c],c,a))return 0}else for(c in a)if(a.hasOwnProperty(c)&&!1===b.call(d,a[c],c,a))return 0;return 1},map:function(a,b){var d=[];h.each(a,
function(a){d.push(b(a))});return d},grep:function(a,b){var d=[];h.each(a,function(a){(!b||b(a))&&d.push(a)});return d},inArray:function(a,b){var d,c;if(a){d=0;for(c=a.length;d<c;d++)if(a[d]===b)return d}return-1},extend:function(a,b){var d,c,e=arguments;d=1;for(c=e.length;d<c;d++)b=e[d],h.each(b,function(b,c){void 0!==b&&(a[c]=b)});return a},trim:function(a){return(a?""+a:"").replace(k,"")},create:function(a,b,d){var c,e,f,g,i,h=0,a=/^((static) )?([\w.]+)(:([\w.]+))?/.exec(a);f=a[3].match(/(^|\.)(\w+)$/i)[2];
e=this.createNS(a[3].replace(/\.\w+$/,""),d);if(!e[f])if("static"==a[2]){if(e[f]=b,this.onCreate)this.onCreate(a[2],a[3],e[f])}else if(b[f]||(b[f]=function(){},h=1),e[f]=b[f],this.extend(e[f].prototype,b),a[5]&&(c=this.resolve(a[5]).prototype,g=a[5].match(/\.(\w+)$/i)[1],i=e[f],e[f]=h?function(){return c[g].apply(this,arguments)}:function(){this.parent=c[g];return i.apply(this,arguments)},e[f].prototype[f]=e[f],this.each(c,function(b,a){e[f].prototype[a]=c[a]}),this.each(b,function(b,a){c[a]?e[f].prototype[a]=
function(){this.parent=c[a];return b.apply(this,arguments)}:a!=f&&(e[f].prototype[a]=b)})),this.each(b["static"],function(b,a){e[f][a]=b}),this.onCreate)this.onCreate(a[2],a[3],e[f].prototype)},walk:function(a,b,d,c){c=c||this;a&&(d&&(a=a[d]),h.each(a,function(a,f){if(!1===b.call(c,a,f,d))return!1;h.walk(a,b,d,c)}))},createNS:function(a,b){var d,c,b=b||g,a=a.split(".");for(d=0;d<a.length;d++)c=a[d],b[c]||(b[c]={}),b=b[c];return b},resolve:function(a,b){var d,c,b=b||g,a=a.split(".");d=0;for(c=a.length;d<
c&&!(b=b[a[d]],!b);d++);return b},addUnload:function(a,b){var d=this,a={func:a,scope:b||this};if(d.unloads)d.unloads.push(a);else{var c=function(){var a=d.unloads,b,h;if(a){for(h in a)(b=a[h])&&b.func&&b.func.call(b.scope,1);g.detachEvent?(g.detachEvent("onbeforeunload",e),g.detachEvent("onunload",c)):g.removeEventListener&&g.removeEventListener("unload",c,!1);d.unloads=w=c=0;g.CollectGarbage&&CollectGarbage()}},e=function(){var a=document;if("interactive"==a.readyState){var b=function(){a.detachEvent("onstop",
b);c&&c();a=0};a&&a.attachEvent("onstop",b);g.setTimeout(function(){a&&a.detachEvent("onstop",b)},0)}};g.attachEvent?(g.attachEvent("onunload",c),g.attachEvent("onbeforeunload",e)):g.addEventListener&&g.addEventListener("unload",c,!1);d.unloads=[a]}return a},removeUnload:function(a){var b=this.unloads,d=null;h.each(b,function(c,e){if(c&&c.func==a)return b.splice(e,1),d=a,!1});return d},explode:function(a,b){return a?h.map(a.split(b||","),h.trim):a},_addVer:function(a){var b;if(!this.query)return a;
b=(-1==a.indexOf("?")?"?":"&")+this.query;return-1==a.indexOf("#")?a+b:a.replace("#",b+"#")},_replace:function(a,b,d){return l?d.replace(a,function(){var a=b,d=arguments,f;for(f=0;f<d.length-2;f++)a=void 0===d[f]?a.replace(RegExp("\\$"+f,"g"),""):a.replace(RegExp("\\$"+f,"g"),d[f]);return a}):d.replace(a,b)}};h._init();g.tinymce=g.tinyMCE=h})(window);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/util/Dispatcher.js' */
tinymce.create("tinymce.util.Dispatcher",{scope:null,listeners:null,Dispatcher:function(a){this.scope=a||this;this.listeners=[]},add:function(a,b){this.listeners.push({cb:a,scope:b||this.scope});return a},addToTop:function(a,b){this.listeners.unshift({cb:a,scope:b||this.scope});return a},remove:function(a){var b=this.listeners,c=null;tinymce.each(b,function(d,e){if(a==d.cb)return c=a,b.splice(e,1),!1});return c},dispatch:function(){var a,b=arguments,c,d=this.listeners;for(c=0;c<d.length&&!(a=d[c],
a=a.cb.apply(a.scope,0<b.length?b:[a.scope]),!1===a);c++);return a}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/util/URI.js' */
(function(){var h=tinymce.each;tinymce.create("tinymce.util.URI",{URI:function(a,b){var c=this,e,a=tinymce.trim(a),b=c.settings=b||{};if(/^([\w\-]+):([^\/]{2})/i.test(a)||/^\s*#/.test(a))c.source=a;else if(0===a.indexOf("/")&&0!==a.indexOf("//")&&(a=(b.base_uri?b.base_uri.protocol||"http":"http")+"://mce_host"+a),/^[\w-]*:?\/\//.test(a)||(e=b.base_uri?b.base_uri.path:(new tinymce.util.URI(location.href)).directory,a=(b.base_uri&&b.base_uri.protocol||"http")+"://mce_host"+c.toAbsPath(e,a)),a=a.replace(/@@/g,
"(mce_at)"),a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(a),h("source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),function(b,d){var e=a[d];e&&(e=e.replace(/\(mce_at\)/g,"@@"));c[b]=e}),e=b.base_uri){c.protocol||(c.protocol=e.protocol);c.userInfo||(c.userInfo=e.userInfo);!c.port&&"mce_host"==
c.host&&(c.port=e.port);if(!c.host||"mce_host"==c.host)c.host=e.host;c.source=""}},setPath:function(a){a=/^(.*?)\/?(\w+)?$/.exec(a);this.path=a[0];this.directory=a[1];this.file=a[2];this.source="";this.getURI()},toRelative:function(a){var b;if("./"===a)return a;a=new tinymce.util.URI(a,{base_uri:this});if("mce_host"!=a.host&&this.host!=a.host&&a.host||this.port!=a.port||this.protocol!=a.protocol)return a.getURI();b=this.toRelPath(this.path,a.path);a.query&&(b+="?"+a.query);a.anchor&&(b+="#"+a.anchor);
return b},toAbsolute:function(a,b){a=new tinymce.util.URI(a,{base_uri:this});return a.getURI(this.host==a.host&&this.protocol==a.protocol?b:0)},toRelPath:function(a,b){var c,e=0,f="",d,g,a=a.substring(0,a.lastIndexOf("/")),a=a.split("/");c=b.split("/");if(a.length>=c.length){d=0;for(g=a.length;d<g;d++)if(d>=c.length||a[d]!=c[d]){e=d+1;break}}if(a.length<c.length){d=0;for(g=c.length;d<g;d++)if(d>=a.length||a[d]!=c[d]){e=d+1;break}}if(1==e)return b;d=0;for(g=a.length-(e-1);d<g;d++)f+="../";d=e-1;for(g=
c.length;d<g;d++)f=d!=e-1?f+("/"+c[d]):f+c[d];return f},toAbsPath:function(a,b){var c,e=0,f=[],d;d=/\/$/.test(b)?"/":"";a=a.split("/");b=b.split("/");h(a,function(a){a&&f.push(a)});a=f;c=b.length-1;for(f=[];0<=c;c--)0==b[c].length||"."==b[c]||(".."==b[c]?e++:0<e?e--:f.push(b[c]));c=a.length-e;c=0>=c?f.reverse().join("/"):a.slice(0,c).join("/")+"/"+f.reverse().join("/");0!==c.indexOf("/")&&(c="/"+c);d&&c.lastIndexOf("/")!==c.length-1&&(c+=d);return c},getURI:function(a){var b;if(!this.source||a)b=
"",a||(this.protocol&&(b+=this.protocol+"://"),this.userInfo&&(b+=this.userInfo+"@"),this.host&&(b+=this.host),this.port&&(b+=":"+this.port)),this.path&&(b+=this.path),this.query&&(b+="?"+this.query),this.anchor&&(b+="#"+this.anchor),this.source=b;return this.source}})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/util/Cookie.js' */
(function(){var h=tinymce.each;tinymce.create("static tinymce.util.Cookie",{getHash:function(c){var c=this.get(c),b;c&&h(c.split("&"),function(a){a=a.split("=");b=b||{};b[unescape(a[0])]=unescape(a[1])});return b},setHash:function(c,b,a,d,e,g){var f="";h(b,function(a,b){f+=(!f?"":"&")+escape(b)+"="+escape(a)});this.set(c,f,a,d,e,g)},get:function(c){var b=document.cookie,a=c+"=",d;if(b){d=b.indexOf("; "+a);if(-1==d){if(d=b.indexOf(a),0!=d)return null}else d+=2;c=b.indexOf(";",d);-1==c&&(c=b.length);
return unescape(b.substring(d+a.length,c))}},set:function(c,b,a,d,e,g){document.cookie=c+"="+escape(b)+(a?"; expires="+a.toGMTString():"")+(d?"; path="+escape(d):"")+(e?"; domain="+e:"")+(g?"; secure":"")},remove:function(c,b){var a=new Date;a.setTime(a.getTime()-1E3);this.set(c,"",a,b,a)}})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/util/JSON.js' */
(function(){function e(a,d){var b,c,f,d=d||'"';if(null==a)return"null";f=typeof a;if("string"==f)return c="\bb\tt\nn\ff\rr\"\"''\\\\",d+a.replace(/([\u0080-\uFFFF\x00-\x1f\"\'\\])/g,function(a,e){if('"'===d&&"'"===a)return a;b=c.indexOf(e);if(b+1)return"\\"+c.charAt(b+1);a=e.charCodeAt().toString(16);return"\\u"+"0000".substring(a.length)+a})+d;if("object"==f){if(a.hasOwnProperty&&a instanceof Array){b=0;for(c="[";b<a.length;b++)c+=(0<b?",":"")+e(a[b],d);return c+"]"}c="{";for(b in a)a.hasOwnProperty(b)&&
(c+="function"!=typeof a[b]?(1<c.length?","+d:d)+b+d+":"+e(a[b],d):"");return c+"}"}return""+a}tinymce.util.JSON={serialize:e,parse:function(a){try{return eval("("+a+")")}catch(d){}}}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/util/XHR.js' */
tinymce.create("static tinymce.util.XHR",{send:function(a){function f(a){b=0;try{b=new ActiveXObject(a)}catch(c){}return b}var b,c=window,d=0;a.scope=a.scope||this;a.success_scope=a.success_scope||a.scope;a.error_scope=a.error_scope||a.scope;a.async=!1===a.async?!1:!0;a.data=a.data||"";if(b=c.XMLHttpRequest?new XMLHttpRequest:f("Microsoft.XMLHTTP")||f("Msxml2.XMLHTTP")){b.overrideMimeType&&b.overrideMimeType(a.content_type);b.open(a.type||(a.data?"POST":"GET"),a.url,a.async);a.content_type&&b.setRequestHeader("Content-Type",
a.content_type);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.send(a.data);var e=function(){!a.async||4==b.readyState||1E4<d++?(a.success&&1E4>d&&200==b.status?a.success.call(a.success_scope,""+b.responseText,b,a):a.error&&a.error.call(a.error_scope,1E4<d?"TIMED_OUT":"GENERAL",b,a),b=null):c.setTimeout(e,10)};if(!a.async)return e();c.setTimeout(e,10)}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/util/JSONRequest.js' */
(function(){var e=tinymce.extend,f=tinymce.util.JSON,g=tinymce.util.XHR;tinymce.create("tinymce.util.JSONRequest",{JSONRequest:function(a){this.settings=e({},a);this.count=0},send:function(a){var c=a.error,h=a.success,a=e(this.settings,a);a.success=function(b,d){b=f.parse(b);"undefined"==typeof b&&(b={error:"JSON Parse error."});b.error?c.call(a.error_scope||a.scope,b.error,d):h.call(a.success_scope||a.scope,b.result)};a.error=function(b,d){c&&c.call(a.error_scope||a.scope,b,d)};a.data=f.serialize({id:a.id||
"c"+this.count++,method:a.method,params:a.params});a.content_type="application/json";g.send(a)},"static":{sendRPC:function(a){return(new tinymce.util.JSONRequest).send(a)}}})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/util/VK.js' */
(function(b){b.VK={DELETE:46,BACKSPACE:8,ENTER:13,TAB:9,SPACEBAR:32,UP:38,DOWN:40,modifierPressed:function(a){return a.shiftKey||a.ctrlKey||a.altKey}}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/util/Quirks.js' */
(function(g){function p(a){function k(b){var h=a.dom.create("body"),b=b.cloneContents();h.appendChild(b);return a.selection.serializer.serialize(h,{format:"html"})}a.onKeyDown.addToTop(function(b,h){var d=h.keyCode;if(d==n||d==m){var d=b.selection.getRng(!0),c;if(c=!d.collapsed)d=k(d),c=a.dom.createRng(),c.selectNode(a.getBody()),c=k(c),c=d===c;c&&(b.setContent("",{format:"raw"}),b.nodeChanged(),h.preventDefault())}})}function q(a){a.onKeyDown.add(function(a,b){if(b.keyCode===m&&a.selection.isCollapsed()&&
0===a.selection.getRng(!0).startOffset){var h=a.selection.getNode().previousSibling;h&&(h.nodeName&&"hr"===h.nodeName.toLowerCase())&&(a.dom.remove(h),g.dom.Event.cancel(b))}})}function o(a){function k(a,b,c){var i=/^&nbsp;$|^<br>$/,c=c||b,c=c.parentNode?c.parentNode.childNodes||[]:[],e=!0,j=/TABLE|TH|TD/;return(e=(e=(e=!j.test(b.nodeName))&&b.previousSibling?!j.test(b.previousSibling.nodeName):e)&&b.nextSibling?!j.test(b.nextSibling.nodeName):e)&&(i.test(a)||1<c.length&&"BR"==c[0].nodeName)}function b(b){return b&&
b.innerHTML&&(b.innerHTML.replace(/\uFEFF|\u200B/g,"")||"&nbsp;")}a.onKeyDown.add(function(a,d){var c=a.selection.getNode(),i=c.nextSibling,e;if(a.selection.isCollapsed()&&c!=a.dom.getRoot())if(d.keyCode===m)0===a.selection.getRng(!0).startOffset&&(i=c.previousSibling,e=b(i),i&&k(e,c,i)&&(a.dom.remove(i),g.dom.Event.cancel(d)));else if(d.keyCode==n&&(e=b(c),!(1>=(c.parentNode?c.parentNode.childNodes||[]:[]).length||1<c.childNodes.length)&&i&&k(e,c,i)))a.dom.remove(c),g.dom.Event.cancel(d),c=a.selection,
e=c.getRng(!0),a.focus(),i.focus(),e.setStart(i,0),e.setEnd(i,0),c.setRng(e)})}function r(a){a.onClick.add(function(a,b){b=b.target;/^(IMG|HR)$/.test(b.nodeName)&&a.selection.getSel().setBaseAndExtent(b,0,b,1);"A"==b.nodeName&&a.dom.hasClass(b,"mceItemAnchor")&&a.selection.select(b);a.nodeChanged()})}function r(a){a.onClick.add(function(a,b){b=b.target;/^(IMG|HR)$/.test(b.nodeName)&&a.selection.getSel().setBaseAndExtent(b,0,b,1);"A"==b.nodeName&&a.dom.hasClass(b,"mceItemAnchor")&&a.selection.select(b);
a.nodeChanged()})}function s(){document.body.setAttribute("role","application")}function s(){document.body.setAttribute("role","application")}var l=g.VK,m=l.BACKSPACE,n=l.DELETE;g.create("tinymce.util.Quirks",{Quirks:function(a){if(g.isWebKit){if(g.isChrome){var k=function(a,b){AJS.$(a).find(".non-editable").attr("contenteditable",b)},b=a.dom,h=a.selection;a.onKeyDown.add(function(a,c){var j,f,d;if(((d=c.keyCode==n)||c.keyCode==m)&&!l.modifierPressed(c))c.preventDefault(),j=h.getRng(),f=b.getParent(j.startContainer,
b.isBlock),f=d?[f,b.getNext(f,b.isBlock)]:[b.getPrev(f,b.isBlock),f],g.each(AJS.$(f).find("span"),function(a){a.setAttribute("data-mce-mark","1")}),(j=!d&&f[1]&&AJS.EditorUtils.isCursorAtStartOf(f[1],j)||d&&f[0]&&AJS.EditorUtils.isCursorAtEndOf(f[0],j))&&k(f[1],!0),a.getDoc().execCommand(d?"ForwardDelete":"Delete",!1,null),j&&k(f,!1),g.each(AJS.$(f).find("span"),function(a){a.getAttribute("data-mce-mark")?a.removeAttribute("data-mce-mark"):a.style.color?AJS.$(a).attr("style","color: "+a.style.color):
b.remove(a,!0)})})}p(a);a.dom.bind(a.getDoc(),"focusin",function(){setTimeout(function(){a&&!a.destroyed&&a.selection.setRng(a.selection.getRng())},0)});r(a);if(g.isIDevice){var d,c;a.dom.bind(a.getDoc(),"selectionchange",function(){c&&(clearTimeout(c),c=0);c=window.setTimeout(function(){var b=a.selection.getRng();if(!d||!g.dom.RangeUtils.compareRanges(b,d)){a.nodeChanged();d=b}},50)})}o(a)}g.isIE&&(q(a),p(a),s(a),a.onKeyDown.add(function(a,b){var c;if(c=b.keyCode===l.ENTER)if(c=!l.modifierPressed(b))c=
a.selection.getNode(),c=a.dom.is(c,"h1,h2,h3,h4,h5,h6")||null!==a.dom.getParent(c,"h1,h2,h3,h4,h5,h6");c&&setTimeout(function(){var b=a.selection.getNode();a.dom.is(b,"p")&&(a.dom.setAttrib(b,"style",null),a.execCommand("mceCleanup"))},0)}),o(a));g.isGecko&&(q(a),o(a),Range.prototype.getClientRects||a.onMouseDown.add(function(a,b){if(b.target.nodeName==="HTML"){var c=a.getBody();c.blur();setTimeout(function(){c.focus()},0)}}))}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/html/Entities.js' */
(function(g){function l(b,d){var a,c,e,k={};if(b){b=b.split(",");d=d||10;for(a=0;a<b.length;a+=2)c=String.fromCharCode(parseInt(b[a],d)),f[c]||(e="&"+b[a+1]+";",k[c]=e,k[e]=c);return k}}var h,f,m,i=/[&<>\"\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,j=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,n=/[<>&\"\']/g,o=/&(#x|#)?([\w]+);/g,p={128:"",130:"",131:"",132:"",133:"",134:"",135:"",136:"",137:"",138:"",139:"",140:"",142:"",145:"",146:"",147:"",
148:"",149:"",150:"",151:"",152:"",153:"",154:"",155:"",156:"",158:"",159:""};f={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;"};m={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"};h=l("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",
32);g.html=g.html||{};g.html.Entities={encodeRaw:function(b,d){return b.replace(d?i:j,function(a){return f[a]||a})},encodeAllRaw:function(b){return(""+b).replace(n,function(b){return f[b]||b})},encodeNumeric:function(b,d){return b.replace(d?i:j,function(a){return 1<a.length?"&#"+(1024*(a.charCodeAt(0)-55296)+(a.charCodeAt(1)-56320)+65536)+";":f[a]||"&#"+a.charCodeAt(0)+";"})},encodeNamed:function(b,d,a){a=a||h;return b.replace(d?i:j,function(b){return f[b]||a[b]||b})},getEncodeFunc:function(b,d){function a(a,
b){return a.replace(b?i:j,function(a){return f[a]||d[a]||"&#"+a.charCodeAt(0)+";"||a})}function c(a,b){return e.encodeNamed(a,b,d)}var e=g.html.Entities,d=l(d)||h,b=g.makeMap(b.replace(/\+/g,","));return b.named&&b.numeric?a:b.named?d?c:e.encodeNamed:b.numeric?e.encodeNumeric:e.encodeRaw},decode:function(b){return b.replace(o,function(b,a,c){if(a)return c=parseInt(c,2===a.length?16:10),65535<c?(c-=65536,String.fromCharCode(55296+(c>>10),56320+(c&1023))):p[c]||String.fromCharCode(c);if(!(a=m[b]))if(!(a=
h[b]))a=document.createElement("div"),a.innerHTML=b,a=a.textContent||a.innerText||b;return a})}}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/html/Styles.js' */
tinymce.html.Styles=function(n,p){function q(i,d,h,c){function g(a){a=parseInt(a).toString(16);return 1<a.length?a:"0"+a}return"#"+g(d)+g(h)+g(c)}var r=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,v=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,t=/\s+$/,f,o={},k,n=n||{};k="\\\" \\' \\; \\: ; : ".split(" ");for(f=0;f<k.length;f++)o[k[f]]=""+f,o[""+f]=k[f];return{toHex:function(i){return i.replace(r,
q)},parse:function(i){function d(j,e){var b,c;if(b=a[j+"-top"+e])c=a[j+"-right"+e],b==c&&(b=a[j+"-bottom"+e],c==b&&(c=a[j+"-left"+e],b==c&&(a[j+e]=c,delete a[j+"-top"+e],delete a[j+"-right"+e],delete a[j+"-bottom"+e],delete a[j+"-left"+e])))}function h(b){var e=a[b],c;if(e&&!(0>e.indexOf(" "))){e=e.split(" ");for(c=e.length;c--;)if(e[c]!==e[0])return!1;a[b]=e[0];return!0}}function c(a){f=!0;return o[a]}function g(a,b){f&&(a=a.replace(/\uFEFF[0-9]/g,function(a){return o[a]}));b||(a=a.replace(/\\([\'\";:])/g,
"$1"));return a}var a={},m,l,b,f,u=n.url_converter,k=n.url_converter_scope||this;if(i){for(i=i.replace(/\\[\"\';:\uFEFF]/g,c).replace(/\"[^\"]+\"|\'[^\']+\'/g,function(a){return a.replace(/[;:]/g,c)});m=s.exec(i);){l=m[1].replace(t,"").toLowerCase();b=m[2].replace(t,"");if(l&&0<b.length){if("font-weight"===l&&"700"===b)b="bold";else if("color"===l||"background-color"===l)b=b.toLowerCase();b=b.replace(r,q);b=b.replace(v,function(a,b,c,i,d,f){if(d=d||f)return d=g(d),"'"+d.replace(/\'/g,"\\'")+"'";b=
g(b||c||i);u&&(b=u.call(k,b,"style"));return"url('"+b.replace(/\'/g,"\\'")+"')"});a[l]=f?g(b,!0):b}s.lastIndex=m.index+m[0].length}d("border","");d("border","-width");d("border","-color");d("border","-style");d("padding","");d("margin","");h("border-width")&&(h("border-style")&&h("border-color"))&&(a.border=a["border-width"]+" "+a["border-style"]+" "+a["border-color"],delete a["border-width"],delete a["border-style"],delete a["border-color"]);"medium none"===a.border&&delete a.border}return a},serialize:function(f,
d){function h(a){var d,b,g,h;if(d=p.styles[a]){b=0;for(g=d.length;b<g;b++)a=d[b],h=f[a],void 0!==h&&0<h.length&&(c+=(0<c.length?" ":"")+a+": "+h+";")}}var c="",g,a;if(d&&p&&p.styles)h("*"),h(d);else for(g in f)a=f[g],void 0!==a&&0<a.length&&(c+=(0<c.length?" ":"")+g+": "+a+";");return c}}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/html/Schema.js' */
(function(k){function m(b,j){return b.split(j||",")}var s={},t,i,x,B,C={},D,E,j=k.makeMap,h=k.each;i="h1,h2,h3,h4,h5,h6,hr,p,div,address,pre,form,table,tbody,thead,tfoot,th,tr,td,li,ol,ul,caption,blockquote,center,dl,dt,dd,dir,fieldset,noscript,menu,isindex,samp,header,footer,article,section,hgroup";i=j(i,",",j(i.toUpperCase()));var n={Z:"H|K|N|O|P",Y:"X|form|R|Q",ZG:"E|span|width|align|char|charoff|valign",X:"p|T|div|U|W|isindex|fieldset|table",ZF:"E|align|char|charoff|valign",W:"pre|hr|blockquote|address|center|noframes",
ZE:"abbr|axis|headers|scope|rowspan|colspan|align|char|charoff|valign|nowrap|bgcolor|width|height",ZD:"[E][S]",U:"ul|ol|dl|menu|dir",ZC:"p|Y|div|U|W|table|br|span|bdo|object|applet|img|map|K|N|Q",T:"h1|h2|h3|h4|h5|h6",ZB:"X|S|Q",S:"R|P",ZA:"a|G|J|M|O|P",R:"a|H|K|N|O",Q:"noscript|P",P:"ins|del|script",O:"input|select|textarea|label|button",N:"M|L",M:"em|strong|dfn|code|q|samp|kbd|var|cite|abbr|acronym",L:"sub|sup",K:"J|I",J:"tt|i|b|u|s|strike",I:"big|small|font|basefont",H:"G|F",G:"br|span|bdo",F:"object|applet|img|map|iframe",
E:"A|B|C",D:"accesskey|tabindex|onfocus|onblur",C:"onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup",B:"lang|xml:lang|dir",A:"id|class|style|title"},o=function(b){return b.replace(/[A-Z]+/g,function(b){return o(n[b])})},c,p={};for(c in n)n.hasOwnProperty(c)&&(n[c]=o(n[c]));o("script[id|charset|type|language|src|defer|xml:space][]style[B|id|type|media|title|xml:space][]object[E|declare|classid|codebase|data|type|codetype|archive|standby|width|height|usemap|name|tabindex|align|border|hspace|vspace][#|param|Y]param[id|name|value|valuetype|type][]p[E|align][#|S]a[E|D|charset|type|name|href|hreflang|rel|rev|shape|coords|target][#|Z]br[A|clear][]span[E][#|S]bdo[A|C|B][#|S]applet[A|codebase|archive|code|object|alt|name|width|height|align|hspace|vspace][#|param|Y]h1[E|align][#|S]img[E|src|alt|name|longdesc|width|height|usemap|ismap|align|border|hspace|vspace][]map[B|C|A|name][X|form|Q|area]h2[E|align][#|S]iframe[A|longdesc|name|src|frameborder|marginwidth|marginheight|scrolling|align|width|height][#|Y]h3[E|align][#|S]tt[E][#|S]i[E][#|S]b[E][#|S]u[E][#|S]s[E][#|S]strike[E][#|S]big[E][#|S]small[E][#|S]font[A|B|size|color|face][#|S]basefont[id|size|color|face][]em[E][#|S]strong[E][#|S]dfn[E][#|S]code[E][#|S]q[E|cite][#|S]samp[E][#|S]kbd[E][#|S]var[E][#|S]cite[E][#|S]abbr[E][#|S]acronym[E][#|S]sub[E][#|S]sup[E][#|S]input[E|D|type|name|value|checked|disabled|readonly|size|maxlength|src|alt|usemap|onselect|onchange|accept|align][]select[E|name|size|multiple|disabled|tabindex|onfocus|onblur|onchange][optgroup|option]optgroup[E|disabled|label][option]option[E|selected|disabled|label|value][]textarea[E|D|name|rows|cols|disabled|readonly|onselect|onchange][]label[E|for|accesskey|onfocus|onblur][#|S]button[E|D|name|value|type|disabled][#|p|T|div|U|W|table|G|object|applet|img|map|K|N|Q]h4[E|align][#|S]ins[E|cite|datetime][#|Y]h5[E|align][#|S]del[E|cite|datetime][#|Y]h6[E|align][#|S]div[E|align][#|Y]ul[E|type|compact][li]li[E|type|value][#|Y]ol[E|type|compact|start][li]dl[E|compact][dt|dd]dt[E][#|S]dd[E][#|Y]menu[E|compact][li]dir[E|compact][li]pre[E|width|xml:space][#|ZA]hr[E|align|noshade|size|width][]blockquote[E|cite][#|Y]address[E][#|S|p]center[E][#|Y]noframes[E][#|Y]isindex[A|B|prompt][]fieldset[E][#|legend|Y]legend[E|accesskey|align][#|S]table[E|summary|width|border|frame|rules|cellspacing|cellpadding|align|bgcolor][caption|col|colgroup|thead|tfoot|tbody|tr]caption[E|align][#|S]col[ZG][]colgroup[ZG][col]thead[ZF][tr]tr[ZF|bgcolor][th|td]th[E|ZE][#|Y]form[E|action|method|name|enctype|onsubmit|onreset|accept|accept-charset|target][#|X|R|Q]noscript[E][#|Y]td[E|ZE][#|Y]tfoot[ZF][tr]tbody[ZF][tr]area[E|D|shape|coords|href|nohref|alt|target][]base[id|href|target][]body[E|onload|onunload|background|bgcolor|text|link|vlink|alink][#|Y]").replace(/#/g,
"#text").replace(/(\w+)\[([^\]]+)\]\[([^\]]*)\]/g,function(b,k,h,i){h=m(h,"|");p[k]={attributes:j(h),attributesOrder:h,children:j(i,"|",{"#comment":{}})}});s=p;t=j("checked,compact,declare,defer,disabled,ismap,multiple,nohref,noresize,noshade,nowrap,readonly,selected,autoplay,loop,controls");x=j("area,base,basefont,br,col,frame,hr,img,input,isindex,link,meta,param,embed,source");B=k.extend(j("td,th,iframe,video,audio,object"),x);D=j("pre,script,style,textarea,code");E=j("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr");
k.html.Schema=function(b){function n(a){var z,F,b,h,e,f,g,i,c,l,o,u,q,r,p,v,s,t,x=/^([#+-])?([^\[\/]+)(?:\/([^\[]+))?(?:\[([^\]]+)\])?$/,y=/^([!\-])?(\w+::\w+|[^=:<]+)?(?:([=:<])(.*))?$/,w=/[*?+]/;if(a){a=m(a);d["@"]&&(v=d["@"].attributes,s=d["@"].attributesOrder);z=0;for(F=a.length;z<F;z++)if(e=x.exec(a[z])){r=e[1];c=e[2];p=e[3];i=e[4];u={};q=[];f={attributes:u,attributesOrder:q};"#"===r&&(f.paddEmpty=!0);"-"===r&&(f.removeEmpty=!0);if(v){for(t in v)u[t]=v[t];q.push.apply(q,s)}if(i){i=m(i,"|");b=
0;for(h=i.length;b<h;b++)if(e=y.exec(i[b]))if(g={},o=e[1],l=e[2].replace(/::/g,":"),r=e[3],e=e[4],"!"===o&&(f.attributesRequired=f.attributesRequired||[],f.attributesRequired.push(l),g.required=!0),"-"===o)delete u[l],q.splice(k.inArray(q,l),1);else{if(r&&("="===r&&(f.attributesDefault=f.attributesDefault||[],f.attributesDefault.push({name:l,value:e}),g.defaultValue=e),":"===r&&(f.attributesForced=f.attributesForced||[],f.attributesForced.push({name:l,value:e}),g.forcedValue=e),"<"===r))g.validValues=
j(e,"?");w.test(l)?(f.attributePatterns=f.attributePatterns||[],g.pattern=RegExp("^"+l.replace(/([?+*])/g,".$1")+"$"),f.attributePatterns.push(g)):(u[l]||q.push(l),u[l]=g)}}!v&&"@"==c&&(v=u,s=q);p&&(f.outputName=c,d[p]=f);w.test(c)?(f.pattern=RegExp("^"+c.replace(/([?+*])/g,".$1")+"$"),A.push(f)):d[c]=f}}}function c(a){d={};A=[];n(a);h(s,function(a,b){g[b]=a.children})}function o(a){var b=/^(~)?(.+)$/;a&&h(m(a),function(a){var a=b.exec(a),c="~"===a[1],d=c?"span":"div",e=a[2];g[e]=g[d];C[e]=d;c||(i[e]=
{});h(g,function(a){a[d]&&(a[e]=a[d])})})}function y(a){var b=/^([+\-]?)(\w+)\[([^\]]+)\]$/;a&&h(m(a),function(a){var a=b.exec(a),d,c;a&&(d=(c=a[1])?g[a[2]]:g[a[2]]={"#comment":{}},d=g[a[2]],h(m(a[3],"|"),function(a){"-"===c?delete d[a]:d[a]={}}))})}function p(a){var b=d[a],c;if(b)return b;for(c=A.length;c--;)if(b=A[c],b.pattern.test(a))return b}var d={},g={},A=[],w,G,b=b||{};!1===b.verify_html&&(b.valid_elements="*[*]");b.valid_styles&&(w={},h(b.valid_styles,function(a,b){w[b]=k.explode(a)}));G=
b.whitespace_elements?j(b.whitespace_elements):D;b.valid_elements?c(b.valid_elements):(h(s,function(a,b){d[b]={attributes:a.attributes,attributesOrder:a.attributesOrder};g[b]=a.children}),h(m("strong/b,em/i"),function(a){a=m(a,"/");d[a[1]].outputName=a[0]}),d.img.attributesDefault=[{name:"alt",value:""}],h(m("ol,ul,sub,sup,blockquote,span,font,a,table,tbody,tr"),function(a){d[a].removeEmpty=true}),h(m("p,h1,h2,h3,h4,h5,h6,th,td,pre,div,address,caption"),function(a){d[a].paddEmpty=true}));o(b.custom_elements);
y(b.valid_children);n(b.extended_valid_elements);y("+ol[ul|ol],+ul[ul|ol]");p("span")||n("span[!data-mce-type|*]");b.invalid_elements&&k.each(k.explode(b.invalid_elements),function(a){d[a]&&delete d[a]});this.children=g;this.styles=w;this.getBoolAttrs=function(){return t};this.getBlockElements=function(){return i};this.getShortEndedElements=function(){return x};this.getSelfClosingElements=function(){return E};this.getNonEmptyElements=function(){return B};this.getWhiteSpaceElements=function(){return G};
this.isValidChild=function(a,b){var c=g[a];return!(!c||!c[b])};this.getElementRule=p;this.getCustomElements=function(){return C};this.addValidElements=n;this.setValidElements=c;this.addCustomElements=o;this.addValidChildren=y};k.html.Schema.boolAttrMap=t;k.html.Schema.blockElementsMap=i})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/html/SaxParser.js' */
(function(q){q.html.SaxParser=function(k,m){var n=this,L=function(){},k=k||{};n.schema=m=m||new q.html.Schema;!1!==k.fix_self_closing&&(k.fix_self_closing=!0);q.each("comment cdata text start end pi doctype".split(" "),function(g){g&&(n[g]=k[g]||L)});n.parse=function(g){function n(a){var b,c;for(b=i.length;b--;)if(i[b].name===a)break;if(b>=0){for(c=i.length-1;c>=b;c--){a=i[c];a.valid&&h.end(a.name)}i.length=b}}var h=this,b,d=0,a,c,i=[],f,s,l,w,C,D,E,r,o,j,e,p,x,F,t,u,v,y,G,z,H,I,J=0,A=q.html.Entities.decode,
K,B;z=RegExp("<(?:(?:!--([\\w\\W]*?)--\>)|(?:!\\[CDATA\\[([\\w\\W]*?)\\]\\]>)|(?:!DOCTYPE([\\w\\W]*?)>)|(?:\\?([^\\s\\/<>]+) ?([\\w\\W]*?)[?/]>)|(?:\\/([^>]+)>)|(?:([^\\s\\/<>]+)((?:\\s+[^\"'>]+(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>]*))*|\\/)>))","g");H=/([\w:\-]+)(?:\s*=\s*(?:(?:\"((?:\\.|[^\"])*)\")|(?:\'((?:\\.|[^\'])*)\')|([^>\s]+)))?/g;I={script:/<\/script[^>]*>/gi,style:/<\/style[^>]*>/gi,noscript:/<\/noscript[^>]*>/gi};D=m.getShortEndedElements();G=m.getSelfClosingElements();E=m.getBoolAttrs();
r=k.validate;C=k.remove_internals;K=k.fix_self_closing;B=q.isIE;for(x=/^:/;b=z.exec(g);){d<b.index&&h.text(A(g.substr(d,b.index-d)));if(a=b[6]){a=a.toLowerCase();B&&x.test(a)&&(a=a.substr(1));n(a)}else if(a=b[7]){a=a.toLowerCase();B&&x.test(a)&&(a=a.substr(1));d=a in D;K&&(G[a]&&i.length>0&&i[i.length-1].name===a)&&n(a);if(!r||(o=m.getElementRule(a))){j=true;if(r){F=o.attributes;t=o.attributePatterns}if(p=b[8]){(w=p.indexOf("data-mce-type")!==-1)&&C&&(j=false);f=[];f.map={};p.replace(H,function(a,
b,c,d,e){b=b.toLowerCase();c=b in E?b:A(c||d||e||"");if(r&&!w&&b.indexOf("data-")!==0){a=F[b];if(!a&&t){for(d=t.length;d--;){a=t[d];if(a.pattern.test(b))break}d===-1&&(a=null)}if(!a||a.validValues&&!(c in a.validValues))return}f.map[b]=c;f.push({name:b,value:c})})}else{f=[];f.map={}}if(r&&!w){u=o.attributesRequired;v=o.attributesDefault;if(y=o.attributesForced)for(c=y.length;c--;){e=y[c];l=e.name;e=e.value;e==="{$uid}"&&(e="mce_"+J++);f.map[l]=e;f.push({name:l,value:e})}if(v)for(c=v.length;c--;){e=
v[c];l=e.name;if(!(l in f.map)){e=e.value;e==="{$uid}"&&(e="mce_"+J++);f.map[l]=e;f.push({name:l,value:e})}}if(u){for(c=u.length;c--;)if(u[c]in f.map)break;c===-1&&(j=false)}f.map["data-mce-bogus"]&&(j=false)}j&&h.start(a,f,d)}else j=false;if(c=I[a]){c.lastIndex=d=b.index+b[0].length;if(b=c.exec(g)){j&&(s=g.substr(d,b.index-d));d=b.index+b[0].length}else{s=g.substr(d);d=g.length}j&&s.length>0&&h.text(s,true);j&&h.end(a);z.lastIndex=d;continue}d||(!p||p.indexOf("/")!=p.length-1?i.push({name:a,valid:j}):
j&&h.end(a))}else(a=b[1])?h.comment(a):(a=b[2])?h.cdata(a):(a=b[3])?h.doctype(a):(a=b[4])&&h.pi(a,b[5]);d=b.index+b[0].length}d<g.length&&h.text(A(g.substr(d)));for(c=i.length-1;c>=0;c--){a=i[c];a.valid&&h.end(a.name)}}}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/html/Node.js' */
(function(h){function i(a,b,c){var d;d=c?"lastChild":"firstChild";c=c?"prev":"next";if(a[d])return a[d];if(a!==b){if(d=a[c])return d;for(a=a.parent;a&&a!==b;a=a.parent)if(d=a[c])return d}}function g(a,b){this.name=a;this.type=b;1===b&&(this.attributes=[],this.attributes.map={})}var j=/^[ \t\r\n]*$/,k={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11};h.extend(g.prototype,{replace:function(a){a.parent&&a.remove();this.insert(a,this);this.remove();return this},attr:function(a,
b){var c,d;if("string"!==typeof a){for(d in a)this.attr(d,a[d]);return this}if(c=this.attributes){if(void 0!==b){if(null===b){if(a in c.map){delete c.map[a];for(d=c.length;d--;)if(c[d].name===a){c.splice(d,1);break}}return this}if(a in c.map)for(d=c.length;d--;){if(c[d].name===a){c[d].value=b;break}}else c.push({name:a,value:b});c.map[a]=b;return this}return c.map[a]}},clone:function(){var a=new g(this.name,this.type),b,c,d,e,f;if(d=this.attributes){f=[];f.map={};b=0;for(c=d.length;b<c;b++)e=d[b],
"id"!==e.name&&(f[f.length]={name:e.name,value:e.value},f.map[e.name]=e.value);a.attributes=f}a.value=this.value;a.shortEnded=this.shortEnded;return a},wrap:function(a){this.parent.insert(a,this);a.append(this);return this},unwrap:function(){var a,b;for(a=this.firstChild;a;)b=a.next,this.insert(a,this,!0),a=b;this.remove()},remove:function(){var a=this.parent,b=this.next,c=this.prev;if(a){if(a.firstChild===this){if(a.firstChild=b)b.prev=null}else c.next=b;if(a.lastChild===this){if(a.lastChild=c)c.next=
null}else b.prev=c;this.parent=this.next=this.prev=null}return this},append:function(a){var b;a.parent&&a.remove();(b=this.lastChild)?(b.next=a,a.prev=b,this.lastChild=a):this.lastChild=this.firstChild=a;a.parent=this;return a},insert:function(a,b,c){var d;a.parent&&a.remove();d=b.parent||this;c?(b===d.firstChild?d.firstChild=a:b.prev.next=a,a.prev=b.prev,a.next=b,b.prev=a):(b===d.lastChild?d.lastChild=a:b.next.prev=a,a.next=b.next,a.prev=b,b.next=a);a.parent=d;return a},getAll:function(a){var b,
c=[];for(b=this.firstChild;b;b=i(b,this))b.name===a&&c.push(b);return c},empty:function(){var a,b,c;if(this.firstChild){a=[];for(c=this.firstChild;c;c=i(c,this))a.push(c);for(b=a.length;b--;)c=a[b],c.parent=c.firstChild=c.lastChild=c.next=c.prev=null}this.firstChild=this.lastChild=null;return this},isEmpty:function(a){var a=a||new h.html.Schema,b=this.firstChild,c,d=a.getNonEmptyElements(),e=a.getWhiteSpaceElements();if(b){do{if(1===b.type){if(b.attributes.map["data-mce-bogus"])continue;if(d[b.name])return!1;
for(a=b.attributes.length;a--;)if(c=b.attributes[a].name,"name"===c||0===c.indexOf("data-"))return!1}if(8===b.type||3===b.type&&(!j.test(b.value)||e[this.name]&&b.value&&0<b.value.length&&j.test(b.value)))return!1}while(b=i(b,this))}return!0},walk:function(a){return i(this,null,a)}});h.extend(g,{create:function(a,b){var c,d;c=new g(a,k[a]||1);if(b)for(d in b)c.attr(d,b[d]);return c}});h.html.Node=g})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/html/DomParser.js' */
(function(n){var y=n.html.Node;n.html.DomParser=function(k,c){var r=this,z={},s=[],t={},u={},k=k||{};k.validate="validate"in k?k.validate:!0;k.root_name=k.root_name||"body";r.schema=c=c||new n.html.Schema;r.filterNode=function(c){var d,j,h;j in z&&((h=t[j])?h.push(c):t[j]=[c]);for(d=s.length;d--;)j=s[d].name,j in c.attributes.map&&((h=u[j])?h.push(c):u[j]=[c]);return c};r.addNodeFilter=function(c,d){n.each(n.explode(c),function(c){var h=z[c];h||(z[c]=h=[]);h.push(d)})};r.addAttributeFilter=function(c,
d){n.each(n.explode(c),function(c){var h;for(h=0;h<s.length;h++)if(s[h].name===c){s[h].callbacks.push(d);return}s.push({name:c,callbacks:[d]})})};r.parse=function(L,d){function j(a,c){var b=new y(a,c),e;a in z&&((e=t[a])?e.push(b):t[a]=[b]);return b}function h(a){for(var c,a=a.prev;a&&3===a.type;)c=a.value.replace(E,""),0<c.length?(a.value=c,a=a.prev):(c=a.prev,a.remove(),a=c)}var f,o,e,i,l,b,w,p,x,A,F,C=[],E,I,G,H,d=d||{};t={};u={};A=n.extend(n.makeMap("script,style,head,html,body,title,meta,param"),
c.getBlockElements());c.getNonEmptyElements();H=c.children;x=k.validate;i="forced_root_block"in d?d.forced_root_block:k.forced_root_block;G=c.getWhiteSpaceElements();F=/^[ \t\r\n]+/;E=/[ \t\r\n]+$/;I=/[ \t\r\n]+/g;f=new n.html.SaxParser({validate:x,fix_self_closing:!x,cdata:function(a){e.append(j("#cdata",4)).value=a},text:function(a,c){var b;G[e.name]||(a=a.replace(I," "),e.lastChild&&A[e.lastChild.name]&&(a=a.replace(F,"")));0!==a.length&&(b=j("#text",3),b.raw=!!c,e.append(b).value=a)},comment:function(a){e.append(j("#comment",
8)).value=a},pi:function(a,c){e.append(j(a,7)).value=c;h(e)},doctype:function(a){e.append(j("#doctype",10)).value=a;h(e)},start:function(a,b,g){var d,f,i;if(d=x?c.getElementRule(a):{}){d=j(d.outputName||a,1);d.attributes=b;d.shortEnded=g;e.append(d);(f=H[e.name])&&(H[d.name]&&!f[d.name])&&C.push(d);for(f=s.length;f--;)i=s[f].name,i in b.map&&((p=u[i])?p.push(d):u[i]=[d]);A[a]&&h(d);g||(e=d)}},end:function(a){var b,d;if(b=x?c.getElementRule(a):{}){if(A[a]&&!G[e.name]){for(a=e.firstChild;a&&3===a.type;)d=
a.value.replace(F,""),0<d.length?(a.value=d,a=a.next):(d=a.next,a.remove(),a=d);for(a=e.lastChild;a&&3===a.type;)d=a.value.replace(E,""),0<d.length?(a.value=d,a=a.prev):(d=a.prev,a.remove(),a=d)}if((b.removeEmpty||b.paddEmpty)&&e.isEmpty(c))if(b.paddEmpty)e.empty().append(new y("#text","3")).value="";else if(!e.attributes.map.name){b=e.parent;e.empty().remove();e=b;return}e=e.parent}}},c);o=e=new y(d.context||k.root_name,11);f.parse(L);if(x&&C.length)if(d.context)d.invalid=!0;else{var g,m,D,q,B,
v,J,K;J=n.makeMap("tr,td,th,tbody,thead,tfoot,table");c.getNonEmptyElements();for(f=0;f<C.length;f++)if(b=C[f],b.parent){m=[b];for(g=b.parent;g&&!c.isValidChild(g.name,b.name)&&!J[g.name];g=g.parent)m.push(g);if(g&&1<m.length){m.reverse();D=q=r.filterNode(m[0].clone());for(v=0;v<m.length-1;v++){c.isValidChild(q.name,m[v].name)?(B=r.filterNode(m[v].clone()),q.append(B)):B=q;for(q=m[v].firstChild;q&&q!=m[v+1];)K=q.next,B.append(q),q=K;q=B}D.isEmpty(c)?g.insert(b,m[0],!0):(g.insert(D,m[0],!0),g.insert(b,
D));g=m[0];(g.isEmpty(c)||g.firstChild===g.lastChild&&"br"===g.firstChild.name)&&g.empty().remove()}else b.parent&&("li"===b.name?(g=b.prev)&&("ul"===g.name||"ul"===g.name)?g.append(b):(g=b.next)&&("ul"===g.name||"ul"===g.name)?g.insert(b,g.firstChild,!0):b.wrap(r.filterNode(new y("ul",1))):c.isValidChild(b.parent.name,"div")&&c.isValidChild("div",b.name)?b.wrap(r.filterNode(new y("div",1))):"style"===b.name||"script"===b.name?b.empty().remove():b.unwrap())}}if(i&&"body"==o.name)for(f=o.firstChild;f;)b=
f.next,3==f.type||1==f.type&&"p"!==f.name&&!A[f.name]&&!f.attr("data-mce-type")?(l||(l=j(i,1),o.insert(l,f)),l.append(f)):l=null,f=b;if(!d.invalid){for(w in t){p=z[w];i=t[w];for(b=i.length;b--;)i[b].parent||i.splice(b,1);l=0;for(f=p.length;l<f;l++)p[l](i,w,d)}l=0;for(f=s.length;l<f;l++)if(p=s[l],p.name in u){i=u[p.name];for(b=i.length;b--;)i[b].parent||i.splice(b,1);b=0;for(w=p.callbacks.length;b<w;b++)p.callbacks[b](i,p.name,d)}}return o};k.remove_trailing_brs&&r.addNodeFilter("br",function(k){var d,
j=k.length,h,f=c.getBlockElements();c.getNonEmptyElements();var o,e,i;f.body=1;for(d=0;d<j;d++)if(h=k[d],o=h.parent,f[h.parent.name]&&h===o.lastChild){for(e=h.prev;e;){i=e.name;if("span"!==i||"bookmark"!==e.attr("data-mce-type")){if("br"!==i)break;if("br"===i){h=null;break}}e=e.prev}if(h&&(h.remove(),o.isEmpty(c)&&(elementRule=c.getElementRule(o.name))))elementRule.removeEmpty?o.remove():elementRule.paddEmpty&&(o.empty().append(new n.html.Node("#text",3)).value="")}})}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/html/Writer.js' */
tinymce.html.Writer=function(c){var a=[],e,i,f,g,j,c=c||{};e=c.indent;i=tinymce.makeMap(c.indent_before||"");f=tinymce.makeMap(c.indent_after||"");g=tinymce.html.Entities.getEncodeFunc(c.entity_encoding||"raw",c.entities);j="html"==c.element_format;return{start:function(b,c,k){var d,l,h;e&&(i[b]&&0<a.length)&&(d=a[a.length-1],0<d.length&&"\n"!==d&&a.push("\n"));a.push("<",b);if(c){d=0;for(l=c.length;d<l;d++)h=c[d],a.push(" ",h.name,'="',g(h.value,!0),'"')}a[a.length]=!k||j?">":" />";k&&(e&&f[b]&&
0<a.length)&&(d=a[a.length-1],0<d.length&&"\n"!==d&&a.push("\n"))},end:function(b){a.push("</",b,">");e&&(f[b]&&0<a.length)&&(b=a[a.length-1],0<b.length&&"\n"!==b&&a.push("\n"))},text:function(b,c){0<b.length&&(a[a.length]=c?b:g(b))},cdata:function(b){a.push("<![CDATA[",b,"]]\>")},comment:function(b){a.push("<\!--",b,"--\>")},pi:function(b,c){c?a.push("<?",b," ",c,"?>"):a.push("<?",b,"?>");e&&a.push("\n")},doctype:function(b){a.push("<!DOCTYPE",b,">",e?"\n":"")},reset:function(){a.length=0},getContent:function(){return a.join("").replace(/\n$/,
"")}}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/html/Serializer.js' */
(function(c){c.html.Serializer=function(b,k){var d=new c.html.Writer(b),b=b||{};b.validate="validate"in b?b.validate:!0;this.schema=k=k||new c.html.Schema;this.writer=d;this.serialize=function(c){function l(a){var b=m[a.type],c,e,f,i,g,h,j,n;if(b)b(a);else{b=a.name;c=a.shortEnded;e=a.attributes;if(o&&e&&1<e.length){g=[];g.map={};n=k.getElementRule(a.name);h=0;for(j=n.attributesOrder.length;h<j;h++)f=n.attributesOrder[h],f in e.map&&(i=e.map[f],g.map[f]=i,g.push({name:f,value:i}));h=0;for(j=e.length;h<
j;h++)f=e[h].name,f in g.map||(i=e.map[f],g.map[f]=i,g.push({name:f,value:i}));e=g}d.start(a.name,e,c);if(!c){if(a=a.firstChild){do l(a);while(a=a.next)}d.end(b)}}}var m,o;o=b.validate;m={3:function(a){d.text(a.value,a.raw)},8:function(a){d.comment(a.value)},7:function(a){d.pi(a.name,a.value)},10:function(a){d.doctype(a.value)},4:function(a){d.cdata(a.value)},11:function(a){if(a=a.firstChild){do l(a);while(a=a.next)}}};d.reset();if(1==c.type&&!b.inner)l(c);else m[11](c);return d.getContent()}}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/DOMUtils.js' */
(function(g){var i=g.each,j=g.is,n=g.isWebKit,h=g.isIE,k=g.html.Entities,o=/^([a-z0-9],?)+$/i,l=g.html.Schema.blockElementsMap,p=/^[ \t\r\n]*$/;g.create("tinymce.dom.DOMUtils",{doc:null,root:null,files:null,pixelStyles:/^(top|left|bottom|right|width|height|borderWidth)$/,props:{"for":"htmlFor","class":"className",className:"className",checked:"checked",disabled:"disabled",maxlength:"maxLength",readonly:"readOnly",selected:"selected",value:"value",id:"id",name:"name",type:"type"},DOMUtils:function(a,
b){var c;this.doc=a;this.win=window;this.files={};this.cssFlicker=!1;this.counter=0;this.stdMode=!g.isIE||8<=a.documentMode;this.boxModel=!g.isIE||"CSS1Compat"==a.compatMode||this.stdMode;this.hasOuterHTML="outerHTML"in a.createElement("a");this.settings=b=g.extend({keep_values:!1,hex_colors:1},b);this.schema=b.schema;this.styles=new g.html.Styles({url_converter:b.url_converter,url_converter_scope:b.url_converter_scope},b.schema);if(g.isIE6)try{a.execCommand("BackgroundImageCache",!1,!0)}catch(d){this.cssFlicker=
!0}if(h&&b.schema)for(c in"abbr article aside audio canvas details figcaption figure footer header hgroup mark menu meter nav output progress section summary time video".replace(/\w+/g,function(b){a.createElement(b)}),b.schema.getCustomElements())a.createElement(c);g.addUnload(this.destroy,this)},getRoot:function(){var a=this.settings;return a&&this.get(a.root_element)||this.doc.body},getViewPort:function(a){var b,a=!a?this.win:a;b=a.document;b=this.boxModel?b.documentElement:b.body;return{x:a.pageXOffset||
b.scrollLeft,y:a.pageYOffset||b.scrollTop,w:a.innerWidth||b.clientWidth,h:a.innerHeight||b.clientHeight}},getRect:function(a){var b,a=this.get(a);b=this.getPos(a);a=this.getSize(a);return{x:b.x,y:b.y,w:a.w,h:a.h}},getSize:function(a){var b,c,a=this.get(a);b=this.getStyle(a,"width");c=this.getStyle(a,"height");-1===b.indexOf("px")&&(b=0);-1===c.indexOf("px")&&(c=0);return{w:parseInt(b)||a.offsetWidth||a.clientWidth,h:parseInt(c)||a.offsetHeight||a.clientHeight}},getParent:function(a,b,c){return this.getParents(a,
b,c,!1)},getParents:function(a,b,c,d){var e=this,f,g=e.settings,m=[],a=e.get(a),d=void 0===d;g.strict_root&&(c=c||e.getRoot());j(b,"string")&&(f=b,b="*"===b?function(a){return 1==a.nodeType}:function(a){return e.is(a,f)});for(;a&&!(a==c||!a.nodeType||9===a.nodeType);){if(!b||b(a))if(d)m.push(a);else return a;a=a.parentNode}return d?m:null},get:function(a){var b;return a&&(this.doc&&"string"==typeof a)&&(b=a,(a=this.doc.getElementById(a))&&a.id!==b)?this.doc.getElementsByName(b)[1]:a},getNext:function(a,
b){return this._findSib(a,b,"nextSibling")},getPrev:function(a,b){return this._findSib(a,b,"previousSibling")},select:function(a,b){return g.dom.Sizzle(a,this.get(b)||this.get(this.settings.root_element)||this.doc,[])},is:function(a,b){var c;if(void 0===a.length){if("*"===b)return 1==a.nodeType;if(o.test(b)){b=b.toLowerCase().split(/,/);a=a.nodeName.toLowerCase();for(c=b.length-1;0<=c;c--)if(b[c]==a)return!0;return!1}}return 0<g.dom.Sizzle.matches(b,a.nodeType?[a]:a).length},add:function(a,b,c,d,
e){var f=this;return this.run(a,function(a){var g;g=j(b,"string")?f.doc.createElement(b):b;f.setAttribs(g,c);d&&(d.nodeType?g.appendChild(d):f.setHTML(g,d));return!e?a.appendChild(g):g})},create:function(a,b,c){return this.add(this.doc.createElement(a),a,b,c,1)},createHTML:function(a,b,c){var d,e;d="<"+a;for(e in b)b.hasOwnProperty(e)&&(d+=" "+e+'="'+this.encode(b[e])+'"');return"undefined"!=typeof c?d+">"+c+"</"+a+">":d+" />"},remove:function(a,b){return this.run(a,function(a){var d,e=a.parentNode;
if(!e)return null;if(b)for(;d=a.firstChild;)!g.isIE||3!==d.nodeType||d.nodeValue?e.insertBefore(d,a):a.removeChild(d);return e.removeChild(a)})},setStyle:function(a,b,c){var d=this;return d.run(a,function(e){var f;f=e.style;b=b.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});if(d.pixelStyles.test(b)&&(g.is(c,"number")||/^[\-0-9\.]+$/.test(c)))c+="px";switch(b){case "opacity":if(h&&(f.filter=""===c?"":"alpha(opacity="+100*c+")",!a.currentStyle||!a.currentStyle.hasLayout))f.display="inline-block";
f[b]=f["-moz-opacity"]=f["-khtml-opacity"]=c||"";break;case "float":h?f.styleFloat=c:f.cssFloat=c;break;default:f[b]=c||""}d.settings.update_styles&&d.setAttrib(e,"data-mce-style")})},getStyle:function(a,b,c){if(a=this.get(a)){if(this.doc.defaultView&&c){b=b.replace(/[A-Z]/g,function(a){return"-"+a});try{return this.doc.defaultView.getComputedStyle(a,null).getPropertyValue(b)}catch(d){return null}}b=b.replace(/-(\D)/g,function(a,b){return b.toUpperCase()});"float"==b&&(b=h?"styleFloat":"cssFloat");
return a.currentStyle&&c?a.currentStyle[b]:a.style?a.style[b]:void 0}},setStyles:function(a,b){var c=this,d=c.settings,e;e=d.update_styles;d.update_styles=0;i(b,function(b,d){c.setStyle(a,d,b)});d.update_styles=e;d.update_styles&&c.setAttrib(a,d.cssText)},removeAllAttribs:function(a){return this.run(a,function(a){var c,d=a.attributes;for(c=d.length-1;0<=c;c--)a.removeAttributeNode(d.item(c))})},setAttrib:function(a,b,c){var d=this;if(a&&b)return d.settings.strict&&(b=b.toLowerCase()),this.run(a,function(a){var f=
d.settings,g=a.getAttribute(b);if(null!==c)switch(b){case "style":if(!j(c,"string")){i(c,function(b,c){d.setStyle(a,c,b)});return}f.keep_values&&(c&&!d._isRes(c)?a.setAttribute("data-mce-style",c,2):a.removeAttribute("data-mce-style",2));a.style.cssText=c;break;case "class":a.className=c||"";break;case "src":case "href":f.keep_values&&(f.url_converter&&(c=f.url_converter.call(f.url_converter_scope||d,c,b,a)),d.setAttrib(a,"data-mce-"+b,c,2));break;case "shape":a.setAttribute("data-mce-style",c)}j(c)&&
null!==c&&0!==c.length?a.setAttribute(b,""+c,2):a.removeAttribute(b,2);tinyMCE.activeEditor&&g!=c&&(f=tinyMCE.activeEditor,f.onSetAttrib.dispatch(f,a,b,c))})},setAttribs:function(a,b){var c=this;return this.run(a,function(a){i(b,function(b,f){c.setAttrib(a,f,b)})})},getAttrib:function(a,b,c){var d,a=this.get(a);if(!a||1!==a.nodeType)return void 0===c?!1:c;j(c)||(c="");if(/^(src|href|style|coords|shape)$/.test(b)&&(d=a.getAttribute("data-mce-"+b)))return d;h&&this.props[b]&&(d=(d=a[this.props[b]])&&
d.nodeValue?d.nodeValue:d);d||(d=a.getAttribute(b,2));if(/^(checked|compact|declare|defer|disabled|ismap|multiple|nohref|noshade|nowrap|readonly|selected)$/.test(b))return!0===a[this.props[b]]&&""===d?b:d?b:"";if("FORM"===a.nodeName&&a.getAttributeNode(b))return a.getAttributeNode(b).nodeValue;if("style"===b&&(d=d||a.style.cssText))d=this.serializeStyle(this.parseStyle(d),a.nodeName),this.settings.keep_values&&!this._isRes(d)&&a.setAttribute("data-mce-style",d);n&&("class"===b&&d)&&(d=d.replace(/(apple|webkit)\-[a-z\-]+/gi,
""));if(h)switch(b){case "rowspan":case "colspan":1===d&&(d="");break;case "size":if("+0"===d||20===d||0===d)d="";break;case "width":case "height":case "vspace":case "checked":case "disabled":case "readonly":0===d&&(d="");break;case "hspace":-1===d&&(d="");break;case "maxlength":case "tabindex":if(32768===d||2147483647===d||"32768"===d)d="";break;case "multiple":case "compact":case "noshade":case "nowrap":return 65535===d?b:c;case "shape":d=d.toLowerCase();break;default:0===b.indexOf("on")&&d&&(d=
g._replace(/^function\s+\w+\(\)\s+\{\s+(.*)\s+\}$/,"$1",""+d))}return void 0!==d&&null!==d&&""!==d?""+d:c},getPos:function(a,b){var c=0,d=0,e=this.doc,a=this.get(a),b=b||e.body;if(a){if(a.getBoundingClientRect)return a=a.getBoundingClientRect(),d=this.boxModel?e.documentElement:e.body,c=a.left+(e.documentElement.scrollLeft||e.body.scrollLeft)-d.clientTop,d=a.top+(e.documentElement.scrollTop||e.body.scrollTop)-d.clientLeft,{x:c,y:d};for(e=a;e&&e!=b&&e.nodeType;)c+=e.offsetLeft||0,d+=e.offsetTop||0,
e=e.offsetParent;for(e=a.parentNode;e&&e!=b&&e.nodeType;)c-=e.scrollLeft||0,d-=e.scrollTop||0,e=e.parentNode}return{x:c,y:d}},parseStyle:function(a){return this.styles.parse(a)},serializeStyle:function(a,b){return this.styles.serialize(a,b)},loadCSS:function(a){var b=this,c=b.doc,d;a||(a="");d=b.select("head")[0];i(a.split(","),function(a){var f;b.files[a]||(b.files[a]=!0,f=b.create("link",{rel:"stylesheet",href:g._addVer(a)}),h&&(c.documentMode&&c.recalc)&&(f.onload=function(){c.recalc&&c.recalc();
f.onload=null}),d.appendChild(f))})},addClass:function(a,b){return this.run(a,function(a){var d;if(!b)return 0;if(this.hasClass(a,b))return a.className;d=this.removeClass(a,b);return a.className=(""!=d?d+" ":"")+b})},removeClass:function(a,b){var c=this,d;return c.run(a,function(a){var f;return c.hasClass(a,b)?(d||(d=RegExp("(^|\\s+)"+b+"(\\s+|$)","g")),f=a.className.replace(d," "),f=g.trim(" "!=f?f:""),a.className=f,f||(a.removeAttribute("class"),a.removeAttribute("className")),f):a.className})},
hasClass:function(a,b){a=this.get(a);return!a||!b?!1:-1!==(" "+a.className+" ").indexOf(" "+b+" ")},show:function(a){return this.setStyle(a,"display","block")},hide:function(a){return this.setStyle(a,"display","none")},isHidden:function(a){a=this.get(a);return!a||"none"==a.style.display||"none"==this.getStyle(a,"display")},uniqueId:function(a){return(!a?"mce_":a)+this.counter++},setHTML:function(a,b){var c=this;return c.run(a,function(a){if(h){for(;a.firstChild;)a.removeChild(a.firstChild);try{a.innerHTML=
"<br />"+b,a.removeChild(a.firstChild)}catch(e){a=c.create("div"),a.innerHTML="<br />"+b,i(a.childNodes,function(b,c){c&&a.appendChild(b)})}}else a.innerHTML=b;return b})},getOuterHTML:function(a){var b,a=this.get(a);if(!a)return null;if(1===a.nodeType&&this.hasOuterHTML)return a.outerHTML;b=(a.ownerDocument||this.doc).createElement("body");b.appendChild(a.cloneNode(!0));return b.innerHTML},setOuterHTML:function(a,b,c){function d(a,b,d){d=d.createElement("body");d.innerHTML=b;for(b=d.lastChild;b;)e.insertAfter(b.cloneNode(!0),
a),b=b.previousSibling;e.remove(a)}var e=this;return this.run(a,function(a){a=e.get(a);if(1==a.nodeType)if(c=c||a.ownerDocument||e.doc,h)try{h&&1==a.nodeType?a.outerHTML=b:d(a,b,c)}catch(g){d(a,b,c)}else d(a,b,c)})},decode:k.decode,encode:k.encodeAllRaw,insertAfter:function(a,b){b=this.get(b);return this.run(a,function(a){var d,e;d=b.parentNode;(e=b.nextSibling)?d.insertBefore(a,e):d.appendChild(a);return a})},isBlock:function(a){var b=a.nodeType;return b?!!(1===b&&l[a.nodeName]):!!l[a]},replace:function(a,
b,c){j(b,"array")&&(a=a.cloneNode(!0));return this.run(b,function(b){c&&i(g.grep(b.childNodes),function(b){a.appendChild(b)});return b.parentNode.replaceChild(a,b)})},rename:function(a,b){var c=this,d;a.nodeName!=b.toUpperCase()&&(d=c.create(b),i(c.getAttribs(a),function(b){c.setAttrib(d,b.nodeName,c.getAttrib(a,b.nodeName))}),c.replace(d,a,1));return d||a},findCommonAncestor:function(a,b){for(var c=a,d;c;){for(d=b;d&&c!=d;)d=d.parentNode;if(c==d)break;c=c.parentNode}return!c&&a.ownerDocument?a.ownerDocument.documentElement:
c},toHex:function(a){function b(a){a=parseInt(a).toString(16);return 1<a.length?a:"0"+a}var c=/^\s*rgb\s*?\(\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?,\s*?([0-9]+)\s*?\)\s*$/i.exec(a);c&&(a="#"+b(c[1])+b(c[2])+b(c[3]));return a},getClasses:function(){function a(f){i(f.imports,function(b){a(b)});i(f.cssRules||f.rules,function(f){switch(f.type||1){case 1:f.selectorText&&i(f.selectorText.split(","),function(a){a=a.replace(/^\s*|\s*$|^\s\./g,"");if(!/\.mce/.test(a)&&/\.[\w\-]+$/.test(a)&&(e=a,a=g._replace(/.*\.([a-z0-9_\-]+).*/i,
"$1",a),(!d||(a=d(a,e)))&&!c[a]))b.push({"class":a}),c[a]=1});break;case 3:a(f.styleSheet)}})}var b=[],c={},d=this.settings.class_filter,e;if(this.classes)return this.classes;try{i(this.doc.styleSheets,a)}catch(f){}0<b.length&&(this.classes=b);return b},run:function(a,b,c){var d=this,e;d.doc&&"string"===typeof a&&(a=d.get(a));if(!a)return!1;c=c||this;return!a.nodeType&&(a.length||0===a.length)?(e=[],i(a,function(a,g){a&&("string"==typeof a&&(a=d.doc.getElementById(a)),e.push(b.call(c,a,g)))}),e):
b.call(c,a)},getAttribs:function(a){var b,a=this.get(a);if(!a)return[];if(h){b=[];if("OBJECT"==a.nodeName)return a.attributes;"OPTION"===a.nodeName&&this.getAttrib(a,"selected")&&b.push({specified:1,nodeName:"selected"});a.cloneNode(!1).outerHTML.replace(/<\/?[\w:\-]+ ?|=[\"][^\"]+\"|=\'[^\']+\'|=[\w\-]+|>/gi,"").replace(/[\w:\-]+/gi,function(a){b.push({specified:1,nodeName:a})});return b}return a.attributes},isEmpty:function(a,b){var c,d,e,f;if(a=a.firstChild){e=new g.dom.TreeWalker(a);b=b||this.schema?
this.schema.getNonEmptyElements():null;do{d=a.nodeType;if(1===d){if(a.getAttribute("data-mce-bogus"))continue;f=a.nodeName.toLowerCase();if(b&&b[f]){c=a.parentNode;if("br"===f&&this.isBlock(c)&&c.firstChild===a&&c.lastChild===a)continue;return!1}this.getAttribs(a);for(c=a.attributes.length;c--;)if(f=a.attributes[c].nodeName.toLowerCase(),"name"===f||"data-mce-bookmark"===f||"contenteditable"===f&&"true"===a.attributes[c].value)return!1}if(8==d||3===d&&!p.test(a.nodeValue))return!1}while(a=e.next())}return!0},
destroy:function(a){this.events&&this.events.destroy();this.win=this.doc=this.root=this.events=null;a||g.removeUnload(this.destroy)},createRng:function(){var a=this.doc;return a.createRange?a.createRange():new g.dom.Range(this)},nodeIndex:function(a,b){var c=0,d,e;if(a){d=a.nodeType;for(a=a.previousSibling;a;a=a.previousSibling)if(e=a.nodeType,!(b&&3==e)||e!=d&&a.nodeValue.length)c++,d=e}return c},split:function(a,b,c){function d(a){var b,c=a.childNodes,f=a.nodeType;if(!(1==f&&"bookmark"==a.getAttribute("data-mce-type"))){for(b=
c.length-1;0<=b;b--)d(c[b]);if(9!=f){if(3==f&&0<a.nodeValue.length){b=g.trim(a.nodeValue).length;if(!(c=!e.isBlock(a.parentNode)))if(!(c=0<b)){if(b=0==b)b=a.nextSibling&&"SPAN"==a.nextSibling.nodeName,b=a.previousSibling&&"SPAN"==a.previousSibling.nodeName&&b;c=b}if(c)return}else if(1==f&&(c=a.childNodes,1==c.length&&(c[0]&&1==c[0].nodeType&&"bookmark"==c[0].getAttribute("data-mce-type"))&&a.parentNode.insertBefore(c[0],a),c.length||/^(br|hr|input|img)$/i.test(a.nodeName)))return;e.remove(a)}return a}}
var e=this,f=e.createRng(),i,h;if(a&&b)return f.setStart(a.parentNode,e.nodeIndex(a)),f.setEnd(b.parentNode,e.nodeIndex(b)),i=f.extractContents(),f=e.createRng(),f.setStart(b.parentNode,e.nodeIndex(b)+1),f.setEnd(a.parentNode,e.nodeIndex(a)+1),f=f.extractContents(),h=a.parentNode,h.insertBefore(d(i),a),c?h.replaceChild(c,b):h.insertBefore(b,a),h.insertBefore(d(f),a),e.remove(a),c||b},bind:function(a,b,c,d){this.events||(this.events=new g.dom.EventUtils);return this.events.add(a,b,c,d||this)},unbind:function(a,
b,c){this.events||(this.events=new g.dom.EventUtils);return this.events.remove(a,b,c)},dumpRng:function(a){return"startContainer: "+a.startContainer.nodeName+", startOffset: "+a.startOffset+", endContainer: "+a.endContainer.nodeName+", endOffset: "+a.endOffset},_findSib:function(a,b,c){var d=this,e=b;if(a){j(e,"string")&&(e=function(a){return d.is(a,b)});for(a=a[c];a;a=a[c])if(e(a))return a}return null},_isRes:function(a){return/^(top|left|bottom|right|width|height)/i.test(a)||/;\s*(top|left|bottom|right|width|height)/i.test(a)}});
g.DOM=new g.dom.DOMUtils(document,{process_html:0})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/Range.js' */
(function(y){function B(t){function w(b,a){C(j,b,a)}function x(b,a){C(m,b,a)}function D(b){w(b.parentNode,p(b))}function E(b){x(b.parentNode,p(b)+1)}function z(b,a){var c;if(3==b.nodeType||0>a)return b;for(c=b.firstChild;c&&0<a;)--a,c=c.nextSibling;return c?c:b}function u(b,a,c,d){var e,g;if(b==c)return a==d?0:a<d?-1:1;for(e=c;e&&e.parentNode!=b;)e=e.parentNode;if(e){g=0;for(c=b.firstChild;c!=e&&g<a;)g++,c=c.nextSibling;return a<=g?-1:1}for(e=b;e&&e.parentNode!=c;)e=e.parentNode;if(e){g=0;for(c=c.firstChild;c!=
e&&g<d;)g++,c=c.nextSibling;return g<d?-1:1}for(a=t.findCommonAncestor(b,c);b&&b.parentNode!=a;)b=b.parentNode;b||(b=a);for(d=c;d&&d.parentNode!=a;)d=d.parentNode;d||(d=a);if(b==d)return 0;for(c=a.firstChild;c;){if(c==b)return-1;if(c==d)return 1;c=c.nextSibling}}function C(b,a,c){b?(d[i]=a,d[k]=c):(d[n]=a,d[o]=c);for(a=d[n];a.parentNode;)a=a.parentNode;for(c=d[i];c.parentNode;)c=c.parentNode;c==a?0<u(d[i],d[k],d[n],d[o])&&d.collapse(b):d.collapse(b);d.collapsed=d[i]==d[n]&&d[k]==d[o];d.commonAncestorContainer=
t.findCommonAncestor(d[i],d[n])}function A(b){var a,c=0,f=0,e;if(d[i]==d[n])return y(b);a=d[n];for(e=a.parentNode;e;a=e,e=e.parentNode){if(e==d[i]){var g=a;e=f=c=c=e=a=void 0;b!=l&&(a=q.createDocumentFragment());e=F(g,b);a&&a.appendChild(e);c=p(g);c-=d[k];if(!(0>=c))for(e=g.previousSibling;0<c;)f=e.previousSibling,e=v(e,b),a&&a.insertBefore(e,a.firstChild),--c,e=f;b!=r&&(d.setEndBefore(g),d.collapse(m));b=a;return b}++c}a=d[i];for(e=a.parentNode;e;a=e,e=e.parentNode){if(e==d[n]){g=a;e=f=c=e=c=a=void 0;
b!=l&&(a=q.createDocumentFragment());e=G(g,b);a&&a.appendChild(e);c=p(g);++c;c=d[o]-c;for(e=g.nextSibling;0<c;)f=e.nextSibling,e=v(e,b),a&&a.appendChild(e),--c,e=f;b!=r&&(d.setStartAfter(g),d.collapse(j));return a}++f}f-=c;for(a=d[i];0<f;)a=a.parentNode,f--;for(c=d[n];0>f;)c=c.parentNode,f++;f=a.parentNode;for(e=c.parentNode;f!=e;f=f.parentNode,e=e.parentNode)a=f,c=e;var h;b!=l&&(g=q.createDocumentFragment());h=G(a,b);g&&g.appendChild(h);f=p(a);e=p(c);++f;f=e-f;for(h=a.nextSibling;0<f;)e=h.nextSibling,
h=v(h,b),g&&g.appendChild(h),h=e,--f;h=F(c,b);g&&g.appendChild(h);b!=r&&(d.setStartAfter(a),d.collapse(j));return g}function y(b){var a,c,f,e;b!=l&&(a=q.createDocumentFragment());if(d[k]==d[o])return a;if(3==d[i].nodeType){c=d[i].nodeValue;c=c.substring(d[k],d[o]);b!=r&&(d[i].deleteData(d[k],d[o]-d[k]),d.collapse(j));if(b==l)return;a.appendChild(q.createTextNode(c));return a}f=z(d[i],d[k]);for(c=d[o]-d[k];0<c;)e=f.nextSibling,f=v(f,b),a&&a.appendChild(f),--c,f=e;b!=r&&d.collapse(j);return a}function F(b,
a){var c=z(d[n],d[o]-1),f,e,g,h=c!=d[n];if(c==b)return s(c,h,m,a);f=c.parentNode;for(e=s(f,m,m,a);f;){for(;c;)g=c.previousSibling,c=s(c,h,m,a),a!=l&&e.insertBefore(c,e.firstChild),h=j,c=g;if(f==b)return e;c=f.previousSibling;f=f.parentNode;g=s(f,m,m,a);a!=l&&g.appendChild(e);e=g}}function G(b,a){var c=z(d[i],d[k]),f=c!=d[i],e,g,h;if(c==b)return s(c,f,j,a);e=c.parentNode;for(g=s(e,m,j,a);e;){for(;c;)h=c.nextSibling,c=s(c,f,j,a),a!=l&&g.appendChild(c),f=j,c=h;if(e==b)return g;c=e.nextSibling;e=e.parentNode;
h=s(e,m,j,a);a!=l&&h.appendChild(g);g=h}}function s(b,a,c,f){var e;if(a)return v(b,f);if(3==b.nodeType){a=b.nodeValue;c?(e=d[k],c=a.substring(e),a=a.substring(0,e)):(e=d[o],c=a.substring(0,e),a=a.substring(e));f!=r&&(b.nodeValue=a);if(f==l)return;b=b.cloneNode(m);b.nodeValue=c;return b}if(f!=l)return b.cloneNode(m)}function v(b,a){if(a!=l)return a==r?b.cloneNode(j):b;b.parentNode.removeChild(b)}var d=this,q=t.doc,r=1,l=2,j=!0,m=!1,k="startOffset",i="startContainer",n="endContainer",o="endOffset",
H=tinymce.extend,p=t.nodeIndex;H(d,{startContainer:q,startOffset:0,endContainer:q,endOffset:0,collapsed:j,commonAncestorContainer:q,START_TO_START:0,START_TO_END:1,END_TO_END:2,END_TO_START:3,setStart:w,setEnd:x,setStartBefore:D,setStartAfter:function(b){w(b.parentNode,p(b)+1)},setEndBefore:function(b){x(b.parentNode,p(b))},setEndAfter:E,collapse:function(b){b?(d[n]=d[i],d[o]=d[k]):(d[i]=d[n],d[k]=d[o]);d.collapsed=j},selectNode:function(b){D(b);E(b)},selectNodeContents:function(b){w(b,0);x(b,1===
b.nodeType?b.childNodes.length:b.nodeValue.length)},compareBoundaryPoints:function(b,a){var c=d[i],f=d[k],e=d[n],g=d[o],h=a.startContainer,j=a.startOffset,l=a.endContainer,m=a.endOffset;if(0===b)return u(c,f,h,j);if(1===b)return u(e,g,h,j);if(2===b)return u(e,g,l,m);if(3===b)return u(c,f,l,m)},deleteContents:function(){A(l)},extractContents:function(){return A(0)},cloneContents:function(){return A(r)},insertNode:function(b){var a=this[i],c=this[k],d;(3===a.nodeType||4===a.nodeType)&&a.nodeValue?c?
c>=a.nodeValue.length?t.insertAfter(b,a):(c=a.splitText(c),a.parentNode.insertBefore(b,c)):a.parentNode.insertBefore(b,a):(0<a.childNodes.length&&(d=a.childNodes[c]),d?a.insertBefore(b,d):a.appendChild(b))},surroundContents:function(b){var a=d.extractContents();d.insertNode(b);b.appendChild(a);d.selectNode(b)},cloneRange:function(){return H(new B(t),{startContainer:d[i],startOffset:d[k],endContainer:d[n],endOffset:d[o],collapsed:d.collapsed,commonAncestorContainer:d.commonAncestorContainer})}})}y.Range=
B})(tinymce.dom);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/TridentSelection.js' */
(function(){tinymce.dom.TridentSelection=function(l){function p(e,c){var a,b=0,f,j,h,k,i,d,g=-1,m;a=e.duplicate();a.collapse(c);m=a.parentElement();if(m.ownerDocument===l.dom.doc){for(;"false"===m.contentEditable;)m=m.parentNode;if(!m.hasChildNodes())return{node:m,inside:1};h=m.children;for(f=h.length-1;b<=f;)if(d=Math.floor((b+f)/2),k=h[d],a.moveToElementText(k),g=a.compareEndPoints(c?"StartToStart":"EndToEnd",e),0<g)f=d-1;else if(0>g)b=d+1;else return{node:k};if(0>g){k?a.collapse(!1):(a.moveToElementText(m),
a.collapse(!0),k=m,j=!0);a.setEndPoint(c?"EndToStart":"EndToEnd",e);if(0<a.compareEndPoints(c?"StartToStart":"StartToEnd",e)){a=e.duplicate();a.collapse(c);for(i=-1;m==a.parentElement()&&0!=a.move("character",-1);)i++}i=i||a.text.replace("\r\n"," ").length}else a.collapse(!0),a.setEndPoint(c?"StartToStart":"StartToEnd",e),i=a.text.replace("\r\n"," ").length;return{node:k,position:g,offset:i,inside:j}}}var q=this,n=l.dom,r=!0;this.getBookmark=function(e){function c(a){var h,b,i,d,c=[];h=a.parentNode;
for(b=n.doc.body.parentNode;h!=b&&9!==h.nodeType;){i=h.children;for(d=i.length;d--;)if(a===i[d]){c.push(d);break}a=h;h=h.parentNode}return c}function a(a){if(a=p(b,a))return{position:a.position,offset:a.offset,indexes:c(a.node),inside:a.inside}}var b=l.getRng(),f={};2===e&&(b.item?f.start={ctrl:!0,indexes:c(b.item(0))}:(f.start=a(!0),l.isCollapsed()||(f.end=a())));return f};this.moveToBookmark=function(e){function c(a){var b,c,i,d;b=n.doc.body;for(c=a.length-1;0<=c;c--)d=b.children,i=a[c],i<=d.length-
1&&(b=d[i]);return b}function a(a){var h=e[a?"start":"end"],k,i;h&&(k=0<h.position,i=f.createTextRange(),i.moveToElementText(c(h.indexes)),offset=h.offset,void 0!==offset?(i.collapse(h.inside||k),i.moveStart("character",k?-offset:offset)):i.collapse(a),b.setEndPoint(a?"StartToStart":"EndToStart",i),a&&b.collapse(!0))}var b,f=n.doc.body;e.start&&(e.start.ctrl?(b=f.createControlRange(),b.addElement(c(e.start.indexes))):(b=f.createTextRange(),a(!0),a()),b.select())};this.addRange=function(e){function c(b){var c,
e,g,l,o;g=n.create("a");c=b?f:h;e=b?j:k;l=a.duplicate();if(c==i||c==i.documentElement)c=d,e=0;3==c.nodeType?(c.parentNode.insertBefore(g,c),l.moveToElementText(g),l.moveStart("character",e),n.remove(g),a.setEndPoint(b?"StartToStart":"EndToEnd",l)):(o=c.childNodes,o.length?(e>=o.length?n.insertAfter(g,o[o.length-1]):c.insertBefore(g,o[e]),l.moveToElementText(g)):(g=i.createTextNode(""),c.appendChild(g),l.moveToElementText(g.parentNode),l.collapse(r)),a.setEndPoint(b?"StartToStart":"EndToEnd",l),n.remove(g))}
var a,b,f,j,h,k,i=l.dom.doc,d=i.body;f=e.startContainer;j=e.startOffset;h=e.endContainer;k=e.endOffset;a=d.createTextRange();if(f==h&&(1==f.nodeType&&j==k-1)&&j==k-1)try{b=d.createControlRange();b.addElement(f.childNodes[j]);b.select();return}catch(g){}c(!0);c();a.select()};this.getRangeAt=function(){function e(b){var d=p(c,b),g,e,f=0,h;g=d.node;e=d.offset;if(d.inside&&!g.hasChildNodes())a[b?"setStart":"setEnd"](g,0);else if(void 0===e)a[b?"setStartBefore":"setEndAfter"](g);else{if(0>d.position){d=
d.inside?g.firstChild:g.nextSibling;if(!d){a[b?"setStartAfter":"setEndAfter"](g);return}if(!e){if(3==d.nodeType)a[b?"setStart":"setEnd"](d,0);else a[b?"setStartBefore":"setEndBefore"](d);return}for(;d;){h=d.nodeValue;f+=h.length;if(f>=e){g=d;f-=e;f=h.length-f;break}d=d.nextSibling}}else{d=g.previousSibling;if(!d)return a[b?"setStartBefore":"setEndBefore"](g);if(!e){if(3==g.nodeType)a[b?"setStart":"setEnd"](d,g.nodeValue.length);else a[b?"setStartAfter":"setEndAfter"](d);return}for(;d;){f+=d.nodeValue.length;
if(f>=e){g=d;f-=e;break}d=d.previousSibling}}a[b?"setStart":"setEnd"](g,f)}}var c=l.getRng(),a=n.createRng(),b,f,j,h;b=c.item?c.item(0):c.parentElement();if(b.ownerDocument!=n.doc)return a;f=l.isCollapsed();if(c.item)return a.setStart(b.parentNode,n.nodeIndex(b)),a.setEnd(a.startContainer,a.startOffset+1),a;try{e(!0),f||e()}catch(k){if(-2147024809==k.number)h=q.getBookmark(2),j=c.duplicate(),j.collapse(!0),b=j.parentElement(),f||(j=c.duplicate(),j.collapse(!1),j=j.parentElement(),j.innerHTML=j.innerHTML),
b.innerHTML=b.innerHTML,q.moveToBookmark(h),c=l.getRng(),e(!0),f||e();else throw k;}return a}}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/Sizzle.js' */
(function(){function w(a,b,c,d,f,e){for(var f=0,j=d.length;f<j;f++){var h=d[f];if(h){for(var h=h[a],g=!1;h;){if(h.sizcache===c){g=d[h.sizset];break}1===h.nodeType&&!e&&(h.sizcache=c,h.sizset=f);if(h.nodeName.toLowerCase()===b){g=h;break}h=h[a]}d[f]=g}}}function x(a,b,c,d,f,e){for(var f=0,j=d.length;f<j;f++){var h=d[f];if(h){for(var h=h[a],g=!1;h;){if(h.sizcache===c){g=d[h.sizset];break}if(1===h.nodeType)if(e||(h.sizcache=c,h.sizset=f),"string"!==typeof b){if(h===b){g=!0;break}}else if(0<i.filter(b,
[h]).length){g=h;break}h=h[a]}d[f]=g}}}var t=/((?:\((?:\([^()]+\)|[^()]+)+\)|\[(?:\[[^\[\]]*\]|['"][^'"]*['"]|[^\[\]'"]+)+\]|\\.|[^ >+~,(\[\\]+)+|[>+~])(\s*,\s*)?((?:.|\r|\n)*)/g,u=0,y=Object.prototype.toString,m=!1,z=!0;[0,0].sort(function(){z=!1;return 0});var i=function(a,b,c,d){var c=c||[],f=b=b||document;if(1!==b.nodeType&&9!==b.nodeType)return[];if(!a||"string"!==typeof a)return c;var e=[],j,h,l,k,o=!0,m=i.isXML(b),n=a,p;do if(t.exec(""),j=t.exec(n))if(n=j[3],e.push(j[1]),j[2]){k=j[3];break}while(j);
if(1<e.length&&B.exec(a))if(2===e.length&&g.relative[e[0]])h=A(e[0]+e[1],b);else for(h=g.relative[e[0]]?[b]:i(e.shift(),b);e.length;)a=e.shift(),g.relative[a]&&(a+=e.shift()),h=A(a,h);else if(!d&&(1<e.length&&9===b.nodeType&&!m&&g.match.ID.test(e[0])&&!g.match.ID.test(e[e.length-1]))&&(j=i.find(e.shift(),b,m),b=j.expr?i.filter(j.expr,j.set)[0]:j.set[0]),b){j=d?{expr:e.pop(),set:q(d)}:i.find(e.pop(),1===e.length&&("~"===e[0]||"+"===e[0])&&b.parentNode?b.parentNode:b,m);h=j.expr?i.filter(j.expr,j.set):
j.set;for(0<e.length?l=q(h):o=!1;e.length;)j=p=e.pop(),g.relative[p]?j=e.pop():p="",null==j&&(j=b),g.relative[p](l,j,m)}else l=[];l||(l=h);l||i.error(p||a);if("[object Array]"===y.call(l))if(o)if(b&&1===b.nodeType)for(a=0;null!=l[a];a++)l[a]&&(!0===l[a]||1===l[a].nodeType&&i.contains(b,l[a]))&&c.push(h[a]);else for(a=0;null!=l[a];a++)l[a]&&1===l[a].nodeType&&c.push(h[a]);else c.push.apply(c,l);else q(l,c);k&&(i(k,f,c,d),i.uniqueSort(c));return c};i.uniqueSort=function(a){if(r&&(m=z,a.sort(r),m))for(var b=
1;b<a.length;b++)a[b]===a[b-1]&&a.splice(b--,1);return a};i.matches=function(a,b){return i(a,null,null,b)};i.find=function(a,b,c){var d;if(!a)return[];for(var f=0,e=g.order.length;f<e;f++){var j=g.order[f],h;if(h=g.leftMatch[j].exec(a)){var i=h[1];h.splice(1,1);if("\\"!==i.substr(i.length-1)&&(h[1]=(h[1]||"").replace(/\\/g,""),d=g.find[j](h,b,c),null!=d)){a=a.replace(g.match[j],"");break}}}d||(d=b.getElementsByTagName("*"));return{set:d,expr:a}};i.filter=function(a,b,c,d){for(var f=a,e=[],j=b,h,l,
k=b&&b[0]&&i.isXML(b[0]);a&&b.length;){for(var m in g.filter)if(null!=(h=g.leftMatch[m].exec(a))&&h[2]){var o=g.filter[m],n,p;p=h[1];l=!1;h.splice(1,1);if("\\"!==p.substr(p.length-1)){j===e&&(e=[]);if(g.preFilter[m])if(h=g.preFilter[m](h,j,c,e,d,k)){if(!0===h)continue}else l=n=!0;if(h)for(var q=0;null!=(p=j[q]);q++)if(p){n=o(p,h,q,j);var r=d^!!n;c&&null!=n?r?l=!0:j[q]=!1:r&&(e.push(p),l=!0)}if(void 0!==n){c||(j=e);a=a.replace(g.match[m],"");if(!l)return[];break}}}if(a===f)if(null==l)i.error(a);else break;
f=a}return j};i.error=function(a){throw"Syntax error, unrecognized expression: "+a;};var g=i.selectors={order:["ID","NAME","TAG"],match:{ID:/#((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,CLASS:/\.((?:[\w\u00c0-\uFFFF\-]|\\.)+)/,NAME:/\[name=['"]*((?:[\w\u00c0-\uFFFF\-]|\\.)+)['"]*\]/,ATTR:/\[\s*((?:[\w\u00c0-\uFFFF\-]|\\.)+)\s*(?:(\S?=)\s*(['"]*)(.*?)\3|)\s*\]/,TAG:/^((?:[\w\u00c0-\uFFFF\*\-]|\\.)+)/,CHILD:/:(only|nth|last|first)-child(?:\((even|odd|[\dn+\-]*)\))?/,POS:/:(nth|eq|gt|lt|first|last|even|odd)(?:\((\d*)\))?(?=[^\-]|$)/,
PSEUDO:/:((?:[\w\u00c0-\uFFFF\-]|\\.)+)(?:\((['"]?)((?:\([^\)]+\)|[^\(\)]*)+)\2\))?/},leftMatch:{},attrMap:{"class":"className","for":"htmlFor"},attrHandle:{href:function(a){return a.getAttribute("href")}},relative:{"+":function(a,b){var c="string"===typeof b,d=c&&!/\W/.test(b),c=c&&!d;d&&(b=b.toLowerCase());for(var d=0,f=a.length,e;d<f;d++)if(e=a[d]){for(;(e=e.previousSibling)&&1!==e.nodeType;);a[d]=c||e&&e.nodeName.toLowerCase()===b?e||!1:e===b}c&&i.filter(b,a,!0)},">":function(a,b){var c="string"===
typeof b,d,f=0,e=a.length;if(c&&!/\W/.test(b))for(b=b.toLowerCase();f<e;f++){if(d=a[f])c=d.parentNode,a[f]=c.nodeName.toLowerCase()===b?c:!1}else{for(;f<e;f++)(d=a[f])&&(a[f]=c?d.parentNode:d.parentNode===b);c&&i.filter(b,a,!0)}},"":function(a,b,c){var d=u++,f=x,e;"string"===typeof b&&!/\W/.test(b)&&(e=b=b.toLowerCase(),f=w);f("parentNode",b,d,a,e,c)},"~":function(a,b,c){var d=u++,f=x,e;"string"===typeof b&&!/\W/.test(b)&&(e=b=b.toLowerCase(),f=w);f("previousSibling",b,d,a,e,c)}},find:{ID:function(a,
b,c){if("undefined"!==typeof b.getElementById&&!c)return(a=b.getElementById(a[1]))?[a]:[]},NAME:function(a,b){if("undefined"!==typeof b.getElementsByName){for(var c=[],d=b.getElementsByName(a[1]),f=0,e=d.length;f<e;f++)d[f].getAttribute("name")===a[1]&&c.push(d[f]);return 0===c.length?null:c}},TAG:function(a,b){return b.getElementsByTagName(a[1])}},preFilter:{CLASS:function(a,b,c,d,f,e){a=" "+a[1].replace(/\\/g,"")+" ";if(e)return a;for(var e=0,g;null!=(g=b[e]);e++)g&&(f^(g.className&&0<=(" "+g.className+
" ").replace(/[\t\n]/g," ").indexOf(a))?c||d.push(g):c&&(b[e]=!1));return!1},ID:function(a){return a[1].replace(/\\/g,"")},TAG:function(a){return a[1].toLowerCase()},CHILD:function(a){if("nth"===a[1]){var b=/(-?)(\d*)n((?:\+|-)?\d*)/.exec("even"===a[2]&&"2n"||"odd"===a[2]&&"2n+1"||!/\D/.test(a[2])&&"0n+"+a[2]||a[2]);a[2]=b[1]+(b[2]||1)-0;a[3]=b[3]-0}a[0]=u++;return a},ATTR:function(a,b,c,d,f,e){b=a[1].replace(/\\/g,"");!e&&g.attrMap[b]&&(a[1]=g.attrMap[b]);"~="===a[2]&&(a[4]=" "+a[4]+" ");return a},
PSEUDO:function(a,b,c,d,f){if("not"===a[1])if(1<(t.exec(a[3])||"").length||/^\w/.test(a[3]))a[3]=i(a[3],null,null,b);else return a=i.filter(a[3],b,c,1^f),c||d.push.apply(d,a),!1;else if(g.match.POS.test(a[0])||g.match.CHILD.test(a[0]))return!0;return a},POS:function(a){a.unshift(!0);return a}},filters:{enabled:function(a){return!1===a.disabled&&"hidden"!==a.type},disabled:function(a){return!0===a.disabled},checked:function(a){return!0===a.checked},selected:function(a){a.parentNode.selectedIndex;return!0===
a.selected},parent:function(a){return!!a.firstChild},empty:function(a){return!a.firstChild},has:function(a,b,c){return!!i(c[3],a).length},header:function(a){return/h\d/i.test(a.nodeName)},text:function(a){return"text"===a.type},radio:function(a){return"radio"===a.type},checkbox:function(a){return"checkbox"===a.type},file:function(a){return"file"===a.type},password:function(a){return"password"===a.type},submit:function(a){return"submit"===a.type},image:function(a){return"image"===a.type},reset:function(a){return"reset"===
a.type},button:function(a){return"button"===a.type||"button"===a.nodeName.toLowerCase()},input:function(a){return/input|select|textarea|button/i.test(a.nodeName)}},setFilters:{first:function(a,b){return 0===b},last:function(a,b,c,d){return b===d.length-1},even:function(a,b){return 0===b%2},odd:function(a,b){return 1===b%2},lt:function(a,b,c){return b<c[3]-0},gt:function(a,b,c){return b>c[3]-0},nth:function(a,b,c){return c[3]-0===b},eq:function(a,b,c){return c[3]-0===b}},filter:{PSEUDO:function(a,
b,c,d){var f=b[1],e=g.filters[f];if(e)return e(a,c,b,d);if("contains"===f)return 0<=(a.textContent||a.innerText||i.getText([a])||"").indexOf(b[3]);if("not"===f){b=b[3];c=0;for(d=b.length;c<d;c++)if(b[c]===a)return!1;return!0}i.error("Syntax error, unrecognized expression: "+f)},CHILD:function(a,b){var c=b[1],d=a;switch(c){case "only":case "first":for(;d=d.previousSibling;)if(1===d.nodeType)return!1;if("first"===c)return!0;d=a;case "last":for(;d=d.nextSibling;)if(1===d.nodeType)return!1;return!0;case "nth":var c=
b[2],f=b[3];if(1===c&&0===f)return!0;var e=b[0],g=a.parentNode;if(g&&(g.sizcache!==e||!a.nodeIndex)){for(var h=0,d=g.firstChild;d;d=d.nextSibling)1===d.nodeType&&(d.nodeIndex=++h);g.sizcache=e}d=a.nodeIndex-f;return 0===c?0===d:0===d%c&&0<=d/c}},ID:function(a,b){return 1===a.nodeType&&a.getAttribute("id")===b},TAG:function(a,b){return"*"===b&&1===a.nodeType||a.nodeName.toLowerCase()===b},CLASS:function(a,b){return-1<(" "+(a.className||a.getAttribute("class"))+" ").indexOf(b)},ATTR:function(a,b){var c=
b[1],c=g.attrHandle[c]?g.attrHandle[c](a):null!=a[c]?a[c]:a.getAttribute(c),d=c+"",f=b[2],e=b[4];return null==c?"!="===f:"="===f?d===e:"*="===f?0<=d.indexOf(e):"~="===f?0<=(" "+d+" ").indexOf(e):!e?d&&!1!==c:"!="===f?d!==e:"^="===f?0===d.indexOf(e):"$="===f?d.substr(d.length-e.length)===e:"|="===f?d===e||d.substr(0,e.length+1)===e+"-":!1},POS:function(a,b,c,d){var f=g.setFilters[b[2]];if(f)return f(a,c,b,d)}}},B=g.match.POS,k=function(a,b){return"\\"+(b-0+1)},n;for(n in g.match)g.match[n]=RegExp(g.match[n].source+
/(?![^\[]*\])(?![^\(]*\))/.source),g.leftMatch[n]=RegExp(/(^(?:.|\r|\n)*?)/.source+g.match[n].source.replace(/\\(\d+)/g,k));var q=function(a,b){a=Array.prototype.slice.call(a,0);return b?(b.push.apply(b,a),b):a};try{Array.prototype.slice.call(document.documentElement.childNodes,0)[0].nodeType}catch(C){q=function(a,b){var c=b||[],d=0;if("[object Array]"===y.call(a))Array.prototype.push.apply(c,a);else if("number"===typeof a.length)for(var f=a.length;d<f;d++)c.push(a[d]);else for(;a[d];d++)c.push(a[d]);
return c}}var r;document.documentElement.compareDocumentPosition?r=function(a,b){if(!a.compareDocumentPosition||!b.compareDocumentPosition)return a==b&&(m=!0),a.compareDocumentPosition?-1:1;var c=a.compareDocumentPosition(b)&4?-1:a===b?0:1;0===c&&(m=!0);return c}:"sourceIndex"in document.documentElement?r=function(a,b){if(!a.sourceIndex||!b.sourceIndex)return a==b&&(m=!0),a.sourceIndex?-1:1;var c=a.sourceIndex-b.sourceIndex;0===c&&(m=!0);return c}:document.createRange&&(r=function(a,b){if(!a.ownerDocument||
!b.ownerDocument)return a==b&&(m=!0),a.ownerDocument?-1:1;var c=a.ownerDocument.createRange(),d=b.ownerDocument.createRange();c.setStart(a,0);c.setEnd(a,0);d.setStart(b,0);d.setEnd(b,0);c=c.compareBoundaryPoints(Range.START_TO_END,d);0===c&&(m=!0);return c});i.getText=function(a){for(var b="",c,d=0;a[d];d++)c=a[d],3===c.nodeType||4===c.nodeType?b+=c.nodeValue:8!==c.nodeType&&(b+=i.getText(c.childNodes));return b};k=document.createElement("div");n="script"+(new Date).getTime();k.innerHTML="<a name='"+
n+"'/>";var s=document.documentElement;s.insertBefore(k,s.firstChild);document.getElementById(n)&&(g.find.ID=function(a,b,c){if("undefined"!==typeof b.getElementById&&!c)return(b=b.getElementById(a[1]))?b.id===a[1]||"undefined"!==typeof b.getAttributeNode&&b.getAttributeNode("id").nodeValue===a[1]?[b]:void 0:[]},g.filter.ID=function(a,b){var c="undefined"!==typeof a.getAttributeNode&&a.getAttributeNode("id");return 1===a.nodeType&&c&&c.nodeValue===b});s.removeChild(k);s=k=null;k=document.createElement("div");
k.appendChild(document.createComment(""));0<k.getElementsByTagName("*").length&&(g.find.TAG=function(a,b){var c=b.getElementsByTagName(a[1]);if(a[1]==="*"){for(var d=[],f=0;c[f];f++)c[f].nodeType===1&&d.push(c[f]);c=d}return c});k.innerHTML="<a href='#'></a>";k.firstChild&&("undefined"!==typeof k.firstChild.getAttribute&&"#"!==k.firstChild.getAttribute("href"))&&(g.attrHandle.href=function(a){return a.getAttribute("href",2)});k=null;if(document.querySelectorAll){var v=i,k=document.createElement("div");
k.innerHTML="<p class='TEST'></p>";if(!(k.querySelectorAll&&0===k.querySelectorAll(".TEST").length)){var i=function(a,b,c,d){b=b||document;if(!d&&b.nodeType===9&&!i.isXML(b))try{return q(b.querySelectorAll(a),c)}catch(f){}return v(a,b,c,d)},o;for(o in v)i[o]=v[o];k=null}}o=document.createElement("div");o.innerHTML="<div class='test e'></div><div class='test'></div>";o.getElementsByClassName&&0!==o.getElementsByClassName("e").length&&(o.lastChild.className="e",1!==o.getElementsByClassName("e").length&&
(g.order.splice(1,0,"CLASS"),g.find.CLASS=function(a,b,c){if(typeof b.getElementsByClassName!=="undefined"&&!c)return b.getElementsByClassName(a[1])},o=null));i.contains=document.compareDocumentPosition?function(a,b){return!!(a.compareDocumentPosition(b)&16)}:function(a,b){return a!==b&&(a.contains?a.contains(b):true)};i.isXML=function(a){return(a=(a?a.ownerDocument||a:0).documentElement)?a.nodeName!=="HTML":false};var A=function(a,b){for(var c=[],d="",f,e=b.nodeType?[b]:b;f=g.match.PSEUDO.exec(a);){d=
d+f[0];a=a.replace(g.match.PSEUDO,"")}a=g.relative[a]?a+"*":a;f=0;for(var j=e.length;f<j;f++)i(a,e[f],c);return i.filter(d,c)};window.tinymce.dom.Sizzle=i})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/EventUtils.js' */
(function(d){var h=d.each,j=d.DOM,l=d.isIE,k;d.create("tinymce.dom.EventUtils",{EventUtils:function(){this.inits=[];this.events=[]},add:function(a,b,c,g){var e,f=this,m=f.events,i;if(b instanceof Array)return i=[],h(b,function(b){i.push(f.add(a,b,c,g))}),i;if(a&&a.hasOwnProperty&&a instanceof Array)return i=[],h(a,function(a){a=j.get(a);i.push(f.add(a,b,c,g))}),i;if(a=j.get(a)){e=function(a){if(!f.disabled){if((a=a||window.event)&&l&&!d.isIE11)a.target||(a.target=a.srcElement),d.extend(a,f._stoppers);
return!g?c(a):c.call(g,a)}};if("unload"==b)return d.unloads.unshift({func:e}),e;if("init"==b)return f.domLoaded?e():f.inits.push(e),e;m.push({obj:a,name:b,func:c,cfunc:e,scope:g});f._add(a,b,e);return c}},remove:function(a,b,c){var g=this,e=g.events,f=!1,d;if(a&&a.hasOwnProperty&&a instanceof Array)return d=[],h(a,function(a){a=j.get(a);d.push(g.remove(a,b,c))}),d;a=j.get(a);h(e,function(d,h){if(d.obj==a&&d.name==b&&(!c||d.func==c||d.cfunc==c))return e.splice(h,1),g._remove(a,b,d.cfunc),f=!0,!1});
return f},clear:function(a){var b=this.events,c,d;if(a){a=j.get(a);for(c=b.length-1;0<=c;c--)d=b[c],d.obj===a&&(this._remove(d.obj,d.name,d.cfunc),d.obj=d.cfunc=null,b.splice(c,1))}},cancel:function(a){if(!a)return!1;this.stop(a);return this.prevent(a)},stop:function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;return!1},prevent:function(a){a.preventDefault?a.preventDefault():a.returnValue=!1;return!1},destroy:function(){var a=this;h(a.events,function(b){a._remove(b.obj,b.name,b.cfunc);
b.obj=b.cfunc=null});a.events=[];a=null},_add:function(a,b,c){a.attachEvent?a.attachEvent("on"+b,c):a.addEventListener?a.addEventListener(b,c,!1):a["on"+b]=c},_remove:function(a,b,c){if(a)try{a.detachEvent?a.detachEvent("on"+b,c):a.removeEventListener?a.removeEventListener(b,c,!1):a["on"+b]=null}catch(d){}},_pageInit:function(){this.domLoaded||(this.domLoaded=!0,h(this.inits,function(a){a()}),this.inits=[])},_wait:function(a){var b=this,c=a.document;a.tinyMCE_GZ&&tinyMCE_GZ.loaded?b.domLoaded=1:"complete"===
c.readyState?b._pageInit(a):(c.attachEvent?(c.attachEvent("onreadystatechange",function(){"complete"===c.readyState&&(c.detachEvent("onreadystatechange",arguments.callee),b._pageInit(a))}),c.documentElement.doScroll&&a==a.top&&function(){if(!b.domLoaded){try{c.documentElement.doScroll("left")}catch(d){setTimeout(arguments.callee,0);return}b._pageInit(a)}}()):c.addEventListener&&b._add(a,"DOMContentLoaded",function(){b._pageInit(a)}),b._add(a,"load",function(){b._pageInit(a)}))},_stoppers:{preventDefault:function(){this.returnValue=
!1},stopPropagation:function(){this.cancelBubble=!0}}});k=d.dom.Event=new d.dom.EventUtils;k._wait(window);d.addUnload(function(){k.destroy()})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/Element.js' */
(function(e){e.dom.Element=function(h,g){var a=this,c;a.settings=g=g||{};a.id=h;a.dom=c=g.dom||e.DOM;e.isIE||c.get(a.id);e.each("getPos,getRect,getParent,add,setStyle,getStyle,setStyles,setAttrib,setAttribs,getAttrib,addClass,removeClass,hasClass,getOuterHTML,setOuterHTML,remove,show,hide,isHidden,setHTML,get".split(/,/),function(b){a[b]=function(){var f=[h],d;for(d=0;d<arguments.length;d++)f.push(arguments[d]);f=c[b].apply(c,f);a.update(b);return f}});e.extend(a,{on:function(b,f,c){return e.dom.Event.add(a.id,
b,f,c)},getXY:function(){return{x:parseInt(a.getStyle("left")),y:parseInt(a.getStyle("top"))}},getSize:function(){var b=c.get(a.id);return{w:parseInt(a.getStyle("width")||b.clientWidth),h:parseInt(a.getStyle("height")||b.clientHeight)}},moveTo:function(b,c){a.setStyles({left:b,top:c})},moveBy:function(b,c){var d=a.getXY();a.moveTo(d.x+b,d.y+c)},resizeTo:function(b,c){a.setStyles({width:b,height:c})},resizeBy:function(b,c){var d=a.getSize();a.resizeTo(d.w+b,d.h+c)},update:function(b){e.isIE6&&g.blocker&&
(b=b||"",0===b.indexOf("get")||(0===b.indexOf("has")||0===b.indexOf("is"))||("remove"==b?c.remove(a.blocker):(a.blocker?b=c.get(a.blocker):(a.blocker=c.uniqueId(),b=c.add(g.container||c.getRoot(),"iframe",{id:a.blocker,style:"position:absolute;",frameBorder:0,src:'javascript:""'}),c.setStyle(b,"opacity",0)),c.setStyles(b,{left:a.getStyle("left",1),top:a.getStyle("top",1),width:a.getStyle("width",1),height:a.getStyle("height",1),display:a.getStyle("display",1),zIndex:parseInt(a.getStyle("zIndex",1)||
0)-1}))))}})}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/Selection.js' */
(function(k){var n=k.is,o=k.isIE,m=k.each;k.create("tinymce.dom.Selection",{Selection:function(a,b,c){var d=this;d.dom=a;d.win=b;d.serializer=c;m(["onBeforeSetContent","onBeforeGetContent","onSetContent","onGetContent"],function(a){d[a]=new k.util.Dispatcher(d)});d.win.getSelection||(d.tridentSel=new k.dom.TridentSelection(d));k.isIE&&a.boxModel&&this._fixIESelection();k.addUnload(d.destroy,d)},setCursorLocation:function(a,b){var c=this.dom.createRng();c.setStart(a,b);c.setEnd(a,b);this.setRng(c);
this.collapse(!1)},getContent:function(a){var b=this.getRng(),c=this.dom.create("body"),d=this.getSel(),f,e,a=a||{};f=e="";a.get=!0;a.format=a.format||"html";a.forced_root_block="";this.onBeforeGetContent.dispatch(this,a);if("text"==a.format)return this.isCollapsed()?"":b.text||(d.toString?d.toString():"");b.cloneContents?(b=b.cloneContents())&&c.appendChild(b):n(b.item)||n(b.htmlText)?(c.innerHTML="<br>"+(b.item?b.item(0).outerHTML:b.htmlText),c.removeChild(c.firstChild)):c.innerHTML=b.toString();
/^\s/.test(c.innerHTML)&&(f=" ");/\s+$/.test(c.innerHTML)&&(e=" ");a.getInner=!0;a.content=this.isCollapsed()?"":f+this.serializer.serialize(c,a)+e;this.onGetContent.dispatch(this,a);return a.content},setContent:function(a,b){var c=this.getRng(),d,f=this.win.document,e,b=b||{format:"html"};b.set=!0;b.content=a;b.no_events||this.onBeforeSetContent.dispatch(this,b);a=b.content;if(c.insertNode){a+='<span id="__caret">_</span>';if(c.startContainer==f&&c.endContainer==f)f.body.innerHTML=a;else if(c.deleteContents(),
0==f.body.childNodes.length)f.body.innerHTML=a;else if(c.createContextualFragment)try{c.insertNode(c.createContextualFragment(a))}catch(g){if(0===c.startOffset&&0===c.endOffset&&0===c.startContainer.children.length){d=f.createDocumentFragment();e=f.createElement("div");e.innerHTML=a;e=e.children[0];for(d.appendChild(e.cloneNode());e=e.nextSibling;)d.appendChild(e.cloneNode());c.startContainer.parentNode.insertBefore(d,c.startContainer)}else throw g;}else d=f.createDocumentFragment(),e=f.createElement("div"),
d.appendChild(e),e.outerHTML=a,c.insertNode(d);d=this.dom.get("__caret");c=f.createRange();c.setStartBefore(d);c.setEndBefore(d);this.setRng(c);this.dom.remove("__caret");try{this.setRng(c)}catch(i){}}else(c.item&&(f.execCommand("Delete",!1,null),c=this.getRng()),/^\s+/.test(a))?(c.pasteHTML('<span id="__mce_tmp">_</span>'+a),this.dom.remove("__mce_tmp")):c.pasteHTML(a);b.no_events||this.onSetContent.dispatch(this,b)},getStart:function(){var a=this.getRng(),b,c;if(a.duplicate||a.item){if(a.item)return a.item(0);
b=a.duplicate();b.collapse(1);b=b.parentElement();for(a=c=a.parentElement();c=c.parentNode;)if(c==b){b=a;break}return b}b=a.startContainer;1==b.nodeType&&b.hasChildNodes()&&(b=b.childNodes[Math.min(b.childNodes.length-1,a.startOffset)]);return b&&3==b.nodeType?b.parentNode:b},getEnd:function(){var a=this.getRng(),b;if(a.duplicate||a.item){if(a.item)return a.item(0);a=a.duplicate();a.collapse(0);return(b=a.parentElement())&&"BODY"==b.nodeName?b.lastChild||b:b}b=a.endContainer;a=a.endOffset;1==b.nodeType&&
b.hasChildNodes()&&(b=b.childNodes[0<a?a-1:a]);return b&&3==b.nodeType?b.parentNode:b},getBookmark:function(a,b){function c(a,b){var c=0;m(f.select(a),function(a,d){a==b&&(c=d)});return c}var d=this,f=d.dom,e,g,i,j,h;if(2==a){if(d.tridentSel)return d.tridentSel.getBookmark(a);e=function(a,c){var f=a[c?"startContainer":"endContainer"],e=a[c?"startOffset":"endOffset"],g=[],h,i=0;if(3==f.nodeType){if(b)for(h=f.previousSibling;h&&3==h.nodeType;h=h.previousSibling)e+=h.nodeValue.length;g.push(e)}else h=
f.childNodes,e>=h.length&&h.length&&(i=1,e=Math.max(0,h.length-1)),g.push(d.dom.nodeIndex(h[e],b)+i);for(;f&&f!=k;f=f.parentNode)g.push(d.dom.nodeIndex(f,b));return g};i=d.getRng(!0);var k=f.doc.body;j={};j.start=e(i,!0);d.isCollapsed()||(j.end=e(i));return j}if(a)return{rng:d.getRng()};e=d.getRng();i=f.uniqueId();j=tinyMCE.activeEditor.selection.isCollapsed();if(e.duplicate||e.item){if(e.item)return h=e.item(0),g=h.nodeName,{name:g,index:c(g,h)};g=e.duplicate();try{e.collapse(),e.pasteHTML('<span data-mce-type="bookmark" id="'+
i+'_start" style="overflow:hidden;line-height:0px"></span>'),j||(g.collapse(!1),e.moveToElementText(g.parentElement()),0==e.compareEndPoints("StartToEnd",g)&&g.move("character",-1),g.pasteHTML('<span data-mce-type="bookmark" id="'+i+'_end" style="overflow:hidden;line-height:0px"></span>'))}catch(p){return null}}else{h=d.getNode();g=h.nodeName;if("IMG"==g)return{name:g,index:c(g,h)};g=e.cloneRange();j||(g.collapse(!1),g.insertNode(f.create("span",{"data-mce-type":"bookmark",id:i+"_end",style:"overflow:hidden;line-height:0px"},
"")));e.collapse(!0);e.insertNode(f.create("span",{"data-mce-type":"bookmark",id:i+"_start",style:"overflow:hidden;line-height:0px"},""))}d.moveToBookmark({id:i,keep:1});return{id:i}},moveToBookmark:function(a){var b=this.dom,c,d,f,e,g,i;if(a)if(a.start){c=b.createRng();d=b.doc.body;var j=function(b){var f=a[b?"start":"end"],e,g,h;if(f){h=f[0];g=d;for(e=f.length-1;1<=e;e--){g=g.childNodes;if(f[e]>g.length-1)return;g=g[f[e]]}3===g.nodeType&&(h=Math.min(f[0],g.nodeValue.length));1===g.nodeType&&(h=
Math.min(f[0],g.childNodes.length));b?c.setStart(g,h):c.setEnd(g,h)}return!0};if(this.tridentSel)return this.tridentSel.moveToBookmark(a);j(!0)&&j()&&this.setRng(c)}else if(a.id){var j=function(c){var d=b.get(a.id+"_"+c),h,j,l;l=a.keep;if(d&&(h=d.parentNode,"start"==c?(l?(h=d.firstChild,j=1):j=b.nodeIndex(d),f=e=h,g=i=j):(l?(h=d.firstChild,j=1):j=b.nodeIndex(d),e=h,i=j),!l)){l=d.previousSibling;h=d.nextSibling;for(m(k.grep(d.childNodes),function(a){if(a.nodeType==3)a.nodeValue=a.nodeValue.replace(/\uFEFF/g,
"")});d=b.get(a.id+"_"+c);)b.remove(d,1);l&&(h&&l.nodeType==h.nodeType&&3==l.nodeType&&!k.isOpera)&&(j=l.nodeValue.length,l.appendData(h.nodeValue),b.remove(h),"start"==c?(f=e=l,g=i=j):(e=l,i=j))}},h=function(a){b.isBlock(a)&&!a.innerHTML&&(a.innerHTML=!o?'<br data-mce-bogus="1" />':" ");return a};j("start");j("end");f&&(c=b.createRng(),c.setStart(h(f),g),c.setEnd(h(e),i),this.setRng(c))}else a.name?this.select(b.select(a.name)[a.index]):a.rng&&this.setRng(a.rng)},select:function(a,b){var c=this.dom,
d=c.createRng();a&&(c=c.nodeIndex(a),d.setStart(a.parentNode,c),d.setEnd(a.parentNode,c+1),b&&(c=function(a,c){var b=new k.dom.TreeWalker(a,a);do{if(3==a.nodeType&&0!=k.trim(a.nodeValue).length){c?d.setStart(a,0):d.setEnd(a,a.nodeValue.length);break}if("BR"==a.nodeName){c?d.setStartBefore(a):d.setEndBefore(a);break}}while(a=c?b.next():b.prev())},c(a,1),c(a)),this.setRng(d));return a},isCollapsed:function(){var a=this.getRng(),b=this.getSel();return!a||a.item?!1:a.compareEndPoints?0===a.compareEndPoints("StartToEnd",
a):!b||a.collapsed},collapse:function(a){var b=this.getRng(),c;b.item&&(c=b.item(0),b=this.win.document.body.createTextRange(),b.moveToElementText(c));b.collapse(!!a);this.setRng(b)},getSel:function(){var a=this.win;return a.getSelection?a.getSelection():a.document.selection},getRng:function(a){var b,c,d,f=this.win.document;if(a&&this.tridentSel)return this.tridentSel.getRangeAt(0);try{if(b=this.getSel())c=0<b.rangeCount?b.getRangeAt(0):b.createRange?b.createRange():f.createRange()}catch(e){}try{k.isIE&&
(c&&c.setStart&&f.selection&&f.selection.createRange().item)&&(d=f.selection.createRange().item(0),c=f.createRange(),c.setStartBefore(d),c.setEndAfter(d))}catch(g){}c||(c=f.createRange?f.createRange():f.body.createTextRange());this.selectedRange&&this.explicitRange&&(0===c.compareBoundaryPoints(c.START_TO_START,this.selectedRange)&&0===c.compareBoundaryPoints(c.END_TO_END,this.selectedRange)?c=this.explicitRange:this.explicitRange=this.selectedRange=null);return c},setRng:function(a){var b;if(this.tridentSel){if(a.cloneRange)try{this.tridentSel.addRange(a);
return}catch(c){AJS.logError("Exception occurred at tinymce setRng() - tridentSel.addRange(): "+c)}try{a.select()}catch(d){AJS.logError("Exception occurred at tinymce setRng() - select(): "+d)}}else if(b=this.getSel()){this.explicitRange=a;try{b.removeAllRanges()}catch(f){AJS.logError("Exception occurred at tinymce setRng() - removeAllRanges(): "+f)}try{b.addRange(a)}catch(e){AJS.logError("Exception occurred at tinymce setRng() - addRange(): "+e)}this.selectedRange=0<b.rangeCount?b.getRangeAt(0):
null}},setNode:function(a){this.setContent(this.dom.getOuterHTML(a));return a},getNode:function(){var a=this.getRng();this.getSel();var b,c=a.startContainer,d=a.endContainer;if(!a)return this.dom.getRoot();if(a.setStart){b=a.commonAncestorContainer;if(!a.collapsed&&(a.startContainer==a.endContainer&&2>a.endOffset-a.startOffset&&a.startContainer.hasChildNodes()&&(b=a.startContainer.childNodes[a.startOffset]),3===c.nodeType&&3===d.nodeType)){var f=function(a,c){for(var b=a;a&&3===a.nodeType&&0===a.length;)a=
c?a.nextSibling:a.previousSibling;return a||b},c=c.length===a.startOffset?f(c.nextSibling,!0):c.parentNode,d=0===a.endOffset?f(d.previousSibling,!1):d.parentNode;if(c&&c===d)return c}return b&&3==b.nodeType?b.parentNode:b}return a.item?a.item(0):a.parentElement()},getSelectedBlocks:function(a,b){var c=this.dom,d,f,e,g=[];d=c.getParent(a||this.getStart(),c.isBlock);f=c.getParent(b||this.getEnd(),c.isBlock);d&&g.push(d);if(d&&f&&d!=f){e=d;for(var i=new k.dom.TreeWalker(d,c.getRoot());(e=i.next())&&
e!=f;)c.isBlock(e)&&g.push(e)}f&&d!=f&&g.push(f);return g},normalize:function(){function a(a){var e,g,i,j=b.dom;i=j.getRoot();var h;e=c[(a?"start":"end")+"Container"];g=c[(a?"start":"end")+"Offset"];9===e.nodeType&&(e=e.body,g=0);if(e===i&&e.hasChildNodes()){e=e.childNodes[Math.min(!a&&0<g?g-1:g,e.childNodes.length-1)];g=0;if("TABLE"===e.nodeName)return;if(e.hasChildNodes()){h=e;i=new k.dom.TreeWalker(e,i);do{if(3===h.nodeType){g=a?0:h.nodeValue.length-1;e=h;d=!0;break}if(/^(BR|IMG)$/.test(h.nodeName)){g=
j.nodeIndex(h);e=h.parentNode;"IMG"==h.nodeName&&!a&&g++;d=!0;break}}while(h=a?i.next():i.prev())}}if(d)c["set"+(a?"Start":"End")](e,g)}var b=this,c,d;k.isIE||(c=b.getRng(),a(!0),c.collapsed&&d&&a(),d&&b.setRng(c))},destroy:function(a){this.win=null;a||k.removeUnload(this.destroy)},_fixIESelection:function(){function a(a,c){var b=e.createTextRange();try{b.moveToPoint(a,c)}catch(d){b=null}return b}function b(b){if(b.button){if(b=a(b.x,b.y))0<b.compareEndPoints("StartToStart",i)?b.setEndPoint("StartToStart",
i):b.setEndPoint("EndToEnd",i),b.select()}else c()}function c(){var a=f.selection?f.selection.createRange():tinyMCE.activeEditor.getBody().createTextRange();i&&(!a.item&&0===a.compareEndPoints("StartToEnd",a))&&i.select();d.unbind(f,"mouseup",c);d.unbind(f,"mousemove",b);i=g=0}var d=this.dom,f=d.doc,e=f.body,g,i,j;f.documentElement.unselectable=!0;d.bind(f,["mousedown","contextmenu"],function(e){if("HTML"===e.target.nodeName&&(g&&c(),j=f.documentElement,!(j.scrollHeight>j.clientHeight)&&(g=1,i=a(e.x,
e.y))))d.bind(f,"mouseup",c),d.bind(f,"mousemove",b),d.win.focus(),i.select()})}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/Serializer.js' */
(function(h){h.dom.Serializer=function(g,j,i){var k,l,m=h.each,f;g.apply_source_formatting||(g.indent=!1);j=j||h.DOM;i=i||new h.html.Schema(g);g.entity_encoding=g.entity_encoding||"named";g.remove_trailing_brs="remove_trailing_brs"in g?g.remove_trailing_brs:!0;k=new h.util.Dispatcher(self);l=new h.util.Dispatcher(self);f=new h.html.DomParser(g,i);f.addAttributeFilter("src,href,style",function(c,a){for(var b=c.length,d,e,f="data-mce-"+a,h=g.url_converter,i=g.url_converter_scope;b--;){d=c[b];e=d.attributes.map[f];
if(e!==void 0){d.attr(a,e.length>0?e:null);d.attr(f,null)}else{e=d.attributes.map[a];a==="style"?e=j.serializeStyle(j.parseStyle(e),d.name):h&&(e=h.call(i,e,a,d.name));d.attr(a,e.length>0?e:null)}}});f.addAttributeFilter("class",function(c){for(var a=c.length,b,d;a--;){b=c[a];d=b.attr("class").replace(/\s*mce(Item\w+|Selected)\s*/g,"");b.attr("class",d.length>0?d:null)}});f.addAttributeFilter("data-mce-type",function(c,a,b){for(var a=c.length,d;a--;){d=c[a];d.attributes.map["data-mce-type"]==="bookmark"&&
!b.cleanup&&d.remove()}});f.addNodeFilter("script,style",function(c,a){function b(a){return a.replace(/(<\!--\[CDATA\[|\]\]--\>)/g,"\n").replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<\!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<\!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<\!--|\/\*\s*<\!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(--\>)?|\s*\/\/\s*\]\]>(--\>)?|\/\/\s*(--\>)?|\]\]>|\/\*\s*--\>\s*\*\/|\s*--\>\s*)\s*$/g,"")}for(var d=c.length,e,f;d--;){e=c[d];f=e.firstChild?e.firstChild.value:
"";if(a==="script"){e.attr("type",(e.attr("type")||"text/javascript").replace(/^mce\-/,""));if(f.length>0)e.firstChild.value="// <![CDATA[\n"+b(f)+"\n// ]]\>"}else if(f.length>0)e.firstChild.value="<\!--\n"+b(f)+"\n--\>"}});f.addNodeFilter("#comment",function(c){for(var a=c.length,b;a--;){b=c[a];if(b.value.indexOf("[CDATA[")===0){b.name="#cdata";b.type=4;b.value=b.value.replace(/^\[CDATA\[|\]\]$/g,"")}else if(b.value.indexOf("mce:protected ")===0){b.name="#text";b.type=3;b.raw=true;b.value=unescape(b.value).substr(14)}}});
f.addNodeFilter("xml:namespace,input",function(c,a){for(var b=c.length,d;b--;){d=c[b];d.type===7?d.remove():d.type===1&&a==="input"&&!("type"in d.attributes.map)&&d.attr("type","text")}});g.fix_list_elements&&f.addNodeFilter("ul,ol",function(c){for(var a=c.length,b,d;a--;){b=c[a];d=b.parent;(d.name==="ul"||d.name==="ol")&&b.prev&&b.prev.name==="li"&&b.prev.append(b)}});f.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style",function(c,a){for(var b=c.length;b--;)c[b].attr(a,null)});return{schema:i,
addNodeFilter:f.addNodeFilter,addAttributeFilter:f.addAttributeFilter,onPreProcess:k,onPostProcess:l,serialize:function(c,a){var b,d,e,c=c.cloneNode(true);b=c.ownerDocument.implementation;if(b.createHTMLDocument){d=b.createHTMLDocument("");m(c.nodeName=="BODY"?c.childNodes:[c],function(a){d.body.appendChild(d.importNode(a,true))});c=c.nodeName!="BODY"?d.body.firstChild:d.body;e=j.doc;j.doc=d}a=a||{};a.format=a.format||"html";if(!a.no_events){a.node=c;k.dispatch(self,a)}b=new h.html.Serializer(g,i);
a.content=b.serialize(f.parse(a.getInner?c.innerHTML:h.trim(j.getOuterHTML(c),a),a));if(!a.cleanup)a.content=a.content.replace(/\uFEFF|\u200B/g,"");a.no_events||l.dispatch(self,a);if(e)j.doc=e;a.node=null;return a.content},addRules:function(c){i.addValidElements(c)},setRules:function(c){i.setValidElements(c)}}}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/ScriptLoader.js' */
(function(a){a.dom.ScriptLoader=function(){var b={},h=[],c={},d=[],j=0;this.isDone=function(a){return 2==b[a]};this.markDone=function(a){b[a]=2};this.add=this.load=function(a,f,d){void 0==b[a]&&(h.push(a),b[a]=0);f&&(c[a]||(c[a]=[]),c[a].push({func:f,scope:d||this}))};this.loadQueue=function(a,b){this.loadScripts(h,a,b)};this.loadScripts=function(h,f,n){function m(b){a.each(c[b],function(a){a.func.call(a.scope)});c[b]=void 0}var k;d.push({func:f,scope:n||this});k=function(){var c=a.grep(h);h.length=
0;a.each(c,function(g){if(2==b[g])m(g);else if(1!=b[g]){b[g]=1;j++;a:{var c=function(){d.remove(l);e&&(e.onreadystatechange=e.onload=e=null);b[g]=2;j--;m(g);k()},h=function(){AJS.log("Failed to load: "+g)},d=a.DOM,e,i,f,l;l=d.uniqueId();if(a.isIE6&&(i=new a.util.URI(g),f=location,i.host==f.hostname&&i.port==f.port&&i.protocol+":"==f.protocol&&"file"!=i.protocol.toLowerCase())){a.util.XHR.send({url:a._addVer(i.getURI()),success:function(a){var b=d.create("script",{type:"text/javascript"});b.text=a;
document.getElementsByTagName("head")[0].appendChild(b);d.remove(b);c()},error:h});break a}e=d.create("script",{id:l,type:"text/javascript",src:a._addVer(g)});a.isIE||(e.onload=c);e.onerror=h;a.isOpera||(e.onreadystatechange=function(){var a=e.readyState;(a=="complete"||a=="loaded")&&c()});(document.getElementsByTagName("head")[0]||document.body).appendChild(e)}}});j||(a.each(d,function(a){a.func.call(a.scope)}),d.length=0)};k()}};a.ScriptLoader=new a.dom.ScriptLoader})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/TreeWalker.js' */
tinymce.dom.TreeWalker=function(f,e){function d(a,c,b,d){if(a){if(!d&&a[c])return a[c];if(a!=e){if(c=a[b])return c;for(a=a.parentNode;a&&a!=e;a=a.parentNode)if(c=a[b])return c}}}var b=f;this.current=function(){return b};this.next=function(a){return b=d(b,"firstChild","nextSibling",a)};this.prev=function(a){return b=d(b,"lastChild","previousSibling",a)}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/dom/RangeUtils.js' */
(function(l){l.dom.RangeUtils=function(c){this.walk=function(a,d){function e(a){var b;b=a[0];3===b.nodeType&&(b===g&&n>=b.nodeValue.length)&&a.splice(0,1);b=a[a.length-1];0===o&&(0<a.length&&b===f&&3===b.nodeType)&&a.splice(a.length-1,1);return a}function p(a,b,d){for(var e=[];a&&a!=d;a=a[b])e.push(a);return e}function q(a,b){do{if(a.parentNode==b)return a;a=a.parentNode}while(a)}function k(a,g,f){var c=f?"nextSibling":"previousSibling";b=a;for(m=b.parentNode;b&&b!=g;b=m)m=b.parentNode,j=p(b==a?b:
b[c],c),j.length&&(f||j.reverse(),d(e(j)))}var g=a.startContainer,n=a.startOffset,f=a.endContainer,o=a.endOffset,h,i,b,m,j;i=c.select("td.mceSelected,th.mceSelected");if(0<i.length)l.each(i,function(a){d([a])});else{1==g.nodeType&&g.hasChildNodes()&&(g=g.childNodes[n]);1==f.nodeType&&f.hasChildNodes()&&(f=f.childNodes[Math.min(o-1,f.childNodes.length-1)]);if(g==f)return d(e([g]));h=c.findCommonAncestor(g,f);for(b=g;b;b=b.parentNode){if(b===f)return k(g,h,!0);if(b===h)break}for(b=f;b;b=b.parentNode){if(b===
g)return k(f,h);if(b===h)break}i=q(g,h)||g;h=q(f,h)||f;k(g,i,!0);j=p(i==g?i:i.nextSibling,"nextSibling",h==f?h.nextSibling:h);j.length&&d(e(j));k(f,h)}};this.split=function(a){var d=a.startContainer,e=a.startOffset,c=a.endContainer,a=a.endOffset;if(d==c&&3==d.nodeType)0<e&&e<d.nodeValue.length&&(c=d.splitText(e),d=c.previousSibling,a>e?(d=c=c.splitText(a-e).previousSibling,a=c.nodeValue.length,e=0):a=0);else if(3==d.nodeType&&(0<e&&e<d.nodeValue.length)&&(d=d.splitText(e),e=0),3==c.nodeType&&0<a&&
a<c.nodeValue.length)c=c.splitText(a).previousSibling,a=c.nodeValue.length;return{startContainer:d,startOffset:e,endContainer:c,endOffset:a}}};l.dom.RangeUtils.compareRanges=function(c,a){if(c&&a)if(c.item||c.duplicate){if(c.item&&a.item&&c.item(0)===a.item(0)||c.isEqual&&a.isEqual&&a.isEqual(c))return!0}else return c.startContainer==a.startContainer&&c.startOffset==a.startOffset;return!1}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/KeyboardNavigation.js' */
(function(i){var n=i.dom.Event,o=i.each;i.create("tinymce.ui.KeyboardNavigation",{KeyboardNavigation:function(d,a){var c=this,e=d.root,f=d.items,p=d.enableUpDown,q=d.enableLeftRight||!d.enableUpDown,r=d.excludeFromTabOrder,j,k,l,m,g,a=a||i.DOM;j=function(a){g=a.target.id};k=function(b){a.setAttrib(b.target.id,"tabindex","-1")};m=function(){var b=a.get(g);a.setAttrib(b,"tabindex","0");b.focus()};c.focus=function(){a.get(g).focus()};c.destroy=function(){o(f,function(b){a.unbind(a.get(b.id),"focus",
j);a.unbind(a.get(b.id),"blur",k)});a.unbind(a.get(e),"focus",m);a.unbind(a.get(e),"keydown",l);f=a=e=c.focus=j=k=l=m=null;c.destroy=function(){}};c.moveFocus=function(b,c){var h=-1,e;if(g){o(f,function(a,b){if(a.id===g)return h=b,!1});h+=b;0>h?h=f.length-1:h>=f.length&&(h=0);e=f[h];a.setAttrib(g,"tabindex","-1");a.setAttrib(e.id,"tabindex","0");a.get(e.id).focus();if(d.actOnFocus)d.onAction(e.id);c&&n.cancel(c)}};l=function(a){switch(a.keyCode){case 37:q&&c.moveFocus(-1);break;case 39:q&&c.moveFocus(1);
break;case 38:p&&c.moveFocus(-1);break;case 40:p&&c.moveFocus(1);break;case 27:d.onCancel&&(d.onCancel(),n.cancel(a));break;case 14:case 13:case 32:d.onAction&&(d.onAction(g),n.cancel(a))}};o(f,function(b,d){var c;b.id||(b.id=a.uniqueId("_mce_item_"));r?(a.bind(b.id,"blur",k),c="-1"):c=0===d?"0":"-1";a.setAttrib(b.id,"tabindex",c);a.bind(a.get(b.id),"focus",j)});f[0]&&(g=f[0].id);a.setAttrib(e,"tabindex","-1");a.bind(a.get(e),"focus",m);a.bind(a.get(e),"keydown",l)}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/Control.js' */
(function(c){var b=c.DOM,e=c.is;c.create("tinymce.ui.Control",{Control:function(a,b,d){this.id=a;this.settings=b=b||{};this.rendered=!1;this.onRender=new c.util.Dispatcher(this);this.classPrefix="";this.scope=b.scope||this;this.active=this.disabled=0;this.editor=d},setAriaProperty:function(a,c){var d=b.get(this.id+"_aria")||b.get(this.id);d&&b.setAttrib(d,"aria-"+a,!!c)},focus:function(){b.get(this.id).focus()},setDisabled:function(a){a!=this.disabled&&(this.setAriaProperty("disabled",a),this.setState("Disabled",
a),this.setState("Enabled",!a),this.disabled=a)},isDisabled:function(){return this.disabled},setActive:function(a){a!=this.active&&(this.setState("Active",a),this.active=a,this.setAriaProperty("pressed",a))},isActive:function(){return this.active},setState:function(a,c){var d=b.get(this.id),a=this.classPrefix+a;c?b.addClass(d,a):b.removeClass(d,a)},isRendered:function(){return this.rendered},renderHTML:function(){},renderTo:function(a){b.setHTML(a,this.renderHTML())},postRender:function(){var a;e(this.disabled)&&
(a=this.disabled,this.disabled=-1,this.setDisabled(a));e(this.active)&&(a=this.active,this.active=-1,this.setActive(a))},remove:function(){b.remove(this.id);this.destroy()},destroy:function(){c.dom.Event.clear(this.id)}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/Container.js' */
tinymce.create("tinymce.ui.Container:tinymce.ui.Control",{Container:function(a,b,c){this.parent(a,b,c);this.controls=[];this.lookup={}},add:function(a){this.lookup[a.id]=a;this.controls.push(a);return a},get:function(a){return this.lookup[a]}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/Separator.js' */
tinymce.create("tinymce.ui.Separator:tinymce.ui.Control",{Separator:function(a,b){this.parent(a,b);this.classPrefix="mceSeparator";this.setDisabled(!0)},renderHTML:function(){return tinymce.DOM.createHTML("span",{"class":this.classPrefix,role:"separator","aria-orientation":"vertical",tabindex:"-1"})}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/MenuItem.js' */
(function(b){var c=b.is;b.create("tinymce.ui.MenuItem:tinymce.ui.Control",{MenuItem:function(a,b){this.parent(a,b);this.classPrefix="mceMenuItem"},setSelected:function(a){this.setState("Selected",a);this.setAriaProperty("checked",!!a);this.selected=a},isSelected:function(){return this.selected},postRender:function(){this.parent();c(this.selected)&&this.setSelected(this.selected)}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/Menu.js' */
(function(b){var d=b.DOM,c=b.walk;b.create("tinymce.ui.Menu:tinymce.ui.MenuItem",{Menu:function(a,e){this.parent(a,e);this.items={};this.collapsed=!1;this.menuCount=0;this.onAddItem=new b.util.Dispatcher(this)},expand:function(a){a&&c(this,function(a){a.expand&&a.expand()},"items",this);this.collapsed=!1},collapse:function(a){a&&c(this,function(a){a.collapse&&a.collapse()},"items",this);this.collapsed=!0},isCollapsed:function(){return this.collapsed},add:function(a){a.settings||(a=new b.ui.MenuItem(a.id||
d.uniqueId(),a));this.onAddItem.dispatch(this,a);return this.items[a.id]=a},addSeparator:function(){return this.add({separator:!0})},addMenu:function(a){a.collapse||(a=this.createMenu(a));this.menuCount++;return this.add(a)},hasMenus:function(){return 0!==this.menuCount},remove:function(a){delete this.items[a.id]},removeAll:function(){c(this,function(a){a.removeAll?a.removeAll():a.remove();a.destroy()},"items",this);this.items={}},createMenu:function(a){a=new b.ui.Menu(a.id||d.uniqueId(),a);a.onAddItem.add(this.onAddItem.dispatch,
this.onAddItem);return a}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/DropMenu.js' */
(function(j){var r=j.is,c=j.DOM,p=j.each,h=j.dom.Event,q=j.dom.Element;j.create("tinymce.ui.DropMenu:tinymce.ui.Menu",{DropMenu:function(a,b){b=b||{};b.container=b.container||c.doc.body;b.offset_x=b.offset_x||0;b.offset_y=b.offset_y||0;b.vp_offset_x=b.vp_offset_x||0;b.vp_offset_y=b.vp_offset_y||0;r(b.icons)&&!b.icons&&(b["class"]+=" mceNoIcons");this.parent(a,b);this.onShowMenu=new j.util.Dispatcher(this);this.onHideMenu=new j.util.Dispatcher(this);this.classPrefix="mceMenu"},createMenu:function(a){var b=
this.settings;a.container=a.container||b.container;a.parent=this;a.constrain=a.constrain||b.constrain;a["class"]=a["class"]||b["class"];a.vp_offset_x=a.vp_offset_x||b.vp_offset_x;a.vp_offset_y=a.vp_offset_y||b.vp_offset_y;a.keyboard_focus=b.keyboard_focus;a=new j.ui.DropMenu(a.id||c.uniqueId(),a);a.onAddItem.add(this.onAddItem.dispatch,this.onAddItem);return a},focus:function(){this.keyboardNav&&this.keyboardNav.focus()},update:function(){var a=this.settings,b=c.get("menu_"+this.id+"_tbl"),e=c.get("menu_"+
this.id+"_co"),d,f;d=a.max_width?Math.min(b.clientWidth,a.max_width):b.clientWidth;f=a.max_height?Math.min(b.clientHeight,a.max_height):b.clientHeight;c.boxModel?this.element.setStyles({width:d,height:f}):this.element.setStyles({width:d+2,height:f+2});a.max_width&&c.setStyle(e,"width",d);a.max_height&&(c.setStyle(e,"height",f),b.clientHeight<a.max_height&&c.setStyle(e,"overflow","hidden"))},showMenu:function(a,b,e){var d=this,f=d.settings,g,i=c.getViewPort(),l,m,n,k,o=d.classPrefix;d.collapse(1);
d.isMenuVisible||(d.rendered?g=c.get("menu_"+d.id):(g=c.add(d.settings.container,d.renderNode()),p(d.items,function(a){a.postRender()}),d.element=new q("menu_"+d.id,{blocker:1,container:f.container})),j.isOpera||c.setStyles(g,{left:-65535,top:-65535}),c.show(g),d.update(),a+=f.offset_x||0,b+=f.offset_y||0,i.w-=4,i.h-=4,f.constrain&&(l=g.clientWidth-2,m=g.clientHeight-2,n=i.x+i.w,i=i.y+i.h,a+f.vp_offset_x+l>n&&(a=e?e-l:Math.max(0,n-f.vp_offset_x-l)),b+f.vp_offset_y+m>i&&(b=Math.max(0,i-f.vp_offset_y-
m))),c.setStyles(g,{left:a,top:b}),d.element.update(),d.isMenuVisible=1,d.mouseClickFunc=h.add(g,"click",function(a){var b;if((a=a.target)&&(a=c.getParent(a,"tr"))&&!c.hasClass(a,o+"ItemSub")){b=d.items[a.id];if(!b.isDisabled()){for(k=d;k;){k.hideMenu&&k.hideMenu();k=k.settings.parent}if(b.settings.onclick)b.settings.onclick(a);return h.cancel(a)}}}),d.hasMenus()&&(d.mouseOverFunc=h.add(g,"mouseover",function(a){var b;if((a=a.target)&&(a=c.getParent(a,"tr"))){b=d.items[a.id];d.lastMenu&&d.lastMenu.collapse(1);
if(!b.isDisabled()&&a&&c.hasClass(a,o+"ItemSub")){a=c.getRect(a);b.showMenu(a.x+a.w-2,a.y-2,a.x);d.lastMenu=b;c.addClass(c.get(b.id).firstChild,o+"ItemActive")}}})),h.add(g,"keydown",d._keyHandler,d),d.onShowMenu.dispatch(d),f.keyboard_focus&&d._setupKeyboardNav())},hideMenu:function(a){var b=c.get("menu_"+this.id),e;this.isMenuVisible&&(this.keyboardNav&&this.keyboardNav.destroy(),h.remove(b,"mouseover",this.mouseOverFunc),h.remove(b,"click",this.mouseClickFunc),h.remove(b,"keydown",this._keyHandler),
c.hide(b),this.isMenuVisible=0,a||this.collapse(1),this.element&&this.element.hide(),(e=c.get(this.id))&&c.removeClass(e.firstChild,this.classPrefix+"ItemActive"),this.onHideMenu.dispatch(this))},add:function(a){var b,a=this.parent(a);this.isRendered&&(b=c.get("menu_"+this.id))&&this._add(c.select("tbody",b)[0],a);return a},collapse:function(a){this.parent(a);this.hideMenu(1)},remove:function(a){c.remove(a.id);this.destroy();return this.parent(a)},destroy:function(){var a=c.get("menu_"+this.id);this.keyboardNav&&
this.keyboardNav.destroy();h.remove(a,"mouseover",this.mouseOverFunc);h.remove(c.select("a",a),"focus",this.mouseOverFunc);h.remove(a,"click",this.mouseClickFunc);h.remove(a,"keydown",this._keyHandler);this.element&&this.element.remove();c.remove(a)},renderNode:function(){var a=this,b=a.settings,e,d,f;f=c.create("div",{role:"listbox",id:"menu_"+a.id,"class":b["class"],style:"position:absolute;left:0;top:0;z-index:200000;outline:0"});a.settings.parent&&c.setAttrib(f,"aria-parent","menu_"+a.settings.parent.id);
d=c.add(f,"div",{role:"presentation",id:"menu_"+a.id+"_co","class":a.classPrefix+(b["class"]?" "+b["class"]:"")});a.element=new q("menu_"+a.id,{blocker:1,container:b.container});b.menu_line&&c.add(d,"span",{"class":a.classPrefix+"Line"});b=c.add(d,"table",{role:"presentation",id:"menu_"+a.id+"_tbl",border:0,cellPadding:0,cellSpacing:0});e=c.add(b,"tbody");p(a.items,function(b){a._add(e,b)});a.rendered=!0;return f},_setupKeyboardNav:function(){var a,b,e=this;a=c.get("menu_"+e.id);b=c.select("a[role=option]",
"menu_"+e.id);b.splice(0,0,a);e.keyboardNav=new j.ui.KeyboardNavigation({root:"menu_"+e.id,items:b,onCancel:function(){e.hideMenu()},enableUpDown:!0});a.focus()},_keyHandler:function(a){switch(a.keyCode){case 37:this.settings.parent&&(this.hideMenu(),this.settings.parent.focus(),h.cancel(a));break;case 39:this.mouseOverFunc&&this.mouseOverFunc(a)}},_add:function(a,b){var e,d=b.settings,f,g,i,h=this.classPrefix;d.separator?(g=c.add(a,"tr",{id:b.id,"class":h+"ItemSeparator"}),c.add(g,"td",{"class":h+
"ItemSeparator"}),(e=g.previousSibling)&&c.addClass(e,"mceLast")):(e=g=c.add(a,"tr",{id:b.id,"class":h+"Item "+h+"ItemEnabled"}),e=i=c.add(e,d.titleItem?"th":"td"),e=f=c.add(e,"a",{id:b.id+"_aria",role:d.titleItem?"presentation":"option",href:"javascript:;",onclick:"return false;",onmousedown:"return false;"}),d.parent&&(c.setAttrib(f,"aria-haspopup","true"),c.setAttrib(f,"aria-owns","menu_"+b.id)),c.addClass(i,d["class"]),f=c.add(e,"span",{"class":"mceIcon"+(d.icon?" mce_"+d.icon:"")}),d.icon_src&&
c.add(f,"img",{src:d.icon_src}),e=c.add(e,d.element||"span",{"class":"mceText",title:b.settings.title},b.settings.title),b.settings.style&&c.setAttrib(e,"style",b.settings.style),1==a.childNodes.length&&c.addClass(g,"mceFirst"),(e=g.previousSibling)&&c.hasClass(e,h+"ItemSeparator")&&c.addClass(g,"mceFirst"),b.collapse&&c.addClass(g,h+"ItemSub"),(e=g.previousSibling)&&c.removeClass(e,"mceLast"),c.addClass(g,"mceLast"))}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/Button.js' */
(function(d){var f=d.DOM;d.create("tinymce.ui.Button:tinymce.ui.Control",{Button:function(a,c,b){this.parent(a,c,b);this.classPrefix="mceButton"},renderHTML:function(){var a=this.classPrefix,c=this.settings,b,e;e=f.encode(c.label||"");b='<a role="button" id="'+this.id+'" href="javascript:;" class="'+a+" "+a+"Enabled "+c["class"]+(e?" "+a+"Labeled":"")+'" onmousedown="return false;" onclick="return false;" aria-labelledby="'+this.id+'_voice" title="'+f.encode(c.title)+'">';b=c.image&&(!this.editor||
!this.editor.forcedHighContrastMode)?b+('<img class="mceIcon" src="'+c.image+'" alt="'+f.encode(c.title)+'" />'+e):b+('<span class="mceIcon '+c["class"]+'"></span>'+(e?'<span class="'+a+'Label">'+e+"</span>":""));b+='<span class="mceVoiceLabel mceIconOnly" style="display: none;" id="'+this.id+'_voice">'+c.title+"</span>";return b+"</a>"},postRender:function(){var a=this,c=a.settings,b;d.isIE&&a.editor&&d.dom.Event.add(a.id,"mousedown",function(){b="IMG"===a.editor.selection.getNode().nodeName?a.editor.selection.getBookmark():
null});d.dom.Event.add(a.id,"click",function(e){if(!a.isDisabled())return d.isIE&&(a.editor&&null!==b)&&a.editor.selection.moveToBookmark(b),c.onclick.call(c.scope,e)});d.dom.Event.add(a.id,"keyup",function(b){if(!a.isDisabled()&&b.keyCode==d.VK.SPACEBAR)return c.onclick.call(c.scope,b)})}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/ListBox.js' */
(function(f){var c=f.DOM,e=f.dom.Event,h=f.each,i=f.util.Dispatcher;f.create("tinymce.ui.ListBox:tinymce.ui.Control",{ListBox:function(a,d,b){this.parent(a,d,b);this.items=[];this.onChange=new i(this);this.onPostRender=new i(this);this.onAdd=new i(this);this.onRenderMenu=new f.util.Dispatcher(this);this.classPrefix="mceListBox"},select:function(a){var d=this,b,c;if(void 0==a)return d.selectByIndex(-1);c=a&&"function"==typeof a?a:function(b){return b==a};a!=d.selectedValue&&(h(d.items,function(a,e){if(c(a.value))return b=
1,d.selectByIndex(e),!1}),b||d.selectByIndex(-1))},selectByIndex:function(a){var d,b,e;a!=this.selectedIndex&&(d=c.get(this.id+"_text"),e=c.get(this.id+"_voiceDesc"),(b=this.items[a])?(this.selectedValue=b.value,this.selectedIndex=a,c.setHTML(d,c.encode(b.title)),c.setHTML(e,this.settings.title+" - "+b.title),c.removeClass(d,"mceTitle"),c.setAttrib(this.id,"aria-valuenow",b.title)):(c.setHTML(d,c.encode(this.settings.title)),c.setHTML(e,c.encode(this.settings.title)),c.addClass(d,"mceTitle"),this.selectedValue=
this.selectedIndex=null,c.setAttrib(this.id,"aria-valuenow",this.settings.title)))},add:function(a,c,b){b=b||{};b=f.extend(b,{title:a,value:c});this.items.push(b);this.onAdd.dispatch(this,b)},getLength:function(){return this.items.length},renderHTML:function(){var a="",a=this.settings,d=this.classPrefix,a='<span role="listbox" aria-haspopup="true" aria-labelledby="'+this.id+'_voiceDesc" aria-describedby="'+this.id+'_voiceDesc"><table role="presentation" tabindex="0" id="'+this.id+'" cellpadding="0" cellspacing="0" class="'+
d+" "+d+"Enabled"+(a["class"]?" "+a["class"]:"")+'"><tbody><tr>',a=a+("<td>"+c.createHTML("span",{id:this.id+"_voiceDesc","class":"voiceLabel",style:"display:none;"},this.settings.title)),a=a+(c.createHTML("a",{id:this.id+"_text",tabindex:-1,href:"javascript:;","class":"mceText",onclick:"return false;",onmousedown:"return false;"},c.encode(this.settings.title))+"</td>"),a=a+("<td>"+c.createHTML("a",{id:this.id+"_open",tabindex:-1,href:"javascript:;","class":"mceOpen",onclick:"return false;",onmousedown:"return false;"},
'<span><span style="display:none;" class="mceIconOnly" aria-hidden="true"></span></span>')+"</td>");return a+"</tr></tbody></table></span>"},showMenu:function(){var a=this,d,b=c.get(this.id),g;if(!(a.isDisabled()||0==a.items.length)){if(a.menu&&a.menu.isMenuVisible)return a.hideMenu();a.isMenuRendered||(a.renderMenu(),a.isMenuRendered=!0);d=c.getPos(b);g=a.menu;g.settings.offset_x=d.x;g.settings.offset_y=d.y;g.settings.keyboard_focus=!f.isOpera;a.oldID&&g.items[a.oldID].setSelected(0);h(a.items,
function(b){if(b.value===a.selectedValue){g.items[b.id].setSelected(1);a.oldID=b.id}});g.showMenu(0,b.clientHeight);e.add(c.doc,"mousedown",a.hideMenu,a);c.addClass(a.id,a.classPrefix+"Selected")}},hideMenu:function(a){if(this.menu&&this.menu.isMenuVisible&&(c.removeClass(this.id,this.classPrefix+"Selected"),!a||!("mousedown"==a.type&&(a.target.id==this.id+"_text"||a.target.id==this.id+"_open"))))if(!a||!c.getParent(a.target,".mceMenu"))c.removeClass(this.id,this.classPrefix+"Selected"),e.remove(c.doc,
"mousedown",this.hideMenu,this),this.menu.hideMenu()},renderMenu:function(){var a=this,d;d=a.settings.control_manager.createDropMenu(a.id+"_menu",{menu_line:1,"class":a.classPrefix+"Menu mceNoIcons",max_width:150,max_height:150});d.onHideMenu.add(function(){a.hideMenu();a.focus()});d.add({title:a.settings.title,"class":"mceMenuItemTitle",onclick:function(){!1!==a.settings.onselect("")&&a.select("")}});h(a.items,function(b){void 0===b.value?d.add({title:b.title,role:"option","class":"mceMenuItemTitle",
onclick:function(){!1!==a.settings.onselect("")&&a.select("")}}):(b.id=c.uniqueId(),b.role="option",b.onclick=function(){!1!==a.settings.onselect(b.value)&&a.select(b.value)},d.add(b))});a.onRenderMenu.dispatch(a,d);a.menu=d},postRender:function(){var a=this,d=a.classPrefix;e.add(a.id,"click",a.showMenu,a);e.add(a.id,"keydown",function(b){32==b.keyCode&&(a.showMenu(b),e.cancel(b))});e.add(a.id,"focus",function(){a._focused||(a.keyDownHandler=e.add(a.id,"keydown",function(b){40==b.keyCode&&(a.showMenu(),
e.cancel(b))}),a.keyPressHandler=e.add(a.id,"keypress",function(b){var c;13==b.keyCode&&(c=a.selectedValue,a.selectedValue=null,e.cancel(b),a.settings.onselect(c))}));a._focused=1});e.add(a.id,"blur",function(){e.remove(a.id,"keydown",a.keyDownHandler);e.remove(a.id,"keypress",a.keyPressHandler);a._focused=0});if(f.isIE6||!c.boxModel)e.add(a.id,"mouseover",function(){c.hasClass(a.id,d+"Disabled")||c.addClass(a.id,d+"Hover")}),e.add(a.id,"mouseout",function(){c.hasClass(a.id,d+"Disabled")||c.removeClass(a.id,
d+"Hover")});a.onPostRender.dispatch(a,c.get(a.id))},destroy:function(){this.parent();e.clear(this.id+"_text");e.clear(this.id+"_open")}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/NativeListBox.js' */
(function(f){var c=f.DOM,e=f.dom.Event,g=f.each;f.create("tinymce.ui.NativeListBox:tinymce.ui.ListBox",{NativeListBox:function(a,b){this.parent(a,b);this.classPrefix="mceNativeListBox"},setDisabled:function(a){c.get(this.id).disabled=a;this.setAriaProperty("disabled",a)},isDisabled:function(){return c.get(this.id).disabled},select:function(a){var b=this,d,h;if(void 0==a)return b.selectByIndex(-1);h=a&&"function"==typeof a?a:function(b){return b==a};a!=b.selectedValue&&(g(b.items,function(a,c){if(h(a.value))return d=
1,b.selectByIndex(c),!1}),d||b.selectByIndex(-1))},selectByIndex:function(a){c.get(this.id).selectedIndex=a+1;this.selectedValue=this.items[a]?this.items[a].value:null},add:function(a,b,d){d=d||{};d.value=b;this.isRendered()&&c.add(c.get(this.id),"option",d,a);a={title:a,value:b,attribs:d};this.items.push(a);this.onAdd.dispatch(this,a)},getLength:function(){return this.items.length},renderHTML:function(){var a;a=c.createHTML("option",{value:""},"-- "+this.settings.title+" --");g(this.items,function(b){a+=
c.createHTML("option",{value:b.value},b.title)});a=c.createHTML("select",{id:this.id,"class":"mceNativeListBox","aria-labelledby":this.id+"_aria"},a);return a+=c.createHTML("span",{id:this.id+"_aria",style:"display: none"},this.settings.title)},postRender:function(){function a(a){if((a=b.items[a.target.selectedIndex-1])&&(a=a.value))if(b.onChange.dispatch(b,a),b.settings.onselect)b.settings.onselect(a)}var b=this,d=!0;b.rendered=!0;e.add(b.id,"change",a);e.add(b.id,"keydown",function(c){var g;e.remove(b.id,
"change",void 0);d=!1;g=e.add(b.id,"blur",function(){d||(d=!0,e.add(b.id,"change",a),e.remove(b.id,"blur",g))});if(f.isWebKit&&(37==c.keyCode||39==c.keyCode))return e.prevent(c);if(13==c.keyCode||32==c.keyCode)return a(c),e.cancel(c)});b.onPostRender.dispatch(b,c.get(b.id))}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/MenuButton.js' */
(function(e){var d=e.DOM,f=e.dom.Event;e.create("tinymce.ui.MenuButton:tinymce.ui.Button",{MenuButton:function(a,b,c){this.parent(a,b,c);this.onRenderMenu=new e.util.Dispatcher(this);b.menu_container=b.menu_container||d.doc.body},showMenu:function(){var a,b=d.get(this.id),c;if(!this.isDisabled()){this.isMenuRendered||(this.renderMenu(),this.isMenuRendered=!0);if(this.isMenuVisible)return this.hideMenu();d.getPos(this.settings.menu_container);a=d.getPos(b);c=this.menu;c.settings.offset_x=a.x;c.settings.offset_y=
a.y;c.settings.vp_offset_x=a.x;c.settings.vp_offset_y=a.y;c.settings.keyboard_focus=this._focused;c.showMenu(0,b.clientHeight);f.add(d.doc,"mousedown",this.hideMenu,this);this.setState("Selected",1);this.isMenuVisible=1}},renderMenu:function(){var a=this,b;b=a.settings.control_manager.createDropMenu(a.id+"_menu",{menu_line:1,"class":this.classPrefix+"Menu",icons:a.settings.icons});b.onHideMenu.add(function(){a.hideMenu();a.focus()});a.onRenderMenu.dispatch(a,b);a.menu=b},hideMenu:function(a){var b=
this;if(!a||!("mousedown"==a.type&&d.getParent(a.target,function(a){return a.id===b.id||a.id===b.id+"_open"}))){if(!a||!d.getParent(a.target,".mceMenu"))b.setState("Selected",0),f.remove(d.doc,"mousedown",b.hideMenu,b),b.menu&&b.menu.hideMenu();b.isMenuVisible=0}},postRender:function(){var a=this,b=a.settings;f.add(a.id,"click",function(){if(!a.isDisabled()){if(b.onclick)b.onclick(a.value);a.showMenu()}})}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/SplitButton.js' */
(function(e){var d=e.DOM,c=e.dom.Event;e.create("tinymce.ui.SplitButton:tinymce.ui.MenuButton",{SplitButton:function(a,b,c){this.parent(a,b,c);this.classPrefix="mceSplitButton"},renderHTML:function(){var a,b=this.settings,c;a="<tbody><tr>";c=b.image?d.createHTML("img ",{src:b.image,role:"presentation","class":"mceAction "+b["class"]}):d.createHTML("span",{"class":"mceAction "+b["class"]},"");c+=d.createHTML("span",{"class":"mceVoiceLabel mceIconOnly",id:this.id+"_voice",style:"display:none;"},b.title);
a+="<td >"+d.createHTML("a",{role:"button",id:this.id+"_action",tabindex:"-1",href:"javascript:;","class":"mceAction "+b["class"],onclick:"return false;",onmousedown:"return false;",title:b.title},c)+"</td>";c=d.createHTML("span",{"class":"mceOpen "+b["class"]},'<span style="display:none;" class="mceIconOnly" aria-hidden="true"></span>');a+="<td >"+d.createHTML("a",{role:"button",id:this.id+"_open",tabindex:"-1",href:"javascript:;","class":"mceOpen "+b["class"],onclick:"return false;",onmousedown:"return false;",
title:b.title},c)+"</td>";a=d.createHTML("table",{role:"presentation","class":"mceSplitButton mceSplitButtonEnabled "+b["class"],cellpadding:"0",cellspacing:"0",title:b.title},a+"</tr></tbody>");return d.createHTML("div",{id:this.id,role:"button",tabindex:"0","aria-labelledby":this.id+"_voice","aria-haspopup":"true"},a)},postRender:function(){var a=this,b=a.settings,f;b.onclick&&(f=function(g){a.isDisabled()||(b.onclick(a.value),c.cancel(g))},c.add(a.id+"_action","click",f),c.add(a.id,["click","keydown"],
function(b){if((32===b.keyCode||13===b.keyCode||14===b.keyCode)&&!b.altKey&&!b.ctrlKey&&!b.metaKey)f(),c.cancel(b);else if("click"===b.type||40===b.keyCode)a.showMenu(),c.cancel(b)}));c.add(a.id+"_open","click",function(b){a.showMenu();c.cancel(b)});c.add([a.id,a.id+"_open"],"focus",function(){a._focused=1});c.add([a.id,a.id+"_open"],"blur",function(){a._focused=0});if(e.isIE6||!d.boxModel)c.add(a.id,"mouseover",function(){d.hasClass(a.id,"mceSplitButtonDisabled")||d.addClass(a.id,"mceSplitButtonHover")}),
c.add(a.id,"mouseout",function(){d.hasClass(a.id,"mceSplitButtonDisabled")||d.removeClass(a.id,"mceSplitButtonHover")})},destroy:function(){this.parent();c.clear(this.id+"_action");c.clear(this.id+"_open");c.clear(this.id)}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/ColorSplitButton.js' */
(function(f){var b=f.DOM,e=f.dom.Event,m=f.is,n=f.each;f.create("tinymce.ui.ColorSplitButton:tinymce.ui.SplitButton",{ColorSplitButton:function(a,b,e){this.parent(a,b,e);this.settings=b=f.extend({colors:"000000,993300,333300,003300,003366,000080,333399,333333,800000,FF6600,808000,008000,008080,0000FF,666699,808080,FF0000,FF9900,99CC00,339966,33CCCC,3366FF,800080,999999,FF00FF,FFCC00,FFFF00,00FF00,00FFFF,00CCFF,993366,C0C0C0,FF99CC,FFCC99,FFFF99,CCFFCC,CCFFFF,99CCFF,CC99FF,FFFFFF",grid_width:8,default_color:"#888888"},
this.settings);this.onShowMenu=new f.util.Dispatcher(this);this.onHideMenu=new f.util.Dispatcher(this);this.value=b.default_color},showMenu:function(){var a=this,c,f;if(!a.isDisabled()){a.isMenuRendered||(a.renderMenu(),a.isMenuRendered=!0);if(a.isMenuVisible)return a.hideMenu();c=b.get(a.id);b.show(a.id+"_menu");b.addClass(c,"mceSplitButtonSelected");f=b.getPos(c);b.setStyles(a.id+"_menu",{left:f.x,top:f.y+c.clientHeight,zIndex:2E5});c=0;e.add(b.doc,"mousedown",a.hideMenu,a);a.onShowMenu.dispatch(a);
a._focused&&(a._keyHandler=e.add(a.id+"_menu","keydown",function(b){b.keyCode==27&&a.hideMenu()}),b.select("a",a.id+"_menu")[0].focus());a.isMenuVisible=1}},hideMenu:function(a){var c=this;if(c.isMenuVisible&&(!a||!("mousedown"==a.type&&b.getParent(a.target,function(a){return a.id===c.id+"_open"})))){if(!a||!b.getParent(a.target,".mceSplitButtonMenu"))b.removeClass(c.id,"mceSplitButtonSelected"),e.remove(b.doc,"mousedown",c.hideMenu,c),e.remove(c.id+"_menu","keydown",c._keyHandler),b.hide(c.id+"_menu");
c.isMenuVisible=0;c.onHideMenu.dispatch()}},renderMenu:function(){var a=this,c,i=0,g=a.settings,d,h,l,j,k;j=b.add(g.menu_container,"div",{role:"listbox",id:a.id+"_menu","class":g.menu_class+" "+g["class"],style:"position:absolute;left:0;top:-1000px;"});c=b.add(j,"div",{"class":g["class"]+" mceSplitButtonMenu"});b.add(c,"span",{"class":"mceMenuLine"});d=b.add(c,"table",{role:"presentation","class":"mceColorSplitMenu"});h=b.add(d,"tbody");i=0;n(m(g.colors,"array")?g.colors:g.colors.split(","),function(c){c=
c.replace(/^#/,"");i--||(l=b.add(h,"tr"),i=g.grid_width-1);d=b.add(l,"td");var e={href:"javascript:;",style:{backgroundColor:"#"+c},title:a.editor.getLang("colors."+c,c),"data-mce-color":"#"+c};f.isIE||(e.role="option");d=b.add(d,"a",e);a.editor.forcedHighContrastMode&&(d=b.add(d,"canvas",{width:16,height:16,"aria-hidden":"true"}),d.getContext&&(k=d.getContext("2d"))?(k.fillStyle="#"+c,k.fillRect(0,0,16,16)):b.remove(d))});g.more_colors_func&&(d=b.add(h,"tr"),d=b.add(d,"td",{colspan:g.grid_width,
"class":"mceMoreColors"}),d=b.add(d,"a",{role:"option",id:a.id+"_more",href:"javascript:;",onclick:"return false;","class":"mceMoreColors"},g.more_colors_title),e.add(d,"click",function(a){g.more_colors_func.call(g.more_colors_scope||this);return e.cancel(a)}));b.addClass(c,"mceColorSplitMenu");new f.ui.KeyboardNavigation({root:a.id+"_menu",items:b.select("a",a.id+"_menu"),onCancel:function(){a.hideMenu();a.focus()}});e.add(a.id+"_menu","mousedown",function(a){return e.cancel(a)});e.add(a.id+"_menu",
"click",function(c){var d;(c=b.getParent(c.target,"a",h))&&(c.nodeName.toLowerCase()=="a"&&(d=c.getAttribute("data-mce-color")))&&a.setColor(d);return e.cancel(c)});return j},setColor:function(a){this.displayColor(a);this.hideMenu();this.settings.onselect(a)},displayColor:function(a){b.setStyle(this.id+"_preview","backgroundColor",a);this.value=a},postRender:function(){var a=this.id;this.parent();b.add(a+"_action","div",{id:a+"_preview","class":"mceColorPreview"});b.setStyle(this.id+"_preview","backgroundColor",
this.value)},destroy:function(){this.parent();e.clear(this.id+"_menu");e.clear(this.id+"_more");b.remove(this.id+"_menu")}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/ToolbarGroup.js' */
(function(b){var d=b.DOM,e=b.each,f=b.dom.Event;b.create("tinymce.ui.ToolbarGroup:tinymce.ui.Container",{renderHTML:function(){var a=[],c=this.controls,g=b.each,h=this.settings;a.push('<div id="'+this.id+'" role="group" aria-labelledby="'+this.id+'_voice">');a.push("<span role='application'>");a.push('<span id="'+this.id+'_voice" class="mceVoiceLabel" style="display:none;">'+d.encode(h.name)+"</span>");g(c,function(b){a.push(b.renderHTML())});a.push("</span>");a.push("</div>");return a.join("")},
focus:function(){d.get(this.id).focus()},postRender:function(){var a=this,c=[];e(a.controls,function(a){e(a.controls,function(a){a.id&&c.push(a)})});a.keyNav=new b.ui.KeyboardNavigation({root:a.id,items:c,onCancel:function(){b.isWebKit&&d.get(a.editor.id+"_ifr").focus();a.editor.focus()},excludeFromTabOrder:!a.settings.tab_focus_toolbar})},destroy:function(){this.parent();this.keyNav.destroy();f.clear(this.id)}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ui/Toolbar.js' */
(function(f){var d=f.DOM;f.create("tinymce.ui.Toolbar:tinymce.ui.Container",{renderHTML:function(){var b="",a,c,f=this.settings,e,h,i,g;g=this.controls;for(e=0;e<g.length;e++){c=g[e];h=g[e-1];i=g[e+1];0===e&&(a="mceToolbarStart",c.Button?a+=" mceToolbarStartButton":c.SplitButton?a+=" mceToolbarStartSplitButton":c.ListBox&&(a+=" mceToolbarStartListBox"),b+=d.createHTML("td",{"class":a},d.createHTML("span",null,"<\!-- IE --\>")));if(h&&c.ListBox&&(h.Button||h.SplitButton))b+=d.createHTML("td",{"class":"mceToolbarEnd"},
d.createHTML("span",null,"<\!-- IE --\>"));b=d.stdMode?b+('<td style="position: relative">'+c.renderHTML()+"</td>"):b+("<td>"+c.renderHTML()+"</td>");if(i&&c.ListBox&&(i.Button||i.SplitButton))b+=d.createHTML("td",{"class":"mceToolbarStart"},d.createHTML("span",null,"<\!-- IE --\>"))}a="mceToolbarEnd";c.Button?a+=" mceToolbarEndButton":c.SplitButton?a+=" mceToolbarEndSplitButton":c.ListBox&&(a+=" mceToolbarEndListBox");b+=d.createHTML("td",{"class":a},d.createHTML("span",null,"<\!-- IE --\>"));return d.createHTML("table",
{id:this.id,"class":"mceToolbar"+(f["class"]?" "+f["class"]:""),cellpadding:"0",cellspacing:"0",align:this.settings.align||"",role:"presentation",tabindex:"-1"},"<tbody><tr>"+b+"</tr></tbody>")}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/AddOnManager.js' */
(function(c){var i=c.util.Dispatcher;c.create("tinymce.AddOnManager",{AddOnManager:function(){this.items=[];this.urls={};this.lookup={};this.onAdd=new i(this)},get:function(b){if(this.lookup[b])return this.lookup[b].instance},dependencies:function(b){var a;this.lookup[b]&&(a=this.lookup[b].dependencies);return a||[]},requireLangPack:function(b){var a=c.settings;a&&(a.language&&!1!==a.language_load)&&c.ScriptLoader.add(this.urls[b]+"/langs/"+a.language+".js")},add:function(b,a,c){this.items.push(a);
this.lookup[b]={instance:a,dependencies:c};this.onAdd.dispatch(this,b,a);return a},createUrl:function(b,a){return"object"===typeof a?a:{prefix:b.prefix,resource:a,suffix:b.suffix}},addComponents:function(b,a){var f=this.urls[b];c.each(a,function(a){c.ScriptLoader.add(f+"/"+a)})},load:function(b,a,f,g){function h(){var d=e.dependencies(b);c.each(d,function(b){b=e.createUrl(a,b);e.load(b.resource,b,void 0,void 0)});f&&(g?f.call(g):f.call(c.ScriptLoader))}var e=this,d=a;e.urls[b]||("object"===typeof a&&
(d=a.prefix+a.resource+a.suffix),0!=d.indexOf("/")&&-1==d.indexOf("://")&&(d=c.baseURL+"/"+d),e.urls[b]=d.substring(0,d.lastIndexOf("/")),c.settings.atlassian||(e.lookup[b]?h():c.ScriptLoader.add(d,h,g)))}});c.PluginManager=new c.AddOnManager;c.ThemeManager=new c.AddOnManager})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/EditorManager.js' */
(function(b){var e=b.each,n=b.extend,i=b.DOM,o=b.dom.Event,p=b.explode,m=b.util.Dispatcher,q=0;b.documentBaseURL=b.baseURL;AJS.debug("tinymce.documentBaseURL = "+b.documentBaseURL);/[\/\\]$/.test(b.documentBaseURL)||(b.documentBaseURL+="/");b.baseURL=(new b.util.URI(b.documentBaseURL)).toAbsolute(b.baseURL);b.baseURI=new b.util.URI(b.baseURL);b.onBeforeUnload=new m(b);o.add(window,"beforeunload",function(a){b.onBeforeUnload.dispatch(b,a)});b.onAddEditor=new m(b);b.onRemoveEditor=new m(b);b.EditorManager=
n(b,{editors:[],i18n:{},activeEditor:null,init:function(a){function g(a,c,k){var d=a[c];if(d){if(b.is(d,"string")){k=(k=d.replace(/\.\w+$/,""))?b.resolve(k):0;d=b.resolve(d)}return d.apply(k||this,Array.prototype.slice.call(arguments,2))}}function c(){var c,j;g(a,"onpageload");switch(a.mode){case "exact":c=a.elements||"";c.length>0&&e(p(c),function(c){if(i.get(c)){h=new b.Editor(c,a);l.push(h);h.render(1)}else e(document.forms,function(d){e(d.elements,function(d){if(d.name===c){c="mce_editor_"+q++;
i.setAttrib(d,"id",c);h=new b.Editor(c,a);l.push(h);h.render(1)}})})});break;case "textareas":case "specific_textareas":e(i.select("textarea"),function(c){if(!a.editor_deselector||!(a.editor_deselector.constructor===RegExp?a.editor_deselector.test(c.className):i.hasClass(c,a.editor_deselector)))if(!a.editor_selector||(a.editor_selector.constructor===RegExp?a.editor_selector.test(c.className):i.hasClass(c,a.editor_selector))){f=i.get(c.name);if(!c.id&&!f)c.id=c.name;if(!c.id||d.get(c.id))c.id=i.uniqueId();
h=new b.Editor(c.id,a);l.push(h);h.render(1)}})}if(a.oninit){c=j=0;e(l,function(b){j++;b.initialized?c++:b.onInit.add(function(){c++;c==j&&g(a,"oninit")});c==j&&g(a,"oninit")})}}var d=this,f,l=[],h,a=n({theme:"simple",language:"en"},a);d.settings=a;a.atlassian?c():o.add(document,"init",c)},get:function(a){return a===void 0?this.editors:this.editors[a]},getInstanceById:function(a){return this.get(a)},add:function(a){var g=this.editors;g[a.id]=a;g.push(a);this._setActive(a);this.onAddEditor.dispatch(this,
a);b.adapter&&b.adapter.patchEditor(a);return a},remove:function(a){var b,c=this.editors;if(!c[a.id])return null;delete c[a.id];for(b=0;b<c.length;b++)if(c[b]==a){c.splice(b,1);break}this.activeEditor==a&&this._setActive(c[0]);a.destroy();this.onRemoveEditor.dispatch(this,a);return a},execCommand:function(a,g,c){var d=this.get(c),f;switch(a){case "mceFocus":d.focus();return true;case "mceAddEditor":case "mceAddControl":this.get(c)||(new b.Editor(c,this.settings)).render();return true;case "mceAddFrameControl":f=
c.window;f.tinyMCE=tinyMCE;f.tinymce=b;b.DOM.doc=f.document;b.DOM.win=f;d=new b.Editor(c.element_id,c);d.render();if(b.isIE){var e=function(){d.destroy();f.detachEvent("onunload",e);f=f.tinyMCE=f.tinymce=null};f.attachEvent("onunload",e)}c.page_window=null;return true;case "mceRemoveEditor":case "mceRemoveControl":d&&d.remove();return true;case "mceToggleEditor":if(!d){this.execCommand("mceAddControl",0,c);return true}d.isHidden()?d.show():d.hide();return true}return this.activeEditor?this.activeEditor.execCommand(a,
g,c):false},execInstanceCommand:function(a,b,c,d){return(a=this.get(a))?a.execCommand(b,c,d):false},triggerSave:function(){e(this.editors,function(a){a.save()})},addI18n:function(a,g){var c=this.i18n;b.is(a,"string")?e(g,function(b,f){c[a+"."+f]=b}):e(a,function(a,b){e(a,function(a,d){e(a,function(a,e){d==="common"?c[b+"."+e]=a:c[b+"."+d+"."+e]=a})})})},_setActive:function(a){this.selectedInstance=this.activeEditor=a}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/Editor.js' */
(function(d){var g=d.DOM,i=d.dom.Event,u=d.extend,v=d.util.Dispatcher,j=d.each,p=d.isGecko,r=d.isIE,m=d.is,s=d.ThemeManager,o=d.PluginManager,q=d.explode,w=d.VK;d.create("tinymce.Editor",{Editor:function(a,b){var c=this;c.id=c.editorId=a;c.execCommands={};c.queryStateCommands={};c.queryValueCommands={};c.isNotDirty=!1;c.plugins={};j("onPreInit onBeforeRenderUI onPostRender onLoad onInit onRemove onActivate onDeactivate onClick onEvent onMouseUp onMouseDown onDblClick onKeyDown onKeyUp onKeyPress onContextMenu onSubmit onReset onPaste onPreProcess onPostProcess onBeforeSetContent onBeforeGetContent onSetContent onGetContent onLoadContent onSaveContent onNodeChange onChange onBeforeExecCommand onExecCommand onUndo onRedo onVisualAid onSetProgressState onSetAttrib".split(" "),
function(a){c[a]=new v(c)});c.settings=b=u({id:a,language:"en",docs_language:"en",theme:"simple",skin:"default",delta_width:0,delta_height:0,popup_css:"",plugins:"",document_base_url:d.documentBaseURL,add_form_submit_trigger:1,submit_patch:1,add_unload_trigger:1,convert_urls:1,relative_urls:1,remove_script_host:1,table_inline_editing:0,object_resizing:1,cleanup:1,accessibility_focus:1,custom_shortcuts:1,custom_undo_redo_keyboard_shortcuts:1,custom_undo_redo_restore_selection:1,custom_undo_redo:1,
doctype:d.isIE6?'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">':"<!DOCTYPE html>",visual_table_class:"mceItemTable",visual:1,font_size_style_values:"xx-small,x-small,small,medium,large,x-large,xx-large",font_size_legacy_values:"xx-small,small,medium,large,x-large,xx-large,300%",apply_source_formatting:1,directionality:"ltr",forced_root_block:"p",hidden_input:1,padd_empty_editor:1,render_ui:1,init_theme:1,force_p_newlines:1,indentation:"30px",keep_styles:1,fix_table_elements:1,inline_styles:1,
convert_fonts_to_spans:!0,indent:"simple",indent_before:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr",indent_after:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,ul,li,area,table,thead,tfoot,tbody,tr",validate:!0,entity_encoding:"named",url_converter:c.convertURL,url_converter_scope:c,ie7_compat:!0},b);c.documentBaseURI=new d.util.URI(b.document_base_url||d.documentBaseURL,{base_uri:tinyMCE.baseURI});c.baseURI=d.baseURI;c.contentCSS=
[];c.execCallback("setup",c)},render:function(){var a=this,b=a.settings,c=a.id,e=d.ScriptLoader;if(!b.atlassian&&!i.domLoaded)i.add(document,"init",function(){a.render()});else if(tinyMCE.settings=b,a.getElement()&&(!d.isIDevice||d.isIOS5))!/TEXTAREA|INPUT/i.test(a.getElement().nodeName)&&(b.hidden_input&&g.getParent(c,"form"))&&g.insertAfter(g.create("input",{type:"hidden",name:c}),c),d.WindowManager&&(a.windowManager=new d.WindowManager(a)),"xml"==b.encoding&&a.onGetContent.add(function(a,b){if(b.save)b.content=
g.encode(b.content)}),b.add_form_submit_trigger&&a.onSubmit.addToTop(function(){if(a.initialized){a.save();a.isNotDirty=1}}),b.add_unload_trigger&&(a._beforeUnload=tinyMCE.onBeforeUnload.add(function(){a.initialized&&(!a.destroyed&&!a.isHidden())&&a.save({format:"raw",no_events:true})})),d.addUnload(a.destroy,a),b.submit_patch&&a.onBeforeRenderUI.add(function(){var b=a.getElement().form;if(b&&!b._mceOldSubmit){if(!b.submit.nodeType&&!b.submit.length){a.formElement=b;b._mceOldSubmit=b.submit;b.submit=
function(){d.triggerSave();a.isNotDirty=1;return a.formElement._mceOldSubmit(a.formElement)}}b=null}}),c=function(){a.removed||a.init()},b.theme&&("-"!=b.theme.charAt(0)&&!s.urls[b.theme])&&s.load(b.theme,"themes/"+b.theme+"/editor_template"+d.suffix+".js"),j(q(b.plugins),function(a){if(a&&!o.urls[a])if(a.charAt(0)=="-"){a=a.substr(1,a.length);a=o.dependencies(a);j(a,function(a){a=o.createUrl({prefix:"plugins/",resource:a,suffix:"/editor_plugin"+d.suffix+".js"},a);o.load(a.resource,a)})}else a!="safari"&&
o.load(a,{prefix:"plugins/",resource:a,suffix:"/editor_plugin"+d.suffix+".js"})}),b.atlassian?c():e.loadQueue(c)},init:function(){function a(c){var f=o.get(c),h=o.urls[c]||d.documentBaseURL.replace(/\/$/,"");f&&-1===d.inArray(i,c)&&(j(o.dependencies(c),function(b){a(b)}),f=new f(b,h),b.plugins[c]=f,f.init&&(f.init(b,h),i.push(c)),AJS.debug("initPlugin: "+c+" initialised"))}var b=this,c=b.settings,e,h,f=b.getElement(),k,l,n,i=[];d.add(b);c.aria_label=c.aria_label||g.getAttrib(f,"aria-label",b.getLang("aria.rich_text_area"));
c.theme&&(c.theme=c.theme.replace(/-/,""),k=s.get(c.theme),b.theme=new k,b.theme.init&&c.init_theme&&b.theme.init(b,s.urls[c.theme]||d.documentBaseURL.replace(/\/$/,"")));j(q(c.plugins.replace(/\-/g,"")),a);!1!==c.popup_css&&(c.popup_css=c.popup_css?b.documentBaseURI.toAbsolute(c.popup_css):b.baseURI.toAbsolute("themes/"+c.theme+"/skins/"+c.skin+"/dialog.css"));c.popup_css_add&&(c.popup_css+=","+b.documentBaseURI.toAbsolute(c.popup_css_add));b.controlManager=new d.ControlManager(b);c.custom_undo_redo&&
(b.onBeforeExecCommand.add(function(a,c,f,h,e){c!="Undo"&&(c!="Redo"&&c!="mceRepaint"&&(!e||!e.skip_undo))&&b.undoManager.beforeChange()}),b.onExecCommand.add(function(a,c,f,h,e){c!="Undo"&&(c!="Redo"&&c!="mceRepaint"&&(!e||!e.skip_undo))&&b.undoManager.add()}));b.onExecCommand.add(function(a,c){/^(FontName|FontSize)$/.test(c)||b.nodeChanged()});p&&(n=function(a,c){(!c||!c.initial)&&b.execCommand("mceRepaint")},b.onUndo.add(n),b.onRedo.add(n),b.onSetContent.add(n));b.onBeforeRenderUI.dispatch(b,b.controlManager);
c.render_ui&&(e=c.width||f.style.width||f.offsetWidth,h=c.height||f.style.height||f.offsetHeight,b.orgDisplay=f.style.display,n=/^[0-9\.]+(|px)$/i,n.test(""+e)&&(e=Math.max(parseInt(e)+(k.deltaWidth||0),100)),n.test(""+h)&&(h=Math.max(parseInt(h)+(k.deltaHeight||0),100)),k=b.theme.renderUI({targetNode:f,width:e,height:h,deltaWidth:c.delta_width,deltaHeight:c.delta_height}),b.editorContainer=k.editorContainer);if(c.content_editable)return f=k=null,b.setupContentEditable();document.domain&&location.hostname!=
document.domain&&(d.relaxedDomain=document.domain);g.setStyles(k.sizeContainer||k.editorContainer,{width:e,height:h});c.content_css&&d.each(q(c.content_css),function(a){b.contentCSS.push(b.documentBaseURI.toAbsolute(a))});100>h&&(h=100);AJS.debug("Editor:init iframe base href="+AJS.Rte.getCurrentBaseUrl());b.iframeHTML=c.doctype+'<html><head xmlns="http://www.w3.org/1999/xhtml">';c.document_base_url!=d.documentBaseURL&&(b.iframeHTML+='<base href="'+AJS.Rte.getCurrentBaseUrl()+'" />');b.iframeHTML=
c.ie7_compat?b.iframeHTML+'<meta http-equiv="X-UA-Compatible" content="IE=7" />':b.iframeHTML+'<meta http-equiv="X-UA-Compatible" content="IE=edge" />';b.iframeHTML+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';for(e=0;e<b.contentCSS.length;e++)b.iframeHTML+='<link type="text/css" rel="stylesheet" href="'+b.contentCSS[e]+'" />';c.contentCssTags&&(b.iframeHTML+=c.contentCssTags);b.contentCSS=[];e=c.body_id||"tinymce";-1!=e.indexOf("=")&&(e=b.getParam("body_id","","hash"),
e=e[b.id]||e);f=c.body_class||"";-1!=f.indexOf("=")&&(f=b.getParam("body_class","","hash"),f=f[b.id]||"");b.iframeHTML+='</head><body id="'+e+'" class="mceContentBody aui-theme-default '+f+'" onload="window.parent.tinyMCE.get(\''+b.id+"').onLoad.dispatch();\"><br></body></html>";if(d.relaxedDomain&&(r||d.isOpera&&11>parseFloat(opera.version())))l='javascript:(function(){document.open();document.domain="'+document.domain+'";var ed = window.parent.tinyMCE.get("'+b.id+'");document.write(ed.iframeHTML);document.close();ed.setupIframe();})()';
g.add(k.iframeContainer,"iframe",{id:b.id+"_ifr",src:l||'javascript:""',frameBorder:"0",allowTransparency:"true",title:c.aria_label,style:{width:"100%",height:h,display:"block"}});b.contentAreaContainer=k.iframeContainer;g.get(k.editorContainer).style.display=b.orgDisplay;g.get(b.id).style.display="none";g.setAttrib(b.id,"aria-hidden",!0);(!d.relaxedDomain||!l)&&b.setupIframe();f=k=null},setupIframe:function(){var a=this,b=a.settings;g.get(a.id);var c=a.getDoc();if(!r||!d.relaxedDomain)c.open(),c.write(a.iframeHTML),
c.close(),d.relaxedDomain&&(c.domain=d.relaxedDomain);c=a.getBody();c.disabled=!0;b.readonly||(c.contentEditable=!0);c.disabled=!1;a.schema=new d.html.Schema(b);a.dom=new d.dom.DOMUtils(a.getDoc(),{keep_values:!0,url_converter:a.convertURL,url_converter_scope:a,hex_colors:b.force_hex_style_colors,class_filter:b.class_filter,update_styles:1,fix_ie_paragraphs:1,schema:a.schema});a.parser=new d.html.DomParser(b,a.schema);a.settings.allow_html_in_named_anchor||a.parser.addAttributeFilter("name",function(a){for(var b=
a.length,c,e,d,g;b--;){g=a[b];if(g.name==="a"&&g.firstChild){d=g.parent;c=g.lastChild;do{e=c.prev;d.insert(c,g);c=e}while(c)}}});a.parser.addAttributeFilter("src,href,style",function(b,c){for(var e=b.length,d,g=a.dom,i,t;e--;){d=b[e];i=d.attr(c);t="data-mce-"+c;d.attributes.map[t]||(c==="style"?d.attr(t,g.serializeStyle(g.parseStyle(i),d.name)):d.attr(t,a.convertURL(i,c,d.name)))}});a.parser.addNodeFilter("script",function(a){for(var b=a.length,c;b--;){c=a[b];c.attr("type","mce-"+(c.attr("type")||
"text/javascript"))}});a.parser.addNodeFilter("#cdata",function(a){for(var b=a.length,c;b--;){c=a[b];c.type=8;c.name="#comment";c.value="[CDATA["+c.value+"]]"}});a.parser.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",function(b){var c=b.length,e;for(a.schema.getNonEmptyElements();c--;){e=b[c];if(e.isEmpty(a.schema))e.empty().append(new d.html.Node("br",1)).shortEnded=true}});a.serializer=new d.dom.Serializer(b,a.dom,a.schema);a.selection=new d.dom.Selection(a.dom,a.getWin(),a.serializer);a.formatter=new d.Formatter(this);
a.formatter.register({alignleft:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"left"}},{selector:"img.confluence-embedded-image",classes:"image-left"},{selector:"img,table",collapsed:!1,styles:{"float":"left"}}],aligncenter:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"center"}},{selector:"img.confluence-embedded-image",classes:"image-center"},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"}}],alignright:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",
styles:{textAlign:"right"}},{selector:"img.confluence-embedded-image",classes:"image-right"},{selector:"img,table",collapsed:!1,styles:{"float":"right"}}],alignfull:[{selector:"p,h1,h2,h3,h4,h5,h6,td,th,div,ul,ol,li",styles:{textAlign:"justify"}}],bold:[{inline:"strong",remove:"all"},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all"}],italic:[{inline:"em",remove:"all"},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all"}],underline:[{inline:"u",remove:"all"},{inline:"span",
styles:{textDecoration:"underline"},exact:!0}],strikethrough:[{inline:"s",remove:"all"}],forecolor:{inline:"span",styles:{color:"%value"},wrap_links:!1},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},wrap_links:!1},fontname:{inline:"span",styles:{fontFamily:"%value"}},fontsize:{inline:"span",styles:{fontSize:"%value"}},fontsize_class:{inline:"span",attributes:{"class":"%value"}},blockquote:{block:"blockquote",wrapper:1,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},
link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:function(){return true},onformat:function(b,c,e){j(e,function(c,f){a.dom.setAttrib(b,f,c)})}},removeformat:[{selector:"b,strong,em,i,font,u,strike",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]});j("p h1 h2 h3 h4 h5 h6 div address pre div code dt dd samp".split(/\s/),
function(b){a.formatter.register(b,{block:b,remove:"all"})});a.formatter.register(a.settings.formats);a.undoManager=new d.UndoManager(a);a.undoManager.onAdd.add(function(b,c){if(b.hasUndo())return a.onChange.dispatch(a,c,b)});a.undoManager.onUndo.add(function(b,c){return a.onUndo.dispatch(a,c,b)});a.undoManager.onRedo.add(function(b,c){return a.onRedo.dispatch(a,c,b)});a.forceBlocks=new d.ForceBlocks(a,{forced_root_block:b.forced_root_block});a.editorCommands=new d.EditorCommands(a);a.serializer.onPreProcess.add(function(b,
c){return a.onPreProcess.dispatch(a,c,b)});a.serializer.onPostProcess.add(function(b,c){return a.onPostProcess.dispatch(a,c,b)});AJS.debug("Editor:setupIframe: dispatch onPreInit");a.onPreInit.dispatch(a);b.gecko_spellcheck||(a.getBody().spellcheck=0);b.readonly||a._addEvents();AJS.debug("Editor:setupIframe: dispatch controlManager onPostRender");a.controlManager.onPostRender.dispatch(a,a.controlManager);AJS.debug("Editor:setupIframe: dispatch onPostRender");a.onPostRender.dispatch(a);a.quirks=new d.util.Quirks(this);
b.directionality&&(a.getBody().dir=b.directionality);b.nowrap&&(a.getBody().style.whiteSpace="nowrap");b.handle_node_change_callback&&a.onNodeChange.add(function(b,c,e){a.execCallback("handle_node_change_callback",a.id,e,-1,-1,true,a.selection.isCollapsed())});b.save_callback&&a.onSaveContent.add(function(b,c){var e=a.execCallback("save_callback",a.id,c.content,a.getBody());if(e)c.content=e});b.onchange_callback&&a.onChange.add(function(b,c){a.execCallback("onchange_callback",a,c)});b.protect&&a.onBeforeSetContent.add(function(a,
c){b.protect&&j(b.protect,function(a){c.content=c.content.replace(a,function(a){return"<\!--mce:protected "+escape(a)+"--\>"})})});b.convert_newlines_to_brs&&a.onBeforeSetContent.add(function(a,b){if(b.initial)b.content=b.content.replace(/\r?\n/g,"<br />")});b.preformatted&&a.onPostProcess.add(function(a,b){b.content=b.content.replace(/^\s*<pre.*?>/,"");b.content=b.content.replace(/<\/pre>\s*$/,"");if(b.set)b.content='<pre class="mceItemHidden">'+b.content+"</pre>"});b.verify_css_classes&&(a.serializer.attribValueFilter=
function(b,c){var e,d;if(b=="class"){if(!a.classesRE){d=a.dom.getClasses();if(d.length>0){e="";j(d,function(a){e=e+((e?"|":"")+a["class"])});a.classesRE=RegExp("("+e+")","gi")}}return!a.classesRE||/(\bmceItem\w+\b|\bmceTemp\w+\b)/g.test(c)||a.classesRE.test(c)?c:""}return c});b.cleanup_callback&&(a.onBeforeSetContent.add(function(b,c){c.content=a.execCallback("cleanup_callback","insert_to_editor",c.content,c)}),a.onPreProcess.add(function(b,c){c.set&&a.execCallback("cleanup_callback","insert_to_editor_dom",
c.node,c);c.get&&a.execCallback("cleanup_callback","get_from_editor_dom",c.node,c)}),a.onPostProcess.add(function(b,c){if(c.set)c.content=a.execCallback("cleanup_callback","insert_to_editor",c.content,c);if(c.get)c.content=a.execCallback("cleanup_callback","get_from_editor",c.content,c)}));b.save_callback&&a.onGetContent.add(function(b,c){if(c.save)c.content=a.execCallback("save_callback",a.id,c.content,a.getBody())});b.handle_event_callback&&a.onEvent.add(function(b,c,e){a.execCallback("handle_event_callback",
c,b,e)===false&&i.cancel(c)});a.onSetContent.add(function(){a.addVisual(a.getBody())});b.padd_empty_editor&&a.onPostProcess.add(function(a,b){b.content=b.content.replace(/^(<p[^>]*>(&nbsp;|&#160;|\s|\u00a0|)<\/p>[\r\n]*|<br \/>[\r\n]*)$/,"")});if(p){var e=function(a){j(a.dom.select("a"),function(b){var c=b.parentNode;a.dom.isBlock(c)&&c.lastChild===b&&a.dom.add(c,"br",{"data-mce-bogus":1})})};a.onExecCommand.add(function(a,b){b==="CreateLink"&&e(a)});a.onSetContent.add(a.selection.onSetContent.add(e))}a.load({initial:!0,
format:"html"});a.startContent=a.getContent({format:"raw"});a.undoManager.add();a.initialized=!0;AJS.debug("Editor:setupIframe: dispatch onInit");a.onInit.dispatch(a);AJS.debug("Editor:setupIframe: Callback setupcontent_callback");a.execCallback("setupcontent_callback",a.id,a.getBody(),a.getDoc());AJS.debug("Editor:setupIframe: Completed setupcontent_callback");AJS.debug("Editor:setupIframe: Callback init_instance_callback");a.execCallback("init_instance_callback",a);AJS.debug("Editor:setupIframe: Completed init_instance_callback");
a.focus(!0);a.nodeChanged({initial:1});j(a.contentCSS,function(b){a.dom.loadCSS(b)});b.auto_focus&&setTimeout(function(){var a=d.get(b.auto_focus);a.selection.select(a.getBody(),1);a.selection.collapse(1);a.getBody().focus();a.getWin().focus()},100)},setupContentEditable:function(){var a=this,b=a.settings,c=a.getElement();a.contentDocument=b.content_document||document;a.contentWindow=b.content_window||window;a.bodyElement=c;b.content_document=b.content_window=null;g.hide(c);c.contentEditable=a.getParam("content_editable_state",
!0);g.show(c);b.gecko_spellcheck||(a.getDoc().body.spellcheck=0);a.dom=new d.dom.DOMUtils(a.getDoc(),{keep_values:!0,url_converter:a.convertURL,url_converter_scope:a,hex_colors:b.force_hex_style_colors,class_filter:b.class_filter,root_element:a.id,fix_ie_paragraphs:1,update_styles:1});a.serializer=new d.dom.Serializer(b,a.dom,schema);a.selection=new d.dom.Selection(a.dom,a.getWin(),a.serializer);a.forceBlocks=new d.ForceBlocks(a,{forced_root_block:b.forced_root_block});a.editorCommands=new d.EditorCommands(a);
a.serializer.onPreProcess.add(function(b,c){return a.onPreProcess.dispatch(a,c,b)});a.serializer.onPostProcess.add(function(b,c){return a.onPostProcess.dispatch(a,c,b)});a.onPreInit.dispatch(a);a._addEvents();a.controlManager.onPostRender.dispatch(a,a.controlManager);a.onPostRender.dispatch(a);a.onSetContent.add(function(){a.addVisual(a.getBody())});a.startContent=a.getContent({format:"raw"});a.undoManager.add({initial:!0});a.initialized=!0;a.onInit.dispatch(a);a.focus(!0);a.nodeChanged({initial:1});
b.content_css&&j(q(b.content_css),function(b){a.dom.loadCSS(a.documentBaseURI.toAbsolute(b))});r&&(a.dom.bind(a.getElement(),"beforedeactivate",function(){a.lastSelectionBookmark=a.selection.getBookmark(1)}),a.onBeforeExecCommand.add(function(a,b,c,d,l){if(!g.getParent(a.selection.getStart(),function(b){return b==a.getBody()}))l.terminate=1;if(!g.getParent(a.selection.getEnd(),function(b){return b==a.getBody()}))l.terminate=1}));c=null},focus:function(a){var b,c=this.selection,e=this.settings.content_editable,
h,f=this.getDoc(),k,l;if(!a){a=c.getRng();a.item&&(h=a.item(0));this._refreshContentEditable();if(!e)if(d.isIE)try{k=this.getWin(),l=g.getViewPort(k),this.dom.getRoot().focus(),k.scrollTo(l.x,l.y)}catch(i){}else this.getWin().focus();d.isGecko&&this.getBody().focus();h&&h.ownerDocument==f&&(a=f.body.createControlRange(),a.addElement(h),a.select());e&&(d.isWebKit?this.getWin().focus():d.isIE?this.getElement().setActive():this.getElement().focus())}d.activeEditor!=this&&(null!=(b=d.activeEditor)&&b.onDeactivate.dispatch(b,
this),this.onActivate.dispatch(this,b));d._setActive(this)},execCallback:function(a){var b=this.settings[a],c;if(b){if(this.callbackLookup&&(c=this.callbackLookup[a]))b=c.func,c=c.scope;m(b,"string")&&(c=(c=b.replace(/\.\w+$/,""))?d.resolve(c):0,b=d.resolve(b),this.callbackLookup=this.callbackLookup||{},this.callbackLookup[a]={func:b,scope:c});return b.apply(c||this,Array.prototype.slice.call(arguments,1))}},translate:function(a){var b=this.settings.language||"en",c=d.i18n;return!a?"":c[b+"."+a]||
a.replace(/{\#([^}]+)\}/g,function(a,d){return c[b+"."+d]||"{#"+d+"}"})},getLang:function(a,b){return d.i18n[(this.settings.language||"en")+"."+a]||(m(b)?b:"{#"+a+"}")},getParam:function(a,b,c){var e=d.trim,a=m(this.settings[a])?this.settings[a]:b,h;return"hash"===c?(h={},m(a,"string")?j(0<a.indexOf("=")?a.split(/[;,](?![^=;,]*(?:[;,]|$))/):a.split(","),function(a){a=a.split("=");1<a.length?h[e(a[0])]=e(a[1]):h[e(a[0])]=e(a)}):h=a,h):a},nodeChanged:function(a){var b=this.selection,c=b.getStart()||
this.getBody();this.initialized&&(a=a||{},c=r&&c.ownerDocument!=this.getDoc()?this.getBody():c,a.parents=[],this.dom.getParent(c,function(b){if("BODY"==b.nodeName)return!0;a.parents.push(b)}),this.onNodeChange.dispatch(this,a?a.controlManager||this.controlManager:this.controlManager,c,b.isCollapsed(),a))},addButton:function(a,b){this.buttons=this.buttons||{};this.buttons[a]=b},addCommand:function(a,b,c){this.execCommands[a]={func:b,scope:c||this}},addQueryStateHandler:function(a,b,c){this.queryStateCommands[a]=
{func:b,scope:c||this}},addQueryValueHandler:function(a,b,c){this.queryValueCommands[a]={func:b,scope:c||this}},addShortcut:function(a,b,c,e){var d=this,f;if(!d.settings.custom_shortcuts)return!1;d.shortcuts=d.shortcuts||{};m(c,"string")&&(f=c,c=function(){d.execCommand(f,!1,null)});m(c,"object")&&(f=c,c=function(){d.execCommand(f[0],f[1],f[2])});j(q(a),function(a){var f={func:c,scope:e||this,desc:b,alt:false,ctrl:false,shift:false};j(q(a,"+"),function(a){switch(a){case "alt":case "ctrl":case "shift":f[a]=
true;break;default:f.charCode=a.charCodeAt(0);f.keyCode=a.toUpperCase().charCodeAt(0)}});d.shortcuts[(f.ctrl?"ctrl":"")+","+(f.alt?"alt":"")+","+(f.shift?"shift":"")+","+f.keyCode]=f});return!0},execCommand:function(a,b,c,e){var d=this,f=0,g;!/^(mceAddUndoLevel|mceEndUndoLevel|mceBeginUndoLevel|mceRepaint|SelectAll)$/.test(a)&&(!e||!e.skip_focus)&&d.focus();e=u({},e);d.onBeforeExecCommand.dispatch(d,a,b,c,e);if(e.terminate)return!1;if(d.execCallback("execcommand_callback",d.id,d.selection.getNode(),
a,b,c))return d.onExecCommand.dispatch(d,a,b,c,e),!0;if(g=d.execCommands[a])if(g=g.func.call(g.scope,b,c),!0!==g)return d.onExecCommand.dispatch(d,a,b,c,e),g;j(d.plugins,function(g){if(g.execCommand&&g.execCommand(a,b,c))return d.onExecCommand.dispatch(d,a,b,c,e),f=1,!1});if(f)return!0;if(d.theme&&d.theme.execCommand&&d.theme.execCommand(a,b,c)||d.editorCommands.execCommand(a,b,c))return d.onExecCommand.dispatch(d,a,b,c,e),!0;d.getDoc().execCommand(a,b,c);d.onExecCommand.dispatch(d,a,b,c,e)},queryCommandState:function(a){var b;
if(!this._isHidden()){if(b=this.queryStateCommands[a])if(b=b.func.call(b.scope),!0!==b)return b;b=this.editorCommands.queryCommandState(a);if(-1!==b)return b;try{return this.getDoc().queryCommandState(a)}catch(c){}}},queryCommandValue:function(a){var b;if(!this._isHidden()){if(b=this.queryValueCommands[a])if(b=b.func.call(b.scope),!0!==b)return b;b=this.editorCommands.queryCommandValue(a);if(m(b))return b;try{return this.getDoc().queryCommandValue(a)}catch(c){}}},show:function(){g.show(this.getContainer());
g.hide(this.id);this.load()},hide:function(){var a=this.getDoc();r&&a&&a.execCommand("SelectAll");this.save();g.hide(this.getContainer());g.setStyle(this.id,"display",this.orgDisplay)},isHidden:function(){return!g.isHidden(this.id)},setProgressState:function(a,b,c){this.onSetProgressState.dispatch(this,a,b,c);return a},load:function(a){var b=this.getElement(),c;if(b)return a=a||{},a.load=!0,c=this.setContent(m(b.value)?b.value:b.innerHTML,a),a.element=b,a.no_events||this.onLoadContent.dispatch(this,
a),a.element=null,c},save:function(a){var b=this,c=b.getElement(),d,h;if(c&&b.initialized){a=a||{};a.save=!0;try{a.no_events||(b.undoManager.typing=!1,b.undoManager.add())}catch(f){AJS.logError("editor.save() : "+f)}a.element=c;d=a.content=b.getContent(a);a.no_events||b.onSaveContent.dispatch(b,a);d=a.content;/TEXTAREA|INPUT/i.test(c.nodeName)?c.value=d:(c.innerHTML=d,(h=g.getParent(b.id,"form"))&&j(h.elements,function(a){if(a.name==b.id)return a.value=d,!1}));a.element=c=null;return d}},setContent:function(a,
b){var c=this.getBody(),e,b=b||{};b.format=b.format||"html";b.set=!0;b.content=a;b.no_events||this.onBeforeSetContent.dispatch(this,b);a=b.content;if(!d.isIE&&(0===a.length||/^\s+$/.test(a)))a=(e=this.settings.forced_root_block)?"<"+e+'><br data-mce-bogus="1"></'+e+">":'<br data-mce-bogus="1">',c.innerHTML=a,this.selection.select(c,!0),this.selection.collapse(!0);"raw"!==b.format&&(a=(new d.html.Serializer({},this.schema)).serialize(this.parser.parse(a)));b.content=d.trim(a);this.dom.setHTML(c,b.content);
b.no_events||this.onSetContent.dispatch(this,b);this.selection.normalize();return b.content},getContent:function(a){var b,a=a||{};a.format=a.format||"html";a.get=!0;a.no_events||this.onBeforeGetContent.dispatch(this,a);b="raw"==a.format?this.getBody().innerHTML:this.serializer.serialize(this.getBody(),a);a.content=d.trim(b);a.no_events||this.onGetContent.dispatch(this,a);return a.content},isDirty:function(){return d.trim(this.startContent)!=d.trim(this.getContent({format:"raw",no_events:1}))&&!this.isNotDirty},
setDirty:function(a){this.isNotDirty=a?0:1},getContainer:function(){this.container||(this.container=g.get(this.editorContainer||this.id+"_parent"));return this.container},getContentAreaContainer:function(){return this.contentAreaContainer},getElement:function(){return g.get(this.settings.content_element||this.id)},getWin:function(){var a;if(!this.contentWindow&&(a=g.get(this.id+"_ifr")))this.contentWindow=a.contentWindow;return this.contentWindow},getDoc:function(){var a;if(!this.contentDocument&&
(a=this.getWin()))this.contentDocument=a.document;return this.contentDocument},getBody:function(){return this.bodyElement||this.getDoc().body},convertURL:function(a,b,c){var d=this.settings;return d.urlconverter_callback?this.execCallback("urlconverter_callback",a,c,!0,b):!d.convert_urls||c&&"LINK"==c.nodeName||0===a.indexOf("file:")?a:d.relative_urls?this.documentBaseURI.toRelative(a):a=this.documentBaseURI.toAbsolute(a,d.remove_script_host)},addVisual:function(a){var b=this,c=b.settings,a=a||b.getBody();
m(b.hasVisual)||(b.hasVisual=c.visual);j(b.dom.select("table,a",a),function(a){var d;switch(a.nodeName){case "TABLE":d=b.dom.getAttrib(a,"border");if(!d||d=="0")b.hasVisual?b.dom.addClass(a,c.visual_table_class):b.dom.removeClass(a,c.visual_table_class);break;case "A":(d=b.dom.getAttrib(a,"name"))&&(b.hasVisual?b.dom.addClass(a,"mceItemAnchor"):b.dom.removeClass(a,"mceItemAnchor"))}});b.onVisualAid.dispatch(b,a,b.hasVisual)},remove:function(){var a=this.getContainer();this.removed=1;this.hide();this.execCallback("remove_instance_callback",
this);this.onRemove.dispatch(this);this.onExecCommand.listeners=[];d.remove(this);g.remove(a)},destroy:function(a){this.destroyed||(a||(d.removeUnload(this.destroy),tinyMCE.onBeforeUnload.remove(this._beforeUnload),this.theme&&this.theme.destroy&&this.theme.destroy(),this.controlManager.destroy(),this.selection.destroy(),this.dom.destroy(),this.settings.content_editable||(i.clear(this.getWin()),i.clear(this.getDoc())),i.clear(this.getBody()),i.clear(this.formElement)),this.formElement&&(this.formElement.submit=
this.formElement._mceOldSubmit,this.formElement._mceOldSubmit=null),this.contentAreaContainer=this.formElement=this.container=this.settings.content_element=this.bodyElement=this.contentDocument=this.contentWindow=null,this.selection&&(this.selection=this.selection.win=this.selection.dom=this.selection.dom.doc=null),this.destroyed=1)},_addEvents:function(){function a(a,c){b.removed||!1!==b.onEvent.dispatch(b,a,c)&&b[h[a.fakeType||a.type]].dispatch(b,a,c)}var b=this,c=b.settings,e=b.dom,h={mouseup:"onMouseUp",
mousedown:"onMouseDown",click:"onClick",keyup:"onKeyUp",keydown:"onKeyDown",keypress:"onKeyPress",submit:"onSubmit",reset:"onReset",contextmenu:"onContextMenu",dblclick:"onDblClick",paste:"onPaste"};j(h,function(d,f){switch(f){case "contextmenu":e.bind(b.getDoc(),f,a);break;case "paste":e.bind(b.getBody(),f,function(b){a(b)});break;case "submit":case "reset":e.bind(b.getElement().form||g.getParent(b.id,"form"),f,a);break;default:e.bind(c.content_editable?b.getBody():b.getDoc(),f,a)}});e.bind(c.content_editable?
b.getBody():p?b.getDoc():b.getWin(),"focus",function(){b.focus(!0)});if(c.content_editable&&d.isOpera){var f=function(){b.focus(!0)};e.bind(b.getBody(),"click",f);e.bind(b.getBody(),"keydown",f)}d.isGecko&&e.bind(b.getDoc(),"DOMNodeInserted",function(a){var c,a=a.target;if(1===a.nodeType&&"IMG"===a.nodeName&&(c=a.getAttribute("data-mce-src")))a.src=b.documentBaseURI.toAbsolute(c)});p&&(f=function(){var a=this.getDoc(),b=this.settings;if(p&&!b.readonly){this._refreshContentEditable();try{a.execCommand("styleWithCSS",
0,!1)}catch(c){if(!this._isHidden())try{a.execCommand("useCSS",0,!0)}catch(d){}}if(!b.table_inline_editing)try{a.execCommand("enableInlineTableEditing",!1,!1)}catch(e){}if(!b.object_resizing)try{a.execCommand("enableObjectResizing",!1,!1)}catch(f){}}},b.onBeforeExecCommand.add(f),b.onMouseDown.add(f));b.onMouseUp.add(b.nodeChanged);b.onKeyUp.add(function(a,c){var e=c.keyCode;(e>=33&&e<=36||e>=37&&e<=40||e==13||e==45||e==46||e==8||d.isMac&&(e==91||e==93)||c.ctrlKey)&&b.nodeChanged()});b.onKeyDown.add(function(a,
b){if(b.keyCode==w.BACKSPACE){var c=a.selection.getRng(true);if(c.collapsed){for(var d=c.startContainer,e=c.startOffset;d&&d.nodeType&&d.nodeType!=1&&d.parentNode;)d=d.parentNode;if(d&&d.parentNode&&d.parentNode.tagName==="BLOCKQUOTE"&&d.parentNode.firstChild==d&&e===0){a.formatter.toggle("blockquote",null,d.parentNode);c.setStart(d,0);c.setEnd(d,0);a.selection.setRng(c);a.selection.collapse(false)}}}});b.onReset.add(function(){b.setContent(b.startContent,{format:"raw"})});if(c.custom_shortcuts){c.custom_undo_redo_keyboard_shortcuts&&
(b.addShortcut("ctrl+z",b.getLang("undo_desc"),"Undo"),b.addShortcut("ctrl+y",b.getLang("redo_desc"),"Redo"));b.addShortcut("ctrl+b",b.getLang("bold_desc"),"Bold");b.addShortcut("ctrl+i",b.getLang("italic_desc"),"Italic");b.addShortcut("ctrl+u",b.getLang("underline_desc"),"Underline");var k=function(a){var c=null;if(!a.altKey&&!a.ctrlKey&&!a.metaKey)return c;j(b.shortcuts,function(b){if(!d.isMac||!(b.ctrl!=a.metaKey&&b.ctrl!=a.ctrlKey))if((d.isMac||b.ctrl==a.ctrlKey)&&b.alt==a.altKey&&b.shift==a.shiftKey)if(a.keyCode==
b.keyCode||a.charCode&&a.charCode==b.charCode){c=b;return false}});return c};b.onKeyUp.add(function(a,b){if(k(b))return i.cancel(b)});b.onKeyPress.add(function(a,b){if(k(b))return i.cancel(b)});b.onKeyDown.add(function(a,b){var c=k(b);if(c){c.func.call(c.scope);return i.cancel(b)}})}d.isIE&&e.bind(b.getDoc(),"controlselect",function(a){var c=b.resizeInfo,a=a.target;if(a.nodeName==="IMG"){c&&e.unbind(c.node,c.ev,c.cb);if(e.hasClass(a,"mceItemNoResize")){ev="resizestart";c=e.bind(a,"resizestart",i.cancel,
i)}else{ev="resizeend";c=e.bind(a,ev,function(a){var b,a=a.target;if(b=e.getStyle(a,"width")){e.setAttrib(a,"width",b.replace(/[^0-9%]+/g,""));e.setStyle(a,"width","")}if(b=e.getStyle(a,"height")){e.setAttrib(a,"height",b.replace(/[^0-9%]+/g,""));e.setStyle(a,"height","")}})}c=b.resizeInfo={node:a,ev:ev,cb:c}}});d.isOpera&&b.onClick.add(function(a,b){i.prevent(b)});if(c.custom_undo_redo){var l=function(){b.undoManager.typing=false;b.undoManager.add()},f=d.isGecko?"blur":"focusout";e.bind(b.getDoc(),
f,function(){!b.removed&&b.undoManager.typing&&l()});b.dom.bind(b.dom.getRoot(),"dragend",function(){l()});b.onKeyUp.add(function(a,b){var c=b.keyCode;(c>=33&&c<=36||c>=37&&c<=40||c==13||c==45||b.ctrlKey)&&l()});b.onKeyDown.add(function(a,c){var e=c.keyCode,f;if(e==8)if((f=b.getDoc().selection)&&f.createRange&&f.createRange().item){b.undoManager.beforeChange();a.dom.remove(f.createRange().item(0));l();return i.cancel(c)}if(e>=33&&e<=36||e>=37&&e<=40||e==13||e==45){d.isIE&&e==13&&b.undoManager.beforeChange();
b.undoManager.typing&&l()}else if((e<16||e>20)&&e!=224&&e!=91&&!b.undoManager.typing){b.undoManager.beforeChange();b.undoManager.typing=true;b.undoManager.add()}});b.onMouseDown.add(function(){b.undoManager.typing&&l()})}if(d.isGecko){var n=function(){var a=b.dom.getAttribs(b.selection.getStart().cloneNode(false));return function(){var c=b.selection.getStart();if(c!==b.getBody()){b.dom.setAttrib(c,"style",null);j(a,function(a){c.setAttributeNode(a.cloneNode(true))})}}},m=function(){var a=b.selection;
return!a.isCollapsed()&&a.getStart()!=a.getEnd()};b.onKeyPress.add(function(a,c){var d;if((c.keyCode==8||c.keyCode==46)&&m()){d=n();b.getDoc().execCommand("delete",false,null);d();return i.cancel(c)}});b.dom.bind(b.getDoc(),"cut",function(){var a;if(m()){a=n();b.onKeyUp.addToTop(i.cancel,i);setTimeout(function(){a();b.onKeyUp.remove(i.cancel,i)},0)}})}},_refreshContentEditable:function(){var a,b;this._isHidden()&&(a=this.getBody(),b=a.parentNode,b.removeChild(a),b.appendChild(a),a.focus())},_isHidden:function(){var a;
if(!p)return 0;a=this.selection.getSel();return!a||!a.rangeCount||0==a.rangeCount}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/EditorCommands.js' */
(function(k){var r=k.each,i=!0,p=!1;k.EditorCommands=function(e){function u(b,a,c){var d,b=b.toLowerCase();return(d=s.exec[b])?(d(b,a,c),i):p}function j(b){var a,b=b.toLowerCase();return(a=s.state[b])?a(b):-1}function q(b,a){a=a||"exec";r(b,function(b,d){r(d.toLowerCase().split(","),function(d){s[a][d]=b})})}function t(b,a,c){void 0===a&&(a=p);void 0===c&&(c=null);return e.getDoc().execCommand(b,a,c)}function m(b,a){h.toggle(b,a?{value:a}:void 0)}var f=e.dom,d=e.selection,s={state:{},exec:{},value:{}},
n=e.settings,h=e.formatter,o;k.extend(this,{execCommand:u,queryCommandState:j,queryCommandValue:function(b){var a,b=b.toLowerCase();return(a=s.value[b])?a(b):p},addCommands:q});q({"mceResetDesignMode,mceBeginUndoLevel":function(){},"mceEndUndoLevel,mceAddUndoLevel":function(){e.undoManager.add()},"Cut,Copy,Paste":function(b){var a=e.getDoc(),c;try{t(b)}catch(d){c=i}if(c||!a.queryCommandSupported(b))k.isGecko?e.windowManager.confirm(e.getLang("clipboard_msg"),function(a){a&&open("http://www.mozilla.org/editor/midasdemo/securityprefs.html",
"_blank")}):e.windowManager.alert(e.getLang("clipboard_no_support"))},unlink:function(b){d.isCollapsed()&&d.select(d.getNode());t(b);d.collapse(p)},"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(b){var a=b.substring(7);e.undoManager.add();var c=d.getRng(),f=d.getNode();r(["left","center","right","full"],function(b){a!=b&&h.remove("align"+b);!tinyMCE.isIE&&("IMG"==f.nodeName&&("#document"==d.getRng().startContainer.nodeName||"#text"==d.getRng().startContainer.nodeName))&&d.setRng(c)});
m("align"+a);u("mceRepaint")},"InsertUnorderedList,InsertOrderedList":function(b){var a;t(b);if(b=f.getParent(d.getNode(),"ol,ul"))a=b.parentNode,/^(H[1-6]|P|ADDRESS|PRE)$/.test(a.nodeName)&&(o=d.getBookmark(void 0),f.split(a,b),d.moveToBookmark(o))},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(b){m(b)},"ForeColor,HiliteColor,FontName":function(b,a,c){m(b,c)},FontSize:function(b,a,c){var d;1<=c&&7>=c&&(d=k.explode(n.font_size_style_values),c=(a=k.explode(n.font_size_classes))?
a[c-1]||c:d[c-1]||c);m(b,c)},RemoveFormat:function(b){h.remove(b)},mceBlockQuote:function(){m("blockquote")},FormatBlock:function(b,a,c){return m(c||"p")},mceCleanup:function(){var b=d.getBookmark();e.setContent(e.getContent({cleanup:i}),{cleanup:i});d.moveToBookmark(b)},mceRemoveNode:function(b,a,c){b=c||d.getNode();b!=e.getBody()&&(o=d.getBookmark(void 0),e.dom.remove(b,i),d.moveToBookmark(o))},mceSelectNodeDepth:function(b,a,c){var l=0;f.getParent(d.getNode(),function(a){if(1==a.nodeType&&l++==
c)return d.select(a),p},e.getBody())},mceSelectNode:function(b,a,c){d.select(c)},mceInsertContent:function(b,a,c){var l,i,g,h,j;l=e.parser;i=new k.html.Serializer({},e.schema);b={content:c,format:"html"};d.onBeforeSetContent.dispatch(d,b);c=b.content;-1==c.indexOf("{$caret}")&&(c+="{$caret}");c=c.replace(/\{\$caret\}/,'<span id="mce_marker" data-mce-type="bookmark"></span>');!d.isCollapsed()&&d.getContent().length&&e.execCommand("mceDelete",!1,null,{skip_undo:!0});g=d.getNode();b={context:g.nodeName.toLowerCase()};
j=l.parse(c,b);a=j.lastChild;if("mce_marker"==a.attr("id")){c=a;for(a=a.prev;a;a=a.walk(!0))if(3==a.type||!f.isBlock(a.name)){a.parent.insert(c,a,"br"===a.name);break}}if(b.invalid){d.setContent('<span id="mce_marker" data-mce-type="bookmark"></span>');g=e.selection.getNode();h=e.getBody();for(9==g.nodeType?g=a=h:a=g;a!==h;)g=a,a=a.parentNode;c=g==h?h.innerHTML:f.getOuterHTML(g);c=i.serialize(l.parse(c.replace(/<span (id="mce_marker"|id=mce_marker).+?<\/span>/i,function(){return i.serialize(j)})));
g==h?f.setHTML(h,c):f.setOuterHTML(g,c)}else c=i.serialize(j),a=g.firstChild,l=g.lastChild,!a||a===l&&"BR"===a.nodeName?f.setHTML(g,c):d.setContent(c);c=f.get("mce_marker");a=f.getRect(c);g=f.getViewPort(e.getWin());if(a.y+a.h>g.y+g.h||a.y<g.y||a.x>g.x+g.w||a.x<g.x)l=k.isIE?e.getDoc().documentElement:e.getBody(),l.scrollLeft=a.x,l.scrollTop=a.y-g.h+25;g=f.createRng();(a=c.previousSibling)&&3==a.nodeType?g.setStart(a,a.nodeValue.length):(g.setStartBefore(c),g.setEndBefore(c));f.remove(c);d.setRng(g);
d.onSetContent.dispatch(d,b);e.addVisual()},mceInsertRawHTML:function(b,a,c){d.setContent("tiny_mce_marker");e.setContent(e.getContent().replace(/tiny_mce_marker/g,function(){return c}))},mceSetContent:function(b,a,c){e.setContent(c)},"Indent,Outdent":function(b){var a,c,e;a=n.indentation;c=/[a-z%]+$/i.exec(a);a=parseInt(a);!j("InsertUnorderedList")&&!j("InsertOrderedList")&&!j("InsertInlineTaskList")?r(d.getSelectedBlocks(),function(d){"outdent"==b?(e=Math.max(0,parseInt(d.style.paddingLeft||0)-
a),f.setStyle(d,"paddingLeft",e?e+c:"")):f.setStyle(d,"paddingLeft",parseInt(d.style.paddingLeft||0)+a+c)}):t(b)},mceRepaint:function(){if(k.isGecko)try{o=d.getBookmark(i),d.getSel()&&d.getSel().selectAllChildren(e.getBody()),d.collapse(i),d.moveToBookmark(o)}catch(b){}},mceToggleFormat:function(b,a,c){h.toggle(c)},InsertHorizontalRule:function(){e.execCommand("mceInsertContent",!1,"<hr />")},mceToggleVisualAid:function(){e.hasVisual=!e.hasVisual;e.addVisual()},mceReplaceContent:function(b,a,c){e.execCommand("mceInsertContent",
!1,c.replace(/\{\$selection\}/g,d.getContent({format:"text"})))},mceInsertLink:function(b,a,c){"string"==typeof c&&(c={href:c});b=f.getParent(d.getNode(),"a");c.href=c.href.replace(" ","%20");(!b||!c.href)&&h.remove("link");c.href&&h.apply("link",c,b)},selectAll:function(){var b=f.getRoot(),a=f.createRng();a.setStart(b,0);a.setEnd(b,b.childNodes.length);e.selection.setRng(a)}});q({"JustifyLeft,JustifyCenter,JustifyRight,JustifyFull":function(b){var a="align"+b.substring(7),b=d.isCollapsed()?[d.getNode()]:
d.getSelectedBlocks(),b=k.map(b,function(b){return!!h.matchNode(b,a)});return-1!==k.inArray(b,i)},"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":function(b){return h.match(b)},mceBlockQuote:function(){return h.match("blockquote")},Outdent:function(){var b;return n.inline_styles&&((b=f.getParent(d.getStart(),f.isBlock))&&0<parseInt(b.style.paddingLeft)||(b=f.getParent(d.getEnd(),f.isBlock))&&0<parseInt(b.style.paddingLeft))?i:j("InsertUnorderedList")||j("InsertOrderedList")||j("InsertInlineTaskList")||
!n.inline_styles&&!!f.getParent(d.getNode(),"BLOCKQUOTE")},"InsertUnorderedList,InsertOrderedList,InsertInlineTaskList":function(b){var a=f.getParent(d.getNode(),"ul,ol"),c;if(!a)return!1;c=a.tagName;return"OL"===c&&"insertorderedlist"===b||"UL"===c&&!f.hasClass(a,"inline-task-list")&&"insertunorderedlist"===b||"UL"===c&&f.hasClass(a,"inline-task-list")&&"insertinlinetasklist"===b}},"state");q({"FontSize,FontName":function(b){var a=0,c;if(c=f.getParent(d.getNode(),"span"))a="fontsize"==b?c.style.fontSize:
c.style.fontFamily.replace(/, /g,",").replace(/[\'\"]/g,"").toLowerCase();return a}},"value");n.custom_undo_redo&&q({Undo:function(){e.undoManager.undo()},Redo:function(){e.undoManager.redo()}})}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/UndoManager.js' */
(function(g){var h=g.util.Dispatcher;g.UndoManager=function(e){var c,d=0,b=[],i;return c={typing:!1,onAdd:new h(c),onUndo:new h(c),onRedo:new h(c),beforeChange:function(){i=e.selection.getBookmark(2,!0)},add:function(a){var f;f=e.settings;var j,a=a||{};a.content=g.trim(e.getContent({format:"raw",no_events:1}));if((j=b[d])&&j.content==a.content)return null;b[d]&&(b[d].beforeBookmark=i);if(f.custom_undo_redo_levels&&b.length>f.custom_undo_redo_levels){for(f=0;f<b.length-1;f++)b[f]=b[f+1];b.length--;
d=b.length}a.bookmark=e.selection.getBookmark(2,!0);d<b.length-1&&(b.length=d+1);b.push(a);d=b.length-1;c.onAdd.dispatch(c,a);e.isNotDirty=0;return a},undo:function(){var a;c.typing&&(c.add(),c.typing=!1);0<d&&(a=b[--d],e.setContent(a.content,{format:"raw"}),e.selection.moveToBookmark(a.beforeBookmark),c.onUndo.dispatch(c,a));return a},redo:function(){var a;d<b.length-1&&(a=b[++d],e.setContent(a.content,{format:"raw"}),e.selection.moveToBookmark(a.bookmark),c.onRedo.dispatch(c,a));return a},clear:function(){b=
[];d=0;c.typing=!1},hasUndo:function(){return 0<d||this.typing},hasRedo:function(){return d<b.length-1&&!this.typing},ignore:function(a,c){var d=b.slice();a.call(c||e);b=d}}}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ForceBlocks.js' */
(function(s){var u=s.dom.Event,y=s.isIE,z=s.isGecko,x=s.isOpera,t=!1;s.create("tinymce.ForceBlocks",{ForceBlocks:function(k){var a=k.settings,h;this.editor=k;this.dom=k.dom;h=(a.forced_root_block||"p").toLowerCase();a.element=h.toUpperCase();k.onPreInit.add(this.setup,this)},setup:function(){var k=this,a=k.editor,h=a.settings,d=a.dom,f=a.selection,n=a.schema.getBlockElements();if(h.forced_root_block){var c=function(){var b=f.getStart(),o=d.getRoot(),c=a.getDoc().body,e,g,k,p,j,l;if(b&&1===b.nodeType){for(;b!=
o;)if(b&&1===b.nodeType){if(n[b.nodeName])return;b=b.parentNode}else return;e=f.getRng();if(e.setStart)g=e.startContainer,k=e.startOffset,p=e.endContainer,j=e.endOffset;else if(e.item&&(e=a.getDoc().body.createTextRange(),e.moveToElementText(e.item(0))),tmpRng=e.duplicate(),tmpRng.collapse(!0),k=-1*tmpRng.move("character",-16777215),!tmpRng.collapsed)tmpRng=e.duplicate(),tmpRng.collapse(!1),j=-1*tmpRng.move("character",-16777215)-k;for(b=o.firstChild;b;b)3===b.nodeType||1==b.nodeType&&!n[b.nodeName]?
(l||(l=d.create(h.forced_root_block),b.parentNode.insertBefore(l,b)),o=b,b=b.nextSibling,l.appendChild(o)):(l=null,b=b.nextSibling);if(e.setStart)e.setStart(g,k),e.setEnd(p,j),f.setRng(e);else try{e=c.createTextRange(),e.moveToElementText(c),e.move("character",-16777215),e.collapse(!0),e.moveStart("character",k),0<j&&e.moveEnd("character",j),e.select()}catch(q){}a.nodeChanged()}};a.onKeyUp.add(c);a.onKeyDown.add(c);a.onClick.add(c)}h.force_br_newlines&&y&&a.onKeyPress.add(function(b,a){var c;if(13==
a.keyCode&&"LI"!=f.getNode().nodeName)return f.setContent('<br id="__" /> ',{format:"raw"}),c=d.get("__"),c.removeAttribute("id"),f.select(c),f.collapse(),u.cancel(a)});h.force_p_newlines&&(y||a.onKeyPress.add(function(b,a){13==a.keyCode&&(!a.shiftKey&&!k.insertPara(a))&&u.cancel(a)}),z&&a.onKeyDown.add(function(b,a){(8==a.keyCode||46==a.keyCode)&&!a.shiftKey&&k.backspaceDelete(a,8==a.keyCode)}));s.isWebKit&&a.onKeyPress.add(function(a,c){if(c.keyCode==13&&(c.shiftKey||h.force_br_newlines&&!d.getParent(f.getNode(),
"h1,h2,h3,h4,h5,h6,ol,ul"))){var i=f.getRng(),e,g=d.create("div",null," "),k=d.getViewPort(a.getWin());i.insertNode(e=d.create("br"));i.setStartAfter(e);i.setEndAfter(e);f.setRng(i);if(f.getSel().focusNode==e.previousSibling){f.select(d.insertAfter(d.doc.createTextNode(""),e));f.collapse(true)}d.insertAfter(g,e);i=d.getPos(g).y;e=d.getSize(g).h;d.remove(g);g=i+e;g>k.y+k.h&&a.getWin().scrollTo(0,g-k.h);u.cancel(c)}});y&&"P"!=h.element&&(a.onKeyPress.add(function(){k.lastElm=f.getNode().nodeName}),
a.onKeyUp.add(function(a,c){var i;i=f.getNode();if(a.getBody().childNodes.length===1&&i.nodeName=="P"){i=d.rename(i,h.element);f.select(i);f.collapse();a.nodeChanged()}else if(c.keyCode==13&&!c.shiftKey&&k.lastElm!="P")if(i=d.getParent(i,"p")){d.rename(i,h.element);a.nodeChanged()}}))},getParentBlock:function(k){var a=this.dom;return a.getParent(k,a.isBlock)},insertPara:function(){function k(a,b){var c=[],d,e;a.innerHTML="";if(f.keep_styles){e=b;do/^(SPAN|STRONG|B|EM|I|FONT|STRIKE|U)$/.test(e.nodeName)&&
(d=e.cloneNode(t),h.setAttrib(d,"id",""),c.push(d));while(e=e.parentNode)}if(0<c.length){e=c.length-1;for(d=a;0<=e;e--)d=d.appendChild(c[e]);c[0].innerHTML=x?"":"<br />";return c[0]}a.innerHTML=x?"":"<br />"}var a=this.editor,h=a.dom,d=a.getDoc(),f=a.settings,n=a.selection.getSel(),c=n.getRangeAt(0),b=d.body,o,i,e,g,v,p,j,l,q,w,m,r=h.getViewPort(a.getWin());a.undoManager.beforeChange();o=d.createRange();o.setStart(n.anchorNode,n.anchorOffset);o.collapse(!0);i=d.createRange();i.setStart(n.focusNode,
n.focusOffset);i.collapse(!0);g=(e=0>o.compareBoundaryPoints(o.START_TO_END,i))?n.anchorNode:n.focusNode;v=e?n.anchorOffset:n.focusOffset;p=e?n.focusNode:n.anchorNode;n=e?n.focusOffset:n.anchorOffset;if(s.isWebKit&&g===p&&1===g.nodeType&&0<g.childNodes.length&&a.dom.is(q=g.childNodes[0<v?v-1:0],"table"))return d=h.create("p",0,'<br data-mce-bogus="1" />'),h.insertAfter(d,q),c.setStart(d,0),a.selection.setRng(c),d=a.dom.getPos(d).y,d>r.y&&a.getWin().scrollTo(0,d),a.undoManager.add(),t;if(g===p&&/^(TD|TH)$/.test(g.nodeName))return"BR"==
g.firstChild.nodeName&&h.remove(g.firstChild),0==g.childNodes.length?a.dom.add(g,f.element,null,"<br />"):(m=g.innerHTML,g.innerHTML="",a.dom.add(g,f.element,null,m)),l=a.dom.add(g,f.element,null,"<br />"),c=d.createRange(),c.selectNodeContents(l),c.collapse(1),a.selection.setRng(c),t;g==b&&(p==b&&b.firstChild&&a.dom.isBlock(b.firstChild))&&(g=p=g.firstChild,v=n=0,o=d.createRange(),o.setStart(g,0),i=d.createRange(),i.setStart(p,0));d.body.hasChildNodes()||d.body.appendChild(h.create("br"));g="HTML"==
g.nodeName?d.body:g;g="BODY"==g.nodeName?g.firstChild:g;p="HTML"==p.nodeName?d.body:p;p="BODY"==p.nodeName?p.firstChild:p;q=a.dom.getRoot();g.nodeName==q.nodeName&&(g=g.firstChild,v=0);p.nodeName==q.nodeName&&(p=p.firstChild,n=0);j=this.getParentBlock(g);l=this.getParentBlock(p);q=j?j.nodeName:f.element;if(m=this.dom.getParent(j,"li,pre"))return"LI"==m.nodeName?(a=a.selection,r=this.dom,d=m,r.isEmpty(d)?(b=r.getParent(d,"ul,ol"),r.getParent(b.parentNode,"ul,ol")||(r.split(b,d),b=r.create("p",0,'<br data-mce-bogus="1" />'),
r.replace(b,d),a.select(b,1)),AJS.Rte.showSelection(),a=t):a=!0,a):!0;if(j&&("CAPTION"==j.nodeName||/absolute|relative|fixed/gi.test(h.getStyle(j,"position",1))))q=f.element,j=null;if(l&&("CAPTION"==l.nodeName||/absolute|relative|fixed/gi.test(h.getStyle(j,"position",1))))q=f.element,l=null;if(/(TD|TABLE|TH|CAPTION)/.test(q)||j&&"DIV"==q&&/left|right/gi.test(h.getStyle(j,"float",1)))q=f.element,j=l=null;e=j&&j.nodeName==q?j.cloneNode(0):a.dom.create(q);l=l&&l.nodeName==q?l.cloneNode(0):a.dom.create(q);
l.removeAttribute("id");if(m=/^(H[1-6])$/.test(q))m=j,j=m.ownerDocument.createRange(),j.setStart(c.endContainer,c.endOffset),j.setEndAfter(m),m=0==j.cloneContents().textContent.length;m&&(l=a.dom.create(f.element));m=j=g;do{if(m==b||9==m.nodeType||this.dom.isBlock(m)||/(TD|TABLE|TH|CAPTION)/.test(m.nodeName))break;j=m}while(m=m.previousSibling?m.previousSibling:m.parentNode);m=w=p;do{if(m==b||9==m.nodeType||this.dom.isBlock(m)||/(TD|TABLE|TH|CAPTION)/.test(m.nodeName))break;w=m}while(m=m.nextSibling?
m.nextSibling:m.parentNode);j.nodeName==q?o.setStart(j,0):o.setStartBefore(j);o.setEnd(g,v);e.appendChild(o.cloneContents()||d.createTextNode(""));try{i.setEndAfter(w)}catch(u){}i.setStart(p,n);l.appendChild(i.cloneContents()||d.createTextNode(""));c=d.createRange();!j.previousSibling&&j.parentNode.nodeName==q?c.setStartBefore(j.parentNode):o.startContainer.nodeName==q&&0==o.startOffset?c.setStartBefore(o.startContainer):c.setStart(o.startContainer,o.startOffset);!w.nextSibling&&w.parentNode.nodeName==
q?c.setEndAfter(w.parentNode):c.setEnd(i.endContainer,i.endOffset);c.deleteContents();x&&a.getWin().scrollTo(0,r.y);e.firstChild&&e.firstChild.nodeName==q&&(e.innerHTML=e.firstChild.innerHTML);l.firstChild&&l.firstChild.nodeName==q&&(l.innerHTML=l.firstChild.innerHTML);h.isEmpty(e)&&k(e,g);h.isEmpty(l)&&k(l,p);x&&9.5>parseFloat(opera.version())?(c.insertNode(e),c.insertNode(l)):(c.insertNode(l),c.insertNode(e));l.normalize();e.normalize();a.selection.select(l,!0);a.selection.collapse(!0);d=a.dom.getPos(l).y;
if(d<r.y||d+25>r.y+r.h)a.getWin().scrollTo(0,d<r.y?d:d-r.h+25);a.undoManager.add();return t},backspaceDelete:function(k,a){var h=this.editor,d=h.getBody(),f,n=h.selection,c=n.getRng(),b=c.startContainer,o;if(!(k.getPreventDefault?k.getPreventDefault():k.defaultPrevented)){if(!a&&c.collapsed&&1==b.nodeType&&c.startOffset==b.childNodes.length){o=new s.dom.TreeWalker(b.lastChild,b);for(f=b.lastChild;f;f=o.prev())if(3==f.nodeType){c.setStart(f,f.nodeValue.length);c.collapse(!0);n.setRng(c);return}}if(b&&
(h.dom.isBlock(b)&&!/^(TD|TH)$/.test(b.nodeName)&&a)&&(0==b.childNodes.length||1==b.childNodes.length&&"BR"==b.firstChild.nodeName)){for(f=b;(f=f.previousSibling)&&!h.dom.isBlock(f););if(f){if(b!=d.firstChild){for(d=h.dom.doc.createTreeWalker(f,NodeFilter.SHOW_TEXT,null,t);c=d.nextNode();)f=c;c=h.getDoc().createRange();c.setStart(f,f.nodeValue?f.nodeValue.length:0);c.setEnd(f,f.nodeValue?f.nodeValue.length:0);n.setRng(c);h.dom.remove(b)}return u.cancel(k)}}if(!a&&c.collapsed&&/^(BODY)$/.test(b.nodeName)&&
(b=b.childNodes[c.startOffset])&&(h.dom.isBlock(b)&&!/^(TD|TH)$/.test(b.nodeName))&&(0==b.childNodes.length||1==b.childNodes.length&&"BR"==b.firstChild.nodeName)){f=b;for(var i;f=f.nextSibling;)if(h.dom.isBlock(f)){i=f;break}if(i&&b!=d.lastChild)return d=h.dom.doc.createTreeWalker(i,NodeFilter.SHOW_TEXT,null,t),i=d.nextNode(),c=h.getDoc().createRange(),c.setStart(i,0),c.setEnd(i,0),n.setRng(c),h.dom.remove(b),u.cancel(k)}}}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/ControlManager.js' */
(function(e){var k=e.dom.Event,i=e.each,h=e.extend;e.create("tinymce.ControlManager",{ControlManager:function(b,a){var c=this,a=a||{};c.editor=b;c.controls={};c.onAdd=new e.util.Dispatcher(c);c.onPostRender=new e.util.Dispatcher(c);c.prefix=a.prefix||b.id+"_";c._cls={};c.onPostRender.add(function(){i(c.controls,function(a){a.postRender()})})},get:function(b){return this.controls[this.prefix+b]||this.controls[b]},setActive:function(b,a){var c=null;(c=this.get(b))&&c.setActive(a);return c},setDisabled:function(b,
a){var c=null;(c=this.get(b))&&c.setDisabled(a);return c},add:function(b){b&&(this.controls[b.id]=b,this.onAdd.dispatch(b,this));return b},createControl:function(b){var a,c=this,d=c.editor;i(d.plugins,function(d){if(d.createControl&&(a=d.createControl(b,c)))return!1});switch(b){case "|":case "separator":return c.createSeparator()}return!a&&d.buttons&&(a=d.buttons[b])?c.createButton(b,a):c.add(a)},createDropMenu:function(b,a,c){var d=this.editor,f,g,j,a=h({"class":"mceDropDown",constrain:d.settings.constrain_menus},
a);a["class"]=a["class"]+" "+d.getParam("skin")+"Skin";if(j=d.getParam("skin_variant"))a["class"]+=" "+d.getParam("skin")+"Skin"+j.substring(0,1).toUpperCase()+j.substring(1);b=this.prefix+b;f=this.controls[b]=new (c||this._cls.dropmenu||e.ui.DropMenu)(b,a);f.onAddItem.add(function(a,b){var c=b.settings;c.title=d.getLang(c.title,c.title);c.onclick||(c.onclick=function(){c.cmd&&d.execCommand(c.cmd,c.ui||!1,c.value)})});d.onRemove.add(function(){f.destroy()});e.isIE&&(f.onShowMenu.add(function(){d.focus();
g=d.selection.getBookmark(1)}),f.onHideMenu.add(function(){g&&(d.selection.moveToBookmark(g),g=0)}));return this.add(f)},createListBox:function(b,a,c){var d=this.editor;if(this.get(b))return null;a.title=d.translate(a.title);a.scope=a.scope||d;a.onselect||(a.onselect=function(b){d.execCommand(a.cmd,a.ui||!1,b||a.value)});a=h({title:a.title,"class":"mce_"+b,scope:a.scope,control_manager:this},a);b=this.prefix+b;d.settings.use_native_selects||d.settings.use_accessible_selects&&!e.isGecko?c=new e.ui.NativeListBox(b,
a):(c=c||this._cls.listbox||e.ui.ListBox,c=new c(b,a,d));this.controls[b]=c;e.isWebKit&&c.onPostRender.add(function(a,b){k.add(b,"mousedown",function(){d.bookmark=d.selection.getBookmark(1)});k.add(b,"focus",function(){d.selection.moveToBookmark(d.bookmark);d.bookmark=null})});c.hideMenu&&d.onMouseDown.add(c.hideMenu,c);return this.add(c)},createButton:function(b,a,c){var d=this.editor;if(this.get(b))return null;a.title=d.translate(a.title);a.label=d.translate(a.label);a.scope=a.scope||d;!a.onclick&&
!a.menu_button&&(a.onclick=function(){d.execCommand(a.cmd,a.ui||!1,a.value)});a=h({title:a.title,"class":"mce_"+b,unavailable_prefix:d.getLang("unavailable",""),scope:a.scope,control_manager:this},a);b=this.prefix+b;a.menu_button?(c=c||this._cls.menubutton||e.ui.MenuButton,b=new c(b,a,d),d.onMouseDown.add(b.hideMenu,b)):(c=this._cls.button||e.ui.Button,b=new c(b,a,d));return this.add(b)},createMenuButton:function(b,a,c){a=a||{};a.menu_button=1;return this.createButton(b,a,c)},createSplitButton:function(b,
a,c){var d=this.editor;if(this.get(b))return null;a.title=d.translate(a.title);a.scope=a.scope||d;a.onclick||(a.onclick=function(b){d.execCommand(a.cmd,a.ui||!1,b||a.value)});a.onselect||(a.onselect=function(b){d.execCommand(a.cmd,a.ui||false,b||a.value)});a=h({title:a.title,"class":"mce_"+b,scope:a.scope,control_manager:this},a);b=this.prefix+b;b=this.add(new (c||this._cls.splitbutton||e.ui.SplitButton)(b,a,d));d.onMouseDown.add(b.hideMenu,b);return b},createColorSplitButton:function(b,a,c){var d=
this.editor,f,g;if(this.get(b))return null;a.title=d.translate(a.title);a.scope=a.scope||d;a.onclick||(a.onclick=function(b){e.isIE&&(g=d.selection.getBookmark(1));d.execCommand(a.cmd,a.ui||!1,b||a.value)});a.onselect||(a.onselect=function(b){d.execCommand(a.cmd,a.ui||false,b||a.value)});a=h({title:a.title,"class":"mce_"+b,menu_class:d.getParam("skin")+"Skin",scope:a.scope,more_colors_title:d.getLang("more_colors")},a);b=this.prefix+b;f=new (c||this._cls.colorsplitbutton||e.ui.ColorSplitButton)(b,
a,d);d.onMouseDown.add(f.hideMenu,f);d.onRemove.add(function(){f.destroy()});e.isIE&&(f.onShowMenu.add(function(){d.focus();g=d.selection.getBookmark(1)}),f.onHideMenu.add(function(){if(g){d.selection.moveToBookmark(g);g=0}}));return this.add(f)},createToolbar:function(b,a,c){b=this.prefix+b;a=new (c||this._cls.toolbar||e.ui.Toolbar)(b,a,this.editor);return this.get(b)?null:this.add(a)},createToolbarGroup:function(b,a,c){b=this.prefix+b;a=new (c||this._cls.toolbarGroup||e.ui.ToolbarGroup)(b,a,this.editor);
return this.get(b)?null:this.add(a)},createSeparator:function(b){return new (b||this._cls.separator||e.ui.Separator)},setControlType:function(b,a){return this._cls[b.toLowerCase()]=a},destroy:function(){i(this.controls,function(b){b.destroy()});this.controls=null}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/WindowManager.js' */
(function(e){var i=e.util.Dispatcher,l=e.each,j=e.isIE,k=e.isOpera;e.create("tinymce.WindowManager",{WindowManager:function(a){this.editor=a;this.onOpen=new i(this);this.onClose=new i(this);this.params={};this.features={}},open:function(a,b){var c="",d="modal"==this.editor.settings.dialog_type,g,f,h;h=e.DOM.getViewPort();a=a||{};b=b||{};f=k?h.w:screen.width;h=k?h.h:screen.height;a.name=a.name||"mc_"+(new Date).getTime();a.width=parseInt(a.width||320);a.height=parseInt(a.height||240);a.resizable=!0;
a.left=a.left||parseInt(f/2)-a.width/2;a.top=a.top||parseInt(h/2)-a.height/2;b.inline=!1;b.mce_width=a.width;b.mce_height=a.height;b.mce_auto_focus=a.auto_focus;d&&j&&(a.center=!0,a.help=!1,a.dialogWidth=a.width+"px",a.dialogHeight=a.height+"px",a.scroll=a.scrollbars||!1);l(a,function(a,b){e.is(a,"boolean")&&(a=a?"yes":"no");/^(name|url)$/.test(b)||(c=j&&d?c+((c?";":"")+b+":"+a):c+((c?",":"")+b+"="+a))});this.features=a;this.params=b;this.onOpen.dispatch(this,a,b);f=a.url||a.file;f=e._addVer(f);try{j&&
d?(g=1,window.showModalDialog(f,window,c)):g=window.open(f,a.name,c)}catch(i){}g||alert(this.editor.getLang("popup_blocked"))},close:function(a){a.close();this.onClose.dispatch(this)},createInstance:function(a,b,c,d,g,f){return new (e.resolve(a))(b,c,d,g,f)},confirm:function(a,b,c,d){d=d||window;b.call(c||this,d.confirm(this._decode(this.editor.getLang(a,a))))},alert:function(a,b,c,d){d=d||window;d.alert(this._decode(this.editor.getLang(a,a)));b&&b.call(c||this)},resizeBy:function(a,b,c){c.resizeBy(a,
b)},_decode:function(a){return e.DOM.decode(a).replace(/\\n/g,"\n")}})})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/Formatter.js' */
(function(w){w.Formatter=function(r){function M(b){return 1===b.nodeType&&"_mce_caret"===b.id}function A(b){return b?N[b]:N}function X(b,c){b&&("string"!==typeof b?p(b,function(a,c){X(c,a)}):(c=c.length?c:[c],p(c,function(a){void 0===a.deep&&(a.deep=!a.selector);void 0===a.split&&(a.split=!a.selector||a.inline);void 0===a.remove&&(a.selector&&!a.inline)&&(a.remove="none");a.selector&&a.inline&&(a.mixed=!0,a.block_expand=!0);"string"===typeof a.classes&&(a.classes=a.classes.split(/\s+/))}),N[b]=c))}
function J(b,c,a){function g(b,j){j=j||d;if(b){if(j.onformat)j.onformat(b,j,c,a);p(j.styles,function(a,j){f.setStyle(b,j,u(a,c))});p(j.attributes,function(a,j){f.setAttrib(b,j,u(a,c))});p(j.classes,function(a){a=u(a,c);f.hasClass(b,a)||f.addClass(b,a)})}}function k(){var b=r.selection.getRng(),c=b.startContainer,l=b.endContainer;if(c!=l&&0==b.endOffset){a:{l=new C(l);for(a=l.current();a;a=l.prev())if(1<a.childNodes.length||a==c){c=a;break a}c=void 0}b.setEnd(c,3==c.nodeType?c.length:c.childNodes.length)}return b}
function e(a,j,l){var i=[],e,k;e=d.inline||d.block;k=f.create(e);g(k);K.walk(a,function(a){function q(a){var v=a.nodeName.toLowerCase(),t=a.parentNode.nodeName.toLowerCase(),o;if(D(v,"br"))z=0,d.block&&f.remove(a);else if(d.wrapper&&E(a,b,c))z=0;else if(d.block&&!d.wrapper&&/^(h[1-6]|p|div|pre|address|dl|dt|dd)$/.test(v))a=f.rename(a,e),g(a),i.push(a),z=0;else{if(d.selector&&(p(m,function(c){!("collapsed"in c&&c.collapsed!==h)&&(f.is(a,c.selector)&&!M(a))&&(g(a,c),o=!0)}),!d.inline||o)){z=0;return}if(O(e,
v)&&O(t,e)&&(l||!(3===a.nodeType&&1===a.nodeValue.length&&65279===a.nodeValue.charCodeAt(0)))&&!M(a))z||(z=k.cloneNode(s),a.parentNode.insertBefore(z,a),i.push(z)),z.appendChild(a);else if("li"==v&&j){var v=a,r=j,t=k,n=i,y=q,x=[],B=-1,A,u=-1,C=-1,F;p(v.childNodes,function(a,c){if("UL"===a.nodeName||"OL"===a.nodeName)return B=c,A=a,!1});p(v.childNodes,function(a,c){"SPAN"===a.nodeName&&"bookmark"==f.getAttrib(a,"data-mce-type")&&(a.id==r.id+"_start"?u=c:a.id==r.id+"_end"&&(C=c))});0>=B||u<B&&C>B?(p(w.grep(v.childNodes),
y),z=0):(F=t.cloneNode(s),p(w.grep(v.childNodes),function(a,c){if(u<B&&c<B||u>B&&c>B)x.push(a),a.parentNode.removeChild(a)}),u<B?v.insertBefore(F,A):u>B&&v.insertBefore(F,A.nextSibling),n.push(F),p(x,function(a){F.appendChild(a)}),z=F)}else z=0,p(w.grep(a.childNodes),q),z=0}}var z;p(a,q)});!1===d.wrap_links&&p(i,function(a){function c(a){var b,j,l;if("A"===a.nodeName){j=k.cloneNode(s);i.push(j);l=w.grep(a.childNodes);for(b=0;b<l.length;b++)j.appendChild(l[b]);a.appendChild(j)}p(w.grep(a.childNodes),
c)}c(a)});p(i,function(a){var j,l=0;p(a.childNodes,function(a){!G(a)&&!x(a)&&l++});j=l;if((1<i.length||!y(a))&&0===j)f.remove(a,1);else if(d.inline||d.wrapper){if(!d.exact&&1===j){j=a;var q,h;p(j.childNodes,function(a){if(1==a.nodeType&&!x(a)&&!M(a))return q=a,s});q&&P(q,d)&&(h=q.cloneNode(s),g(h),f.replace(h,j,n),f.remove(q,1));a=h||j}p(m,function(b){p(f.select(b.inline,a),function(a){var j;if(!1===b.wrap_links){j=a.parentNode;do if("A"===j.nodeName)return;while(j=j.parentNode)}L(b,c,a,b.exact?a:
null)})});if(E(a.parentNode,b,c))return f.remove(a,1),a=0,n;d.merge_with_parents&&f.getParent(a.parentNode,function(j){if(E(j,b,c))return f.remove(a,1),a=0,n});a&&!1!==d.merge_siblings&&(a=Y(Q(a),a),a=Y(a,Q(a,n)))}})}var m=A(b),d=m[0],i,h=o.isCollapsed();if(d)if(a)a.nodeType?(i=f.createRng(),i.setStartBefore(a),i.setEndAfter(a),e(H(i,m),null,!0)):e(a,null,!0);else if(!h||!d.inline||f.select("td.mceSelected,th.mceSelected").length){if(!f.select("td.mceSelected.numberingColumn").length){var t=r.selection.getNode();
r.selection.setRng(k());i=o.getBookmark();e(H(o.getRng(n),m),i);if(d.styles&&(d.styles.color||d.styles.textDecoration))w.walk(t,Z,"childNodes"),Z(t);o.moveToBookmark(i);$(o.getRng(n));r.nodeChanged()}}else aa("apply",b,c)}function R(b,c,a){function g(a){var b,l,d;b=w.grep(a.childNodes);l=0;for(d=i.length;l<d&&!L(i[l],c,a,a);l++);if(h.deep){l=0;for(d=b.length;l<d;l++)g(b[l])}}function k(a){var j;p(f.getParents(a.parentNode,void 0,f.getRoot()).reverse(),function(a){var d;!j&&"_start"!=a.id&&"_end"!=
a.id&&(d=E(a,b,c))&&!1!==d.split&&(j=a)});return j}function e(a,b,d,e){var g,k,v,m,t,o;if(a){o=a.parentNode;for(g=b.parentNode;g&&g!=o;g=g.parentNode){k=g.cloneNode(s);for(t=0;t<i.length;t++)if(L(i[t],c,k,k)){k=0;break}k&&(v&&k.appendChild(v),m||(m=k),v=k)}if(e&&(!h.mixed||!y(a)))b=f.split(a,b);v&&(d.parentNode.insertBefore(v,d),m.appendChild(d))}return b}function m(a){var b=f.get(a?"_start":"_end"),c=b[a?"firstChild":"lastChild"];x(c)&&(c=c[a?"firstChild":"lastChild"]);f.remove(b,!0);return c}function d(a){var c,
b,d,a=H(a,i,n);h.split&&(c=ba(a,n),b=ba(a),c!=b?(d=c.firstChild,"TD"==c.nodeName&&d&&(c=d),c=S(c,"span",{id:"_start","data-mce-type":"bookmark"}),b=S(b,"span",{id:"_end","data-mce-type":"bookmark"}),e(k(c),c,c,!0),e(k(b),b,b,!0),c=m(n),b=m()):c=b=e(k(c),c,c,!0),a.startContainer=c.parentNode,a.startOffset=I(c),a.endContainer=b.parentNode,a.endOffset=I(b)+1);K.walk(a,function(a){p(a,function(a){g(a);a.nodeType===1&&(r.dom.getStyle(a,"text-decoration")==="underline"&&a.parentNode&&ca(a.parentNode)===
"underline")&&L({deep:false,exact:true,inline:"span",styles:{textDecoration:"underline"}},null,a)})})}var i=A(b),h=i[0],t;a?a.nodeType?(t=f.createRng(),t.setStartBefore(a),t.setEndAfter(a),d(t)):d(a):!o.isCollapsed()||!h.inline||f.select("td.mceSelected,th.mceSelected").length?f.select("td.mceSelected.numberingColumn").length||(a=o.getBookmark(),d(o.getRng(n)),o.moveToBookmark(a),h.inline&&T(b,c,o.getStart())&&$(o.getRng(!0)),r.nodeChanged()):aa("remove",b,c)}function E(b,c,a,g){function k(c,b,h){var e,
q,j=b[h];if(b.onmatch)return b.onmatch(c,b,h);if(j)if(void 0===j.length)for(e in j){if(j.hasOwnProperty(e)&&(q="attributes"===h?f.getAttrib(c,e):U(c,e),g&&!q&&!b.exact||(!g||b.exact)&&!D(q,u(j[e],a))))return}else for(e=0;e<j.length&&!("attributes"===h?f.getAttrib(c,j[e]):U(c,j[e]));e++);return b}var e=A(c),m;if(e&&b)for(m=0;m<e.length;m++)if(c=e[m],P(b,c)&&k(b,c,"attributes")&&k(b,c,"styles")){if(e=c.classes)for(m=0;m<e.length;m++)if(!f.hasClass(b,e[m]))return;return c}}function T(b,c,a){function g(a){a=
f.getParent(a,function(a){return!!E(a,b,c,!0)});return E(a,b,c)}var k;if(a)return g(a);a=o.getNode();if(g(a))return n;k=o.getStart();return k!=a&&g(k)?n:s}function P(b,c){if(D(b,c.inline)||D(b,c.block))return n;if(c.selector)return f.is(b,c.selector)}function D(b,c){b=b||"";c=c||"";b=""+(b.nodeName||b);c=""+(c.nodeName||c);return b.toLowerCase()==c.toLowerCase()}function U(b,c){var a=f.getStyle(b,c);if("color"==c||"backgroundColor"==c)a=f.toHex(a);"fontWeight"==c&&700==a&&(a="bold");return""+a}function u(b,
c){"string"!=typeof b?b=b(c):c&&(b=b.replace(/%(\w+)/g,function(a,b){return c[b]||a}));return b}function G(b){return b&&3===b.nodeType&&/^([\t \r\n]+|)$/.test(b.nodeValue)}function S(b,c,a){c=f.create(c,a);b.parentNode.insertBefore(c,b);c.appendChild(b);return c}function H(b,c,a){function g(a){var b,h,g;b=h=a?e:d;g=a?"previousSibling":"nextSibling";root=f.getRoot();if(3==b.nodeType&&!G(b)&&(a?0<m:i<b.nodeValue.length))return b;for(;;){if(!c[0].block_expand&&y(h))return h;for(a=h[g];a;a=a[g])if(!x(a)&&
!G(a))return h;if(h.parentNode==root){b=h;break}h=h.parentNode}return b}function k(a,b){for(void 0===b&&(b=3===a.nodeType?a.length:a.childNodes.length);a&&a.hasChildNodes();)(a=a.childNodes[b])&&(b=3===a.nodeType?a.length:a.childNodes.length);return{node:a,offset:b}}var e=b.startContainer,m=b.startOffset,d=b.endContainer,i=b.endOffset,h;1==e.nodeType&&e.hasChildNodes()&&(h=e.childNodes.length-1,e=e.childNodes[m>h?h:m],3==e.nodeType&&(m=0));1==d.nodeType&&d.hasChildNodes()&&(h=d.childNodes.length-
1,d=d.childNodes[i>h?h:i-1],3==d.nodeType&&(i=d.nodeValue.length));if(x(e.parentNode)||x(e))e=x(e)?e:e.parentNode,e=e.nextSibling||e,3==e.nodeType&&(m=0);if(x(d.parentNode)||x(d))d=x(d)?d:d.parentNode,d=d.previousSibling||d,3==d.nodeType&&(i=d.length);if(c[0].inline){if(b.collapsed){var t=function(b,c,d){function h(b,c){var e,i;i=b.nodeValue;typeof c=="undefined"&&(c=d?i.length:0);if(d){e=i.lastIndexOf(" ",c);i=i.lastIndexOf("",c);e=e>i?e:i;e!==-1&&!a&&e++}else{e=i.indexOf(" ",c);i=i.indexOf("",
c);e=e!==-1&&(i===-1||e<i)?e:i}return e}var e,i;if(b.nodeType===3){c=h(b,c);if(c!==-1)return{container:b,offset:c};i=b}for(b=new C(b,f.getParent(b,y)||r.getBody());e=b[d?"prev":"next"]();)if(e.nodeType===3){i=e;c=h(e);if(c!==-1)return{container:e,offset:c}}else if(y(e))break;if(i){c=d?0:i.length;return{container:i,offset:c}}};if(h=t(e,m,!0))e=h.container,m=h.offset;if(h=t(d,i))d=h.container,i=h.offset}h=k(d,i);if(h.node){for(;h.node&&0===h.offset&&h.node.previousSibling;)h=k(h.node.previousSibling);
h.node&&(0<h.offset&&3===h.node.nodeType&&" "===h.node.nodeValue.charAt(h.offset-1))&&1<h.offset&&(d=h.node,d.splitText(h.offset-1))}}if(c[0].inline||c[0].block_expand){if(!c[0].inline||3!=e.nodeType||0===m)e=g(!0);if(!c[0].inline||3!=d.nodeType||i===d.nodeValue.length)d=g()}c[0].selector&&(c[0].expand!==s&&!c[0].inline)&&(h=function(a,d){var e,h,i,g;a.nodeType==3&&(a.nodeValue.length==0&&a[d])&&(a=a[d]);e=f.getParents(a,void 0,f.getRoot());for(h=0;h<e.length;h++)for(i=0;i<c.length;i++){g=c[i];if(!("collapsed"in
g&&g.collapsed!==b.collapsed)&&f.is(e[h],g.selector))return e[h]}return a},e=h(e,"previousSibling"),d=h(d,"nextSibling"));if(c[0].block||c[0].selector)h=function(a,b){var d;if(a==f.getRoot())return a;c[0].wrapper||(d=f.getParent(a,c[0].block));d||(d=f.getParent(a.nodeType==3?a.parentNode:a,y));d&&c[0].wrapper&&(d=f.getParents(d,"ul,ol",f.getRoot()).reverse()[0]||d);if(!d)for(d=a;d[b]&&!y(d[b]);){d=d[b];if(D(d,"br"))break}return d||a},e=h(e,"previousSibling"),d=h(d,"nextSibling"),c[0].block&&(y(e)||
(e=g(!0)),y(d)||(d=g()));1==e.nodeType&&(m=I(e),e=e.parentNode);1==d.nodeType&&(i=I(d)+1,d=d.parentNode);return{startContainer:e,startOffset:m,endContainer:d,endOffset:i}}function L(b,c,a,g){var k,e,m;if(!P(a,b))return s;if("all"!=b.remove){p(b.styles,function(b,d){b=u(b,c);"number"===typeof d&&(d=b,g=0);(!g||D(U(g,d),b))&&f.setStyle(a,d,"");m=1});m&&""==f.getAttrib(a,"style")&&(a.removeAttribute("style"),a.removeAttribute("data-mce-style"));p(b.attributes,function(b,d){var e,b=u(b,c);if(typeof d===
"number"){d=b;g=0}if(!g||D(f.getAttrib(g,d),b)){if(d=="class")if(b=f.getAttrib(a,d)){e="";p(b.split(/\s+/),function(a){/mce\w+/.test(a)&&(e=e+((e?" ":"")+a))});if(e){f.setAttrib(a,d,e);return}}d=="class"&&a.removeAttribute("className");da.test(d)&&a.removeAttribute("data-mce-"+d);a.removeAttribute(d)}});p(b.classes,function(b){b=u(b,c);(!g||f.hasClass(g,b))&&f.removeClass(a,b)});e=f.getAttribs(a);for(k=0;k<e.length;k++)if(0!==e[k].nodeName.indexOf("_"))return s}if("none"!=b.remove){k=a.parentNode;
var d;b.block&&(V?k==f.getRoot()&&(!b.list_block||!D(a,b.list_block))&&p(w.grep(a.childNodes),function(a){O(V,a.nodeName.toLowerCase())?d?d.appendChild(a):d=S(a,V):d=0}):(e=function(a,b,c){a=Q(a,b,c);return!a||"BR"==a.nodeName||y(a)},y(a)&&!y(k)&&(!e(a,s)&&!e(a.firstChild,n,1)&&a.insertBefore(f.create("br"),a.firstChild),!e(a,n)&&!e(a.lastChild,s,1)&&a.appendChild(f.create("br")))));(!b.selector||!b.inline||D(b.inline,a))&&f.remove(a,1);return n}}function Q(b,c,a){if(b){c=c?"nextSibling":"previousSibling";
for(b=a?b:b[c];b;b=b[c])if(1==b.nodeType||!G(b))return b}}function x(b){return b&&1==b.nodeType&&"bookmark"==b.getAttribute("data-mce-type")}function Y(b,c){var a,g;if(b&&c){g=function(b,c){for(a=b;a&&!(3==a.nodeType&&0!==a.nodeValue.length);a=a[c])if(1==a.nodeType&&!x(a))return a;return b};b=g(b,"previousSibling");c=g(c,"nextSibling");g=b;var k=c,e=function(a){var b={};p(f.getAttribs(a),function(c){c=c.nodeName.toLowerCase();0!==c.indexOf("_")&&"style"!==c&&(b[c]=f.getAttrib(a,c))});return b},m=
function(a,b){var c,e;for(e in a)if(a.hasOwnProperty(e)){c=b[e];if(void 0===c||a[e]!=c)return s;delete b[e]}for(e in b)if(b.hasOwnProperty(e))return s;return n};if(g.nodeName!=k.nodeName||!m(e(g),e(k))||!m(f.parseStyle(f.getAttrib(g,"style")),f.parseStyle(f.getAttrib(k,"style")))?s:n){for(a=b.nextSibling;a&&a!=c;)g=a,a=a.nextSibling,b.appendChild(g);f.remove(c);p(w.grep(c.childNodes),function(a){b.appendChild(a)});return b}}return c}function ba(b,c){var a,f,k;a=b[c?"startContainer":"endContainer"];
f=b[c?"startOffset":"endOffset"];1==a.nodeType&&(k=a.childNodes.length-1,!c&&f&&f--,a=a.childNodes[f>k?k:f]);3===a.nodeType&&(c&&f>=a.nodeValue.length)&&(a=(new C(a,r.getBody())).next()||a);3===a.nodeType&&(!c&&0==f)&&(a=(new C(a,r.getBody())).prev()||a);return a}function aa(b,c,a){function g(a){var b=f.create("span",{id:h,"data-mce-bogus":!0,style:p?"color:red":""});a&&b.appendChild(r.getDoc().createTextNode(i));return b}function k(a,b){for(;a;){if(3===a.nodeType&&a.nodeValue!==i||1<a.childNodes.length)return!1;
b&&1===a.nodeType&&b.push(a);a=a.firstChild}return!0}function e(a){for(;a;){if(a.id===h)return a;a=a.parentNode}}function m(a){var b;if(a){b=new C(a,a);for(a=b.current();a;a=b.next())if(3===a.nodeType)return a}}function d(a,b){var c,g;if(a)g=o.getRng(!0),k(a)?(!1!==b&&(g.setStartBefore(a),g.setEndBefore(a)),f.remove(a)):(c=m(a),c.nodeValue.charAt(0)===W&&c.deleteData(0,1),f.remove(a,1)),o.setRng(g);else if(a=e(o.getStart()),!a)for(;a=f.get(h);)d(a,!1)}var i,h="_mce_caret",p=r.settings.caret_debug;
i=w.isGecko?"":W;self._hasCaretEvents||(r.onBeforeGetContent.addToTop(function(){var a=[],b;if(k(e(o.getStart()),a))for(b=a.length;b--;)f.setAttrib(a[b],"data-mce-bogus","1")}),w.each(["onMouseUp","onKeyUp"],function(a){r[a].addToTop(function(){d()})}),r.onKeyDown.addToTop(function(a,b){var c=b.keyCode;(8==c||37==c||39==c)&&d(e(o.getStart()))}),self._hasCaretEvents=!0);if("apply"==b){var q,j,l,n;q=o.getRng(!0);b=q.startOffset;n=q.startContainer.nodeValue;(j=e(o.getStart()))&&(l=m(j));if(n&&0<b&&
b<n.length&&/\w/.test(n.charAt(b))&&/\w/.test(n.charAt(b-1)))j=o.getBookmark(),q.collapse(!0),q=H(q,A(c)),q=K.split(q),J(c,a,q),o.moveToBookmark(j);else{if(!j||l.nodeValue!==i)j=g(!0),l=j.firstChild,q.insertNode(j),b=1;J(c,a,j);o.setCursorLocation(l,b)}}else{n=o.getRng(!0);var s,u,b=[];s=n.startContainer;u=n.startOffset;l=s;if(3==s.nodeType){if(u!=s.nodeValue.length||s.nodeValue===i)j=!0;l=l.parentNode}for(;l;){if(E(l,c,a)){q=l;break}l.nextSibling&&(j=!0);b.push(l);l=l.parentNode}if(q)if(j)q=o.getBookmark(),
n.collapse(!0),n=H(n,A(c),!0),n=K.split(n),R(c,a,n),o.moveToBookmark(q);else{l=a=g();for(c=b.length-1;0<=c;c--)l.appendChild(b[c].cloneNode(!1)),l=l.firstChild;l.appendChild(f.doc.createTextNode(i));l=l.firstChild;f.insertAfter(a,q);o.setCursorLocation(l,1)}}}function $(b){var c=b.startContainer,a=b.startOffset,g;3==c.nodeType&&a>=c.nodeValue.length&&(c=c.parentNode,a=I(c)+1);if(1==c.nodeType){g=c.childNodes;c=g[Math.min(a,g.length-1)];c=new C(c,f.getParent(c,f.isBlock));a>g.length-1&&c.next();for(a=
c.current();a;a=c.next())if(3==a.nodeType&&!G(a)){c=f.create("a",null,W);a.parentNode.insertBefore(c,a);b.setStart(a,0);o.setRng(b);f.remove(c);break}}}var N={},p=w.each,f=r.dom,o=r.selection,C=w.dom.TreeWalker,K=new w.dom.RangeUtils(f),O=r.schema.isValidChild,y=f.isBlock,V=r.settings.forced_root_block,I=f.nodeIndex,W="",da=/^(src|href|style)$/,s=!1,n=!0,ca=function(b){var c;r.dom.getParent(b,function(a){return(c=r.dom.getStyle(a,"text-decoration"))&&"none"!==c});return c},Z=function(b){var c;1===
b.nodeType&&(b.parentNode&&1===b.parentNode.nodeType)&&(c=ca(b.parentNode),r.dom.getStyle(b,"color")&&c?r.dom.setStyle(b,"text-decoration",c):r.dom.getStyle(b,"textdecoration")===c&&r.dom.setStyle(b,"text-decoration",null))};w.extend(this,{get:A,register:X,apply:J,remove:R,toggle:function(b,c,a){var f=A(b);T(b,c,a)&&(!("toggle"in f[0])||f[0].toggle)?R(b,c,a):J(b,c,a)},match:T,matchAll:function(b,c){var a,g=[],k={};a=o.getStart();f.getParent(a,function(a){var f,d;for(f=0;f<b.length;f++)d=b[f],!k[d]&&
E(a,d,c)&&(k[d]=!0,g.push(d))});return g},matchNode:E,canApply:function(b){var b=A(b),c,a,g,k;if(b){c=o.getStart();c=f.getParents(c,void 0,f.getRoot());for(g=b.length-1;0<=g;g--){k=b[g].selector;if(!k)return n;for(a=c.length-1;0<=a;a--)if(f.is(c[a],k))return n}}return s}})}})(tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-core', location = 'jscripts/tiny_mce/classes/LegacyInput.js' */
tinymce.onAddEditor.add(function(c,b){var g,h,e,f=b.settings;if(f.inline_styles){h=c.explode(f.font_size_legacy_values);var i=function(b,a){c.each(a,function(a,c){a&&e.setStyle(b,c,a)});e.rename(b,"span")};g={font:function(b,a){i(a,{backgroundColor:a.style.backgroundColor,color:a.color,fontFamily:a.face,fontSize:h[parseInt(a.size)-1]})},strike:function(b,a){i(a,{textDecoration:"line-through"})}};var d=function(d,a){e=d.dom;f.convert_fonts_to_spans&&c.each(e.select("font,strike",a.node),function(a){g[a.nodeName.toLowerCase()](b.dom,
a)})};b.onPreProcess.add(d);b.onSetContent.add(d);b.onInit.add(function(){b.selection.onSetContent.add(d)})}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-extensions', location = 'jscripts/tiny_mce/themes/atlassian/editor_template.js' */
(function(e,g,h){g(function(){var j=e.DOM,k=e.each,l=e.explode,m=e.extend,i;i=function(a){this.setup=this.setup();this.init=this.init(a)};i.INCOMPATIBLE_PLUGINS=["dfe"];i.shouldInit=function(){var a=g("body");return a.hasClass("edit")||a.hasClass("create")||a.hasClass("copy-page")};i.suppressIncompatiblePlugins=function(){for(var a=function(){},b=0,f=i.INCOMPATIBLE_PLUGINS.length;b<f;b++)e.PluginManager.lookup[i.INCOMPATIBLE_PLUGINS[b]]=a};i.prototype.setup=function(){window.requestAnimFrame=window.requestAnimationFrame||
window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(a){window.setTimeout(a,1E3/60)};return!0};i.prototype.init=function(a){function b(a){c.toggleToolbarButtons(a,a,a,function(){return!g(this).parent().hasClass("close")})}function f(){var a=l-j.scrollTop(),c=o.offset().top-i.offset().top,b=n.outerHeight(),d=o.outerHeight();n.css("top",c+d+a+q+"px");h.css("padding-top",b+m+"px")}var d=g.ui.keyCode,c=a.plugins.customtoolbar,e=g("#content-title"),i=g("form.editor"),h=g(a.getBody()),
j=g(a.getDoc()),n=g("#editor-precursor"),k=g(a.getWin()),o=g("#toolbar"),l=j.scrollTop(),m=parseInt(h.css("padding-top"),10)+parseInt(h.css("margin-top"),10),q=parseInt(n.css("padding-top"),10);e.on("keydown",function(c){var b=c.keyCode||c.which;if(b===d.ENTER||b===d.DOWN)c.preventDefault(),c.stopPropagation(),a.focus()}).on("focus click",function(){b(!0)});k.on("focus",function(){b(!1)});(function p(){requestAnimFrame(p);f()})();h.on("scroll mousewheel",function(){setTimeout(f,0)});return!0};e.ThemeManager.requireLangPack("advanced");
e.create("tinymce.themes.ConfluenceTheme",{controlHandlers:{},controls:{bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",justifyleft:"JustifyLeft",justifycenter:"JustifyCenter",justifyright:"JustifyRight",bullist:"InsertUnorderedList",numlist:"InsertOrderedList",tasklist:"InsertInlineTaskList",outdent:"Outdent",indent:"Indent",cut:"Cut",copy:"Copy",paste:"Paste",undo:"Undo",redo:"Redo",removeformat:"RemoveFormat",sub:"subscript",sup:"superscript",forecolor:"ForeColor",
forecolorpicker:"mceForeColor",backcolor:"HiliteColor",backcolorpicker:"mceBackColor",charmap:"mceCharMap",visualaid:"mceToggleVisualAid",anchor:"mceInsertAnchor",newdocument:"mceNewDocument",blockquote:"mceBlockQuote"},stateControls:"bold italic underline bullist numlist tasklist justifyleft justifycenter justifyright strikethrough sub sup monospace".split(" "),init:function(a,b){var f=i.shouldInit(),d=this;f&&i.suppressIncompatiblePlugins();d.editor=a;d.url=b;d.settings=m({theme_advanced_toolbar_location:"bottom",
theme_advanced_buttons1:"formatselect,bold,italic,underline,strikethrough,forecolor,separator,table,row_before,row_after,delete_row,col_before,col_after,delete_col,delete_table,separator,bullist,numlist,tasklist,outdent,indent,blockquote,justifyleft,justifycenter,justifyright,justifyfull,separator,sup,sub,separator,undo,redo,separator,conflink,oldlinkbrowserButton,confimage,conf_macro_browser,separator,search,code,customtoolbar, monospacep,h1,h2,h3,h4,h5,h6,pre,blockquote",readonly:a.settings.readonly},
a.settings);a.onInit.add(function(){a.settings.readonly||(a.onNodeChange.add(d.nodeChanged,d),a.onKeyUp.add(d._updateUndoStatus,d),a.onMouseUp.add(d._updateUndoStatus,d),a.dom.bind(a.dom.getRoot(),"dragend",function(){d._updateUndoStatus(a)}),f&&new i(a))})},execCommand:function(a,b,f){return(a=this["_"+a])?(a.call(this,b,f),!0):!1},renderUI:function(a){this.bindControls();return{iframeContainer:j.get("rte"),editorContainer:"wysiwyg",sizeContainer:void 0,deltaHeight:a.deltaHeight}},getInfo:function(){return{longname:"Confluence theme",
author:"Atlassian",authorurl:"http://tinymce.moxiecode.com",version:e.majorVersion+"."+e.minorVersion}},bindControls:function(){var a=this;k(l(a.settings.theme_advanced_buttons1),function(b){if(!a.createEditorButtons(b))switch(b){case "formatselect":a.createBlockFormats()}});a.bindControlHandlers();a.renderToolbarButtons()},renderToolbarButtons:function(){var a=this,b=Confluence.Templates.Editor.Toolbar.toolbarButton,f={toolbar:"toolbar-primary",title:"",tooltip:"",cmd:"",className:"",locationGroup:null,
weight:Infinity,onclick:null},d=h.map(this.editor.buttons,function(a,b){a=h.extend({},f,a);a.id=b;a.weight=h.isNumber(a.weight)?a.weight:Infinity;return a}),d=h.filter(d,function(a){return!!a.locationGroup});h.each(["toolbar-primary"],function(c){var f=g("."+c),c=h.where(d,{toolbar:c}),c=h.sortBy(c,"weight");h.each(c,function(c){a.createEditorButtons(c.id);var d=f.find("."+c.locationGroup),c=g(b({button:c}));d.append(c).removeClass("hidden")})})},createEditorButtons:function(a){var b=this.editor.buttons[a];
if(b)this.controls[a]=b.cmd?b.cmd:b.onclick;else return!1},bindControlHandlers:function(){var a=this;a.controlHandlers.buttons={};a.controlHandlers.buttons.state=new e.util.Dispatcher;a.controlHandlers.buttons.click=new e.util.Dispatcher;a.controlHandlers.buttons.click.add(function(b){var f=a.controls[b],d=typeof f;"string"==d?AJS.Rte.getEditor().execCommand(a.controls[b]):"function"==d&&f()})},createBlockFormats:function(){this.controlHandlers.formatselect={};this.controlHandlers.formatselect.state=
new e.util.Dispatcher;this.controlHandlers.formatselect.click=new e.util.Dispatcher;this.controlHandlers.formatselect.click.add(function(a){AJS.Rte.getEditor().execCommand("FormatBlock",!1,a)})},createForeColorMenu:function(){return!0},_updateUndoStatus:function(a){a=a.undoManager;this.controlHandlers.buttons.state.dispatch("undo","disabled",!a.hasUndo()&&!a.typing);this.controlHandlers.buttons.state.dispatch("redo","disabled",!a.hasRedo())},nodeChanged:function(a,b,f,d,c){var e=this;k(e.stateControls,
function(b){e.controlHandlers.buttons.state.dispatch(b,"active",!!a.queryCommandState(e.controls[b]))});e._updateUndoStatus(a);e.controlHandlers.buttons.state.dispatch("outdent","disabled",!a.queryCommandState("Outdent"));a:{b=j.isBlock;f=c.parents;for(c=0;c<f.length;c++)if(b(f[c])){c=f[c];break a}c=void 0}c&&e.controlHandlers.formatselect.state.dispatch(c.nodeName.toLowerCase())}});e.ThemeManager.add("atlassian",e.themes.ConfluenceTheme)})})(tinymce,$,_);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-extensions', location = 'jscripts/jquery/jquery-column.js' */
/*
 jQuery Column cell selector v1.0

 Licensed under the new BSD License.
 Copyright 2009-2012, Bram Stein
 All rights reserved.

 ATLASSIAN modified: Removed all extensions,modifications to jQuery expression internals (jQuery.expr)
 now creates pseudo selector via jQuery/Sizzle preferred method
*/
(function(g){var m=/([\+\-]?\d*)[nN]([\+\-]?\d*)/,j,c;g.extend(jQuery.fn,{nthCol:function(a){var f=[],i={multiplier:0,offset:0};"even"===a?a="2n":"odd"===a?a="2n+1":/^\d*$/.test(a)&&(a="0n+"+a);f=m.exec(a);null!==f&&(i.multiplier=f[1]-0,i.offset=f[2]-0);c=i;var d,k,e=[],h=0,l=[];g.each(this,function(n,a){var b=0,c=0,f=a.rowSpan||1,g=a.colSpan||1;if(a.parentNode!==d){d=a.parentNode;if(d.parentNode!==k){k=d.parentNode;e=[]}h=0;e[d.rowIndex]===void 0&&(e[d.rowIndex]=[])}for(b=0;b<e[d.rowIndex].length+
1;b=b+1)if(e[d.rowIndex][b]===void 0){h=b;break}l[n]=h;for(b=d.rowIndex;b<d.rowIndex+f;b=b+1){e[b]===void 0&&(e[b]=[]);for(c=h;c<h+g;c=c+1)e[b][c]=true}});j=l;return g(this).filter(function(a){a=j[a]-(c.offset-1);a=c.multiplier===0?a===0:a%c.multiplier===0&&a/c.multiplier>=0;return a})}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-extensions', location = 'jscripts/tiny_mce/plugins/lists/editor_plugin_src.js' */
(function(C){function D(a,b){for(;a&&(8===a.nodeType||3===a.nodeType&&/^[ \t\n\r]*$/.test(a.nodeValue));)a=b(a);return a}function m(a){return D(a,function(a){return a.previousSibling})}function r(a){return D(a,function(a){return a.nextSibling})}function E(a,b,f){return a.dom.getParent(b,function(a){return-1!==tinymce.inArray(f,a)})}function n(a){return a&&("OL"===a.tagName||"UL"===a.tagName)}function A(a,b){var f,d;for(f=m(a.lastChild);n(f);)d=f,f=m(d.previousSibling);d&&(f=b.create("li",{style:t}),
b.split(a,d),b.insertAfter(f,d),f.appendChild(d),f.appendChild(d),a=f.previousSibling);return a}function u(a,b,f){var d=m(a.previousSibling),a=d?s(d,a,b?d:!1,f):a;return F(a,b,f)}function F(a,b,f){var d=r(a.nextSibling);return d?s(a,d,b?d:!1,f):a}function s(a,b,f,d){var e=!!f;if(!a||!b)d=!1;else if("LI"===a.tagName&&"LI"===b.tagName)d="none"===b.style.listStyleType||G(b);else if(n(a)){if(!(d=a.tagName===b.tagName&&a.className===b.className&&(e||a.style.listStyleType===b.style.listStyleType)))d=r(b.firstChild),
e=m(b.lastChild),d=d&&e&&n(b)&&d===e&&(n(d)||"none"===d.style.listStyleType||G(d))}else d=d&&"P"===a.tagName&&"P"===b.tagName;if(d){d=m(a.lastChild);e=r(b.firstChild);for("P"===a.tagName&&a.appendChild(a.ownerDocument.createElement("br"));b.firstChild;)a.appendChild(b.firstChild);f&&(a.style.listStyleType=f.style.listStyleType);b.parentNode.removeChild(b);s(d,e,!1);return a}a&&("LI"===a.tagName&&n(b))&&a.appendChild(b);return b}function G(a){var b=r(a.firstChild),a=m(a.lastChild);return b&&a&&b===
a&&n(b)}function H(a,b){var f;b.is(a,"li,ol,ul")||(f=b.getParent(a,"li"))&&(a=f);return a}var t="list-style-type: none; background-image: none;",I="a,b,i,em,strong,u,span,s,sub,sup,code,br",v=tinymce.each,q=tinymce.dom.Event,w;tinymce.create("tinymce.plugins.Lists",{init:function(a){function b(){var x=a.selection.getStart();return"LI"==x.tagName?x:a.dom.getParent(x,"li")}function f(a){if(a){var a=C(a),b=a.find("*"),c=b.filter(I);return b.length!=c.length?!1:0===AJS.trim(a.text()).length&&1>=c.filter("br").length}return!1}
function d(b){if(b&&(tinymce.isGecko||tinymce.isWebKit))for(var b=b.childNodes,d,c=b.length-1;0<=c;c--)d=b[c],3==d.nodeType&&!d.length&&a.dom.remove(d)}function e(a,b,c){c&&(1==c.nodeType&&a.dom.is(c,"li"))&&(b=c.parentNode,tinymce.each(a.dom.select("li>ul,li>ol",b),function(c){a.dom.getAttrib(c.parentNode,"data-mce-style")||c.previousSibling||c.parentNode.insertBefore(a.dom.doc.createElement("br"),c)}))}function j(a,d){var c,g;if(b()&&(d.keyCode===tinymce.VK.ENTER&&!d.shiftKey||d.keyCode===tinymce.VK.BACKSPACE||
d.keyCode===tinymce.VK.DELETE)){c=a.selection.getRng(!0);g=c.endContainer;if(3==g.nodeType){if(c.endOffset!==g.length)return;g=g.nextSibling}else if(1==g.nodeType)g=g.childNodes[c.endOffset];else return;if(g&&a.dom.is(g,"ul,ol"))if(tinymce.isIE){var f=g,e=a.dom.doc.createTextNode(String.fromCharCode(160)),h=f.previousSibling;c=tinymce.isIE6||tinymce.isIE7||tinymce.isIE8?c:a.getDoc().createRange();h&&3==h.nodeType&&h.nodeValue[h.length-1]==e.nodeValue?(c.setStart(h,h.length-1),c.setEnd(h,h.length-
1)):(g.parentNode.insertBefore(e,f),c.setStartBefore(e),c.setEndBefore(e));c.collapse(!0);a.selection.setRng(c)}else g.parentNode.insertBefore(a.dom.create("br"),g)}}function l(a){function e(c){var b=c.parentNode,g=b.previousSibling,o;d(b);b.childNodes[0]===c&&!a.dom.getAttrib(b,"data-mce-style")&&(a.selection.getStart().parentNode==c&&(o=a.selection.getRng(!0),o={startOffset:o.startOffset,startContainer:o.startContainer}),g?g.appendChild(c):(g=a.dom.create("li",{style:t}),g.appendChild(c),b.parentNode.insertBefore(g,
b)),o&&a.selection.setCursorLocation(o.startContainer||c.firstChild,o.startOffset),f(b)&&a.dom.remove(b))}var c=b();if(c){var g=c.parentNode;tinymce.grep(a.dom.select("li>ul, li>ol",g),e);a.dom.is(g.parentNode,"li")&&e(g);c===g.lastChild&&(g.nextSibling&&a.dom.is(g.nextSibling,"ul, ol"))&&tinymce.grep(a.dom.select("li>ul, li>ol",g.nextSibling),e)}}function k(a,d){if(46==d.keyCode&&!d.shiftKey){var c=b();if(c&&(0==c.childNodes.length||1==c.childNodes.length&&"BR"==c.firstChild.nodeName)){var g,f;if(g=
c.nextSibling)g=a.dom.doc.createTreeWalker(g,NodeFilter.SHOW_TEXT,null,!1),g=g.nextNode(),f=a.getDoc().createRange(),f.setStart(g,0),f.setEnd(g,0),a.selection.setRng(f),a.dom.remove(c),a.undoManager.add(),q.cancel(d)}}}var i="UNKNOWN";this.ed=a;a.addCommand("Indent",this.indent,this);a.addCommand("Outdent",this.outdent,this);a.addCommand("InsertUnorderedList",function(){this.applyList("UL","OL")},this);a.addCommand("InsertOrderedList",function(){this.applyList("OL","UL")},this);a.addCommand("InsertInlineTaskList",
function(){AJS.Rte.Support.inlineTasks()&&this.applyList("UL","OL","inline-task-list",{attributesOnItems:{"data-inline-task-id":""},placeholderText:"Type your task here, using \"@\" to assign to a user and \"//\" to select a due date"})},this);a.addCommand("InsertInlineTaskListNoToggle",function(){AJS.Rte.Support.inlineTasks()&&this.applyList("UL","OL","inline-task-list",{attributesOnItems:{"data-inline-task-id":""},placeholderText:"Type your task here, using \"@\" to assign to a user and \"//\" to select a due date",noToggle:!0})},this);a.onInit.add(function(){a.editorCommands.addCommands({outdent:function(){function b(d){return(d=
c.getParent(d,c.isBlock))&&0<parseInt(a.dom.getStyle(d,"margin-left")||0,10)+parseInt(a.dom.getStyle(d,"padding-left")||0,10)}var d=a.selection,c=a.dom;return b(d.getStart())||b(d.getEnd())||a.queryCommandState("InsertOrderedList")||a.queryCommandState("InsertUnorderedList")||a.queryCommandState("InsertInlineTaskList")}},"state")});a.onKeyUp.add(function(f,e){if("TABBING"==i)return f.execCommand(e.shiftKey?"Outdent":"Indent",!0,null),d(b()),i="UNKNOWN",q.cancel(e);if("EMPTY"==i){var c=b();f.execCommand(!0===
f.settings.list_outdent_on_enter||e.shiftKey?"Outdent":"Indent",!0,null);if(tinymce.isIE){var g=a.dom.getParent(c,"ol,ul");null!=g&&(g=g.lastChild,g.appendChild(a.getDoc().createTextNode(AJS.Rte.HIDDEN_CHAR)),a.selection.setCursorLocation(g,0))}d(c);AJS.Rte.showSelection();return q.cancel(e)}if("ESCAPE"==i)if(tinymce.isIE6||tinymce.isIE7||tinymce.isIE8)c=f.getDoc().createTextNode(AJS.Rte.HIDDEN_CHAR),f.selection.getNode().appendChild(c);else if(tinymce.isIE9||tinymce.isIE10||tinymce.isIE11||tinymce.isGecko||
tinymce.isWebKit)return f.execCommand("Outdent"),q.cancel(e)});a.onKeyDown.add(function(d,e){if(e.keyCode===tinymce.VK.TAB&&!e.altKey&&!e.ctrlKey&&(a.queryCommandState("InsertUnorderedList")||a.queryCommandState("InsertOrderedList")||a.queryCommandState("InsertInlineTaskList")||a.queryCommandState("InsertInlineTaskListNoToggle")))i="TABBING";else{var c;if(c=e.keyCode===tinymce.VK.ENTER&&!e.shiftKey)if(c=b()){var g=c.parentNode.parentNode;c=c.parentNode.lastChild===c&&!(n(g)?g.parentNode&&"LI"===g.parentNode.tagName:
"LI"===g.tagName)&&f(c)}else c=!1;i=c?"ESCAPE":e.keyCode===tinymce.VK.ENTER&&!e.shiftKey&&a.selection.isCollapsed()&&f(b())?"EMPTY":"UNKNOWN"}});a.onKeyDown.add(function(a,b){("TABBING"==i||"EMPTY"==i||(tinymce.isGecko||tinymce.isWebKit)&&"ESCAPE"==i)&&q.cancel(b)});a.onKeyDown.add(function(a,b){var c;if(tinymce.isGecko){var d=a.selection.getStart();if(!(b.keyCode!=tinymce.VK.BACKSPACE||"IMG"!==d.tagName))if(c=d.parentNode.previousSibling){if(!("UL"===c.tagName||"OL"===c.tagName))if(c.previousSibling&&
("UL"===c.previousSibling.tagName||"OL"===c.previousSibling.tagName))c=c.previousSibling;else return;c=c.firstChild;var e=null;do{if(!c)break;"LI"===c.tagName&&(e=c)}while(c=c.nextSibling);c=e;e=a.dom.createRng();e.setStart(c,1);e.setEnd(c,1);a.selection.setRng(e);a.selection.collapse(!0);var e=a.selection.getBookmark(),f=d.parentNode.cloneNode(!0);if("P"===f.tagName||"DIV"===f.tagName)for(;0<f.childNodes.length;)c.appendChild(f.childNodes[0]);else c.appendChild(f);d.parentNode.parentNode.removeChild(d.parentNode);
a.selection.moveToBookmark(e)}}});a.onKeyDown.add(function(b,d){var c;if(c=d.keyCode===tinymce.VK.ENTER&&!d.shiftKey){var e=a.selection.getNode();c=a.dom.is(e,"h1,h2,h3,h4,h5,h6,p,div")&&"LI"===e.parentNode.tagName&&e.parentNode.lastChild===e;e=AJS.EditorUtils.isCursorAtEndOf(e,a.selection.getRng(!0));c=a.selection.isCollapsed()&&c&&e}if(c){b.undoManager.beforeChange();b.undoManager.add();c=b.selection.getNode();var f=b.dom.create("li",{},!tinyMCE.isIE?'<br data-mce-bogus="true">':"");c=b.dom.getParent(c,
"li");b.dom.insertAfter(f,c);tinyMCE.isIE6||tinyMCE.isIE7||tinyMCE.isIE8?(f.appendChild(b.dom.create("&nbsp;")),b.selection.setCursorLocation(f,1)):tinyMCE.isGecko?setTimeout(function(){b.selection.setCursorLocation(f,0)},0):b.selection.setCursorLocation(f,0);b.undoManager.add();d.preventDefault()}});tinymce.isWebKit&&(a.onNodeChange.add(l),a.onKeyUp.add(l));tinymce.isIE?a.onKeyDown.add(j):(a.onNodeChange.add(e),tinymce.isGecko&&a.onKeyDown.add(j));tinymce.isGecko&&a.onKeyDown.add(k)},applyList:function(a,
b,f,d){function e(a){a&&"BR"===a.tagName&&h.remove(a)}function j(a){a&&"LI"===a.tagName&&(h.removeClass(a,"checked"),a.removeAttribute("data-inline-task-id"))}function l(a){if(B&&a&&"LI"===a.tagName)for(var b in B)a.setAttribute(b,B[b])}function k(b){function d(a){(a.style.marginLeft||a.style.paddingLeft)&&n.adjustPaddingFunction(!1)(a)}var c=h.create(a),g;""!=f&&(c.className=f);if("LI"===b.tagName)l(b);else{if("P"===b.tagName||"DIV"===b.tagName||"BODY"===b.tagName){x(b,function(a,c){i(a,c,b.tagName===
"BODY"?null:a.parentNode);g=a.parentNode;d(g);tinymce.isChrome||e(c)});if(g){if("LI"===g.tagName&&("P"===b.tagName||1<y.length)){if(z&&n.isEmptyElement(g)){var k=document.createTextNode(z),c=h.create("span");c.appendChild(k);g.appendChild(c);setTimeout(function(){p.selection.select(k)},0);(tinymce.isIE7||tinymce.isIE8)&&g.appendChild(p.dom.create("br",{_mce_bogus:"1"}));var j=function(a,b){if((b.which||b.keyCode)==64)if(k.textContent==z)k.textContent=" ";else if(k.data==z)k.data=" ";window.setTimeout(function(){p.onKeyPress.remove(j)},
0)};p.onKeyPress.addToTop(j)}h.split(g.parentNode.parentNode,g.parentNode)}u(g.parentNode,!0);l(g)}return}g=h.create("li");l(g);h.insertAfter(g,b);g.appendChild(b);d(b);b=g}h.insertAfter(c,b);c.appendChild(b);u(c,!0);m.push(b)}function i(a,b,c){for(var d=a;!h.isBlock(a.parentNode)&&a.parentNode!==h.getRoot();)a=h.split(a.parentNode,a.previousSibling),d=a=a.nextSibling;if(c){c=c.cloneNode(!0);for(a.parentNode.insertBefore(c,a);c.firstChild;)h.remove(c.firstChild);c=h.rename(c,"li")}else c=h.create("li"),
a.parentNode.insertBefore(c,a);d&&d==b&&(a=h.create("br"),h.setAttrib(a,"data-mce-bogus",1),c.appendChild(d),h.insertAfter(a,d));for(;d&&d!=b;)a=d.nextSibling,c.appendChild(d),d=a;0===c.childNodes.length&&(c.innerHTML='<br _mce_bogus="1" />');k(c)}function x(a,b){function c(a,b){var d=h.createRng(),e;w.keep=!0;p.selection.moveToBookmark(w);w.keep=!1;e=p.selection.getRng(!0);b||(b=a.parentNode.lastChild);d.setStartBefore(a);d.setEndAfter(b);return!(0<d.compareBoundaryPoints(g,e)||0>=d.compareBoundaryPoints(k,
e))}function d(a){if(a.nextSibling)return a.nextSibling;if(!h.isBlock(a.parentNode)&&a.parentNode!==h.getRoot())return d(a.parentNode)}var e,f,g=3,k=1;e=a.firstChild;var i=!1;v(h.select("br,ul,ol,p,div,h1,h2,h3,h4,h5,h6,table,blockquote,address,pre,form,center,dl",a),function(a){if(a.hasAttribute&&a.hasAttribute("_mce_bogus"))return!0;c(e,a)&&(h.addClass(a,"_mce_tagged_br"),e=d(a))});i=e&&c(e,void 0);e=a.firstChild;v(h.select("br,ul,ol,p,div,h1,h2,h3,h4,h5,h6,table,blockquote,address,pre,form,center,dl",
a),function(a){var c=d(a);if(a.hasAttribute&&a.hasAttribute("_mce_bogus"))return!0;h.hasClass(a,"_mce_tagged_br")?(b(e,a,f),f=null):f=a;e=c});i&&b(e,void 0,f)}function o(a){x(a,function(a,b,c){i(a,b);e(b);e(c)})}function c(a){j(a);if(-1===tinymce.inArray(m,a)){if(a.parentNode.tagName===b||!s)h.split(a.parentNode,a),k(a),F(a.parentNode,!1);""!=f&&(a.parentNode.className=f);l(a);m.push(a)}}function g(a){j(a);var b,c;if(-1===tinymce.inArray(m,a)&&(a=A(a,h))){for(;h.is(a.parentNode,"ol,ul,li");)h.split(a.parentNode,
a);m.push(a);a=h.rename(a,"p");b=u(a,!1,p.settings.force_br_newlines);if(b===a)for(a=a.firstChild;a;)h.isBlock(a)?(a=h.split(a.parentNode,a),c=!0,b=a.nextSibling&&a.nextSibling.firstChild):(b=a.nextSibling,c&&"BR"===a.tagName&&h.remove(a),c=!1),a=b}}var n=this,p=n.ed,h=p.dom,m=[],q=!1,r=!1,t=!1,s=!1,y=p.selection.getSelectedBlocks(),f=f||"",d=d||{},B=d.attributesOnItems,z=d.placeholderText,d=d.noToggle;v(y,function(c){c=H(c,h);c="LI"===c.tagName?c.parentNode:c;s=c.className===f;c.tagName===b?r=!0:
c.tagName===a?q=!0:t=!0});d=t&&!q||r||!s||0===y.length?{LI:c,H1:k,H2:k,H3:k,H4:k,H5:k,H6:k,P:k,BODY:k,DIV:1<y.length?k:o,defaultAction:o,elements:this.selectedBlocks()}:d?{}:{defaultAction:g,elements:this.selectedBlocks()};this.process(d)},indent:function(){var a=this.ed,b=a.dom,f=[];this.process({LI:function(d){if(!E(a,d,f)&&(d=A(d,b))){var e=d,j=b.create("li",{style:t});b.insertAfter(j,e);var l=b.getParent(e,"ol,ul"),e=l.tagName,k=b.getStyle(l,"list-style-type"),l=l.className||"",i={};""!==k&&(i.style=
"list-style-type: "+k+";");e=b.create(e,i);""!=l&&(e.className=l);j.appendChild(e);(tinymce.isIE7||tinymce.isIE8)&&d.appendChild(a.dom.create("br",{_mce_bogus:"1"}));e.appendChild(d);u(e.parentNode,!1);u(e,!1);f.push(d)}},defaultAction:this.adjustPaddingFunction(!0),elements:this.selectedBlocks()})},outdent:function(a,b){var f=this,d=f.ed,e=d.dom,j=[],l=b&&tinymce.is(b,"array")?b:this.selectedBlocks();this.process({LI:function(a){var b,l;if(!E(d,a,j)){if(""!==e.getStyle(a,"margin-left")||""!==e.getStyle(a,
"padding-left"))return f.adjustPaddingFunction(!1)(a);b=e.getStyle(a,"text-align",!0);if("center"===b||"right"===b)e.setStyle(a,"text-align","left");else if(a=A(a,e))b=a.parentNode,l=a.parentNode.parentNode,"P"===l.tagName?e.split(l,a.parentNode):(e.split(b,a),"LI"===l.tagName?e.split(l,a):e.is(l,"ol,ul")||e.rename(a,"p")),e.hasClass(a.parentNode,"inline-task-list")?a.hasAttribute("data-inline-task-id")||a.setAttribute("data-inline-task-id",""):a.removeAttribute("data-inline-task-id"),j.push(a)}},
defaultAction:this.adjustPaddingFunction(!1),elements:l});v(j,u)},isEmptyElement:function(a){var b=this.ed.dom;return 0===tinymce.grep(a.childNodes,function(a){return!("BR"===a.nodeName||"SPAN"===a.nodeName&&"bookmark"==b.getAttrib(a,"data-mce-type")||3==a.nodeType&&(a.nodeValue==String.fromCharCode(160)||""==a.nodeValue))}).length},process:function(a){function b(b){(tinymce.isIE7||tinymce.isIE8)&&C(b).find("br[_mce_bogus='1']").remove();l.removeClass(b,"_mce_act_on");if(b&&!(1!==b.nodeType||1<k.length&&
e.isEmptyElement(b))){var b=H(b,l),c=a[b.tagName];c||(c=a.defaultAction);c(b)}}function f(a){e.splitSafeEach(a.childNodes,b)}function d(a,b){return 0<=b&&a.hasChildNodes()&&b<a.childNodes.length&&"BR"===a.childNodes[b].tagName}var e=this,j=e.ed.selection,l=e.ed.dom,k,i;if(!l.select("td.mceSelected.numberingColumn").length){k=a.elements;i=j.getRng(!0);if(!i.collapsed&&(d(i.endContainer,i.endOffset-1)&&(i.setEnd(i.endContainer,i.endOffset-1),j.setRng(i)),d(i.startContainer,i.startOffset)))i.setStart(i.startContainer,
i.startOffset+1),j.setRng(i);if(tinymce.isIE7||tinymce.isIE8)if(i=e.ed.selection.getNode(),"LI"===i.tagName&&i.parentNode.lastChild!==i){var m=e.ed.getDoc().createTextNode(AJS.Rte.HIDDEN_CHAR);i.appendChild(m)}w=j.getBookmark();a.OL=a.UL=f;e.splitSafeEach(k,b);j.moveToBookmark(w);w=null;j=j.getNode();null===l.getParent(j,"td")&&e.ed.execCommand("mceRepaint")}},splitSafeEach:function(a,b){tinymce.isGecko&&(/Firefox\/[12]\.[0-9]/.test(navigator.userAgent)||/Firefox\/3\.[0-4]/.test(navigator.userAgent))?
this.classBasedEach(a,b):v(a,b)},classBasedEach:function(a,b){var f=this.ed.dom,d;v(a,function(a){f.addClass(a,"_mce_act_on")});for(d=f.select("._mce_act_on");0<d.length;)d=d.shift(),f.removeClass(d,"_mce_act_on"),b(d),d=f.select("._mce_act_on")},adjustPaddingFunction:function(a){var b,f,d=this.ed;b=d.settings.indentation;f=/[a-z%]+/i.exec(b);b=parseInt(b,10);return function(e){var j;j=parseInt(d.dom.getStyle(e,"margin-left")||0,10)+parseInt(d.dom.getStyle(e,"padding-left")||0,10);j=a?j+b:j-b;d.dom.setStyle(e,
"padding-left","");d.dom.setStyle(e,"margin-left",0<j?j+f:"")}},selectedBlocks:function(){var a=this.ed,b=a.selection.getSelectedBlocks();return 0==b.length?[a.dom.getRoot()]:b},getInfo:function(){return{longname:"Lists",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/lists",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("lists",tinymce.plugins.Lists)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-extensions', location = 'jscripts/tiny_mce/plugins/table/editor_plugin_src.js' */
(function(l,s){function v(e,j){return parseInt(e.getAttribute(j)||1)}function S(d,j,t){function E(b,a){b=b.cloneNode(a);b.removeAttribute("id");a&&z()&&b.removeChild(b.children[0]);return b}function F(){var b=0;k=[];e(["thead","tbody","tfoot"],function(a){var g=j.select("> "+a+" tr",d);e(g,function(g,p){p+=b;e(j.select("> td, > th",g),function(b,g){var h,f,c,o;if(k[p])for(;k[p][g];)g++;c=v(b,"rowspan");o=v(b,"colspan");for(f=p;f<p+c;f++){k[f]||(k[f]=[]);for(h=g;h<g+o;h++)k[f][h]={part:a,real:f==p&&
h==g,elm:b,rowspan:c,colspan:o}}})});b+=g.length})}function B(b,a){var g;if(g=k[a])return g[b]}function n(b,a,g){b&&(g=parseInt(g),1===g?b.removeAttribute(a,1):b.setAttribute(a,g,1))}function w(b){return b&&(j.hasClass(b.elm,"mceSelected")||b==H)}function C(){var b=[];e(d.rows,function(a){e(a.cells,function(g){if(j.hasClass(g,"mceSelected")||g==H.elm)return b.push(a),!1})});return b}function A(b){var a;l.walk(b,function(g){var h;if(3==g.nodeType)return e(j.getParents(g.parentNode,null,b).reverse(),
function(b){b=E(b,!1);a?h&&h.appendChild(b):a=h=b;h=b}),h&&(h.innerHTML=l.isIE?"&nbsp;":'<br data-mce-bogus="1" />'),!1},"childNodes");b=E(b,!1);n(b,"rowSpan",1);n(b,"colSpan",1);a?b.appendChild(a):l.isIE||(b.innerHTML='<br data-mce-bogus="1" />');s(b).attr("contenteditable","true").removeClass("numberingColumn");return b}function a(){var b=j.createRng();e(j.select("tr",d),function(b){0==b.cells.length&&j.remove(b)});if(0==j.select("tr",d).length)b.setStartAfter(d),b.setEndAfter(d),t.setRng(b),j.remove(d);
else if(e(j.select("thead,tbody,tfoot",d),function(b){0==b.rows.length&&j.remove(b)}),F(),b=k[Math.min(k.length-1,q.y)])if(b=b[Math.min(b.length-1,q.x)].elm)l.isIE9||l.isIE10up?t.setCursorLocation(b,0):t.select(b,!0),t.collapse(!0)}function m(b,a,g,h){var p,L,f,c,o;p=k[a][b].elm.parentNode;for(f=1;f<=g;f++)if(p=j.getNext(p,"tr")){for(L=b;0<=L;L--)if(o=k[a+f][L].elm,o.parentNode==p){for(c=1;c<=h;c++)j.insertAfter(A(o),o);break}if(-1==L)for(c=1;c<=h;c++)p.insertBefore(A(p.cells[0]),p.cells[0])}}function O(){e(k,
function(b,a){e(b,function(b,h){var p,f,c;if(w(b)&&(b=b.elm,p=v(b,"colspan"),f=v(b,"rowspan"),1<p||1<f)){n(b,"rowSpan",1);n(b,"colSpan",1);for(c=0;c<p-1;c++)j.insertAfter(A(b),b);m(h,a,f-1,p)}})})}function N(b){var a,g,h,p,f,c,o,m;e(k,function(g,h){e(g,function(g){if(w(g)&&(g=g.elm,f=g.parentNode,c=E(f,!1),a=h,b))return!1});if(b)return!a});for(p=0;p<k[0].length;p++)if(k[a][p]&&(g=k[a][p].elm,g!=h)){if(b){if(0<a&&k[a-1][p]&&(o=k[a-1][p].elm,m=v(o,"rowSpan"),1<m)){n(o,"rowSpan",m+1);continue}}else if(m=
v(g,"rowspan"),1<m){n(g,"rowSpan",m+1);continue}h=(o=AJS.Rte.Table.isColumnHeading(s(g).closest("table"),p+1))?j.create("th"):j.create("td");h.colSpan=g.colSpan;h.width=g.width;h.innerHTML=l.isIE9?"":l.isIE?"&nbsp;":'<br data-mce-bogus="1" />';h.className=g.className;o||(j.removeClass(h,l.settings.confluence_table_heading_style),j.addClass(h,l.settings.confluence_table_cell_style));o=j.getAttrib(g,"data-highlight-colour");AJS.Rte.Table.isColumnHighlighted(d,p+1)?j.setAttrib("data-highlight-colour",
o):j.removeClass(h,"highlight-"+o);c.appendChild(h);h=g}c.hasChildNodes()&&(b?f.parentNode.insertBefore(c,f):j.insertAfter(c,f));r()}function u(b){var a,g,h=[];e(k,function(g){e(g,function(g,h){if(w(g)&&(a=h,b))return!1});if(b)return!a});if(0==a&&b&&z())return!1;e(k,function(p,f){var c,o,k;if(p[a]&&(c=p[a].elm,c!=g)){k=v(c,"colspan");o=v(c,"rowspan");if(1==k){var e,d=j.create(c.tagName);d.colSpan=c.colSpan;d.width=c.width;d.className=c.className;d.innerHTML=l.isIE?"&nbsp;":'<br data-mce-bogus="1"/>';
(e=j.getAttrib(c,"data-highlight-colour"))&&j.setAttrib(d,"data-highlight-colour",e);s(d).attr("contenteditable","true").removeClass("numberingColumn");b?c.parentNode.insertBefore(d,c):j.insertAfter(d,c);m(a,f,o-1,k);h.push(d)}else n(c,"colSpan",c.colSpan+1);g=c}});return h}function r(){if(z()){var b=1,a=0,g=0;e(d.rows,function(h){h=s(h);AJS.Rte.Table.areCellsHeadings(h.children())?h.children(":first").addClass("numberingColumn").attr("contenteditable","true"):0<g?g--:(h.children(":first").html(b).attr("contenteditable",
"false").addClass("numberingColumn"),a=h.children(":first").attr("rowspan"),1<a&&(g=a-1),b++)})}}function z(){return s(d.rows[0]).children(":first").hasClass("numberingColumn")}function o(b){b?s(d.rows[0]).children(":first").addClass("numberingColumn"):s(d.rows[0]).children(":first").removeClass("numberingColumn")}function c(){var b=[];e(k,function(a){e(a,function(a,h){w(a)&&-1===l.inArray(b,h)&&(e(k,function(b){if(b[h]){var b=b[h].elm,a;a=v(b,"colSpan");1<a?n(b,"colSpan",a-1):j.remove(b)}}),b.push(h))})});
a()}function f(){var b={};e(k,function(a){e(a,function(a,h){w(a)&&(b[h]||(b[h]=[]))})});e(k,function(a){e(a,function(a,h){b[h]&&b[h].push(a.elm.innerHTML)})});return b}function M(b){b&&b.parentNode&&(t.select(b.parentNode),t.collapse(!0))}function P(b,a){var g=B(b.x,b.y).elm,h="undefined"===typeof a?!0:a;if((l.isGecko||l.isIE)&&g.firstChild)g=g.firstChild;if(l.isIE9||l.isIE10up){var c=t.getRng(1);h?(c.setStart(g,0),c.setEnd(g,0)):(c.setStartAfter(g,0),c.setEndAfter(g,0));t.setRng(c)}else t.select(g,
!0),t.collapse(h)}function Q(){var b,a=k[0].length;q.x==a-1&&q.y==k.length-1||(q.x==a-1&&z()?(b={x:1,y:q.y+1},AJS.Rte.Table.areCellsHeadings(s(k[b.y][0].elm).parent().children())&&(b.x=0)):b=q.x==a-1?{x:0,y:q.y+1}:{x:q.x+1,y:q.y});return b}function R(){var b;0==q.x&&0==q.y||(1==q.x&&z()&&!AJS.Rte.Table.areCellsHeadings(s(k[q.y][0].elm).parent().children())?(b=q.y-1,b={x:k[b].length-1,y:b}):0<q.x?b={x:q.x-1,y:q.y}:(b=q.y-1,b={x:k[b].length-1,y:b}));return b}function G(b){var a;e(k,function(g,h){e(g,
function(g,c){if(g.elm==b)return a={x:c,y:h},!1});return!a});return a}var k,q,D,H;F();if(H=j.select("td.mceSelected,th.mceSelected")[0]||j.getParent(t.getStart(),"th,td")){q=G(H);var I,J;I=J=0;e(k,function(b,a){e(b,function(b,h){var c,f;w(b)&&(b=k[a][h],h>I&&(I=h),a>J&&(J=a),b.real&&(c=b.colspan-1,f=b.rowspan-1,c&&h+c>I&&(I=h+c),f&&a+f>J&&(J=a+f)))})});D={x:I,y:J};H=B(q.x,q.y)}l.extend(this,{deleteTable:function(){var b=j.createRng();b.setStartAfter(d);b.setEndAfter(d);t.setRng(b);j.remove(d)},split:O,
merge:function(b,c,g){var h,f,o,d,m,M;b?(pos=G(b),h=pos.x,b=pos.y,c=h+(c-1),g=b+(g-1)):(h=q.x,b=q.y,c=D.x,g=D.y);if(!(0==h&&z())&&(d=B(h,b),f=B(c,g),d&&f&&d.part==f.part)){O();F();d=B(h,b).elm;n(d,"colSpan",c-h+1);n(d,"rowSpan",g-b+1);for(o=b;o<=g;o++)for(f=h;f<=c;f++)k[o]&&k[o][f]&&(b=k[o][f].elm,b!=d&&(m=l.grep(b.childNodes),e(m,function(b){d.appendChild(b)}),m.length&&(m=l.grep(d.childNodes),M=0,e(m,function(b){b.nodeName=="BR"&&(j.getAttrib(b,"data-mce-bogus")&&M++<m.length-1)&&d.removeChild(b)})),
j.remove(b)));a()}},insertRow:N,insertCol:u,insertNumCol:function(){if(z())e(k,function(b){cell=b[0].elm;s(cell).hasClass("numberingColumn")&&null!==cell.parentNode&&cell.parentNode.removeChild(cell)}),o(!1);else{var b;e(k,function(a){cell=a[0].elm;b!=cell&&(a=A(cell),cell.parentNode.insertBefore(a,cell),1<cell.rowSpan&&(a.rowSpan=cell.rowSpan),b=cell)});o(!0)}r()},updateNumCol:r,deleteCols:c,deleteRows:function(){var b;b=C();(l.isIE9||l.isIE10)&&M(b[0]);e(b.reverse(),function(b){var a,c;j.getNext(b,
"tr");e(b.cells,function(b){var c=v(b,"rowSpan");1<c&&(n(b,"rowSpan",c-1),a=G(b),m(a.x,a.y,1,1))});a=G(b.cells[0]);e(k[a.y],function(b){var a,b=b.elm;b!=c&&(a=v(b,"rowSpan"),1>=a?j.remove(b):n(b,"rowSpan",a-1),c=b)})});a();r()},cutRows:function(){var b=C();(l.isIE9||l.isIE10)&&M(b[0]);j.remove(b);a();r();return b},copyRows:function(){var b=C();e(b,function(a,c){b[c]=E(a,!0)});return b},pasteRows:function(b,a){var c=C(),h=c[a?0:c.length-1],f=h.cells.length;e(k,function(b){var a;f=0;e(b,function(b){b.real&&
(f+=b.colspan);b.elm.parentNode==h&&(a=1)});if(a)return!1});a||b.reverse();e(b,function(b){var c=b.cells.length,g;s(b.cells[0]).hasClass("numberingColumn")&&b.removeChild(b.cells[0]);for(i=0;i<c;i++)g=b.cells[i],n(g,"colSpan",1),n(g,"rowSpan",1);z()&&(b.insertBefore(b.firstChild.cloneNode(!1),b.firstChild),s(b.firstChild).addClass("numberingColumn"),c++);for(;f<c;)u(!1),f++;for(i=c;i<f;i++)b.appendChild(A(b.cells[c-1]));a?h.parentNode.insertBefore(b,h):j.insertAfter(b,h)});r()},getPos:G,setStartCell:function(b){q=
G(b)},setEndCell:function(b){var a,c,f,o,d,m,e;D=G(b);if(q&&D){a=Math.min(q.x,D.x);c=Math.min(q.y,D.y);f=Math.max(q.x,D.x);o=Math.max(q.y,D.y);d=f;m=o;for(y=c;y<=m;y++)b=k[y][a],b.real||a-(b.colspan-1)<a&&(a-=b.colspan-1);for(x=a;x<=d;x++)b=k[c][x],b.real||c-(b.rowspan-1)<c&&(c-=b.rowspan-1);for(y=c;y<=o;y++)for(x=a;x<=f;x++)b=k[y][x],b.real&&(e=b.colspan-1,b=b.rowspan-1,e&&x+e>d&&(d=x+e),b&&y+b>m&&(m=y+b));j.removeClass(j.select("td.mceSelected,th.mceSelected"),"mceSelected");for(y=c;y<=m;y++)for(x=
a;x<=d;x++)k[y][x]&&j.addClass(k[y][x].elm,"mceSelected")}},moveCaretToNextCell:function(){var b=Q();b||(N(!1),F(),b=Q());P(b)},moveCaretToPrevCell:function(){var b=R();b||(N(!0),F(),q=G(j.getParent(t.getStart(),"th,td")),b=R());P(b,!1)},cutColumns:function(){var b=f();c();return b},copyColumns:f,pasteColumns:function(b,a){var c=Object.keys(b);a||c.reverse();s.each(c,function(c,f){for(var g=u(a),c=0;c<g.length;c++)g[c].innerHTML=b[f][c]||""})},prepareTableForColPasteAndCheckIfNeedToRepaint:function(b){var a=
b[Object.keys(b)[0]].length,c,f,b=!1;e(k,function(b,o){a--;c=o;e(b,function(b,a){f=a})});if(0<a){b=!0;H=B(f,c);for(var o=0;o<a;o++)N(!1)}return b}})}var e=l.each,K=AJS.storageManager("atlassian.editor","tables");l.create("tinymce.plugins.TablePlugin",{init:function(d,j){function t(a){var m=d.selection,a=a||m.getNode().parentNode;if(a=d.dom.getParent(a,"table"))return new S(a,d.dom,m)}function E(){d.getBody().style.webkitUserSelect="";A&&(d.dom.removeClass(d.dom.select("td.mceSelected,th.mceSelected"),
"mceSelected"),A=!1)}function F(a){for(var d=[],e="",e=0;e<a.length;e++)d.push(AJS.Rte.getEditor().serializer.serialize(a[e]));e="<tr>"+d.join("</tr><tr>")+"</tr>";K.setItem("copied",e,7200)}function B(){var a=[],e=K.getItem("copied")||"";e&&(a=d.getDoc().createElement("div"),a.innerHTML="<table>"+e+"</table>",a=s(a).find("tr"));return a}var n,w,C,A=!0;e([["table","table.desc","mceInsertTable",!0],["delete_table","table.del","mceTableDelete"],["delete_col","table.delete_col_desc","mceTableDeleteCol"],
["delete_row","table.delete_row_desc","mceTableDeleteRow"],["col_after","table.col_after_desc","mceTableInsertColAfter"],["col_before","table.col_before_desc","mceTableInsertColBefore"],["row_after","table.row_after_desc","mceTableInsertRowAfter"],["row_before","table.row_before_desc","mceTableInsertRowBefore"],["row_props","table.row_desc","mceTableRowProps",!0],["cell_props","table.cell_desc","mceTableCellProps",!0],["split_cells","table.split_cells_desc","mceTableSplitCells",!0],["merge_cells",
"table.merge_cells_desc","mceTableMergeCells",!0]],function(a){d.addButton(a[0],{title:a[1],cmd:a[2],ui:a[3]})});l.isIE||d.onClick.add(function(a,d){d=d.target;"TABLE"===d.nodeName&&(a.selection.select(d),a.nodeChanged())});d.onPreProcess.add(function(a,d){var e,j,l,r=a.dom,n;e=r.select("table",d.node);for(j=e.length;j--;){l=e[j];r.setAttrib(l,"data-mce-style","");if(n=r.getAttrib(l,"width"))r.setStyle(l,"width",n),r.setAttrib(l,"width","");if(n=r.getAttrib(l,"height"))r.setStyle(l,"height",n),r.setAttrib(l,
"height","")}});d.onNodeChange.add(function(a,d,e){e=a.selection.getStart();a=a.dom.getParent(e,"td,th,caption");d.setActive("table","TABLE"===e.nodeName||!!a);a&&"CAPTION"===a.nodeName&&(a=0);d.setDisabled("delete_table",!a);d.setDisabled("delete_col",!a);d.setDisabled("delete_table",!a);d.setDisabled("delete_row",!a);d.setDisabled("col_after",!a);d.setDisabled("col_before",!a);d.setDisabled("row_after",!a);d.setDisabled("row_before",!a);d.setDisabled("row_props",!a);d.setDisabled("cell_props",!a);
d.setDisabled("split_cells",!a);d.setDisabled("merge_cells",!a)});d.onInit.add(function(a){function d(a){if(l.isWebKit){var c=a.selection.getRng(),f=a.selection.getNode(),e=a.dom.getParent(c.startContainer,"TD,TH"),j=e,m=a.dom.getParent(c.startContainer,"TABLE"),n;m&&(n=m.parentNode);m=3==c.startContainer.nodeType&&0==c.startOffset&&0==c.endOffset&&j&&("TR"==f.nodeName||f==n);j=("TD"==f.nodeName||"TH"==f.nodeName)&&!j;if(m||j){e||(e=f);for(f=e.lastChild;f.lastChild;)f=f.lastChild;c.setEnd(f,f.nodeValue.length);
a.selection.setRng(c)}}}var j,s,u=a.dom,r;n=a.windowManager;a.onMouseDown.add(function(a,c){2!=c.button&&(E(),s=u.getParent(c.target,"td,th"),j=u.getParent(s,"table"))});u.bind(a.getDoc(),"mouseover",function(d){var c,f=u.getParent(d.target,"td,th");if(s&&(r||f!=s)&&f){c=u.getParent(f,"table");c==j&&(r||(r=t(c),r.setStartCell(s),a.getBody().style.webkitUserSelect="none"),r.setEndCell(f),A=!0);c=a.selection.getSel();try{c.removeAllRanges?c.removeAllRanges():c.empty()}catch(e){}d.preventDefault()}});
a.onMouseUp.add(function(a){var c,f=a.selection,d;f.getSel();var e,m;if(s){r&&(a.getBody().style.webkitUserSelect="");var n=function(a,f){var d=new l.dom.TreeWalker(a,a);do{if(a.nodeType==3&&l.trim(a.nodeValue).length!=0){f?c.setStart(a,0):c.setEnd(a,a.nodeValue.length);break}if(a.nodeName=="BR"){f?c.setStartBefore(a):c.setEndBefore(a);break}}while(a=f?d.next():d.prev())};d=u.select("td.mceSelected,th.mceSelected");if(0<d.length){c=u.createRng();e=d[0];c.setStartBefore(e);c.setEndAfter(e);n(e,1);
d=new l.dom.TreeWalker(e,u.getParent(d[0],"table"));do if("TD"==e.nodeName||"TH"==e.nodeName){if(!u.hasClass(e,"mceSelected"))break;m=e}while(e=d.next());n(m);f.setRng(c)}a.nodeChanged();s=r=j=null}});a.onUndo.add(function(a){A=0<a.dom.select("td.mceSelected, th.mceSelected").length});a.onKeyUp.add(function(){E()});a.onKeyDown.add(function(a){d(a)});a.onMouseDown.add(function(a,c){2!=c.button&&d(a)});a.plugins.table.fixTableCellSelection=d;a&&a.plugins.contextmenu&&a.plugins.contextmenu.onContextMenu.add(function(d,
c,f){d=a.selection.getNode()||a.getBody();a.dom.getParent(f,"td")||a.dom.getParent(f,"th")||a.dom.select("td.mceSelected,th.mceSelected").length?(c.removeAll(),"A"==d.nodeName&&!a.dom.getAttrib(d,"name")&&(c.add({title:"advanced.link_desc",icon:"link",cmd:a.plugins.advlink?"mceAdvLink":"mceLink",ui:!0}),c.add({title:"advanced.unlink_desc",icon:"unlink",cmd:"UnLink"}),c.addSeparator()),"IMG"==d.nodeName&&-1==d.className.indexOf("mceItem")&&(c.add({title:"advanced.image_desc",icon:"image",cmd:a.plugins.advimage?
"mceAdvImage":"mceImage",ui:!0}),c.addSeparator()),c.add({title:"table.desc",icon:"table",cmd:"mceInsertTable",value:{action:"insert"}}),c.add({title:"table.props_desc",icon:"table_props",cmd:"mceInsertTable"}),c.add({title:"table.del",icon:"delete_table",cmd:"mceTableDelete"}),c.addSeparator(),f=c.addMenu({title:"table.cell"}),f.add({title:"table.cell_desc",icon:"cell_props",cmd:"mceTableCellProps"}),f.add({title:"table.split_cells_desc",icon:"split_cells",cmd:"mceTableSplitCells"}),f.add({title:"table.merge_cells_desc",
icon:"merge_cells",cmd:"mceTableMergeCells"}),f=c.addMenu({title:"table.row"}),f.add({title:"table.row_desc",icon:"row_props",cmd:"mceTableRowProps"}),f.add({title:"table.row_before_desc",icon:"row_before",cmd:"mceTableInsertRowBefore"}),f.add({title:"table.row_after_desc",icon:"row_after",cmd:"mceTableInsertRowAfter"}),f.add({title:"table.delete_row_desc",icon:"delete_row",cmd:"mceTableDeleteRow"}),f.addSeparator(),f.add({title:"table.cut_row_desc",icon:"cut",cmd:"mceTableCutRow"}),f.add({title:"table.copy_row_desc",
icon:"copy",cmd:"mceTableCopyRow"}),f.add({title:"table.paste_row_before_desc",icon:"paste",cmd:"mceTablePasteRowBefore"}).setDisabled(!w),f.add({title:"table.paste_row_after_desc",icon:"paste",cmd:"mceTablePasteRowAfter"}).setDisabled(!w),f=c.addMenu({title:"table.col"}),f.add({title:"table.col_before_desc",icon:"col_before",cmd:"mceTableInsertColBefore"}),f.add({title:"table.col_after_desc",icon:"col_after",cmd:"mceTableInsertColAfter"}),f.add({title:"table.delete_col_desc",icon:"delete_col",cmd:"mceTableDeleteCol"})):
c.add({title:"table.desc",icon:"table",cmd:"mceInsertTable"})});l.isWebKit&&a.onKeyDown.add(function(a,c){function f(c,e,k){var m=c?"previousSibling":"nextSibling",b=a.dom.getParent(e,"tr"),n=b[m];if(n)return j(a,e,n,c),l.dom.Event.cancel(k),!0;var n=a.dom.getParent(b,"table"),g=b.parentNode,h=g.nodeName.toLowerCase();if("tbody"===h||h===(c?"tfoot":"thead")){var h=a.dom.select(">tbody",n),p=h.indexOf(g);c&&0===p||!c&&p===h.length-1?(g=a.dom.select(">"+(c?"thead":"tfoot"),n),g=0!==g.length?g[0]:null):
-1===p?(g="thead"===g.tagName.toLowerCase()?0:h.length-1,g=h[g]):g=h[p+(c?-1:1)];if(null!==g)return(b=d(g,c))&&j(a,e,b,c),l.dom.Event.cancel(k),!0}(e=n[m])?(a.selection.setCursorLocation(e,0),k=!0):(e=a.dom.getParent(n,"td,th"))?k=f(c,e,k):(c=d(b,!c),a.selection.setCursorLocation(c,0),k=l.dom.Event.cancel(k));return k}function d(c,f){var e=c&&c[f?"lastChild":"firstChild"];return e&&"BR"===e.nodeName?a.dom.getParent(e,"td,th"):e}function j(c,f,k,l){for(var b=0,c=c.dom.getParent(f,"td,th");c.previousSibling;)c=
c.previousSibling,b+=v(c,"colspan");var m=b,g=0,h=0;e(k.children,function(a,b){g+=v(a,"colspan");h=b;if(g>m)return!1});k=k.childNodes[h];l=d(k,l);a.selection.setCursorLocation(l||k,0)}var m=l.VK,n=c.keyCode,r;if(r=n==m.UP||n==m.DOWN){r=a;var k=r.selection.getNode();r=null!==r.dom.getParent(k,"tr")}if(r){var q=a.selection.getNode();setTimeout(function(){var d=a.selection.getNode(),d=a.dom.getParent(d,"td,th"),e=a.dom.getParent(q,"td,th");d&&(d!==e&&a.dom.getParent(d,"TABLE")===a.dom.getParent(e,"TABLE"))&&
f(!c.shiftKey&&n===m.UP,q,c)},0)}});if(!l.isIE){var z=function(){};l.isGecko&&a.onKeyDown.add(function(a,c){var d,e,j=a.dom;if(37==c.keyCode||38==c.keyCode)if(d=a.selection.getRng(),(e=j.getParent(d.startContainer,"table"))&&a.getBody().firstChild==e){var l=d,m=e.ownerDocument;d=m.createRange();d.setStartBefore(e);d.setEnd(l.endContainer,l.endOffset);l=m.createElement("body");l.appendChild(d.cloneContents());0==l.innerHTML.replace(/<(br|img|object|embed|input|textarea)[^>]*>/gi,"-").replace(/<[^>]+>/g,
"").length&&(d=j.createRng(),d.setStartBefore(e),d.setEndBefore(e),a.selection.setRng(d),c.preventDefault())}});a.onKeyUp.add(z);a.onSetContent.add(z);a.onVisualAid.add(z);l.isGecko&&a.onKeyDown.add(function(a,c){if(c.keyCode===l.VK.ENTER&&c.shiftKey){var d=a.selection.getRng().startContainer;if(u.getParent(d,"td,th")){var e=a.getDoc().createTextNode("");u.insertAfter(e,d)}}});a.startContent=a.getContent({format:"raw"})}});e({mceTableSplitCells:function(a){a.split()},mceTableMergeCells:function(a){d.dom.getParent(d.selection.getNode(),
"th,td");d.dom.select("td.mceSelected,th.mceSelected").length&&a.merge()},mceTableInsertRowBefore:function(a){a.insertRow(!0)},mceTableInsertRowAfter:function(a){a.insertRow()},mceTableInsertNumberingCol:function(a){a.insertNumCol()},mceTableUpdateNumberingCol:function(a){a.updateNumCol()},mceTableInsertColBefore:function(a){a.insertCol(!0)},mceTableInsertColAfter:function(a){a.insertCol()},mceTableDeleteCol:function(a){a.deleteCols()},mceTableDeleteRow:function(a){a.deleteRows()},mceTableCutRow:function(a){w=
a.cutRows();F(w)},mceTableCopyRow:function(a){w=a.copyRows();F(w)},mceTablePasteRowBefore:function(a){a.pasteRows(B(),!0)},mceTablePasteRowAfter:function(a){a.pasteRows(B())},mceTableDelete:function(a){a.deleteTable()},mceTableMoveCaretToNextCell:function(a){a.moveCaretToNextCell()},mceTableMoveCaretToPrevCell:function(a){a.moveCaretToPrevCell()},mceTableCopyCol:function(a){C=a.copyColumns();K.setItem("copiedCols",JSON.stringify(C))},mceTableCutCol:function(a){C=a.cutColumns();K.setItem("copiedCols",
JSON.stringify(C))},mceTablePasteColBefore:function(a){var e=JSON.parse(K.getItem("copiedCols"))||{};a.prepareTableForColPasteAndCheckIfNeedToRepaint(e)&&(d.execCommand("mceRepaint"),a=t());a.pasteColumns(e,!0)},mceTablePasteColAfter:function(a){a.pasteColumns(JSON.parse(K.getItem("copiedCols"))||{},!1)}},function(a,e){d.addCommand(e,function(){var e=t();e&&(a(e),d.execCommand("mceRepaint"),E())})});e({mceInsertTable:function(a){n.open({url:j+"/table.htm",width:400+parseInt(d.getLang("table.table_delta_width",
0)),height:320+parseInt(d.getLang("table.table_delta_height",0)),inline:1},{plugin_url:j,action:a?a.action:0})},mceTableRowProps:function(){n.open({url:j+"/row.htm",width:400+parseInt(d.getLang("table.rowprops_delta_width",0)),height:295+parseInt(d.getLang("table.rowprops_delta_height",0)),inline:1},{plugin_url:j})},mceTableCellProps:function(){n.open({url:j+"/cell.htm",width:400+parseInt(d.getLang("table.cellprops_delta_width",0)),height:295+parseInt(d.getLang("table.cellprops_delta_height",0)),
inline:1},{plugin_url:j})}},function(a,e){d.addCommand(e,function(d,e){a(e)})})}});l.PluginManager.add("table",l.plugins.TablePlugin)})(tinymce,AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-extensions', location = 'jscripts/tiny_mce/plugins/table/js/table.js' */
(function(){function i(c,a){var e=document.forms[0].elements[c];if("undefined"==typeof a||null==a)a="",e&&(a=e.value);if(""==a)return"";a=a.replace(/&/g,"&amp;");a=a.replace(/\"/g,"&quot;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");return" "+c+'="'+a+'"'}AJS.$.extend(tinymce.plugins.TablePlugin.prototype,{insertTable:function(){var c=AJS.$("#tinymce-table-form")[0],a=AJS.Rte.getEditor(),e=a.dom,f=2,m=2,h=tinymce.settings.confluence_table_style,d="",b="";e.getParent(a.selection.getNode(),"table");
var j,n;j=c.elements.heading.checked;n=c.elements["equal-width-columns"].checked;f=c.elements.cols.value;m=c.elements.rows.value;c=AJS.$("#tinymce-table-form input[name='width']").val();b=b+"<table"+i("data-mce-new","1");c&&a.settings.inline_styles?(d&&(d+="; "),/^[0-9\.]+$/.test(c)&&(c+="px"),d+="width: "+c):b+=i("width",c);b+=i("class",h);b+=i("style",d);b+=">";for(h=0;h<m;h++){b+="<tr>";for(d=0;d<f;d++){var k,l;0==h&&j?(c="th",l=tinymce.settings.confluence_table_heading_style):(c="td",l=tinymce.settings.confluence_table_cell_style);
n&&(k=' width="'+Math.round(100*(100/f))/100+'%"');b+="<"+c+(k?k:"")+' class="'+l+'">';!tinymce.isIE||tinymce.isIE11?b+='<br data-mce-bogus="1"/>':tinymce.isIE9&&(b+="&nbsp;");b+="</"+c+">"}b+="</tr>"}b+="</table>";if(a.settings.fix_table_elements){var g="";AJS.Rte.BookmarkManager.restoreBookmark();a.selection.setContent('<br class="_mce_marker" />');tinymce.each("h1 h2 h3 h4 h5 h6 p".split(" "),function(a){g&&(g=g+",");g=g+(a+" ._mce_marker")});tinymce.each(a.dom.select(g),function(b){a.dom.split(a.dom.getParent(b,
"h1,h2,h3,h4,h5,h6,p"),b)});f=e.select("br._mce_marker")[0];a.selection.select(f);a.selection.setContent(b);a.dom.remove(f)}else a.execCommand("mceInsertContent",!1,b);tinymce.each(e.select("table[data-mce-new]"),function(b){var c=e.select(j?"th":"td",b);try{a.selection.setCursorLocation(c[0],0)}catch(d){}e.setAttrib(b,"data-mce-new","")});a.addVisual();a.execCommand("mceEndUndoLevel",!1,{},{skip_undo:!0})}})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.plugins.tinymce:atlassian-rte-javascript-tinymce-extensions', location = 'jscripts/tiny_mce/plugins/autoresize/editor_plugin_src.js' */
(function(j){tinymce.create("tinymce.plugins.AutoResizePlugin",{init:function(a){function b(){var e,d=a.getDoc();e=d.body;var h=d.documentElement,i=tinymce.DOM,f=c.autoresize_min_height,d=AJS.$(d).height();d>c.autoresize_min_height&&(f=d);c.autoresize_max_height&&d>c.autoresize_max_height?(f=c.autoresize_max_height,e.style.overflowY="auto",h.style.overflowY="auto"):(e.style.overflowY="hidden",h.style.overflowY="hidden",e.scrollTop=0);f!==g&&(e=f-g,i.setStyle(i.get(a.id+"_ifr"),"height",f+"px"),g=
f,tinymce.isWebKit&&0>e&&b())}a.onInit.add(function(){j(a.getBody()).addClass("resizable")});var c=this,g=0;a.getParam("fullscreen_is_enabled")||(c.editor=a,c.autoresize_min_height=parseInt(a.getParam("autoresize_min_height",a.getElement().offsetHeight)),c.autoresize_max_height=parseInt(a.getParam("autoresize_max_height",0)),a.onChange.add(b),a.onSetContent.add(b),a.onPaste.add(b),a.onKeyUp.add(b),a.onPostRender.add(b),a.getParam("autoresize_on_init",!0)&&(a.onLoad.add(b),a.onLoadContent.add(b)),
a.addCommand("mceAutoResize",b))},getInfo:function(){return{longname:"Auto Resize",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/autoresize",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("autoresize",tinymce.plugins.AutoResizePlugin)})($);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:attachments-insert-utils-resources', location = 'utils/attachments-insert-utils.js' */
define("confluence-editor/utils/attachments-insert",["underscore","ajs"],function(c,b){return{insertFilePlaceholder:function(a,d,e){a.height="comment"===b.Meta.get("content-type")?"150":"250";a.ownerId&&a.ownerId===b.Data.get("content-id")&&(delete a.page,delete a.space,delete a.date);a=c.omit(c.pick(a,"name","page","space","date","height"),function(a){return!a});a={contentId:b.Meta.get("content-id")||"0",macro:{name:"view-file",params:a}};tinymce.confluence.MacroUtils.insertMacro(a,d).done(function(a){e&&
$(a).click()})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/flextofullsize/editor_plugin_src.js' */
(function(a){var f,e,c=function(){var d=a("#wysiwyg").is(":hidden")?a("#preview"):a("#wysiwyg");e=d.find("iframe");$headerPrecursor=a("#header-precursor");var b=a(window).height(),c=$headerPrecursor.offset().top+$headerPrecursor.height()+a("#header").height();a("#content.edit").height(b-c);setTimeout(function(){if(a("#preview").is(":hidden"))e.height(0).height(d.height());else{a("#content.edit").height("auto");var g=a("#savebar-container").height();c+=a("#editor-precursor").height()+a("#conflict-wrapper").height();
e.height(b-c-g-4)}},1)};tinymce.create("tinymce.plugins.flextofullsizeplugin",{init:function(d){d.onInit.add(function(){var b;a(d.getBody()).addClass("fullsize");if(tinymce.isIE||tinymce.isOpera)b=d.getWin(),f=a(b.parent),b=a(b.parent.document),a("body").css({overflow:"hidden"}),f.bind("resize.resizeplugin",function(){c()}),b.bind("messageClose",function(){setTimeout(c,0)}),b.bind("resize.resizeplugin",function(a,b){c(b&&b.height)}),b.bind("mode-changed",function(){c()}),d.onChange.add(function(){c()}),
d.onInit.add(function(){c()})})},getInfo:function(){return{longname:"flex editor to full size plugin",description:"adjusts height of editor so it always occupies the right space in between the toolbars",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("flextofullsize",tinymce.plugins.flextofullsizeplugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'i18n/tinyMce-translations.i18n.js' */
TinyMCELang={popup_blocked:"The browser has blocked a popup opened by the Editor.",ctrl_key:"Ctrl",shift_key:"Shift",searchreplace:{search_desc:"Find",replace_desc:"Find/Replace"},searchreplace_dlg:{allreplacedplural:"{0} replacements were made",allreplacedsingular:"1 replacement was made",
notfound:"No replacements were made",findlabel:"Find",replacelabel:"Replace",findnext:"Next",findprevious:"Previous",replace:"Replace",replaceall:"Replace all",close:"Close"},
advhr:{advhr_desc:"tinymce.advhr.advhr_desc"},emotions:{emotions_desc:"Emoticons"},emotions_dlg:{title:"Insert emoticon",desc:"Emoticons",smile:"Smile :)",sad:"Sad :(",tongue:"Tongue :p",biggrin:"Big grin :D",wink:"Wink ;)",
thumbs_up:"Thumbs up (y)",thumbs_down:"Thumbs down (n)",information:"Info (i)",check:"Tick (/)",error:"Error (x)",warning:"Warning (!)",add:"Plus (+)",forbidden:"Minus (-)",help_16:"Question mark (?)",
lightbulb_on:"Lightbulb on (on)",lightbulb:"Lightbulb off (off)",star_yellow:"Yellow star (*y)",star_red:"Red star (*r)",star_green:"Green star (*g)",star_blue:"Blue star (*b)",heart:"Heart \u003c3",broken_heart:"Broken heart \u003c/3"},confluence:{conf_macro_browser:"Macro",
conf_macro_browser_desc:"Insert macro",conf_image:"Image",confimage_desc:"Insert image",conf_file:"Files and images",confifile_desc:"Insert files and images",conf_link:"Link",conflink_desc:"Insert link",conf_table:"Table",
conf_wikimarkup:"Markup",conf_wikimarkup_desc:"Insert markup",conf_wikimarkup_errors:"Wiki markup conversion errors",conf_wikimarkup_timeout:"The server took too long to convert the wiki markup. This may only be a temporary problem so you could try again.",conf_wikimarkup_hint:"Hint: you can also enter wiki markup directly in the editor, where it will be formatted as you type.",conf_wikimarkup_markdown_label:"Markdown",
conf_wikimarkup_confluence_label:"Confluence wiki",conf_shortcuts_help_desc:"Keyboard shortcuts help",conf_insert_button_title:"Insert"},table:{desc:"Insert table",row_before_desc:"Insert row before",row_after_desc:"Insert row after",delete_row_desc:"Remove row",
numbering_column_desc:"Insert numbering column",col_before_desc:"Insert column before",col_after_desc:"Insert column after",col_copy_desc:"Copy table column",col_paste_desc:"Paste table column",col_cut_desc:"Cut table column",delete_col_desc:"Remove column",split_cells_desc:"Split merged table cells",
merge_cells_desc:"Merge table cells",row_desc:"tinymce.table.row_desc",cell_desc:"tinymce.table.cell_desc",props_desc:"tinymce.table.props_desc",paste_row_before_desc:"Paste table row",paste_row_after_desc:"Paste row after",cut_row_desc:"Cut table row",copy_row_desc:"Copy table row",
del:"Remove table",row:"Row",col:"Column",cell:"Cell",row_highlight:"Heading row",col_highlight:"Heading column",selection_highlight:"Change cell colour",invalid_table_field:"Rows and columns must both be numbers greater than zero.",table_more_heading:"Table settings",
cut_row_desc_shortcut:"Ctrl+Shift+X",copy_row_desc_shortcut:"Ctrl+Shift+C",paste_row_before_desc_shortcut:"Ctrl+Shift+V",row_before_desc_shortcut:"Alt+\u2191",row_after_desc_shortcut:"Alt+\u2193"},advanced:{style_select:"tinymce.advanced.style_select",font_size:"tinymce.advanced.font_size",
fontdefault:"tinymce.advanced.fontdefault",block:"Format",paragraph:"Paragraph",pre:"Preformatted",h1:"Heading 1",h2:"Heading 2",h3:"Heading 3",h4:"Heading 4",h5:"Heading 5",h6:"Heading 6",blockquote:"Quote",
code:"tinymce.advanced.code",samp:"tinymce.advanced.samp",dt:"tinymce.advanced.dt",dd:"tinymce.advanced.dd",bold_desc:"Bold",italic_desc:"Italic",underline_desc:"Underline",striketrough_desc:"Strikethrough",justifyleft_desc:"Align left",
justifycenter_desc:"Align center",justifyright_desc:"Align right",justifyfull_desc:"Align full",bullist_desc:"Bullet list",numlist_desc:"Numbered list",tasklist_desc:"Task list",outdent_desc:"Outdent",indent_desc:"Indent",
undo_desc:"Undo",redo_desc:"Redo",link_desc:"tinymce.advanced.link_desc",unlink_desc:"Unlink",image_desc:"tinymce.advanced.image_desc",cleanup_desc:"tinymce.advanced.cleanup_desc",code_desc:"tinymce.advanced.code_desc",sub_desc:"Subscript",sup_desc:"Superscript",
hr_desc:"Horizontal rule",removeformat_desc:"tinymce.advanced.removeformat_desc",custom1_desc:"tinymce.advanced.custom1_desc",forecolor_desc:"Select text colour",backcolor_desc:"tinymce.advanced.backcolor_desc",charmap_desc:"Symbol",visualaid_desc:"tinymce.advanced.visualaid_desc",anchor_desc:"tinymce.advanced.anchor_desc",
cut_desc:"tinymce.advanced.cut_desc",copy_desc:"tinymce.advanced.copy_desc",paste_desc:"tinymce.advanced.paste_desc",image_props_desc:"tinymce.advanced.image_props_desc",newdocument_desc:"tinymce.advanced.newdocument_desc",help_desc:"Help",blockquote_desc:"tinymce.advanced.blockquote_desc",path:"tinymce.advanced.path",newdocument:"tinymce.advanced.newdocument",
toolbar_focus:"tinymce.advanced.toolbar_focus",more_colors:"tinymce.advanced.more_colors",paragraph_shortcut:"Ctrl+0",pre_shortcut:"Ctrl+7",h1_shortcut:"Ctrl+1",h2_shortcut:"Ctrl+2",h3_shortcut:"Ctrl+3",h4_shortcut:"Ctrl+4",
h5_shortcut:"Ctrl+5",h6_shortcut:"Ctrl+6",blockquote_shortcut:"Ctrl+8",bullist_shortcut:"Ctrl+Shift+B",numlist_shortcut:"Ctrl+Shift+N",tasklist_shortcut:"[ then ]",undo_shortcut:"Ctrl+Z",redo_shortcut:"Ctrl+Y"},
colorpicker:{more_colors:"More colours",title:"Select a colour",picker_tab:"Picker",picker_title:"Colour picker",palette_title:"tinymce.colorpicker.palette_title",named_tab:"tinymce.colorpicker.named_tab",named_title:"tinymce.colorpicker.named_title",color:"Colour",
name:"tinymce.colorpicker.name",apply:"tinymce.colorpicker.apply"},hints:{drafts:"Hint: Confluence saves drafts automatically. If you ever lose a window, recover your work from the \"Username -\u003e Drafts\" menu.",dnd:"Hint: you can drag and drop images and Office files from your computer right into this editor.",insert_link_recently_viewed:"Hint: type \"\u003cstrong\u003e[\u003c/strong\u003e\" to see a list of suggested pages and insert a link.",insert_link_search:"Hint: type \"\u003cstrong\u003e[\u003c/strong\u003e\" and part of a page title to find and link to that page.",insert_link_end:"Hint: press \u003cstrong\u003eCtrl+Shift+K\u003c/strong\u003e after a word to find and link to relevant pages. Press it again for more suggestions.",insert_link_newpage:"Hint: type \"\u003cstrong\u003e[\u003c/strong\u003e\" and the title of a new page you wish to create, to see an insert link suggestion.",
insert_link_user_mention:"Hint: you can mention somebody in Confluence by typing \"\u003cstrong\u003e@\u003c/strong\u003e\" and then their name.",insert_image_on_page:"Hint: type \"\u003cstrong\u003e!\u003c/strong\u003e\" to see images attached to the page and insert one of them.",insert_image_search:"Hint: type \"\u003cstrong\u003e!\u003c/strong\u003e\" and part of an image name to find and insert the image.",insert_image_end:"Hint: press \u003cstrong\u003eCtrl+Shift+M\u003c/strong\u003e after a word to find and insert relevant images.",insert_wikimarkup:"Hint: the Editor will automatically convert wiki markup as you type it.",insert_wikimarkup_dialog:"Hint: press \u003cstrong\u003eCtrl+Shift+D\u003c/strong\u003e to open the Wiki Markup dialog.",insert_link:"Hint: press \u003cstrong\u003eCtrl+K\u003c/strong\u003e to open the link browser.",
insert_image:"Hint: press \u003cstrong\u003eCtrl+M\u003c/strong\u003e to open the image browser.",insert_macro:"Hint: press \u003cstrong\u003eCtrl+Shift+A\u003c/strong\u003e to open the macro browser.",insert_macro_toc:"Hint: Let Confluence generate you a table of contents for this page. Use \"Insert -\u003e Table of contents\"",insert_bullet_list:"Hint: press \u003cstrong\u003eCtrl+Shift+B\u003c/strong\u003e to start a bullet list.",insert_numbered_list:"Hint: press \u003cstrong\u003eCtrl+Shift+N\u003c/strong\u003e to start a numbered list.",insert_heading:"Hint: press \u003cstrong\u003eCtrl+1\u003c/strong\u003e to create a heading level 1, \u003cstrong\u003eCtrl+2\u003c/strong\u003e for heading level 2 and so on.",insert_table:"Hint: press \u003cstrong\u003eCtrl+Shift+I\u003c/strong\u003e to insert a table.",table_rows_copy:"Hint: press \u003cstrong\u003eCtrl+Shift+C\u003c/strong\u003e to copy a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",
table_rows_cut:"Hint: press \u003cstrong\u003eCtrl+Shift+X\u003c/strong\u003e to cut a row and \u003cstrong\u003eCtrl+Shift+V\u003c/strong\u003e to paste a row in a table.",insert_newline:"Hint: Type \u003cstrong\u003eShift+Enter\u003c/strong\u003e to insert a new paragraph without spacing",autoformat_heading1:"Hint: Type \"\u003cstrong\u003eh1. Title\u003c/strong\u003e\" to quickly insert a Heading 1.",autoformat_heading3:"Hint: Type \"\u003cstrong\u003eh3. Title\u003c/strong\u003e\" to quickly insert a Heading 3.",autoformat_code:"Hint: Type \"\u003cstrong\u003e{{code}}\u003c/strong\u003e\" to quickly insert monospaced text."},auiwindowmanager:{cancel:"Cancel",ok:"OK"},propertypanel:{links_goto:"Go to link",
links_edit:"Edit",links_unlink:"Unlink",links_goto_disabled_tooltip:"This link goes to content on the page you are editing",links_edit_tooltip:"Edit link in a dialogue",links_unlink_tooltip:"Replace link with the text it contains",images_small:"Small",images_medium:"Medium",
images_large:"Large",images_original:"Original",images_border:"Border",images_link_create:"Link",images_link_edit:"Edit link",images_link_remove:"Unlink",images_link_create_tooltip:"Link this image to other content",
images_link_edit_tooltip:"Edit the link for this image",images_link_remove_tooltip:"Remove the link for this image",images_sizing_tooltip:"Resize image to a specific width",images_small_tooltip:"Resize image to small and link to the original",images_medium_tooltip:"Resize image to medium and link to the original",images_large_tooltip:"Resize image to large and link to the original",
images_original_tooltip:"Reset image size to original",images_thumbnail_tooltip:"tinymce.propertypanel.images.thumbnail.tooltip",images_border_tooltip:"Display a border around image"}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'toolbar/toolbar.soy' */
// This file was automatically generated from toolbar.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.Toolbar == 'undefined') { Confluence.Templates.Editor.Toolbar = {}; }


Confluence.Templates.Editor.Toolbar.toolbarButton = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li id="', soy.$$escapeHtml(opt_data.button.id), '" class="toolbar-item ', soy.$$escapeHtml(opt_data.button.className), '" data-tooltip="', soy.$$escapeHtml(opt_data.button.tooltip), '" data-weight="', soy.$$escapeHtml(opt_data.button.weight), '"><a class="toolbar-trigger aui-button" href="#" data-control-id="', soy.$$escapeHtml(opt_data.button.id), '"><span class="icon"></span><span class="trigger-text">', soy.$$escapeHtml(opt_data.button.title), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepaste/editor_plugin_src.js' */
(function(g){function h(b,a){return b.getParam(a,q[a])}function p(b,a){b.is("ul.inline-task-list")?a.each(function(){var b=g(this);b.attr("data-inline-task-id")||b.attr("data-inline-task-id","")}):a.removeAttr("data-inline-task-id").removeAttr("data-pasted-task")}var k=tinymce.each,q={paste_auto_cleanup_on_paste:!0,paste_enable_default_filters:!0,paste_block_drop:!1,paste_retain_style_properties:"none",paste_strip_class_attributes:"mso",paste_remove_spans:!1,paste_remove_styles:!1,paste_remove_styles_if_webkit:!1,
paste_convert_middot_lists:!0,paste_convert_headers_to_strong:!1,paste_dialog_width:"450",paste_dialog_height:"400",paste_text_use_dialog:!1,paste_text_sticky:!1,paste_text_sticky_default:!1,paste_text_notifyalways:!1,paste_text_linebreaktype:"combined",paste_text_replacements:[[/\u2026/g,"..."],[/[\x93\x94\u201c\u201d]/g,'"'],[/[\x60\x91\x92\u2018\u2019]/g,"'"]]};tinymce.create("tinymce.plugins.ConfluencePastePlugin",{init:function(b,a){function c(a,c){var e=b.dom,f;d.onPreProcess.dispatch(d,a);
a.node=e.create("div",0,a.content);tinymce.isGecko&&(f=b.selection.getRng(!0),f.startContainer==f.endContainer&&3==f.startContainer.nodeType&&1===a.node.childNodes.length&&(/^(p|h[1-6]|pre)$/i.test(a.node.firstChild.nodeName)&&-1===a.content.indexOf("__MCE_ITEM__"))&&e.remove(a.node.firstChild,!0));d.onPostProcess.dispatch(d,a);a.content=b.serializer.serialize(a.node,{getInner:1,forced_root_block:""});!c&&b.pasteAsPlainText?(d._insertPlainText(a.content),h(b,"paste_text_sticky")||(b.pasteAsPlainText=
!1,b.controlManager.setActive("pastetext",!1))):d._insert(a.content);tinymce.isGecko&&b.dom.getRoot().focus()}function f(a){if(a){var c=a.firstChild;c&&("DIV"==c.nodeName&&c.style.marginTop&&c.style.backgroundColor)&&b.dom.remove(c,1);tinymce.isWebKit&&k(b.dom.select("span.Apple-style-span",a),function(a){b.dom.removeClass(a,"Apple-style-span")});tinymce.isWebKit&&k(b.dom.select("br.Apple-interchange-newline",a),function(a){b.dom.remove(a)});k(b.dom.select("br[data-mce-bogus]",a),function(a){b.dom.remove(a)});
k(b.dom.select("meta[charset]",a),function(a){b.dom.remove(a)})}}function e(a){var d,e,i,o,n=b.selection,j=b.dom;i=b.getBody();var l;b.undoManager.add();if(function(a){if(!a.clipboardData||-1==g.inArray("text/html",a.clipboardData.types||[]))return!1;var a=a.clipboardData.getData("text/html"),d;if(!a||!g.browser.webkit)return!1;d=AJS.ClipboardHelper.repair(a);if(d==a)return!1;a=AJS.ClipboardHelper.parse(d,b.getDoc());d=g("<div></div>");d.append(a);f(d[0]);c({content:d.html()});return!0}(a))g.Event(a).preventDefault();
else{if(a.clipboardData||j.doc.dataTransfer)if(l=(a.clipboardData||j.doc.dataTransfer).getData("Text"),b.pasteAsPlainText){a.preventDefault();c({content:j.encode(l).replace(/\r?\n/g,"<br />")});return}if(!j.get("_mcePaste"))if(o=i,"true"!=i.contentEditable&&(o=j.getParent(b.selection.getStart(),'[contenteditable="true"]',i)),d=j.add(o,"div",{id:"_mcePaste","class":"mcePaste","data-mce-bogus":"1"},"\ufeff\ufeff"),i!=b.getDoc().body?i=j.getPos(b.selection.getStart(),i).y:(i=j.getViewPort(b.getWin()),
i=i.y+parseInt(i.h/2,10)),j.setStyles(d,{position:"absolute",left:tinymce.isGecko?-40:0,top:i-25,width:1,height:1,overflow:"hidden"}),tinymce.isIE)if(o=n.getRng(),i=j.doc.body.createTextRange(),i.moveToElementText(d),i.execCommand("Paste"),j.remove(d),"\ufeff\ufeff"===d.innerHTML)b.execCommand("mcePasteWord"),a.preventDefault();else return n.setRng(o),n.setContent(""),setTimeout(function(){c({content:d.innerHTML})},0),tinymce.dom.Event.cancel(a);else{var h=function(b){b.preventDefault()};j.bind(b.getDoc(),
"mousedown",h);j.bind(b.getDoc(),"keydown",h);e=b.selection.getRng();d=d.firstChild;i=b.getDoc().createRange();i.setStart(d,0);i.setEnd(d,2);n.setRng(i);window.setTimeout(function(){var a="",d;if(j.select("div.mcePaste > div.mcePaste").length)a="<p>"+j.encode(l).replace(/\r?\n\r?\n/g,"</p><p>").replace(/\r?\n/g,"<br />")+"</p>";else{d=j.select("div.mcePaste");k(d,function(b){f(b);b.parentNode.className!="mcePaste"&&(a=a+b.innerHTML)})}k(j.select("div.mcePaste"),function(b){j.remove(b)});e&&n.setRng(e);
c({content:a});j.unbind(b.getDoc(),"mousedown",h);j.unbind(b.getDoc(),"keydown",h)},0)}}}var d=this;d.editor=b;d.url=a;d.onPreProcess=new tinymce.util.Dispatcher(d);d.onPostProcess=new tinymce.util.Dispatcher(d);d.onPreProcess.add(d._preProcess);d.onPostProcess.add(d._postProcess);d.onPreProcess.add(function(a,c){b.execCallback("paste_preprocess",a,c)});d.onPostProcess.add(function(a,c){b.execCallback("paste_postprocess",a,c)});b.onKeyDown.addToTop(function(a,b){if((tinymce.isMac?b.metaKey:b.ctrlKey)&&
!b.shiftKey&&86==b.keyCode||b.shiftKey&&45==b.keyCode)return!1});b.pasteAsPlainText=h(b,"paste_text_sticky_default");b.addCommand("mceInsertClipboardContent",function(b,a){c(a,!0)});h(b,"paste_text_use_dialog")||b.addCommand("mcePasteText",function(){var a=tinymce.util.Cookie;b.pasteAsPlainText=!b.pasteAsPlainText;b.controlManager.setActive("pastetext",b.pasteAsPlainText);b.pasteAsPlainText&&!a.get("tinymcePasteText")&&(h(b,"paste_text_sticky")?b.windowManager.alert(b.translate("paste.plaintext_mode_sticky")):
b.windowManager.alert(b.translate("paste.plaintext_mode")),h(b,"paste_text_notifyalways")||a.set("tinymcePasteText","1",new Date((new Date).getFullYear()+1,12,31)))});b.addButton("pastetext",{title:"paste.paste_text_desc",cmd:"mcePasteText"});b.addButton("selectall",{title:"paste.selectall_desc",cmd:"selectall"});h(b,"paste_auto_cleanup_on_paste")&&(tinymce.isOpera||/Firefox\/2/.test(navigator.userAgent)?b.onKeyDown.addToTop(function(b,a){((tinymce.isMac?a.metaKey:a.ctrlKey)&&86==a.keyCode||a.shiftKey&&
45==a.keyCode)&&e(a)}):b.onPaste.addToTop(function(a,b){return e(b)}));b.onInit.add(function(){b.controlManager.setActive("pastetext",b.pasteAsPlainText);h(b,"paste_block_drop")&&b.dom.bind(b.getBody(),"dragend dragover draggesture dragdrop drop drag".split(" "),function(a){a.preventDefault();a.stopPropagation();return false})});b.onSaveContent.add(function(a,b){var c=g("<div/>").html(b.content);g('ul.inline-task-list > li[data-pasted-task="true"]',c).each(function(){var a=g(this),b=a.attr("data-inline-task-id");
b&&1<c.find('ul.inline-task-list > li[data-inline-task-id="'+b+'"]').size()&&a.attr("data-inline-task-id","")});b.content=c.html()});d._legacySupport()},getInfo:function(){return{longname:"ConfluencePastePlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}},_preProcess:function(b,a){function c(a){k(a,function(a){e=a.constructor==RegExp?e.replace(a,""):e.replace(a[0],a[1])})}var f=this.editor,e=a.content,
d=tinymce.grep,g=tinymce.explode,r=tinymce.trim,m,i;if(!1!=f.settings.paste_enable_default_filters){tinymce.isIE&&9<=document.documentMode&&(c([[/(?:<br>&nbsp;[\s\r\n]+|<br>)*(<\/?(h[1-6r]|p|div|address|pre|form|table|tbody|thead|tfoot|th|tr|td|li|ol|ul|caption|blockquote|center|dl|dt|dd|dir|fieldset)[^>]*>)(?:<br>&nbsp;[\s\r\n]+|<br>)*/g,"$1"]]),c([[/<br><br>/g,"<BR><BR>"],[/<br>/g," "],[/<BR><BR>/g,"<br>"]]));if(/class="?Mso|style="[^"]*\bmso-|w:WordDocument/i.test(e)||a.wordContent){a.wordContent=
!0;c([/^\s*(&nbsp;)+/gi,/(&nbsp;|<br[^>]*>)+\s*$/gi]);h(f,"paste_convert_headers_to_strong")&&(e=e.replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>"));h(f,"paste_convert_middot_lists")&&c([[/<\!--\[if !supportLists\]--\>/gi,"$&__MCE_ITEM__"],[/(<span[^>]+(?:mso-list:|:\s*symbol)[^>]+>)/gi,"$1__MCE_ITEM__"],[/(<p[^>]+(?:MsoListParagraph)[^>]+>)/gi,"$1__MCE_ITEM__"]]);c([/<\!--[\s\S]+?--\>/gi,/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|img|meta|link|style|\w:\w+)(?=[\s\/>]))[^>]*>/gi,
[/<(\/?)s>/gi,"<$1strike>"],[/&nbsp;/gi,"\u00a0"]]);do m=e.length,e=e.replace(/(<[a-z][^>]*\s)(?:id|name|language|type|on\w+|\w+:\w+)=(?:"[^"]*"|\w+)\s?/gi,"$1");while(m!=e.length);0==h(f,"paste_retain_style_properties").replace(/^none$/i,"").length?e=e.replace(/<\/?span[^>]*>/gi,""):c([[/<span\s+style\s*=\s*"\s*mso-spacerun\s*:\s*yes\s*;?\s*"\s*>([\s\u00a0]*)<\/span>/gi,function(a,b){return b.length>0?b.replace(/./," ").slice(Math.floor(b.length/2)).split("").join("\u00a0"):""}],[/(<[a-z][^>]*)\sstyle="([^"]*)"/gi,
function(a,b,c){var d=[],e=0,a=g(r(c).replace(/&quot;/gi,"'"),";");k(a,function(a){function b(a){return a+(a!=="0"&&/\d$/.test(a))?"px":""}var c,f=g(a,":");if(f.length==2){a=f[0].toLowerCase();c=f[1].toLowerCase();switch(a){case "mso-padding-alt":case "mso-padding-top-alt":case "mso-padding-right-alt":case "mso-padding-bottom-alt":case "mso-padding-left-alt":case "mso-margin-alt":case "mso-margin-top-alt":case "mso-margin-right-alt":case "mso-margin-bottom-alt":case "mso-margin-left-alt":case "mso-table-layout-alt":case "mso-height":case "mso-width":case "mso-vertical-align-alt":d[e++]=
a.replace(/^mso-|-alt$/g,"")+":"+b(c);return;case "horiz-align":d[e++]="text-align:"+c;return;case "vert-align":d[e++]="vertical-align:"+c;return;case "font-color":case "mso-foreground":d[e++]="color:"+c;return;case "mso-background":case "mso-highlight":d[e++]="background:"+c;return;case "mso-default-height":d[e++]="min-height:"+b(c);return;case "mso-default-width":d[e++]="min-width:"+b(c);return;case "mso-padding-between-alt":d[e++]="border-collapse:separate;border-spacing:"+b(c);return;case "text-line-through":if(c==
"single"||c=="double")d[e++]="text-decoration:line-through";return;case "mso-zero-height":c=="yes"&&(d[e++]="display:none");return}/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?!align|decor|indent|trans)|top-bar|version|vnd|word-break)/.test(a)||(d[e++]=a+":"+f[1])}});return e>0?b+' style="'+d.join(";")+'"':b}]])}h(f,"paste_convert_headers_to_strong")&&c([[/<h[1-6][^>]*>/gi,"<p><strong>"],[/<\/h[1-6][^>]*>/gi,"</strong></p>"]]);
c([[/Version:[\d.]+\nStartHTML:\d+\nEndHTML:\d+\nStartFragment:\d+\nEndFragment:\d+/gi,""]]);i=h(f,"paste_strip_class_attributes");"none"!==i&&(m=function(a,b){if(i==="all")return"";var c=d(g(b.replace(/^(["'])(.*)\1$/,"$2")," "),function(a){return/^(?!mso)/i.test(a)});return c.length?' class="'+c.join(" ")+'"':""},e=e.replace(/ class="([^"]+)"/gi,m),e=e.replace(/ class=([\-\w]+)/gi,m));h(f,"paste_remove_spans")&&(e=e.replace(/<\/?span[^>]*>/gi,""));a.content=e}},_postProcess:function(b,a){var c=
this.editor,f=c.dom,e;!1!=c.settings.paste_enable_default_filters&&(a.wordContent&&(k(f.select("a",a.node),function(a){(!a.href||-1!=a.href.indexOf("#_Toc"))&&f.remove(a,1)}),h(c,"paste_convert_middot_lists")&&this._convertLists(b,a),e=h(c,"paste_retain_style_properties"),tinymce.is(e,"string")&&("all"!==e&&"*"!==e)&&(e=tinymce.explode(e.replace(/^none$/i,"")),k(f.select("*",a.node),function(a){var b={},c=0,g,i,h;if(e)for(g=0;g<e.length;g++)if(i=e[g],h=f.getStyle(a,i))b[i]=h,c++;f.setAttrib(a,"style",
"");e&&0<c?f.setStyles(a,b):"SPAN"==a.nodeName&&!a.className&&f.remove(a,!0)}))),h(c,"paste_remove_styles")||h(c,"paste_remove_styles_if_webkit")&&tinymce.isWebKit?k(f.select("*[style]",a.node),function(a){a.removeAttribute("style");a.removeAttribute("data-mce-style")}):tinymce.isWebKit&&k(f.select("*",a.node),function(a){a.removeAttribute("data-mce-style")}))},_convertLists:function(b,a){var c=b.editor.dom,f,e,d=-1,g,h=[],m,i;k(c.select("p",a.node),function(a){var b,i="",l;for(b=a.firstChild;b&&
3==b.nodeType;b=b.nextSibling)i+=b.nodeValue;i=a.innerHTML.replace(/<\/?\w+[^>]*>/gi,"").replace(/&nbsp;/g,"\u00a0");/^(__MCE_ITEM__)+[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*\u00a0*/.test(i)&&(l="ul");/^__MCE_ITEM__\s*\w+\.\s*\u00a0+/.test(i)&&(l="ol");l?(g=parseFloat(a.style.marginLeft||0),g>d&&h.push(g),!f||l!=m?(f=c.create(l),c.insertAfter(f,a)):g>d?f=e.appendChild(c.create(l)):g<d&&(b=tinymce.inArray(h,g),i=c.getParents(f.parentNode,l),f=i[i.length-1-b]||f),k(c.select("span",a),function(a){var b=
a.innerHTML.replace(/<\/?\w+[^>]*>/gi,"");l=="ul"&&/^__MCE_ITEM__[\u2022\u00b7\u00a7\u00d8o\u25CF]/.test(b)?c.remove(a):/^__MCE_ITEM__[\s\S]*\w+\.(&nbsp;|\u00a0)*\s*/.test(b)&&c.remove(a)}),b=a.innerHTML,b="ul"==l?a.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^[\u2022\u00b7\u00a7\u00d8o\u25CF]\s*(&nbsp;|\u00a0)+\s*/,""):a.innerHTML.replace(/__MCE_ITEM__/g,"").replace(/^\s*\w+\.(&nbsp;|\u00a0)+\s*/,""),e=f.appendChild(c.create("li",0,b)),c.remove(a),d=g,m=l):f=d=0});i=a.node.innerHTML;-1!=i.indexOf("__MCE_ITEM__")&&
(a.node.innerHTML=i.replace(/__MCE_ITEM__/g,""))},_insert:function(b,a){var c=this.editor,f=c.selection.getRng(!0),e,d,b=this._applyOnBeforeSetContentListeners(c,b);d=AJS.ClipboardHelper.parse(b,c.getDoc());(e=this._getClipboardInserter(c,f,d))?(e.insert(c,f,d),c.selection.onSetContent.dispatch(c.selection,{content:b,format:"html"}),c.addVisual()):(!c.selection.isCollapsed()&&f.startContainer!=f.endContainer&&c.execCommand("mceDelete",!1,null,{skip_undo:!0}),c.execCommand("mceInsertContent",!1,b,
{skip_undo:a}))},_getClipboardInserter:function(b,a,c){var f;g.each(this.clipboardInserters,function(e,d){if(d.shouldInsert(b,a,c))return f=d,!1});return f},clipboardInserters:[{shouldInsert:function(b,a,c){b=3==a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer;return(tinymce.isIE?"LI"==b.nodeName&&0===b.childNodes.length:"LI"==b.nodeName&&1===b.childNodes.length&&"BR"==b.firstChild.nodeName)&&c.length===c.filter("ol,ul").length&&0<c.children("li").length},insert:function(b,a,
c){a=g(3==a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer);c=c.children();b.undoManager.beforeChange();b.undoManager.add();p(a.parent(),c);a.replaceWith(c);b.selection.select(c.last()[0],!0);b.selection.collapse();b.undoManager.add()}},{shouldInsert:function(b,a,c){!a.collapsed||0!=a.startOffset?a=!1:(b=g(a.startContainer).closest("ol, ul",b.getBody()),0===b.length?a=!1:(a=(new tinymce.dom.TreeWalker(a.startContainer,b[0])).prev(!0),a=void 0===a||g(a).is("li")));return a&&c.length===
c.filter("ol,ul").length&&0<c.children("li").length},insert:function(b,a,c){a=g(a.startContainer).closest("li",b.getBody());c=c.children();b.undoManager.beforeChange();b.undoManager.add();p(a.parent(),c);a.before(c);b.selection.select(a[0],!0);b.selection.collapse(!0);b.undoManager.add()}},{shouldInsert:function(b,a,c){!a.collapsed||3==a.startContainer.nodeType&&a.startOffset!=a.startContainer.nodeValue.length||1===a.startContainer.nodeType&&a.startOffset!=a.startContainer.childNodes.length?a=!1:
(b=g(a.startContainer).closest("ol, ul",b.getBody()),0===b.length?a=!1:(a=(new tinymce.dom.TreeWalker(a.startContainer,b[0])).next(!0),a=void 0===a||g(a).is("li")));return a&&c.length===c.filter("ol,ul").length&&0<c.children("li").length},insert:function(b,a,c){a=g(a.startContainer).closest("li",b.getBody());c=c.children();b.undoManager.beforeChange();b.undoManager.add();p(a.parent(),c);a.after(c);b.selection.select(c.last()[0],!0);b.selection.collapse(!1);b.undoManager.add()}},{shouldInsert:function(b,
a,c){return a.collapsed||!g(a.commonAncestorContainer).is("table.confluenceTable > tbody, table.confluenceTable > tbody > tr")?!1:c.is("table:not(.wysiwyg-macro)")},insert:function(b,a,c){function f(a,b){for(var c=a.shift(),d=b.shift();c&&d;c=a.shift(),d=b.shift())g(d).html(g(c).html())}var e=0<c.children("tbody").length?c.children("tbody").children("tr"):c.children("tr"),d=e.children("td, th"),h=g(".mceSelected",b.getDoc()),c=h.parent();b.undoManager.beforeChange();b.undoManager.add();if(1===c.length)f(g.makeArray(d),
g.makeArray(h));else{e=g.makeArray(e);c=g.makeArray(c);d=e.shift();for(h=c.shift();d&&h;d=e.shift(),h=c.shift())f(g.makeArray(g(d).children()),g.makeArray(g(h).children()))}b.selection.setRng(a);b.undoManager.add()}},{shouldInsert:function(b,a,c){b=g(a.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0===b.length)return!1;b=b.closest("table.confluenceTable",".mceContent");if(!(0===b.length||0===b.children("tbody").length)){if(!c.is("table:not(.wysiwyg-macro)"))return!1;
var f=!1;b.find("*[colspan], *[rowspan]").each(function(a,b){if(1<g(b).attr("rowspan")||1<g(b).attr("colspan"))return f=!0,!1});return!f}},insert:function(b,a,c){var a=g(a.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent"),f=a.closest("table.confluenceTable",".mceContent"),c=0<c.children("tbody").length?c.children("tbody").children("tr"):c.children("tr"),e=f.children("tbody").children("tr"),d=c.length,h=c.first().children("td, th").length,k=e.length,m=e.first().children("td, th").length,
i=a.parent().index(),o=a.index();b.undoManager.beforeChange();b.undoManager.add();var n=o+h-m,d=i+d-k,n=0>n?0:n,d=0>d?0:d;e.each(function(a,b){for(var c=g(b),d=c.children().last(),e=0;e<n;e++)c.append(d.clone().html(tinymce.isIE?"":"<br/>"))});h=e.last();for(e=0;e<d;e++){h=g("<tr></tr>").insertAfter(h);for(k=0;k<m+n;k++)h.append('<td class="confluenceTd">'+(tinymce.isIE?"":"<br/>")+"</td>")}var j=[];f.children("tbody").children("tr").slice(i).each(function(a,b){j.push(g.makeArray(g(b).children("th, td").slice(o)))});
var l=[];c.each(function(a,b){l.push(g.makeArray(g(b).children("th, td")))});f=l.shift();for(c=j.shift();f&&c;f=l.shift(),c=j.shift()){m=f.shift();for(i=c.shift();m&&i;m=f.shift(),i=c.shift())g(i).html(g(m).html())}b.selection.select(a[0],1);b.selection.collapse(!0);b.undoManager.add()}}],_applyOnBeforeSetContentListeners:function(b,a){var c={content:a,format:"html"};b.selection.onBeforeSetContent.dispatch(b.selection,c);return c.content},_insertPlainText:function(b){function a(a){k(a,function(a){b=
a.constructor==RegExp?b.replace(a,""):b.replace(a[0],a[1])})}var c=this.editor,f=h(c,"paste_text_linebreaktype"),e=h(c,"paste_text_replacements"),d=tinymce.is;"string"===typeof b&&0<b.length&&(/<(?:p|br|h[1-6]|ul|ol|dl|table|t[rdh]|div|blockquote|fieldset|pre|address|center)[^>]*>/i.test(b)?a([/[\n\r]+/g]):a([/\r+/g]),a([[/<\/(?:p|h[1-6]|ul|ol|dl|table|div|blockquote|fieldset|pre|address|center)>/gi,"\n\n"],[/<br[^>]*>|<\/tr>/gi,"\n"],[/<\/t[dh]>\s*<t[dh][^>]*>/gi,"\t"],/<[a-z!\/?][^>]*>/gi,[/&nbsp;/gi,
" "],[/(?:(?!\n)\s)*(\n+)(?:(?!\n)\s)*/gi,"$1"],[/\n{3,}/g,"\n\n"]]),b=c.dom.decode(tinymce.html.Entities.encodeRaw(b)),d(e,"array")?a(e):d(e,"string")&&a(RegExp(e,"gi")),"none"==f?a([[/\n+/g," "]]):"br"==f?a([[/\n/g,"<br />"]]):"p"==f?a([[/\n+/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"]]):a([[/\n\n/g,"</p><p>"],[/^(.*<\/p>)(<p>)$/,"<p>$1"],[/\n/g,"<br />"]]),c.execCommand("mceInsertContent",!1,b))},_legacySupport:function(){var b=this,a=b.editor;a.addCommand("mcePasteWord",function(){a.windowManager.open({file:b.url+
"/pasteword.htm",width:parseInt(h(a,"paste_dialog_width")),height:parseInt(h(a,"paste_dialog_height")),inline:1})});h(a,"paste_text_use_dialog")&&a.addCommand("mcePasteText",function(){a.windowManager.open({file:b.url+"/pastetext.htm",width:parseInt(h(a,"paste_dialog_width")),height:parseInt(h(a,"paste_dialog_height")),inline:1})});a.addButton("pasteword",{title:"paste.paste_word_desc",cmd:"mcePasteWord"})}});tinymce.PluginManager.add("confluencepaste",tinymce.plugins.ConfluencePastePlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confcharmap/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.ConfCharmapPlugin",{init:function(a){a.addCommand("confCharmap",function(){a.windowManager.open({id:"insert-char-dialog",url:tinyMCE.settings.editor_plugin_action_base_path+"/charmap.action",width:600+parseInt(a.getLang("advanced.charmap_delta_width",0)),height:290+parseInt(a.getLang("advanced.charmap_delta_height",0)),inline:!0,name:"advanced.charmap_desc"})})},getInfo:function(){return{longname:"Confluence Charmap Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",
version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confcharmap",tinymce.plugins.ConfCharmapPlugin)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencelist/editor_plugin_src.js' */
(function(b){tinymce.create("tinymce.plugins.ConfluenceListPlugin",{init:function(j){!tinymce.isIE8&&j.onKeyDown.add(function(d,i){if(8==i.keyCode){var c=d.selection.getRng(!0),e=b(c.startContainer).closest("li",d.getBody());if(0!==e.length&&AJS.EditorUtils.isCursorAtStartOf(e[0],c)){var c=e.prev("li"),f,g=e[0],a;if(0<c.length){f=c[0];a=b(g.firstChild);tinymce.isIE9&&0===a.length?a=b("<br/>").appendTo(e):a.is("p")&&(a=a.contents().first());var h=function(a){a&&a.lastChild&&!d.dom.isBlock(a.lastChild)&&
!b(a.lastChild).is("br")&&b(a).append("<br/>")};d.undoManager.beforeChange();d.undoManager.add();b(f.lastChild).is("p")&&!d.dom.isBlock(g.firstChild)?(h(f.lastChild),e.contents().each(function(a,c){if(d.dom.isBlock(c))return!1;b(f.lastChild).append(b(c).detach())})):b(g.firstChild).is("p")&&!d.dom.isBlock(f.lastChild)?(h(f),b.each(b.makeArray(c.contents()).reverse(),function(a,c){if(d.dom.isBlock(c))return!1;b(g.firstChild).prepend(b(c).detach())})):h(f);c.append(e.detach().contents());a[0]&&AJS.EditorUtils.setCursorAtStartOfContents(a[0]);
d.undoManager.add();return tinymce.dom.Event.cancel(i)}}}})},getInfo:function(){return{longname:"Confluence List Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluencelist",tinymce.plugins.ConfluenceListPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/atlassianemotions/editor_plugin_src.js' */
(function(d,f){d.create("tinymce.plugins.EmotionsPlugin",{init:function(a,g){a.addCommand("mceEmotion",function(){a.windowManager.open({file:tinyMCE.settings.editor_plugin_action_base_path+"/emotions.action",width:190+parseInt(a.getLang("emotions.delta_width",0)),height:125+parseInt(a.getLang("emotions.delta_height",0)),inline:1,id:"insert-emoticon-dialog",name:"emotions_dlg.title"},{plugin_url:g})});a.addButton("emotions",{title:"emotions.emotions_desc",cmd:"mceEmotion"});a.onClick.add(function(a,
e){var b=e.target,c;if("IMG"===b.nodeName&&(c=f(b),c.hasClass("emoticon")))return c=a.selection.getRng(!0),(e.offsetX||e.layerX-b.x)<b.width/2?(c.setStartBefore(b),c.setEndBefore(b)):(c.setStartAfter(b),c.setEndAfter(b)),a.selection.setRng(c),a.selection.collapse(),d.dom.Event.prevent(e)})},getInfo:function(){return{longname:"Emotions",author:"Moxiecode Systems AB",authorurl:"http://tinymce.moxiecode.com",infourl:"http://wiki.moxiecode.com/index.php/TinyMCE:Plugins/emotions",version:d.majorVersion+
"."+d.minorVersion}}});d.PluginManager.add("emotions",d.plugins.EmotionsPlugin)})(tinymce,AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'com/atlassian/confluence/tinymceplugin/tinymce-confluence.js' */
tinymce.confluence=tinymce.confluence||{};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'breadcrumbs/tinymce-breadcrumbs-oninit-rte.js' */
(function(a){AJS.bind("init.rte",function(){if("comment"!==AJS.Meta.get("content-type")){var b=a("#quickedit-breadcrumbs");0<b.length&&(a("#breadcrumbs").detach(),b.attr("id","breadcrumbs"),a("#breadcrumb-section").append(b));var d=a(".edited-page-title").parent().detach(),e=function(){var c=a("#breadcrumbs");c.detach();!c.find(".edited-page-title").length&&d.length&&c.append(d);a("#editor-precursor .cell").prepend(c)};e();a(document).bind("mode-changed",function(c,b){if(b==="preview"){var f=a("#breadcrumbs").detach();
d.detach();a("#breadcrumb-section").append(f)}else b==="richtext"&&e()})}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/tinymce-node-utils.js' */
(function(j){var l;tinymce.confluence.NodeUtils=l={updateNode:function(a,e){var c=j(a,tinymce.activeEditor.getDoc()),b=l.prepareNodeForUpdate(c);return l.replaceNode(c,e).fail(b).promise()},storeNodeState:function(a,e){for(var c={},b,d=0,g=e.length;d<g;d++)b=e[d],c[b]=a.attr(b);return function(){for(var b in c)a.attr(b,c[b])}},prepareNodeForUpdate:function(a){var e=null;a.is("img")&&(e=l.storeNodeState(a,["width","height","src","class"]),a.addClass("image-hotswap").attr({src:Confluence.getContextPath()+
"/images/border/spacer.gif",width:a.attr("width"),height:a.attr("height")}));return e},replaceNode:function(a,e){var c=l.getDoc(),b=j(e,c),d=j(a,c);return j.Deferred(function(){var a=this;b.is("img")?(b[0].onload=function(){AJS.debug("replaceNode: new node's src has been loaded by the browser.");this.onload=null;a.resolve(this)},j.browser.opera&&(b[0].src=b.attr("src")),c.createDocumentFragment().appendChild(b[0])):a.resolve(b[0])}).done(function(a){d.replaceWith(a)}).promise()},replaceSelection:function(a){var e=
tinymce.activeEditor,c=e.selection.getRng(!0),b;b=j.browser.msie&&9>~~j.browser.version?c:e.getDoc().createRange();a=j(a).clone(!0,!1)[0];c.deleteContents();3==c.startContainer.nodeType&&""===c.startContainer.nodeValue&&(c.startContainer.nodeValue=AJS.Rte.HIDDEN_CHAR);c.insertNode(a);j.browser.msie&&9>~~j.browser.version?c=a:(c=e.getDoc().createTextNode(AJS.Rte.HIDDEN_CHAR),e.dom.insertAfter(c,a));b.setStartBefore(c);b.setEndAfter(c);b.collapse(!1);e.selection.setRng(b);return a},normalize:function(a){var e,
c,b,d,g,f,l=tinymce.activeEditor;g=l.selection.getRng(!0);var h,m=[];if(a&&a.childNodes){if(tinymce.isWebKit)h=g;else if(tinymce.isGecko&&(h=g.cloneRange(),e=j.inArray(g.startContainer,a.childNodes),c=h.startOffset,b=j.inArray(g.endContainer,a.childNodes),d=h.endOffset,f=g=f=g=void 0,-1<e||-1<b)){var n=[],o=0;j.each(a.childNodes,function(a,b){var c={},e=n[a-1]||{};c.isTextNode=3==b.nodeType;c.textNodesBefore=(c.isTextNode&&e.isTextNode?1:0)+~~e.textNodesBefore;c.precedingTextLength=o;o=c.isTextNode?
o+b.nodeValue.length:0;n.push(c)});m=n}a.normalize();if(tinymce.isGecko){if(f=m[e])g=e-f.textNodesBefore,f=c+f.precedingTextLength,h.setStart(a.childNodes[g],f);if(f=m[b])g=b-f.textNodesBefore,f=d+f.precedingTextLength,h.setEnd(a.childNodes[g],f)}h&&l.selection.setRng(h)}},getDoc:function(){var a=tinymce.activeEditor;return j.browser.mozilla||j.browser.opera?document:a.getDoc()},isolateSelectedRange:function(){function a(a,b,d){var g;(g=e.dom.getParent(a,e.dom.isBlock))||(g=e.getBody());a:{var f,
i=null,k=null,h;h=(f=d?!0:!1)?"nextSibling":"previousSibling";i=0===b;!i&&f&&(i=3===a.nodeType?b===a.length:b===a.childNodes.length);if(i){i=a[h];for(k=a;null===i;){if(k===g){a=void 0;break a}else if(k.parentNode===g)break;k=k.parentNode;i=k[h]}}else 3===a.nodeType?(h=a.data,a.data=h.slice(b),i=c.createTextNode(h.slice(0,b)),k=a,j(i).insertBefore(k),f&&(h=k,k=i,i=h)):(k=a.childNodes[b-(f?1:0)],i=k[h]);a=[k,i]}if(a)if(a[1]){b=a[1];a=a[0];for(d=d?!0:!1;!(a===g||a.parentNode===g);){i=a.parentNode;f=
i.cloneNode(!1);if(d)for(j(f).insertAfter(i);b;)k=b.nextSibling,f.appendChild(b),b=k;else{j(f).insertBefore(i);for(b=i.firstChild;b!==a;)k=b.nextSibling,f.appendChild(b),b=k}b=f;a=i}d=a}else d=a[0];else d=void 0;return d}var e=tinymce.activeEditor,c=l.getDoc(),b=e.selection,d=b.getRng(!0),g=d.startContainer,f=d.startOffset,p=d.endContainer,h=d.endOffset,m;if(d.collapsed)return d;g===p&&(m=h-f);(f=a(g,f))&&d.setStartBefore(f);g!==d.startContainer&&(h=m||h);(g=a(p,h,!0))&&d.setEndAfter(g);b.setRng(d);
return d}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'autoformat/wiki-autoformat-oninit-rte.js' */
AJS.bind("init.rte",function(q,r){function k(a){return AJS.$("<div>").append(a.cloneNode(!0)).html()}function s(a,b,e){if(!b)throw Error("text node is null");3!=b.nodeType&&(b=b.childNodes[e-1],e=b.length);for(;b&&3==b.nodeType;b=b.previousSibling){-1==e&&(e=b.nodeValue.length);if(e>a)return{container:b,offset:e-a};if(e==a){e=0;for(a=b.parentNode;b=b.previousSibling;)e++;return{container:a,offset:e}}a-=e;e=-1}return null}function l(a){var b,e;if(!a||!a.collapsed)throw Error("range is null or not collapsed");
b=a.startContainer;e=a.startOffset;if(1==b.nodeType&&0<e)if(b=b.childNodes[a.startOffset-1],3==b.nodeType)e=b.nodeValue.length;else return"";else if(3!=b.nodeType)return"";a=b.nodeValue.substring(0,e);for(b=b.previousSibling;b&&3==b.nodeType;b=b.previousSibling)a=b.nodeValue+a;return a}function f(a,b,e,c){return{handles:function(b){var e=!1,b=b.selection.getRng(!0),e=b.commonAncestorContainer||{};return!b.collapsed||AJS.$(e).closest("pre,.text-placeholder").length||c&&AJS.$(e).closest(c).length?!1:
e=a.test(l(b))},execute:function(c,h,g){var f,d,j=1;f=AJS.$.browser.msie?h.keyCode:h.which;32==f?c.execCommand("mceInsertContent",!1,"&nbsp;"):c.execCommand("mceInsertContent",!1,String.fromCharCode(f));c.undoManager.beforeChange();c.undoManager.add();f=c.selection.getRng(!0);d=l(f);"|"==d[d.length-1]&&(d+=" ",j=0);d=a.exec(d.substring(0,d.length-1));j=s(d[1].length+j,f.commonAncestorContainer,f.startOffset);f.setStart(j.container,j.offset);j=AJS.$(f.commonAncestorContainer);c.selection.setRng(f);
j.closest(".wysiwyg-macro-body").length&&f.toString()==j.text()?(j[0].innerHTML="<br>",c.selection.select(j[0].childNodes[0]),c.selection.collapse(!0)):c.execCommand("delete",!1,{},{skip_undo:!0});b(d,c.selection.getRng(!0));m=c.selection.getRng(!0);if(e)return g.preventDefault(),g.stopPropagation(),tinymce.dom.Event.cancel(h),AJS.Rte.showElement(m.startContainer),!1}}}function n(){this.handlers={}}function g(a,b,e,d,g){var a=a.charCodeAt(0),i=AJS.Rte.getResourceUrlPrefix()+"/images/icons/emoticons/"+
g,b=f(b,function(){var a=c.dom.createHTML("img",{src:i,alt:c.getLang(d),title:c.getLang(d),border:0,"class":"emoticon emoticon-"+e,"data-emoticon-name":e});c.execCommand("mceInsertContent",!1,a,{skip_undo:!0})},!0);this.imagePath=i;h.registerHandler(a,b)}function o(a,b){var e=c.formatter.get(a)[0],e=c.dom.create(e.inline,{style:e.styles});e.appendChild(document.createTextNode(b+"{$caret}"));c.execCommand("mceInsertContent",!1,k(e),{skip_undo:!0});c.formatter.remove(a)}AJS.Rte.autoformat={_REGEXES:{WIKI_MACRO:/(?:\s|^)(\{[^{^}]+)$/,
WIKI_LINK:/(?:\s|^)(\[[^\[^\]]+)$/,WIKI_EMBED:/(?:\s|^)(![^!]{5,})$/},_REGEXES_EMOTICON:{SMILE:/\B(:-?)$/,SAD:/\B(:-?)$/,CHEEKY:/\B(:-?)$/,CHEEKY_2:/\B(:-?)$/,LAUGH:/\B(:-?)$/,WINK:/\B(;-?)$/,THUMBS_UP:/\B(\(y)$/,THUMBS_DOWN:/\B(\(n)$/,INFORMATION:/\B(\(i)$/,TICK:/\B(\(\/)$/,CROSS:/\B(\(x)$/,WARNING:/\B(\(!)$/,PLUS:/\B(\(\+)$/,MINUS:/\B(\(-)$/,QUESTION:/\B(\(\?)$/,LIGHT_ON:/\B(\(on)$/,LIGHT_OFF:/\B(\(off)$/,YELLOW_STAR:/\B(\(\*)$/,YELLOW_STAR_2:/\B(\(\*y)$/,RED_STAR:/\B(\(\*r)$/,GREEN_STAR:/\B(\(\*g)$/,
BLUE_STAR:/\B(\(\*b)$/,HEART:/\B(<)$/,BROKEN_HEAR:/\B(<\/)$/}};var m;if(!AJS.Meta.get("remote-user")||!AJS.Meta.get("confluence.prefs.editor.disable.autoformat")){n.prototype={registerHandler:function(a,b){this.handlers[a]||(this.handlers[a]=[]);this.handlers[a].push(b)},executeHandlers:function(a,b,e,c){var d=!0;AJS.$.each(this.handlers[a]||[],function(a,f){if(f.handles(b))return d=f.execute(b,e,c),!1});return d}};for(var c=r.editor,h=new n,d=[new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.SMILE,
"smile","emotions_dlg.smile","smile.png"),new g("(",AJS.Rte.autoformat._REGEXES_EMOTICON.SAD,"sad","emotions_dlg.sad","sad.png"),new g("P",AJS.Rte.autoformat._REGEXES_EMOTICON.CHEEKY,"cheeky","emotions_dlg.tongue","tongue.png"),new g("p",AJS.Rte.autoformat._REGEXES_EMOTICON.CHEEKY_2,"cheeky","emotions_dlg.tongue","tongue.png"),new g("D",AJS.Rte.autoformat._REGEXES_EMOTICON.LAUGH,"laugh","emotions_dlg.biggrin","biggrin.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.WINK,"wink","emotions_dlg.wink",
"wink.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.THUMBS_UP,"thumbs-up","emotions_dlg.thumbs_up","thumbs_up.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.THUMBS_DOWN,"thumbs-down","emotions_dlg.thumbs_down","thumbs_down.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.INFORMATION,"information","emotions_dlg.information","information.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.TICK,"tick","emotions_dlg.check","check.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.CROSS,
"cross","emotions_dlg.error","error.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.WARNING,"warning","emotions_dlg.warning","warning.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.PLUS,"plus","emotions_dlg.add","add.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.MINUS,"minus","emotions_dlg.forbidden","forbidden.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.QUESTION,"question","emotions_dlg.help_16","help_16.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.LIGHT_ON,"light-on",
"emotions_dlg.lightbulb_on","lightbulb_on.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.LIGHT_OFF,"light-off","emotions_dlg.lightbulb","lightbulb.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.YELLOW_STAR,"yellow-star","emotions_dlg.star_yellow","star_yellow.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.YELLOW_STAR_2,"yellow-star","emotions_dlg.star_yellow","star_yellow.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.RED_STAR,"red-star","emotions_dlg.star_red","star_red.png"),
new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.GREEN_STAR,"green-star","emotions_dlg.star_green","star_green.png"),new g(")",AJS.Rte.autoformat._REGEXES_EMOTICON.BLUE_STAR,"blue-star","emotions_dlg.star_blue","star_blue.png"),new g("3",AJS.Rte.autoformat._REGEXES_EMOTICON.HEART,"heart","emotions_dlg.heart","heart.png"),new g("3",AJS.Rte.autoformat._REGEXES_EMOTICON.BROKEN_HEAR,"broken-heart","emotions_dlg.broken_heart","broken_heart.png")],p=[],i=0;i<d.length;i++)p[i]=new Image,p[i].src=d[i].imagePath;
AJS.$.each({"*":"bold",_:"italic","~":"subscript","^":"superscript","+":"underline","-":"strikethrough"},function(a,b){var c=RegExp("(?:[\\s\\xA0\\u200b\\uFEFF]+|^)(\\"+a+"(?=[^\\s"+a+"])([^"+a+"]*?[^\\s]))$");h.registerHandler(a.charCodeAt(0),f(c,function(a){o(b,a[2])},!0))});c.formatter.register("code",{inline:"code"});h.registerHandler(125,f(/(?:[\s\xA0\u200b]+|^)({{(?=[^\s])([^}]*?[^\s])})$/,function(a){o("code",a[2])},!0));for(i=1;6>=i;i++)(function(a){h.registerHandler(32,f(RegExp("^\\u200b?(h"+
a+"\\.)$"),function(){c.execCommand("formatBlock",!1,"h"+a,{skip_undo:!0})},!0))})(i);h.registerHandler(32,f(/^\u200b?(bq\.)$/,function(){c.execCommand("formatBlock",!1,"blockquote",{skip_undo:!0})},!0));h.registerHandler(32,f(/^\u200b?(\*)$/,function(){c.plugins.lists.applyList("UL","OL")},!0));h.registerHandler(32,f(/^\u200b?(\#)$/,function(){c.plugins.lists.applyList("OL","UL")},!0));h.registerHandler(32,f(/^\u200b?(1\.)$/,function(){c.plugins.lists.applyList("OL","UL")},!0));h.registerHandler(32,
f(/^\u200b?(\-)$/,function(){var a=c.dom,b;c.plugins.lists.applyList("UL","OL");if(b=a.getParent(c.selection.getNode(),"OL,UL"))a.setStyles(b,{listStyleType:"square"}),b.removeAttribute("data-mce-style")},!0));AJS.trigger("confluence.editor.registerHandlers",{handlerManager:h,createHandler:f,ed:c});h.registerHandler(32,f(/[^-]*[\s](\-\-\-?)$/,function(a){c.execCommand("mceInsertContent",!1,2===a[1].length?"\u2013":"\u2014",{skip_undo:!0})},!1));d=f(/(([^\s-]+)(\-\-\-?)([^\s-]+))$/,function(a){c.execCommand("mceInsertContent",
!1,a[2]+(2===a[3].length?"\u2013":"\u2014")+a[4],{skip_undo:!0})},!1);h.registerHandler(32,d);h.registerHandler(13,d);d=f(/^\u200b?(\-\-\-\-)$/,function(){c.execCommand("mceInsertContent",!1,"<hr />",{skip_undo:!0})},!0);h.registerHandler(32,d);h.registerHandler(13,d);h.registerHandler(13,f(/(^\u200b?\|\|\s*(?:[^|]*\s?\|\|\s?)+$)/,function(a){var b="<table class='confluenceTable'><tr>",e="",d=!0,a=AJS.$(a[1].slice(2,-2).split("||")).map(function(a){a=AJS.$.trim(this);d=d&&""==a;return a});d&&(a[0]=
"first cell");for(var f=0,g=a.length;f<g;f++)b+="<th class='confluenceTh'>"+a[f]+"</th>",e+="<td class='confluenceTd'>"+AJS.Rte.ZERO_WIDTH_WHITESPACE+"</td>";c.execCommand("mceInsertContent",!1,b+("</tr><tr>"+e+"</tr></table>"),{skip_undo:!0});c.selection.select(AJS.$(c.selection.getRng(!0).commonAncestorContainer).parents("table").find(d?"th":"td")[0].childNodes[0]);AJS.$(c.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()},
!0));h.registerHandler(13,f(/(^\u200b?\|\s?(?:[^|]*\s?\|\s?)+$)/,function(a){var b="<table class='confluenceTable'><tr>",e=!0,a=AJS.$(a[1].slice(1,-1).split("|")).map(function(a){a=AJS.$.trim(this);e=e&&""==a;return a});e&&(a[0]="first cell");for(var d=0,f=a.length;d<f;d++)b+="<td class='confluenceTd'>"+a[d]+"</td>";c.execCommand("mceInsertContent",!1,b+"</tr></table>",{skip_undo:!0});e&&c.selection.select(AJS.$(c.selection.getRng(!0).commonAncestorContainer).parents("table").find("td")[0].childNodes[0]);
AJS.$(c.selection.getRng().startContainer).parent().closest('[contenteditable="true"]').focus()},!0));d=f(/\b(((https?|ftp):\/\/|(www\.))[\w\.\$\-_\+!\*'\(\),/\?:@=&%#~;\[\]]+)$/,function(a){var b=c.dom.create("a",{href:a[3]?a[1]:"http://"+a[1]});b.appendChild(document.createTextNode(a[1]));c.execCommand("mceInsertContent",!1,k(b),{skip_undo:!0});c.getDoc().execCommand("unlink",!1,{})},!1,"a");h.registerHandler(32,d);h.registerHandler(13,d);d=f(/\b((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)$/i,
function(a){var b=c.dom.create("a",{href:"mailto:"+a[1]});b.appendChild(document.createTextNode(a[1]));c.execCommand("mceInsertContent",!1,k(b),{skip_undo:!0});c.getDoc().execCommand("unlink",!1,{})},!1,"a");h.registerHandler(32,d);h.registerHandler(13,d);d=function(a,b){var e=f(a,function(){c.execCommand("mceInsertContent",!1,b,{skip_undo:!0})},!1);h.registerHandler(32,e);h.registerHandler(13,e)};d(/(?:\b|^)([Jj]ira)$/,"JIRA");d(/(?:\b|^)(bitbucket|[Bb]itBucket)$/,"Bitbucket");d(/(?:\b|^)(atlassian)$/,
"Atlassian");d(/(?:\b|^)([Hh]ipchat)$/,"HipChat");AJS.$.each({"]":AJS.Rte.autoformat._REGEXES.WIKI_LINK,"}":AJS.Rte.autoformat._REGEXES.WIKI_MACRO,"!":AJS.Rte.autoformat._REGEXES.WIKI_EMBED},function(a,b){h.registerHandler(a.charCodeAt(0),f(b,function(b){var d=b[1]+a,b={type:"POST",contentType:"application/json; charset=utf-8",url:AJS.Meta.get("context-path")+"/rest/tinymce/1/wikixhtmlconverter",data:AJS.$.toJSON({wiki:d,entityId:AJS.Meta.get("content-id"),spaceKey:AJS.Meta.get("space-key"),suppressFirstParagraph:!0}),
dataType:"text",timeout:5E3};"}"==a?tinymce.confluence.MacroUtils.insertMacro(b):"!"==a?AJS.$.ajax(b).done(function(a){!d===a?tinymce.confluence.ImageUtils.insertImagePlaceholder(a):c.execCommand("mceInsertContent",!1,a,{skip_undo:!0})}):AJS.$.ajax(b).done(function(a){c.execCommand("mceInsertContent",!1,a,{skip_undo:!0})})},!0))});c.onKeyPress.addToTop(function(a,b){return h.executeHandlers(AJS.$.browser.msie?b.keyCode:b.which,a,b,q)})}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencedrafts/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.ConfluenceDrafts",{init:function(d){function e(c,a){a===Confluence.Editor.MODE_PREVIEW&&Confluence.Editor.Drafts.save()}var f;d.onInit.add(function(){AJS.bind("rte-changeMode",e)});d.onRemove.add(function(){AJS.unbind("rte-changeMode",e)});AJS.bind("rte-ready",function(){AJS.debug("confluence drafts plugin initialisation");$("#draft-status").show();$("#draft-messages").show();Confluence.Editor.Drafts.bindUnloadMessage();Confluence.Editor.UI.cancelButton.text("Close");
Confluence.Editor.UI.cancelButton.click(function(){Confluence.Editor.Drafts.save({skipErrorHandler:!0})});$("#draft-messages").is(":visible")&&AJS.Confluence.Analytics.publish("rte.notification.draft");$("#draft-messages").find("a.use-draft").click(function(a){a.stopPropagation();a.preventDefault();Confluence.Editor.Drafts.useDraft();AJS.Confluence.Analytics.publish("rte.notification.draft.resume")});$("#draft-messages").find("a.discard-draft").click(function(a){a.stopPropagation();a.preventDefault();
Confluence.Editor.Drafts.discardDraft(AJS.Meta.get("existing-draft-id"));AJS.Confluence.Analytics.publish("rte.notification.draft.discard")});if(AJS.Meta.getBoolean("shared-drafts")){var c=function(a,b){0!==a&&(window.history&&window.history.replaceState)&&window.history.replaceState(null,"",AJS.Meta.get("base-url")+"/pages/resumedraft.action?draftId="+a+"&draftShareId="+b)};c(AJS.Meta.getNumber("draft-id"),AJS.Meta.get("draft-share-id"));Confluence.Editor.UI.saveButton.text("Publish");
AJS.bind("rte-draft-saved",function(a,b){c(b.draftId,b.draftShareId)})}f=setInterval(Confluence.Editor.Drafts.save,+AJS.params.draftSaveInterval||3E4)});AJS.bind("rte-destroyed",function(){AJS.debug("confluence drafts plugin tear down");clearInterval(f)})},getInfo:function(){return{longname:"Confluence Drafts",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluencedrafts",tinymce.plugins.ConfluenceDrafts)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/referrer/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.Referrer",{init:function(c){c.onInit.add(function(){var a=$("#createpageform"),b=a.find("#originalReferrer");a.length&&(!b.val()&&document.referrer)&&b.val(document.referrer)})},getInfo:function(){return{longname:"Confluence Cancel Return Url",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("referrer",tinymce.plugins.Referrer)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/watch/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.ConfluenceWatch",{init:function(a){a.onInit.add(function(){if(AJS.Meta.get("use-watch")){var a={userWatchingOwnContent:AJS.Meta.get("user-watching-own-content")};$("#rte-savebar-tinymce-plugin-point").append(Confluence.Templates.Editor.SaveBar.Watch.render(a))}})},getInfo:function(){return{longname:"Confluence Watch",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluencewatch",
tinymce.plugins.ConfluenceWatch)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/watch/watch.soy' */
// This file was automatically generated from watch.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.SaveBar == 'undefined') { Confluence.Templates.Editor.SaveBar = {}; }
if (typeof Confluence.Templates.Editor.SaveBar.Watch == 'undefined') { Confluence.Templates.Editor.SaveBar.Watch = {}; }


Confluence.Templates.Editor.SaveBar.Watch.render = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul class="toolbar-group toolbar-group-watch-page" id="toolbar-group-watch-page-after-comment"><li class="toolbar-item"><input id="watchPage" name="watchPageAfterComment" value="true" type="checkbox" ', (opt_data.userWatchingOwnContent) ? 'checked="checked"' : '', '/><label for="watchPage">', soy.$$escapeHtml("Watch this page"), '</label></li></ul>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/notifywatchers/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.ConfluenceNotifyWatchers",{init:function(a){a.onInit.add(function(){var a={defaultVersionComment:AJS.params.versionComment};$("#rte-savebar-tinymce-plugin-point").append(Confluence.Templates.Editor.SaveBar.NotifyWatchers.render(a))});require(["confluence/persistable"])},getInfo:function(){return{longname:"Confluence Notify Watchers",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluencenotifywatchers",
tinymce.plugins.ConfluenceNotifyWatchers)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/notifywatchers/notifywatchers.soy' */
// This file was automatically generated from notifywatchers.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.SaveBar == 'undefined') { Confluence.Templates.Editor.SaveBar = {}; }
if (typeof Confluence.Templates.Editor.SaveBar.NotifyWatchers == 'undefined') { Confluence.Templates.Editor.SaveBar.NotifyWatchers = {}; }


Confluence.Templates.Editor.SaveBar.NotifyWatchers.render = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="minor-edit toolbar-item"><input id="notifyWatchers" name="notifyWatchers" value="true" type="checkbox" data-persist="checked" data-default-value="true" checked><label for="notifyWatchers"><span>', soy.$$escapeHtml("Notify watchers"), '</span></label></span>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/versioncomment/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.ConfluenceVersionComment",{init:function(a){a.onInit.add(function(){var a={versionComment:AJS.params.versionComment};$("#rte-savebar-tinymce-plugin-point").append(Confluence.Templates.Editor.SaveBar.VersionComment.render(a))})},getInfo:function(){return{longname:"Confluence Version Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluenceversioncomment",
tinymce.plugins.ConfluenceVersionComment)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/versioncomment/versioncomment.soy' */
// This file was automatically generated from versioncomment.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.SaveBar == 'undefined') { Confluence.Templates.Editor.SaveBar = {}; }
if (typeof Confluence.Templates.Editor.SaveBar.VersionComment == 'undefined') { Confluence.Templates.Editor.SaveBar.VersionComment = {}; }


Confluence.Templates.Editor.SaveBar.VersionComment.render = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="rte-toolbar-comment toolbar-item"><input id="versionComment" name="versionComment" ', (opt_data.versionComment) ? 'value="' + soy.$$escapeHtml(opt_data.versionComment) + '"' : '', 'placeholder="', soy.$$escapeHtml("What did you change?"), '" class="text" type="text" size="35"><label for="versionComment" class="assistive">', soy.$$escapeHtml("What did you change?"), '</label></span>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/imagedialog/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.ConfluenceImageDialog",{init:function(a){a.onInit.add(function(){a.addCommand("mceConfimage",Confluence.Editor.defaultInsertImageDialog)})},getInfo:function(){return{longname:"Confluence Image Dialog",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluenceimagedialog",tinymce.plugins.ConfluenceImageDialog)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/macrobrowser/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.ConfluenceMacroBrowser",{init:function(a){a.onInit.add(function(){a.addCommand("mceConfMacroBrowser",tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked)})},getInfo:function(){return{longname:"Confluence Macro Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluencemacrobrowser",tinymce.plugins.ConfluenceMacroBrowser)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/leavecomment/editor_plugin_src.js' */
(function(b){tinymce.create("tinymce.plugins.ConfluenceLeaveComment",{init:function(a){function c(){if(Confluence.Editor.UI.isFormEnabled()&&a.isDirty()&&!Confluence.Editor.isEmpty())return "Your comment will be lost."}a.onInit.add(function(){b(window).bind("beforeunload",c)});a.onRemove.add(function(){b(window).unbind("beforeunload",c)})},getInfo:function(){return{longname:"Confluence Leave Comment",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+
"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluenceleavecomment",tinymce.plugins.ConfluenceLeaveComment)})($);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/leavetemplate/editor_plugin_src.js' */
(function(b){tinymce.create("tinymce.plugins.ConfluenceLeaveTemplate",{init:function(a){function c(){if(Confluence.Editor.UI.isFormEnabled()&&a.isDirty()&&!Confluence.Editor.isEmpty())return "Your unsaved template changes will be lost."}a.onInit.add(function(){b(window).bind("beforeunload",c)});a.onRemove.add(function(){b(window).unbind("beforeunload",c)})},getInfo:function(){return{longname:"Confluence Leave Template",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+
"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluenceleavetemplate",tinymce.plugins.ConfluenceLeaveTemplate)})($);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/template-editor/editor_plugin_src.js' */
(function(b){tinymce.create("tinymce.plugins.ConfluenceTemplateEditor",{init:function(a){a.onInit.add(function(){b(a.getBody()).addClass("template-editor")})},getInfo:function(){return{longname:"Confluence Template Editor",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluencetemplateeditor",tinymce.plugins.ConfluenceTemplateEditor)})($);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/tinyMce-table-toolbar.js' */
$(document).bind("initContextToolbars.Toolbar",function(u,c){function i(f){var a=$(this),b=$("#table-highlight-group"),d=b.attr("data-highlight-colour"),e=b.attr("data-remove-highlight");d&&(b.removeClass("highlight-"+d),b.removeAttr("data-highlight-colour"));b.removeClass("remove-highlight");e&&b.removeAttr("data-remove-highlight");if(d=a.attr("data-highlight-colour"))b.addClass("highlight-"+d),b.attr("data-highlight-colour",d);a.attr("data-remove-highlight")&&(b.addClass("remove-highlight"),b.attr("data-remove-highlight",
!0));c.focus();c.execCommand("confTableSelectionToggleHighlight",!1,{alwaysHighlight:!0});f.preventDefault()}var g,a=function(f){var a=c.getLang(f);(f=c.getLang(f+"_shortcut",""))&&(a+=" ("+f+")");return a},h=AJS.storageManager("atlassian.editor","tables"),e;require("aui/inline-dialog2");e=aui.buttons.button({id:"table-more-settings-trigger",text:"",iconType:"aui",iconClass:"aui-icon-small aui-iconfont-configure",iconText:a("table.table_more_heading"),extraAttributes:{type:"button","data-aui-trigger":"true",
"aria-controls":"table-more-settings","data-tooltip":a("table.table_more_heading")}});var k=aui.inlineDialog2.inlineDialog2({alignment:"bottom left",respondsTo:"toggle",id:"table-more-settings",content:"<h2>"+a("table.table_more_heading")+"</h2>"}),l=aui.buttons.buttons({content:e});e=function(a){this.render=function(){var c=$(l),b=$(k),d=b.find(".aui-inline-dialog-contents"),e=b[0],g=function(){e.hide&&e.hide()};a.forEach(function(a){var f=$(aui.form.field({type:"checkbox",id:a.id,labelContent:a.text,
isChecked:a.isChecked,isDisabled:a.isDisabled}));f.on("change",a.onChange);b.on("aui-layer-show",a.onMenuOpen);b.on("aui-layer-hide",a.onMenuClose);d.append(f)});c.append(b);$(window).on("resize",$.debounce(g,100));$(document).on("enableContextToolbarRow.Toolbar disableContextToolbarRow.Toolbar",g);return c}};c.onNodeChange.add(function(a,e,b){a=$("body");a=!a.hasClass("no-tools")||a.hasClass("no-tools-toolbars-visible");!g&&(null!=b.parentNode&&"BODY"!=b.nodeName)&&(g=!0,$(b).closest("table:not(.wysiwyg-macro)").length?
($(document).trigger("createContextToolbarRow.Toolbar",{buttons:Confluence.Editor.tableToolbar.Buttons,topToolbar:!0,animate:a}).trigger("enableContextToolbarRow.Toolbar"),b=$(b).closest("td,th"),a=$(".mceSelected",b.closest("table")),1<=b.add(a).filter(function(){var a=$(this);return 1<parseInt(a.attr("rowspan"),10)||1<parseInt(a.attr("colspan"),10)}).length?c.plugins.customtoolbar.enableToolbarButton("table-split-cells"):c.plugins.customtoolbar.disableToolbarButton("table-split-cells")):$(document).trigger("disableContextToolbarRow.Toolbar",
{animate:a}),g=!1)});c.onUndo.add(function(a){a.nodeChanged()});c.onInit.add(function(){$(document).delegate("#table-highlight-colour .aui-dropdown a","click",i)});c.onRemove.add(function(){$(document).undelegate("#table-highlight-colour .aui-dropdown a","click",i)});var m=Confluence.Editor,n=new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:a("table.row_before_desc"),iconClass:"table-insert-row-before",click:function(){tinyMCE.execCommand("mceTableInsertRowBefore",
!1,"")}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.row_after_desc"),iconClass:"table-insert-row-after",click:function(){tinyMCE.execCommand("mceTableInsertRowAfter",!1,"")}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.delete_row_desc"),iconClass:"table-delete-row",click:function(){tinyMCE.execCommand("mceTableDeleteRow",!1,"")}})]),h=new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:a("table.cut_row_desc"),
iconClass:"table-cut",click:function(){tinyMCE.execCommand("mceTableCutRow",!1,"");c.plugins.customtoolbar.enableToolbarButton("table-paste")}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.copy_row_desc"),iconClass:"table-copy",click:function(){tinyMCE.execCommand("mceTableCopyRow",!1,"");c.plugins.customtoolbar.enableToolbarButton("table-paste")}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.paste_row_before_desc"),iconClass:"table-paste",click:function(){tinyMCE.execCommand("mceTablePasteRowBefore",
!1,"")},disabled:!h.doesContain("copied")})]),o=new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:a("table.col_before_desc"),iconClass:"table-insert-column-before",click:function(){tinyMCE.execCommand("mceTableInsertColBefore",!1,"")}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.col_after_desc"),iconClass:"table-insert-column-after",click:function(){tinyMCE.execCommand("mceTableInsertColAfter",!1,"")}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.delete_col_desc"),
iconClass:"table-delete-column",click:function(){tinyMCE.execCommand("mceTableDeleteCol",!1,"")}})]),p=new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:a("table.merge_cells_desc"),iconClass:"table-merge-cells",click:function(){tinyMCE.execCommand("mceTableMergeCells",!1,"")}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.split_cells_desc"),iconClass:"table-split-cells",click:function(){tinyMCE.execCommand("mceTableSplitCells",
!1,"")}})]),q=new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:a("table.row_highlight"),iconClass:"table-heading-row",click:function(){tinyMCE.execCommand("confTableRowToggleHeading",!1);tinyMCE.execCommand("mceTableUpdateNumberingCol",!1)}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.col_highlight"),iconClass:"table-heading-column",click:function(){tinyMCE.execCommand("confTableColumnToggleHeading",!1)}})]),r=Confluence.Editor.Toolbar.Components.SplitGroup,
s=[new Confluence.Editor.Toolbar.Components.Button({text:a("table.selection_highlight"),iconClass:"table-highlight-selection",click:function(){tinyMCE.execCommand("confTableSelectionToggleHighlight",!1)}})],j=$("<ul/>").addClass("table-highlight-picker"),t=[!1,!1,!1,!1,!1,!0];$.each("grey red green blue yellow ".split(" "),function(a,c){var b=$("<li/>"),d=$("<a href='#'></a>");t[a]?d.addClass("remove-highlight").attr("data-remove-highlight",true):d.addClass("highlight-"+c).attr("data-highlight-colour",
c);b.append(d);j.append(b)});m.tableToolbar={Buttons:[n,h,o,p,q,new r(s,{id:"table-highlight-group",dropDownOptions:{id:"table-highlight-colour",dropDownContent:j,alignment:"right"},postProcess:function(a){a.attr("data-highlight-colour","grey");a.addClass("highlight-grey");var c=$("<span>&nbsp;</span>");c.addClass("highlight-indicator");a.find(".icon.table-highlight-selection").after(c)}}),new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:a("table.del"),
iconClass:"table-delete-table",click:function(){tinyMCE.execCommand("mceTableDelete",!1,"")}})])],Events:[]};AJS.DarkFeatures.isEnabled("confluence-table-enhancements.copy-cut-paste-cols.disabled")||Confluence.Editor.tableToolbar.Buttons.splice(3,0,new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:a("table.col_cut_desc"),iconClass:"table-cut-col",click:function(){tinyMCE.execCommand("mceTableCutCol",!1,"")}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.col_copy_desc"),
iconClass:"table-copy-col",click:function(){tinyMCE.execCommand("mceTableCopyCol",!1,"")}}),new Confluence.Editor.Toolbar.Components.Button({text:a("table.col_paste_desc"),iconClass:"table-paste-col",click:function(){tinyMCE.execCommand("mceTablePasteColBefore",!1,"")}})]));AJS.DarkFeatures.isEnabled("confluence-table-enhancements.auto-row.disabled")||Confluence.Editor.tableToolbar.Buttons.push(new e([{text:a("table.numbering_column_desc"),id:"insert-numbering-column",onChange:function(){tinyMCE.execCommand("mceTableInsertNumberingCol",
!1,"")},onMenuOpen:function(){var a=0<$(c.selection.getNode()).closest("table").find(".numberingColumn").length;$("#insert-numbering-column").prop("checked",a)}}]))});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/editor_plugin_src.js' */
(function(b){function q(a){var c=function(){a&&a.hide()};b(document).bind("showLayer",function(b,d,f){"dropdown"==d&&f==a&&(b=AJS.Rte.getEditor(),b.onClick.add(c),b.onKeyUp.add(c))}).bind("hideLayer",function(b,d,f){"dropdown"==d&&f==a&&(b=AJS.Rte.getEditor(),b.onClick.remove(c),b.onKeyUp.remove(c))})}function r(b){b.addCallback("show",function(){b.$.parents(".disabled").length&&b.hide()})}function s(a,c){var e=j(c);b("#"+e).removeClass("disabled")}function t(a,c){var e=j(c);b("#"+e).addClass("disabled")}
function k(b,c){c?b.closest(".aui-button").prop("disabled",!0).attr("aria-disabled","true").toggleClass("disabled",c):b.closest(".aui-button").prop("disabled",!1).removeAttr("aria-disabled").toggleClass("disabled",c)}function n(a,c,e,d){var f=b("#toolbar"),h=f.find(".toolbar-item"),o=b("#insert-menu, #more-menu"),g=b("#insert-menu, #color-picker-control"),i=b("#format-dropdown"),d=d||function(){return!0};h.toggleClass("disabled",a);o.toggleClass("disabled",a);g.toggleClass("disabled",a);i.toggleClass("disabled",
!!c);AJS.Rte.TablePicker[a?"disable":"enable"]();"undefined"!==typeof e&&f.find("button, input").filter(d).toggleClass("disabled",e).prop("disabled",e)}function j(b){var c="default";b&&b.id&&(c=b.id);return"rte-toolbar-row-"+c}function u(a,c){var e=c.animate;void 0==e&&(e=!0);var d=function(){b(this).remove();b(document).trigger("resize.resizeplugin");if(c.onHide)c.onHide()};clearTimeout(l);l=setTimeout(function(){var a=j(c),a=b("#"+a);e?a.slideUp(400,d):(a.hide(),d.call(a))},100)}function v(a,c){var e=
j(c),d=c.animate;void 0==d&&(d=!0);if(0<b("#"+e).length)b("#"+e+":hidden").slideDown(400,function(){AJS.debug("Prevented toolbar deferred display race condition")});else{var f=b("<div></div>").addClass("toolbar-split toolbar-split-row toolbar-contextual");f.attr("id",e);c.editorAdjacent&&f.addClass("editor-adjacent");for(var e=!c.topToolbar?b("#savebar-container .aui-toolbar"):b("#rte-toolbar.aui-toolbar"),h=0,o=c.buttons.length;h<o;h++)f.append(c.buttons[h].render());f.css({display:"none"});c.editorAdjacent?
e.append(f):(h=b(".editor-adjacent",e).filter(":first"),h.length?h.before(f):e.append(f));f.find(".toolbar-dropdown").each(function(){i(this)});var g=function(){b(document).trigger("resize.resizeplugin").trigger("shown.contextToolbar");if(c.onVisible)c.onVisible()};clearTimeout(l);l=setTimeout(function(){if(d)f.slideDown(400,g);else{f.show();g()}},100)}}function i(a){var a=b(a),c=a.dropDown("Standard",{alignment:a.data("dropdown-alignment")||"left"})[0];a.find(".dropdown-item").click(function(a){var d=
b(this),f=d.attr("data-macro-name"),h=d.attr("data-command"),i=d.attr("data-format"),d=d.attr("data-control-id"),g=AJS.Rte.getEditor();f&&tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({presetMacroName:f});h&&g.execCommand(h,!1);i&&g.theme.controlHandlers.formatselect.click.dispatch(i);d&&g.theme.controlHandlers.buttons.click.dispatch(d);c.hide();a.preventDefault()});r(c);q(c)}var l;tinymce.create("tinymce.plugins.customtoolbar",{init:function(a){i("#format-dropdown");i("#more-menu .aui-dd-parent");
i("#insert-menu .aui-dd-parent");b("#pagelayout-menu").length&&i("#pagelayout-menu .aui-dd-parent");b("#template-menu").length&&i("#template-menu .aui-dd-parent");var c=b("#color-picker-control");if(c.length){var e=c.find(".aui-dd-parent"),d=b("#rte-button-color"),f=d.find(".selected-color"),e=e.dropDown("Standard",{alignment:"left"})[0],h=d.attr("data-color");f.css("background-color","#"+h);c.delegate("a[data-color]","click",function(a){var c=b(this),e=c.attr("data-color");a.preventDefault();c.closest(".disabled").length||
(tinyMCE.execCommand("ForeColor",!1,"#"+e),d.attr("data-color",e),f.css("background-color","#"+e))});r(e);q(e)}AJS.Rte.TablePicker.bindToControl(AJS.Rte.getEditor(),b("#insert-table-dropdown"));var j=b("#rte-button-source-mode");j.click(function(){j.hasClass("active")?Confluence.Editor.changeMode(Confluence.Editor.MODE_RICHTEXT):Confluence.Editor.changeMode(Confluence.Editor.MODE_SOURCE)});var c=[],g;for(g in TinyMCELang.hints)c.push("hints."+g);var l=Confluence.hintManager(c),k=function(){b("#rte-savebar .hints-text").html(AJS.Rte.getEditor().getLang(l.getNextHint()))};
k();b("#rte-savebar a.hints-close").click(function(a){b(this).closest(".toolbar-split").addClass("hidden");a.preventDefault()});b("#rte-savebar a.hints-next").click(function(b){k();b.preventDefault()});g=AJS.Rte.EventDelegator(a);b(document).trigger("initContextToolbars.Toolbar",a);b(document).bind("createContextToolbarRow.Toolbar",v).bind("removeContextToolbarRow.Toolbar",u).bind("enableContextToolbarRow.Toolbar",s).bind("disableContextToolbarRow.Toolbar",t);g.addEventsForComponent("TableToolbar",
Confluence.Editor.tableToolbar.Events);var m=b("#format-dropdown"),p=m.find("span.dropdown-text");a.onBeforeExecCommand.add(function(a,c,e,d,f){b.each(["pre","blockquote"],function(){"FormatBlock"==c&&d==this&&(a.formatter.remove("alignleft"),a.formatter.remove("aligncenter"),a.formatter.remove("alignright"))});if(b(a.selection.getNode()).closest("pre,.text-placeholder").length)for(var e="Bold Italic Underline Strikethrough InsertUnorderedList InsertOrderedList InsertInlineTaskList InsertInlineTaskListNoToggle superscript subscript mceConfMacroBrowser mceConfimage mceConfAttachments mceEmotion InsertWikiMarkup mceConflink mceInsertTable mceConfAutocompleteLink".split(" "),
h=e.length,g=0;g<h;g++)c==e[g]&&(f.terminate=!0);"FormatBlock"==c&&"pre"==d&&(a.undoManager.add(),a.execCommand("removeFormat"));"FormatBlock"==c&&"p"==d?(e=m.find(".dropdown-item[data-format='blockquote']").text(),p.text()==e&&(f.terminate=!0,a.execCommand("FormatBlock",!1,"blockquote"))):"FormatBlock"==c&&("removeformat"==d&&a.selection.isCollapsed())&&(f.terminate=!0,AJS.debug("Not removing format for no selected text"))});a.onExecCommand.add(function(b,a,c,e){"FormatBlock"==a&&(b=m.find(".dropdown-item[data-format='"+
e+"']"),b.length||(b=m.find(".dropdown-item[data-format='p']")),p.text(b.text()))});a.onNodeChange.add(function(a,c,e){var d,f=e,f=b(f).closest("PRE,BLOCKQUOTE,.text-placeholder");d=function(b){return f.is(b)};var a=d("BLOCKQUOTE"),g=d("PRE");d=d(".text-placeholder");g?(c=b(e).parents("table").is("[data-macro-body-type='PLAIN_TEXT']"),n(!0,c)):d?n(!0):a?(c.setDisabled("justifyleft",a),c.setDisabled("justifycenter",a),c.setDisabled("justifyright",a)):n(!1)});a.onInit.add(function(a){AJS.debug("customtoolbar: ed.onInit function");
var c={};b(".aui-toolbar").find("[data-control-id]").each(function(e,d){var f,d=b(d);d.closest(".toolbar-item");f=d.attr("data-control-id");"formatselect"==f?(f=a.theme.controlHandlers[f],f.state.add(function(a){var c=AJS.Rte.getEditor();"p"==a&&(c=c.selection.getNode(),b(c).closest("p").parent().is("blockquote")&&(a="blockquote"));(a=m.find(".dropdown-item[data-format='"+a+"']").text())&&p.text(a)})):c[f]=d});control=a.theme.controlHandlers.buttons;control.state.add(function(a,b,d){if(a=c[a]){var e=
a.find(".icon-check");toolbarItem=a.closest(".toolbar-item");e.length?e.toggleClass("hidden",!d):toolbarItem.toggleClass(b,d)}});b(".aui-toolbar").delegate(".toolbar-item","click",function(a){var c=b(this);if(c.hasClass("disabled"))a.preventDefault();else if(c=c.children(".toolbar-trigger[data-control-id]").attr("data-control-id"))control.click.dispatch(c),a.preventDefault()});AJS.$.support.shrinkWrapBlocks=!1;AJS.debug("customtoolbar: finished ed.onInit function")})},toggleToolbarButton:k,disableToolbarButton:function(a){k(b("."+
a.replace(".","")),!0)},enableToolbarButton:function(a){k(b("."+a.replace(".","")),!1)},focusToolbarButton:function(a){b("."+a.replace(".","")).closest(".aui-button").focus()},isToolbarRowEnabled:function(a){a=j({id:a});return 0<b("#"+a).length&&!b("#"+a).hasClass("disabled")},getToolbarRow:function(a){a=j({id:a});a=b("#"+a);return a.length?a[0]:null},isToolbarButtonEnabled:function(a){return!b("."+a.replace(".","")).closest(".aui-button").prop("disabled")},bindDropdownMenu:i,toggleToolbarButtons:n,
getInfo:function(){return{longname:"customtoolbar",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}});tinymce.PluginManager.add("customtoolbar",tinymce.plugins.customtoolbar)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/custom-toolbar-components.js' */
Confluence.Editor.Toolbar={Components:{}};
Confluence.Editor.Toolbar.Components.Button=function(a){var b=a.text,e=a.tooltip,c=a.triggerText,h=a.iconClass,f=a.click,i=!!a.disabled,g=a.id;this.render=function(){var a=AJS.$('<button type="button"></button>').addClass("aui-button").attr("data-tooltip",e||b);g&&a.attr("id",g);i&&a.prop("disabled",!0).attr("aria-disabled","true");a.click(function(){a.prop("disabled")||f()});if(h){var d=AJS.$("<span />");d.addClass("icon "+h);d.text(b);a.append(d)}c&&(d=AJS.$("<span />"),d.addClass("trigger-text"),
d.text(c),a.append(d));return a[0]}};
Confluence.Editor.Toolbar.Components.DropDownButton=function(a){var b=a.id,e=a.text,c=a.iconClass,h=!!a.disabled,f=a.dropDownContent,i;this.render=function(){var a=AJS.$("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").attr("data-tooltip",e);a.attr("id",b);var j=AJS.$("<div/>").addClass("aui-dd-parent"),d=AJS.$("<a href='#'></a>");d.addClass("toolbar-trigger").addClass("aui-dd-trigger");h&&(a.addClass("disabled"),d.addClass("disabled"));if(c){var k=AJS.$("<span />");k.addClass("icon "+
c);k.text(e);d.append(k)}k=AJS.$("<span/>");k.addClass("icon").addClass("icon-dropdown");d.append(k);i=AJS.$("<div/>").addClass("hidden").addClass("aui-dropdown").addClass("aui-dropdown-right");f&&i.append(f);j.append(d);j.append(i);a.append(j);return a[0]}};
Confluence.Editor.Toolbar.Components.TextButton=function(a){var b=a.text,e=a.textClass,c=a.click,h=!!a.disabled,f=a.tooltip;this.render=function(){var a=AJS.$('<button type="button"></button>').addClass("aui-button").addClass(e).text(b);f&&a.attr("data-tooltip",f);h&&a.prop("disabled",!0).attr("aria-disabled","true");a.click(function(){a.prop("disabled")||c()});return a[0]}};
Confluence.Editor.Toolbar.Components.TextBox=function(a){var b=a.id,e=a.text,c=a.name,h=a.keydown,f=a.cssClass;this.render=function(){var a=AJS.$("<div></div>").addClass("toolbar-item");a.append(AJS.$("<label for='"+b+"'>"+e+"</label>"));var g=AJS.$("<input id='"+b+"' type='text' name='"+c+"' class='"+f+" text' autocomplete='off'>");g.keydown(function(a){h(a)});a.append(g);return a[0]}};
Confluence.Editor.Toolbar.Components.Group=function(a,b){this.render=function(){var e=AJS.$("<div></div>");e.addClass("aui-buttons");b&&(b.id&&e.attr("id",b.id),b.groupClass&&e.addClass(b.groupClass));for(var c=0,h=a.length;c<h;c++)e.append(a[c].render());return e[0]}};
Confluence.Editor.Toolbar.Components.SplitGroup=function(a,b){function e(){var a=c.id,b=c.disabled,e=c.dropDownContent,g=c.title,j=c.alignment,d=AJS.$("<div></div>").addClass("toolbar-item").addClass("toolbar-dropdown").addClass("toolbar-splitbutton");a&&d.attr("id",a);g&&d.attr({"data-tooltip":g});j&&d.data("dropdown-alignment",j);a=AJS.$("<div/>").addClass("aui-dd-parent");g=AJS.$("<a href='#'></a>");g.addClass("toolbar-trigger aui-dd-trigger");b&&(d.addClass("disabled"),g.addClass("disabled"));
b=AJS.$("<span/>");b.addClass("icon").addClass("icon-dropdown");g.append(b);b=AJS.$("<div/>").addClass("hidden").addClass("aui-dropdown");e&&b.append(e);a.append(g);a.append(b);d.append(a);return d[0]}var c=b&&b.dropDownOptions||{};this.render=function(){var c=AJS.$("<div></div>");c.addClass("aui-buttons");b&&(b.id&&c.attr("id",b.id),b.groupClass&&c.addClass(b.groupClass));for(var f=0,i=a.length;f<i;f++)c.append(a[f].render());c.append(e(b));b&&b.postProcess&&b.postProcess(c);return c[0]}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/thirdpartycode/tipsy.js' */
(function(a){a.fn.tipsy.autoBounds2=function(f,b){return function(){var d,c,g=a(document).scrollTop()+f,h=a(document).scrollLeft()+f,e=a(this);1<b.length?(d=b[0],c=b[1]):"e"==b[0]||"w"==b[0]?c=b[0]:d=b[0];e.offset().top<g&&(d="n");e.offset().left<h&&(c="w");a(window).width()+a(document).scrollLeft()-(e.offset().left+e.width())<f&&(c="e");a(window).height()+a(document).scrollTop()-(e.offset().top+e.height())<f&&(d="s");return d?d+(c?c:""):c}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/customtoolbar/chunky-tips.js' */
(function(a){AJS.bind("init.rte",function(){function h(d,c,b){if("dropdown"===c&&(a(".tipsy").remove(),b&&(b.trigger&&b.trigger.jquery)&&(d=b.trigger.data("tipsy"))))d.hoverState="out"}function i(){a(".tipsy").remove()}AJS.debug("Enabling Chunky Tooltip for the editor");var e={live:!0,gravity:"n",title:function(){return a(this).attr("data-tooltip")||""},delayIn:250,delayOut:0},f=a.fn.tipsy.autoBounds2(50,"n"),g=a.fn.tipsy.autoBounds2(50,"s"),j=a.fn.tipsy.autoBounds2(50,"w"),f=a.extend({},e,{gravity:f}),
g=a.extend({},e,{gravity:g}),e=a.extend({},e,{gravity:j});a("#rte-toolbar [data-tooltip]:not(.dropdown-item)").tooltip(f);a("#rte-toolbar .dropdown-item[data-tooltip]").tooltip(e);a("#rte-savebar [data-tooltip]").tooltip(g);a("#editor-precursor [data-tooltip]").tooltip(f);a("#property-panel [data-tooltip]").tooltip(f);AJS.$(document).bind("showLayer",h);AJS.$(document).bind("hideLayer",h);AJS.bind("created.property-panel",i);AJS.bind("destroyed.property-panel",i);var k=/\+/g;AJS.bind("register-contexts.keyboardshortcuts",
function(){setTimeout(function(){AJS.$("#rte-savebar .aui-button[title]").each(function(){var d=a(this),c=d.attr("title");d.removeAttr("title");if(tinymce.isMac){var b=c.indexOf("(");0<=b&&(c=c.substr(0,b)+c.substr(b).replace(k,""))}d.attr("data-tooltip",c)})},0)})})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepaste/linkify.js' */
linkify={RE_EMAIL_PATTERN:"(?:\\s|\\A|^)[\\w.-]+\\+*[\\w.-]+@(?:(?:[\\w-]+\\.)+[A-Za-z]{2,6}|(?:\\d{1,3}\\.){3}\\d{1,3})",RE_URL_SCHEME:"(?:[\\w-]{2,}):/{1,3}",RE_TLD:"(?:aero|arpa|biz|com|coop|edu|gov|info|int|mil|museum|name|net|org|travel|ac|ad|ae|af|ag|ai|al|am|an|ao|aq|ar|as|at|au|aw|az|ba|bb|bd|be|bf|bg|bh|bi|bj|bm|bn|bo|br|bs|bt|bv|bw|by|bz|ca|cc|cd|cf|cg|ch|ci|ck|cl|cm|cn|co|cr|cu|cv|cx|cy|cz|de|dj|dk|dm|do|dz|ec|ee|eg|eh|er|es|et|fi|fj|fk|fm|fo|fr|ga|gd|ge|gf|gg|gh|gi|gl|gm|gn|gp|gq|gr|gs|gt|gu|gw|gy|hk|hm|hn|hr|ht|hu|id|ie|il|im|in|io|iq|ir|is|it|je|jm|jo|jp|ke|kg|kh|ki|km|kn|kp|kr|kw|ky|kz|la|lb|lc|li|lk|lr|ls|lt|lu|lv|ly|ma|mc|md|mg|mh|mk|ml|mm|mn|mo|mp|mq|mr|ms|mt|mu|mv|mw|mx|my|mz|na|nc|ne|nf|ng|ni|nl|no|np|nr|nu|nz|om|pa|pe|pf|pg|ph|pk|pl|pm|pn|pr|ps|pt|pw|qa|re|ro|ru|rw|sa|sb|sc|sd|se|sg|si|sj|sk|sl|sm|sn|so|sr|st|sv|sy|sz|tc|td|tf|tg|th|tj|tk|tm|tn|to|tp|tr|tt|tv|tw|tz|ua|ug|uk|um|us|uy|uz|va|vc|ve|vg|vi|vn|vu|wf|ws|ye|yt|yu|za|zm|zw)",
RE_URL_MIDCHAR:"(?:[^\\s()]+|\\((\\S+)\\))",RE_URL_ENDCHAR:"(?:\\((\\S+)\\)|[^\\s`!()\\[\\]{};:'\".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019])",init:function(){this.RE_URL_ENDING||(this.RE_URL_ENDING="(?:"+this.RE_URL_MIDCHAR+"*"+this.RE_URL_ENDCHAR+")?",this.RE_FULL_URL=this.RE_URL_SCHEME+"\\w+(?:.\\w+)"+this.RE_URL_ENDING,this.RE_OTHER_URL="\\w[\\w_-]*(?:\\.\\w[\\w_-]*)*\\."+this.RE_TLD+"(?:[\\/\\?#]"+this.RE_URL_ENDING+"|\\b)")},linkify:function(f,b,i){this.init();f=this.match_and_replace(this.RE_EMAIL_PATTERN,
f,!0,!1,b,i);f=this.match_and_replace(this.RE_FULL_URL,f,!1,!1,b,i);return f=this.match_and_replace(this.RE_OTHER_URL,f,!1,!0,b,i)},match_and_replace:function(f,b,i,o,k,h){for(var c=0,a=0,d=0,c=0,l=/<\/[aA]>/,f=RegExp(f,"g"),p=h.hasOwnProperty("add_wbrs")?h.add_wbrs:null,j=h.hasOwnProperty("truncate_length")?h.truncate_length:100,m=h.hasOwnProperty("link_target")?h.link_target:"_blank",h=h.hasOwnProperty("link_titles")?h.link_titles:null,d={},n=0;d=f.exec(b);){n++;if(20<n)break;c=d.index;d=d[0].length;
if(0<=b.substring(a,c).search(/<[aA]/)){l.lastIndex=a;c=b.substring(a,b.length).search(l);if(0>c)break;c+=a;f.lastIndex=c+4;a=c+4}else{var a=b.substr(c,d),g=a.search(/&(amp|gt|lt)$/);if(0<g&&b.length>c+d&&";"==b[c+d]){d-=a.length-g;for(a=b.substr(c,d);!a.match(this.RE_URL_ENDCHAR+"$")&&0<d;)d--,a=b.substr(c,d)}g=a;o&&(g="http://"+g);var e="<a";m&&(e+=' target="'+m+'"');e+=' href="';i&&(e+="mailto:");g=g.replace(/"/g,"%22");e+=g+'"';h&&(e+=' title="'+(i?"Email "+g:g)+'"');j&&a.length>j&&(a=a.substr(0,
j)+"...");p&&(a=a.replace(RegExp("([/=])","g"),"<wbr>$1"));e+=">"+a+"</a>";k&&k.push(g);b=b.slice(0,c)+e+b.slice(c+d,b.length);f.lastIndex=c+e.length;a=c+e.length}}return b}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepaste/post-paste-node-filter.js' */
(function(d,h){function r(a,b){for(var e=d(a).find("["+b+"]"),c="",g="",f="",i=0,v=e.length;i<v;i++)g=(c=d(e[i]))&&["/",c.attr(b)].join(""),f=c&&["/",c.attr("data-mce-"+b)].join(""),h.getContextPath()&&0===g.indexOf(h.getContextPath())&&(e[i]=c.attr(b,g)),h.getContextPath()&&0===f.indexOf(h.getContextPath())&&(e[i]=c.attr("data-mce-"+b,f));return e}function j(a,b,e){var a=d(a).find("["+b+"]"),c="",g,f;if(a)for(var i=0,h=a.length;i<h;i++){g=d(a[i]);f=e.standard;for(var j in e)e.hasOwnProperty(j)&&
g.is(j)&&(f=e[j]);if(-1<b.indexOf("style")){var c=g,l=f;f=[];for(var n="",n=void 0,o=c.attr("style"),m=c.attr("data-mce-style"),k=0,p=l.length;k<p;k++)o&&-1<o.toLowerCase().indexOf(l[k])?f.push(l[k]+": "+c.css(l[k])+";"):m&&-1<m.toLowerCase().indexOf(l[k])&&(n=RegExp(l[k]+":.+?(?:;|$)"),n=m.match(n),f.push(-1<n[0].indexOf(";")?n:n+";"));c=f.join(" ")}else{c=g;l=b;o=[];if(f){m=0;for(k=f.length;m<k;m++)c.is("["+l+"~="+f[m]+"]")&&o.push(f[m])}c=o.join(" ")}g.removeAttr(b);c.length&&g.attr(b,c)}}function w(a,
b){function e(e){var f;c.index&&(f=a.splitText(c.index),a&&b.push(a),a=f);(f=a.splitText(c[0].length))&&b.push(f);d(a).wrap("<a href='"+e+a.data+"'></a>")}var c,g,f;g=p.exec(a.data);f=q.exec(a.data);g?(c=g,e("mailto:")):f&&(g=(c=f)&&-1==c[0].indexOf("://")?"http://":"",e(g))}var q;linkify.init();var s=RegExp(linkify.RE_FULL_URL),t=RegExp(linkify.RE_OTHER_URL);q={exec:function(a){var b=s.exec(a);return b?b:t.exec(a)},test:function(a){return s.test(a)||t.test(a)}};var p,u=RegExp(linkify.RE_EMAIL_PATTERN);
p={exec:function(a){if((a=u.exec(a))&&/\s/.test(a[0][0]))a[0]=a[0].replace(/\s/,""),a.index++;return a},test:function(a){return u.test(a)}};h=h||{};h.Editor=h.Editor||{};h.Editor.regex={URL:q,EMAIL:p};d(document).bind("postPaste",function(a,b,e){a=e.node;b={standard:["text-decoration","text-align","margin-left"],".wysiwyg-macro":["background-image"],p:["margin-left","text-align"],span:["color","text-decoration"],pre:["margin-left"]};b.td=b.th=["text-align"];j(a,"style",b);j(a,"data-mce-style",b);
d.browser.mozilla&&(r(a,"src"),r(a,"href"));j(a,"face",{standard:[]});j(a,"id",{standard:[]});j(a,"data-mce-href",{standard:[]});var c=e.node;d.each(".contentLayout .contentLayout2 .columnLayout .header .footer .cell .innerCell .panelContent .panel .panelHeader .Apple-converted-space font .jira-status .jira-issue .diff-html-removed .diff-html-added .diff-html-changed".split(" "),function(a,b){d(b,c).contents().unwrap()});d("img",c).map(function(){!d(this).attr("src")&&d(this).remove()});d("dl",c).map(function(){d(this).replaceWith("<p>"+
d(this).text()+"</p>")});d("a",c).map(function(){d(this).removeClass("confluence-userlink userLogoLink")});if(!d.browser.msie)for(a=d.makeArray(e.node.childNodes);a.length;)b=a.pop(),d(b).is("a")||(3==b.nodeType?w(b,a):1==b.nodeType&&(b.childNodes&&"pre"!==b.nodeName.toLowerCase())&&(a=a.concat(d.makeArray(b.childNodes))));if(a=d.browser.mozilla)a=d(e.node),a=a.children("br").length&&!a.find(":not(br)").length;a&&(e=d(e.node),a="<p>"+e.html().replace(/<br>/gi,"</p><p>")+"</p>",e.html(a))})})(AJS.$,
Confluence);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepaste/clipboard-helper.js' */
(function(c){var d=[{repair:function(a){var b=/<meta charset='utf-8'>(<td.*<\/td>)<br class="Apple-interchange-newline">/.exec(a);return b?'<table class="confluenceTable"><tbody><tr>'+b[1]+"</tr></tbody></table>":a}},{repair:function(a){var b=/<meta charset='utf-8'>(<tr.*<\/tr>)<br class="Apple-interchange-newline">/.exec(a);return b?'<table class="confluenceTable"><tbody>'+b[1]+"</tbody></table>":a}}];AJS.ClipboardHelper={parse:function(a,b){return"<"===a.charAt(0)&&">"===a.charAt(a.length-1)&&3<=
a.length?c(a,b||document):c("<div>"+a+"</div>",b||document).contents()},repair:function(a){if(!a)return a;c.each(d,function(b,c){a=c.repair(a)});return a}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepastetable/editor_plugin_src.js' */
(function(f){tinymce.create("tinymce.plugins.ConfluencePasteTablePlugin",{init:function(i){function m(a){var c={id:!0,"class":!0,style:!0,rowspan:!0,colspan:!0,"data-mce-style":!0,"data-mce-bogus":!0,"data-macro-name":!0,"data-macro-parameters":!0,"data-macro-body-type":!0,"data-highlight-colour":!0,"data-highlight-class":!0},d=["highlight","nohighlight"],b,e=0,g=[],h=f(a);if(!a||j(a))return a;a&&a.getAttribute&&(b=a.getAttribute("class"));if(b&&0<=b.indexOf("table-wrap"))if(a=f("table",a),a.length)f(a).unwrap(),
a=a[0];else return null;if((!a.tagName?0:"TABLE"==a.tagName||"TR"==a.tagName||"TH"==a.tagName||"TD"==a.tagName||"TBODY"==a.tagName||"THEAD"==a.tagName||"TFOOT"==a.tagName||"COL"==a.tagName||"COLGROUP"==a.tagName||"CAPTION"==a.tagName)&&a.attributes){for(;e<=a.attributes.length;)(b=a.attributes[e])&&!0===b.specified&&!c[b.name]?a.removeAttribute(b.name):e++;k(a)&&g.push(k(a));c=0;for(e=d.length;c<e;c++)d[c].exec||h.hasClass(d[c])&&g.push(d[c]);(d=h.attr("data-highlight-class"))&&g.push(d);(d=h.attr("data-highlight-colour"))&&
g.push("highlight-"+d);h.attr("class",g.join(" "))}return a}function k(a){return!a.tagName?"":"TABLE"==a.tagName?"confluenceTable":"TH"==a.tagName?"confluenceTh":"TD"==a.tagName?"confluenceTd":""}function j(a){var c="";a&&a.getAttribute&&(c=a.getAttribute("class"));return!a.tagName?!1:"TABLE"!=a.tagName?!1:!c?!1:-1!==c.indexOf("wysiwyg-macro")}function l(a,c,d){for(var a=d.node,c=m,b=a,e="";b;)if("function"==typeof c&&(b=c(b)),b)b.firstChild&&e.parentNode!==b&&!j(b)?(e=b,b=b.firstChild):b.nextSibling?
(e=b,b=b.nextSibling):(e=b,b=b.parentNode);else break;d.node=a}i.onInit.add(function(){f(document).bind("postPaste",l)});i.onRemove.add(function(){f(document).unbind("postPaste",l)})},getInfo:function(){return{longname:"ConfluencePasteTablePlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("confluencepastetableplugin",tinymce.plugins.ConfluencePasteTablePlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluencepastemacro/editor_plugin_src.js' */
(function(f){tinymce.create("tinymce.plugins.ConfluencePasteMacroPlugin",{init:function(b){var c=this,a=function(a,d,g){d=b.getDoc();f(b.selection.getStart()).closest("[data-macro-body-type='PLAIN_TEXT']").length&&(c.bindPostSerializeHandler(b),a=c.parseHtml(b,g.node),d=d.createElement("div"),d.appendChild(a),g.node=d)};b.onInit.add(function(){f(document).bind("postPaste",a)});b.onRemove.add(function(){f(document).unbind("postPaste",a)})},bindPostSerializeHandler:function(b){function c(b,d){d.content=
d.content.replace(/^<pre>|<\/pre>$/g,"");a.remove(c)}var a=b.serializer.onPostProcess;a.add(c)},parseHtml:function(b,c){for(var a=f.makeArray(c.childNodes),e,d=b.getDoc(),g=d.createElement("pre");a.length;)e=a.shift(),e.childNodes.length?(tinymce.html.Schema.blockElementsMap[e.nodeName]&&a.unshift(d.createElement("br")),a=f.makeArray(e.childNodes).concat(a)):(e=this.formatMacroContent(e,d))&&g.appendChild(e);return g},formatMacroContent:function(b,c){var a,e=/\xA0/g,c=c||window.document;3==b.nodeType?
a=c.createTextNode(f(b).text().replace(e," ")):"BR"==b.nodeName&&(a=c.createElement("br"));return a},getInfo:function(){return{longname:"ConfluencePasteMacroPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("confluencepastemacroplugin",tinymce.plugins.ConfluencePasteMacroPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confcursortarget/editor_plugin_src.js' */
(function(e){var j=".wysiwyg-macro,.placeholder,table";AJS.Rte=AJS.Rte||{};AJS.Rte.CursorTarget={addFixSelector:function(e){j+=","+e}};tinymce.create("tinymce.plugins.CursorTargetPlugin",{init:function(d){function k(a){e(j,a).each(function(b,a){var u=function(a){if(0===a.length)throw Error("no paragraph element specified");a=a[0];0===a.childNodes.length&&(a.innerHTML=tinymce.isIE&&!tinymce.isIE9?"&nbsp;":"<br />");return a},d=function(a,b){var c=e("<p/>");if(e(a.parentNode).is("li, td, th"))for(;a[b]&&
!e(a[b]).is(q);)c["previousSibling"==b?"prepend":"append"](a[b]);return u(c)},h=e(a);(!h.prev().length||h.prev(j).length||e(a.parentNode).is("li, td, th")&&!e(a.previousSibling).is(q))&&h.before(d(a,"previousSibling"));(!h.next().length||h.next(j).length||e(a.parentNode).is("li, td, th")&&!e(a.nextSibling).is(q))&&h.after(d(a,"nextSibling"));var d=function(a){("BR"==a[0].nodeName||l(a[0]))&&a.replaceWith(u(e("<p/>")))},g=h.prev(),f;if(f=g.length)a:{for(f=g.prev();f.length&&!f.is(j);){var i=f[0];if("BR"!=
i.nodeName&&"P"!=i.nodeName){f=!1;break a}f=f.prev()}f=!0}f&&d(g);h=h.next();if(g=h.length)a:{for(g=h.next();g.length&&!g.is(j);){f=g[0];if("BR"!=f.nodeName&&"P"!=f.nodeName){g=!1;break a}g=g.next()}g=!0}g&&d(h)})}function v(a){e("p",a).each(function(a,c){l(c)&&m(c)&&e(c).attr("data-tag","marked-for-deletion")});e("p[data-tag=marked-for-deletion]",a).remove();return a}function l(a){function b(a){for(var b=0,e=0,d=0,g=a.childNodes.length;d<g;d++){var f=a.childNodes[d];if("BR"==f.nodeName){if(1<++b)return!1}else if(/^[\s|\u00A0]$/.test(f.nodeValue)){if(1<
++e)return!1}else if(""!==f.nodeValue)return!1}return!0}return 1==a.nodeType&&0===a.childNodes.length||b(a)}function m(a){if(!a||1!=a.nodeType)return!1;var b=n(a,!1),c=n(a,!0),a=p(b)||e(b).is(j),d=p(c)||e(c).is(j),b=p(b)&&p(c);return a&&d&&!b}function p(a){return a?a.className&&/cell|header|footer/.test(a.className):!0}function n(a,b){var c=e(a);do{var d=b?c[0].nextSibling:c[0].previousSibling;if(d)return d;c=c.parent()}while(0<c.length&&!c.is(".cell, .mceContentBody, td, li"));return null}function r(a){var b=
a.startContainer;return 3==b.nodeType?!(b.previousSibling&&(3==b.previousSibling.nodeType||e(b.previousSibling).is("br")))&&0===a.startOffset:1==b.nodeType?0===a.startOffset:!1}function w(a){var a=e(a).children(),b;for(b=0;b<a.length;b++)if(!l(a[b])&&(e(a[b]).contents().filter(function(){return 3==this.nodeType}).length||w(a[b])))return!0;return!1}function s(a,b){var c;if(c=b.startContainer==b.endContainer)if(c=1==b.startContainer.nodeType)c=b.startOffset,a||c--,c=0<=c&&c<b.startContainer.childNodes.length&&
"TABLE"==b.startContainer.childNodes[c].nodeName;return c}function x(a){if(!a.collapsed)return!1;var b=a.startContainer,c;if(3==b.nodeType)return c=n(b,!0),a.startOffset==b.nodeValue.length&&(null==c||e(c).is("br"));if(1===b.nodeType){if(e(b).is("td, th")&&0===a.startOffset&&0<b.childNodes.length)return e(b.childNodes[0]).is("br");c=n(b.parentNode.childNodes[0===a.startOffset?0:a.startOffset-1],!0);return null==c||e(c).is("br")}return!1}function y(a){return a&&1===a.childNodes.length&&e(a.childNodes[0]).is("br")}
function z(a,b){return tinymce.isWebKit&&s(!1,b)||tinymce.isGecko&&(x(b)||m(a)&&0===b.startOffset&&y(a))?!0:!1}function A(a,b){var c;if(c=tinymce.isWebKit)if(!(c=s(!0,b)))if(!(c=r(b)&&m(a)))c=d.getBody(),c=c.childNodes.length?b.collapsed&&0===b.startOffset&&c.childNodes[0]==b.startContainer:!1;return c||tinymce.isGecko&&r(b)&&m(a)&&y(a)?!0:!1}function t(a,b){var c=b.keyCode;if(c!==i.BACKSPACE&&c!==i.DELETE)return!0;a.selection.isCollapsed()?c===i.BACKSPACE&&A(a.selection.getNode(),a.selection.getRng(B))?
tinymce.dom.Event.prevent(b):c===i.DELETE&&z(a.selection.getNode(),a.selection.getRng(B))&&tinymce.dom.Event.prevent(b):k(a.getBody());return!0}var B=!0,q="ol, ul, p, pre, table, blockquote, div, h1, h2, h3, h4, h5, h6",i=e.ui.keyCode;d.onSetContent.add(function(a){k(a.getBody());var a=a.getBody(),b=tinyMCE.isIE?"&nbsp;":"<br/>";e("p, td.confluenceTd, th.confluenceTh",a).each(function(a,d){d&&(d.childNodes&&1===d.childNodes.length&&3==d.childNodes[0].nodeType&&d.childNodes[0].nodeValue&&1===d.childNodes[0].nodeValue.length&&
160==d.childNodes[0].nodeValue.charCodeAt(0))&&e(d).html(b)})});d.onGetContent.add(function(a,b){var c=v(e("<div class='root-node'>"+b.content+"</div>")),c=AJS.Rte.getEditor().serializer.serialize(c[0],b);b.content=c.substring(23,c.length-6)});var o=function(){k(d.getBody())};d.onInit.add(function(){d.selection.onSetContent.add(o);d.dom.bind(d.getBody(),"cut",o);AJS.bind("cursor-target-refresh",o)});d.onRemove.add(function(){AJS.unbind("cursor-target-refresh",o)});tinymce.isGecko&&d.onKeyDown.add(function(a,
b){(b.keyCode===i.ENTER||b.keyCode===i.BACKSPACE||b.keyCode===i.DELETE)&&a.selection.normalize()});d.onKeyDown.add(t);d.onKeyUp.add(t);tinymce.isGecko&&d.onKeyPress.add(t);d.onPaste.add(o);e.extend(this,{_isTextContainerEmpty:l,_processCursorTargets:v,_isCursorAtStartOfContainer:r,_isCursorAtEndOfContainer:function(a){var b=a.startContainer;if(3==b.nodeType)return!(b.nextSibling&&(3==b.nextSibling.nodeType||e(b.nextSibling).is("br")))&&a.endOffset==b.nodeValue.length;if(1==b.nodeType){var c=b.childNodes[a.startOffset];
return e(c).is("br")&&null==c.nextSibling?!0:a.endOffset==b.childNodes.length}return!1},_getSiblingWithinBlockDisregardingNesting:n,_doesContainerHaveNestedContent:w,isCursorBeforeAfterTable:s,isCursorTarget:m,_addCursorTargetParagraphsToContent:k,_isCursorAtEndOfBottomRightCellInTable:x,_shouldCancelDelete:z,_shouldCancelBackspace:A});AJS.Rte.Cursor=AJS.Rte.Cursor||{};e.extend(AJS.Rte.Cursor,{isTextContainerEmpty:l,fixCursorTargets:k})},getInfo:function(){return{longname:"Cursor Target plugin",author:"Atlassian",
authorurl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("cursorTarget",tinymce.plugins.CursorTargetPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confcleanup/editor_plugin_src.js' */
(function(f){tinymce.create("tinymce.plugins.ConfluenceCleanupPlugin",{init:function(d){if(tinymce.isWebKit){var h={},g=function(a,c){var b=a[c];b||(b={},a[c]=b);return b};f("#format-dropdown").find("ul.aui-dropdown li").each(function(){var a=f("a",this),c=a.css("font-size"),b=a.css("font-weight"),a=a.css("color"),a=g(h,a),b=g(a,b);b[c]||(b[c]=f(this).attr("data-format"))});d.onNodeChange.add(function(a){for(var c=a.dom.select("span.Apple-style-span",a.dom.doc.body),b=a.dom.select("font.Apple-style-span",
a.dom.doc.body),c=c.concat(b),b=0,j=c.length;b<j&&!a.dom.is(c[b],'[face="mceinline"]');b++){var e;a:{e=f(c[b]);var d=h[e.css("color")],g=void 0;if(d&&(g=d[e.css("font-weight")])){e=g[e.css("font-size")];break a}e=null}e&&(d=a.selection.getBookmark(),e&&a.dom.remove(c[b],1),a.selection.moveToBookmark(d),a.execCommand("FormatBlock",!1,e))}})}d.onNodeChange.add(function(a){for(var c=a.dom.select("img",a.dom.doc.body),b=c.length,d=0;d<b;d++)"file:///"===f(c[d]).attr("src").substr(0,8)&&a.dom.remove(c[d])});
if(tinymce.isIE9){var i=function(a){a.getBody().childNodes.length||a.setContent("<p>\ufeff</p>")};d.onNodeChange.add(i);d.onSetContent.add(i)}},getInfo:function(){return{longname:"ConfluenceCleanupPlugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("confluencecleanupplugin",tinymce.plugins.ConfluenceCleanupPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'com/atlassian/confluence/tinymceplugin/tinyMce-auiwindowmanager.js' */
(function(){var f=tinymce.util.Dispatcher,g=tinymce.isIE;tinymce.create("tinymce.plugins.AUIWindowManager",{init:function(a){a.onBeforeRenderUI.add(function(){a.windowManager=new tinymce.AUIWindowManager(a)})},getInfo:function(){return{longname:"AUIWindowManager",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.create("tinymce.AUIWindowManager:tinymce.WindowManager",{AUIWindowManager:function(a){this.editor=a;this.onOpen=new f(this);
this.onClose=new f(this);this.params={};this.features={};this.modalDialogsStack=[];this.dialogs={};this.count=0},open:function(a,b){tinymce.DOM.getViewPort();a=a||{};this.initialiseSettings(a);b=b||{};b=this.setDefaultParameters(b);b.mce_width=a.width;b.mce_height=a.height;b.mce_auto_focus=a.auto_focus;g&&(a.center=!0,a.help=!1,a.dialogWidth=a.width+"px",a.dialogHeight=a.height+"px");this.features=a;this.params=b;this.onOpen.dispatch(this,a,b);var c=a.height;a.name&&(c+=56);if(b.cancelLink||b.buttons)c+=
51;c+=40;a.popup&&(c+=8);var d=a.id||tinymce.DOM.uniqueId(),e=new AJS.ConfluenceDialog({width:a.width,height:c,id:d,onCancel:function(){e.hide().remove()}});a.name&&e.addHeader(this.editor.getLang(a.name));this.createDialogButtons(e,b,d);a.file=a.file||a.url;a.file&&(a.file=tinymce._addVer(a.file));this.createDialogContent(e,a,b,d);b.helpLink&&this.createHelpLink(e,b.helpLink,b.helpName,d);b.hintText&&this.createHintText(e,b.hintText,d);c={id:d,settings:a,params:b,dialog:e};this.modalDialogsStack.push(c);
this.dialogs[d]=c;this.count++;AJS.Rte.BookmarkManager.storeBookmark();e.show();void 0!=e.takeFocus&&e.takeFocus();g&&(AJS.$("#"+d).css("overflow","hidden"),AJS.$("#"+d+" ."+b.cssClass).css("overflow","hidden"));return d},initialiseSettings:function(a){a.width=parseInt(a.width||400,10);a.height=parseInt(a.height||250,10);a.resizable=!1;void 0==a.popup&&(a.popup=!0);a.popup&&void 0!=a.content&&(a.popup=!1);a.scrollbars=a.scrollbars?"yes":"no"},createDialogButtons:function(a,b,c){if(b.buttons)for(var d=
0,d=0;d<b.buttons.length;d++){var e=b.buttons[d];a.addButton(this.editor.getLang(e.label),e.action)}b.cancelLink&&a.addCancel(this.editor.getLang("auiwindowmanager.cancel"),function(){return tinyMCE.activeEditor.windowManager.close(c)})},createDialogContent:function(a,b,c,d){var e=this.createContentId(d),d="panel_"+e;b.popup?(a.addPanel(d,AJS.$("<iframe id='"+e+"' width='100%' height='"+b.height+"px' frameborder='0' name='auidialogiframe' src='"+b.file+"' scrolling='"+b.scrollbars+"'></iframe>"),
c.cssClass),a.takeFocus=function(){AJS.$("#"+e).focus()}):(void 0==b.content?(a.addPanel(d,AJS.$("<div id='"+e+"'/>"),c.cssClass),AJS.$("#"+e).load(b.file)):a.addPanel(d,AJS.$("<div id='"+e+"'>"+b.content+"</div>"),c.cssClass),a.takeFocus=function(){var a=AJS.$("#"+e+" :input");if(a.length)AJS.$(a[0]).focus();else{a=AJS.$("#"+e+" .button-panel button");a.length&&AJS.$(a[0]).focus()}});a.gotoPanel(0,0)},createHintText:function(a,b,c){a=AJS.$("<div></div>").addClass("dialog-tip");a.text(tinyMCE.activeEditor.getLang(b));
AJS.$("#"+c+" .dialog-button-panel").append(a)},createHelpLink:function(a,b,c,d){a=AJS.$("<div></div>").addClass("dialog-help-link");a.load(AJS.params.contextPath+"/plugins/tinymce/helplink.action",{linkUrlKey:b,linkNameKey:c||""});AJS.$("#"+d+" .dialog-components .dialog-title").prepend(a)},close:function(a,b){var c;if("string"==typeof a)c=a;else if(b)c=b;else{var d=this.modalDialogsStack.pop();d&&(c=d.id)}this.dialogs[c]?(this.count--,d=this.dialogs[c],d.dialog.remove(),this.dialogs[c]=null,tinyMCE.activeEditor.focus(),
AJS.Rte.BookmarkManager.restoreBookmark()):AJS.log("Couldn't find id "+c+" in dialogs array so dialog is not closed.");return!1},alert:function(a,b,c){var d;d=this.open({content:"<p>"+a+"</p>",width:500,height:160,popup:!1},{buttons:[{label:"auiwindowmanager.ok",action:function(){tinyMCE.activeEditor.windowManager.toggleOtherDialogs(d,!0);tinyMCE.activeEditor.windowManager.close(d);b&&b.call(c||this)}}],cancelLink:!1,cssClass:"tinymce-auidialog-alert"});this.toggleOtherDialogs(d,!1)},createInstance:function(a,
b,c,d,e,h){return new (tinymce.resolve(a))(b,c,d,e,h)},toggleOtherDialogs:function(a,b){for(var c=0,c=0;c<this.modalDialogsStack.length;c++){var d=this.modalDialogsStack[c];d.id!=a&&AJS.$("#"+d.id+" .dialog-button-panel").toggle(b)}},confirm:function(a,b,c,d){d=d||window;b.call(c||this,d.confirm(this._decode(this.editor.getLang(a,a))))},setBusy:function(a,b){if(this.dialogs[a])if(b){var c=this.createContentId(a),c=AJS.$("#"+c);c.hide();var c=c.parent(),d=this.createBusyContentId(a),e=AJS.$("#"+d,
c);e.length||(c.append(AJS.$("<div id='"+d+"' class='spinner'></div>")),e=AJS.$("#"+d,c),Raphael.spinner(e[0],50,"#666"));AJS.$(".button-panel button",AJS.$("#"+a)).each(function(a,b){AJS.$(b).prop("disabled",true)});AJS.$(e[0]).show()}else d=this.createBusyContentId(a),e=AJS.$("#"+d),e.length&&AJS.$(e[0]).hide(),c=this.createContentId(a),c=AJS.$("#"+c),AJS.$(".button-panel button",AJS.$("#"+a)).each(function(a,b){AJS.$(b).prop("disabled",!1)}),AJS.$(c[0]).show()},logMCESelection:function(a){var b=
tinyMCE.activeEditor.selection;AJS.log("******************************");AJS.log("Logging TinyMCE selection title:    "+a);AJS.log("Bookmark:");AJS.log(b.getBookmark());a=AJS.$(b.getRng().startContainer).text()||$(b.getRng().startContainer.parentNode).text();AJS.log("Range: "+a);AJS.log(b.getRng())},setDefaultParameters:function(a){a.inline=!1;a.cssClass||(a.cssClass="tinymce-auidialog");!1!=a.cancelLink&&(a.cancelLink=!0);return a},createContentId:function(a){return"content_"+a},createBusyContentId:function(a){return"content_busy_"+
a}});tinymce.PluginManager.add("auiwindowmanager",tinymce.plugins.AUIWindowManager)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'macrobrowser/tinymce-macrobrowser.js' */
tinymce.confluence.macrobrowser=function(c){return{storedRange:null,bookmark:null,getCurrentNode:function(){return c(tinyMCE.activeEditor.selection.getNode())},isMacroDiv:function(a){return c(a).hasClass("wysiwyg-macro")},isMacroTag:function(a){a=c(a);return a.hasClass("wysiwyg-macro")||a.hasClass("editor-inline-macro")},isBodylessMacro:function(a){return c(a).hasClass("editor-inline-macro")},isMacroWithBody:function(a){return c(a).hasClass("wysiwyg-macro")},isMacroStartTag:function(a){return c(a).hasClass("wysiwyg-macro-starttag")},
isMacroEndTag:function(a){return c(a).hasClass("wysiwyg-macro-endtag")},isMacroBody:function(a){return c(a).hasClass("wysiwyg-macro-body")},hasMacroBody:function(a){return"true"==c(a).attr("macrohasbody")},getNestingMacros:function(a){var b=[];c(a||this.getCurrentNode()).parents(".wysiwyg-macro").each(function(){b.push(c(this).attr("data-macro-name"))});return b},logMCESelection:function(a){var b=tinyMCE.activeEditor.selection;AJS.log("******************************");AJS.log("Logging TinyMCE selection title:    "+
a);AJS.log("Bookmark:");AJS.log(b.getBookmark());a=c(b.getRng().startContainer).text()||c(b.getRng().startContainer.parentNode).text();AJS.log("Range: "+a);AJS.log(b.getRng())},getSelectedMacro:function(){var a=tinymce.confluence.macrobrowser,b=a.getCurrentNode();AJS.log("getSelectedMacro: $selectionNode="+b[0]);return a.isMacroDiv(b)?b:tinymce.confluence.MacroUtils.isInMacro(b)},openMacro:function(a){AJS.MacroBrowser.open({selectedMacro:a,onComplete:tinymce.confluence.macrobrowser.macroBrowserComplete,
onCancel:tinymce.confluence.macrobrowser.macroBrowserCancel})},editMacro:function(a){var b=tinymce.confluence.macrobrowser,a=c(a);b.editedMacroDiv=a[0];var d=AJS.Rte.getEditor().serializer.serialize(a.clone()[0],{forced_root_block:!1});AJS.Rte.getEditor().selection.select(a[0]);AJS.Rte.BookmarkManager.storeBookmark();c.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:AJS.params.contextPath+"/rest/tinymce/1/macro/definition",data:AJS.$.toJSON({contentId:Confluence.getContentId(),
macroHtml:d}),dataType:"text",success:function(a){b.openMacro(AJS.$.secureEvalJSON(a))}})},macroBrowserToolbarButtonClicked:function(a){var b=tinymce.confluence.macrobrowser,d=tinyMCE.activeEditor,e=b.getCurrentNode();AJS.Rte.BookmarkManager.storeBookmark();b=c.extend({presetMacroName:null,nestingMacros:b.getNestingMacros(e),onComplete:b.macroBrowserComplete,onCancel:b.macroBrowserCancel,mode:"insert",selectedHtml:"",selectedText:""},a);a.ignoreEditorSelection||(b.selectedHtml=d.selection.getContent(),
b.selectedText=d.selection.getContent({format:"text"}));AJS.MacroBrowser.open(b)},macroBrowserComplete:function(a){var b=tinymce.confluence.macrobrowser,a={contentId:AJS.Meta.get("content-id")||"0",macro:{name:a.name,params:a.params,defaultParameterValue:a.defaultParameterValue,body:a.bodyHtml}};AJS.Rte.BookmarkManager.restoreBookmark();b.editedMacroDiv?(tinymce.confluence.MacroUtils.insertMacro(a,b.editedMacroDiv),delete b.editedMacroDiv):tinymce.confluence.MacroUtils.insertMacro(a)},macroBrowserCancel:function(){var a=
tinymce.confluence.macrobrowser;AJS.Rte.BookmarkManager.restoreBookmark();a.editedMacroDiv=null;a.editedMacro=null}}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/tinymce-image-utils.js' */
(function(g){var k="imagetext src align border width height".split(" "),m=/\/download\/(thumbnails|attachments)\/([0-9]+)\//,l=function(a,b,e,c,d){c?(b>=d&&(a.width=d),a.style.maxWidth=""):(e>=d&&(a.height=d),a.style.maxHeight="")},h;tinymce.confluence.ImageProperties=function(a){if(a&&g.nodeName(a,"img")&&g(a).hasClass("confluence-embedded-image")){var b=g(a),a={destination:b.attr("src"),url:b.attr("src"),border:b.attr("class")&&-1!=b.attr("class").indexOf("confluence-content-image-border")?1:0,
width:b.prop("width"),height:b.prop("height"),originalSelected:!b.attr("width")&&!b.attr("height")};if(!h.isRemoteImg(a.destination)&&!AJS.$(b).hasClass("confluence-external-resource")){var e=a;var b=g(b).attr("src"),c=b.match(m);c&&3==c.length?b=c[2]:(AJS.log("ERROR: could not parse page id from image url "+b),b="0");e.pageId=b}return g.extend({},a)}return a.destination?(a.imageFileName=a.imageFileName||a.destination,g.extend({},a)):null};h=tinymce.confluence.ImageUtils={isScaledByWidth:function(){return!1},
updateImageElement:function(a,b){var e=g(a),c;c=b.destination;c=h.isRemoteImg(c)?c:b.thumbnail?c.replace("/attachments/","/thumbnails/"):c.replace("/thumbnails/","/attachments/");b.src=c;e.toggleClass("confluence-content-image-border",!!b.border);e.toggleClass("confluence-thumbnail",!!b.thumbnail);c=0;for(var d=k.length;c<d;c++){var f=k[c],i=b[f];!1!==i&&null!=i?e.attr(f,i):e.removeAttr(f)}tinyMCE.activeEditor.undoManager.add()},insertFromProperties:function(a,b){AJS.$.ajax({type:"POST",contentType:"application/json; charset=utf-8",
url:AJS.params.contextPath+"/rest/tinymce/1/embed/placeholder/image",data:AJS.$.toJSON(a),dataType:"text",success:function(a){h.insertImagePlaceholder(a,b)}})},insertImagePlaceholder:function(a,b){var e,c=tinymce.confluence.ImageUtils.isScaledByWidth(),d=g(a);e=c?AJS.Confluence.PropertyPanel.Image.getPresetImageSize("large"):"comment"===AJS.Meta.get("content-type")?AJS.Confluence.PropertyPanel.Image.getPresetImageSize("small"):AJS.Confluence.PropertyPanel.Image.getPresetImageSize("medium");d.css(c?
"max-width":"max-height",e+"px");var f=tinyMCE.activeEditor,i="_"+ +new Date,h=g("<div></div>").append(d.attr("id",i));f.selection.setContent(h.html());var j=f.dom.get(i);f.dom.setAttrib(j,"id","");d.hasClass("confluence-external-resource")||l(j,d.attr("data-image-width"),d.attr("data-image-height"),c,e);g(j).one("load",function(){d.hasClass("confluence-external-resource")&&l(this,this.width,this.height,c,e);AJS.Rte.showSelection(function(){b||AJS.trigger("trigger.property-panel",{elem:j});f.undoManager.add()});
f.onChange.dispatch()})},isRemoteImg:function(a){var b=AJS.Rte.getCurrentBaseUrl();return a.match("(https?://)")&&-1==a.indexOf(b)},isThumbnailUsable:function(a,b,e,c,d,f){if(a){if(a>d)return!1;d=e/c;return 1<=d?!0:d*f>=a}a=b;if(a>f)return!1;f=c/e;return 1<=f?!0:f*d>=a}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/tinymce-macro-utils.js' */
(function(e){var k;tinymce.confluence.MacroUtils=k={DEFAULT_INSERT_MACRO_TIMEOUT:5E3,insertMacro:function(a,d){var f;if(a.macro&&a.contentId)f={type:"POST",url:Confluence.getContextPath()+"/rest/tinymce/1/macro/placeholder",contentType:"application/json; charset=utf-8",data:e.toJSON(a),dataType:"text"};else if(a.url&&a.type)f=a;else throw Error("illegal argument received: "+a);var c=e.Deferred(),g=AJS.Rte.getEditor(),i,j;d||(j="macro-"+(new Date).getTime(),i=g.dom.create("span",{id:j}),g.selection.setNode(i),
d=i=g.dom.select("#"+j)[0],c.fail(function(){e(i).remove()}));e.extend(f,{timeout:k.DEFAULT_INSERT_MACRO_TIMEOUT});AJS.debug("Insert macro timeout = "+f.timeout);Confluence.Editor.UI.setButtonsState(!1);e.ajax(f).done(function(b){b[0]!=="<"&&(b=document.createTextNode(b));if(!d||!d.parentNode){AJS.logError("The node to be replaced has been already deleted from the document");c.rejectWith(this,arguments)}else tinymce.confluence.NodeUtils.updateNode(d,b).done(function(a){c.resolve(a,b)}).fail(c.reject)}).fail(function(b,
a,e){AJS.logError("Macro placeholder request failed "+a+": '"+e+"'");c.rejectWith(this,arguments)});c.done(function(b,a){Confluence.Editor.UI.setButtonsState(true);tinymce.confluence.macrobrowser.isMacroWithBody(b)&&/P|H\d/.test(b.parentNode.nodeName)&&g.dom.split(b.parentNode,b);var c=tinymce.confluence.macrobrowser,d=tinymce.activeEditor,f=d.getDoc(),h=d.selection.getRng(true);if(c.isMacroWithBody(b)){!tinymce.isIE&&e("p, pre",b).each(function(){this.childNodes.length===0&&this.appendChild(f.createElement("br"))});
if(c=d.dom.select(".wysiwyg-macro-body",b)[0].firstChild){h.setStart(c,0);h.setEnd(c,0)}else AJS.debug("focusMacroNode: couldn't find anything to focus, cap'n!")}else{h.setStartAfter(b);h.setEndAfter(b)}d.selection.setRng(h);g.nodeChanged();AJS.Rte.showElement(b);g.selection.onSetContent.dispatch(g.selection,{content:a,format:"html"});tinymce.activeEditor.undoManager.add()}).fail(function(){Confluence.Editor.UI.setButtonsState(true)});return c.promise()},isInMacro:function(a){return 0<(a.jquery?a:
e(a)).closest(".wysiwyg-macro").length}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confluence/editor_plugin_src.js' */
(function(j){tinymce.create("tinymce.plugins.ConfluencePlugin",{init:function(e){e.addCommand("mceConfUnlink",function(e,k){var f=AJS.Rte.getEditor(),g=f.selection,d=k||g.getNode(),a=j(d);if("A"!=d.nodeName){a=a.closest("a");if(!a.length)return;d=a[0]}var b=a.attr("href");b||(b="#",a.attr("href",b));var c;if(c=!a.attr("data-linked-resource-id"))if(c=Confluence.Link.isExternalLink(b)){c=a.text();var h=b,i=/(.*)[\/]$/.exec(h);c=c==(null!=i?i[1]:h)}c?(g=f.dom.create("span",{"class":"nolink"},b),f.dom.replace(g,
d,!1)):(g.select(d),a.removeClass("createlink unresolved"),f.execCommand("UnLink"))});e.addButton("confimage",{title:"confluence.confimage_desc",cmd:"mceConfimage"});e.addButton("conf_macro_browser",{title:"confluence.conf_macro_browser_desc",cmd:"mceConfMacroBrowser"})},getInfo:function(){return{longname:"Confluence TinyMCE Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluence",tinymce.plugins.ConfluencePlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/macroplaceholder/editor_plugin_src.js' */
(function(e){var i=tinymce.VK;tinymce.create("tinymce.plugins.MacroPlaceHolderPlugin",{init:function(h){function g(a){h.onKeyDown.add(a);tinymce.isGecko&&(h.onKeyPress.add(a),h.onKeyUp.add(a))}function j(a,b){return a&&1===a.childNodes.length&&e(a).is(b)&&e(a.firstChild).is("br")}function k(a){if(!a.collapsed)return!1;a=3==a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer;if(!a||!a.parentNode)return!1;for(;a&&!e(a).is(".wysiwyg-macro-body");){if(a.previousSibling||a.nextSibling)return!1;
a=a.parentNode}return!0}var f=this;h.onInit.add(function(a){a.selection.onSetContent.add(function(a){tinymce.each(a.dom.select("p > .wysiwyg-macro"),function(c){var d=a.dom.getParent(c.parentNode,"p");try{a.dom.split(d,c)}catch(e){}})})});h.onSetContent.add(function(a){tinymce.each(a.dom.select('.wysiwyg-macro[data-macro-body-type="PLAIN_TEXT"] .wysiwyg-macro-body'),function(b){a.dom.select("pre",b).length||(tinymce.isIE?a.dom.setHTML(b,"<pre></pre>"):a.dom.setHTML(b,"<pre><br /></pre>"))})});h.onKeyDown.add(function(a,
b){var c=a.selection,d;if(!(d=-1!=jQuery.inArray(b.keyCode,[i.BACKSPACE,i.DELETE,i.ENTER,i.ESCAPE])))d=!1,0===b.charCode&&(d=-1!=jQuery.inArray(b.keyCode,[i.SHIFT,i.CTRL,i.ALT,i.META])),d=d||c.isCollapsed();if(!d&&!b.ctrlKey&&!(b.metaKey||!tinymce.isMac&&b.altKey))d=c.getNode(),tinymce.confluence.macrobrowser.isMacroWithBody(d)&&(d=e(".wysiwyg-macro-body",d),0<d.length&&(AJS.debug("MacroPlaceholderPlugin: Adjusting text selection to only include macro's body."),c.select(d[0],!0)))});h.onDblClick.add(function(a,
b){var c=e(b.target),d=c.closest("[data-macro-name]");if(d.length){AJS.debug("Double-click triggered inside a macro.");if(d.attr("data-macro-body-type"))if(tinymce.isIE)if(c.hasClass("wysiwyg-macro-body")||c.hasClass("wysiwyg-macro"))AJS.debug("Double-click inside macro body, but its IE so its OK I guess...");else{AJS.debug("Double-click was inside bodied macro content, even in IE. Skipping.");return}else if(c.closest(".wysiwyg-macro-body").length){AJS.debug("Double-click was inside bodied macro content. Skipping.");
return}tinymce.confluence.macrobrowser.editMacro(d);AJS.Confluence.PropertyPanel&&AJS.Confluence.PropertyPanel.current&&AJS.Confluence.PropertyPanel.destroy()}});h.onNodeChange.addToTop(function(a){var b=a.selection.getNode();"PRE"==b.nodeName&&AJS.$(b).closest(".wysiwyg-macro").length?f._setTinymceControlsState(a,0):f._setTinymceControlsState(a,1)});h.addCommand("mceConfRemoveMacro",function(a){e(a).remove();tinymce.isGecko&&AJS.Rte.getEditor().execCommand("mceRepaint",!1)});f._isCursorInMostNestedElement=
k;var n=function(a){if(!a.collapsed)return!1;a=3==a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer;return a.previousSibling&&!a.nextSibling&&j(a,"p, pre")};(tinymce.isWebKit||tinymce.isGecko)&&g(function(a,b){if(46==b.keyCode&&n(a.selection.getRng(!0)))return tinymce.dom.Event.cancel(b)});f._isCursorInLastParagraphOrPre=n;tinymce.isWebKit&&g(function(a,b){if(8!=b.keyCode&&46!=b.keyCode)return!0;var c=a.selection.getRng(!0),d=3==c.startContainer.nodeType?c.startContainer.parentNode:
c.startContainer;if(c.collapsed)var f=3==c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer,c=k(c)&&1===f.childNodes.length&&e(f.firstChild).is("br");else c=!1;return c&&(8==b.keyCode?!e(d).is("li"):1)?tinymce.dom.Event.cancel(b):!0});var o=function(a){if(!a.collapsed)return!1;var b=3==a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer;return 0===a.startOffset&&e(b).is(".wysiwyg-macro-body > ul > li")&&1===b.childNodes.length&&e(b.firstChild).is("br")};tinymce.isWebKit&&
g(function(a,b){return 8!=b.keyCode?!0:o(a.selection.getRng(!0))?(a.execCommand("Outdent"),tinymce.dom.Event.cancel(b)):!0});f._isCursorInsideMacroPlacholderInsideListItemContainingSoloBr=o;var p=function(a){var b=3==a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer,c=e(b);return 0===a.startOffset&&j(b,"p, pre")&&c.parent().is("td.wysiwyg-macro-body")&&!b.previousSibling&&b.nextSibling&&j(b.nextSibling,"p, pre")};tinymce.isWebKit&&g(function(a,b){if(46!=b.keyCode)return!0;var c=
a.selection.getRng(!0),d=3==c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer,f=e(d);if(p(c))return c=d.nextSibling,f.remove(),a.selection.select(c,!0),tinymce.dom.Event.cancel(b)});f._isCursorInFirstParagraphWhenThereAreTwoEmptyParagraphs=p;var q=function(a){var b=3==a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer,c=e(b);return 0===a.startOffset&&j(b,"p, pre")&&c.parent().is("td.wysiwyg-macro-body")&&!b.nextSibling&&b.previousSibling&&!b.previousSibling.previousSibling&&
j(b.previousSibling,"p, pre")};tinymce.isWebKit&&g(function(a,b){if(8!=b.keyCode)return!0;var c=a.selection.getRng(!0),d=3==c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer,f=e(d);if(q(c))return c=d.previousSibling,f.remove(),a.selection.select(c,!0),tinymce.dom.Event.cancel(b)});f._isCursorInSecondParagraphWhenThereAreTwoEmptyParagraphs=q;var r=function(a){if(!a.collapsed)return!1;var b=3==a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer,c=e(b);if(!b||
0<a.startOffset)return!1;tinymce.confluence.NodeUtils.normalize(b);return b&&0===a.startOffset&&j(b,"p, pre")&&c.parent().is("td.wysiwyg-macro-body")&&!b.previousSibling&&!b.nextSibling};(tinymce.isWebKit||tinymce.isGecko)&&g(function(a,b){if(8!=b.keyCode&&46!=b.keyCode)return!0;if(r(a.selection.getRng(!0)))return tinymce.dom.Event.cancel(b)});f._isCursorInSoloParagraphOrPreInsidePlaceholder=r;var s=function(a){return a&&a.parentNode&&"BR"==a.nodeName&&a===a.parentNode.lastChild},t=function(a){if(!a.collapsed)return!1;
var b=a.startContainer;return b&&0===a.startOffset&&3==b.nodeType&&k(a)&&1===b.nodeValue.length&&!b.previousSibling&&(!b.nextSibling||s(b.nextSibling))},u=function(a){if(!a.collapsed)return!1;var b=a.startContainer;return b&&1===a.startOffset&&3==b.nodeType&&k(a)&&1===b.nodeValue.length&&!b.previousSibling&&(!b.nextSibling||s(b.nextSibling))},v=function(a){if(!a.collapsed)return!1;var b=a.startContainer;return b&&0===a.startOffset&&1==b.nodeType&&1===b.childNodes.length&&k(a)&&!b.previousSibling&&
!b.nextSibling},w=function(a){if(!a.collapsed)return!1;var b=a.startContainer;return b&&1===a.startOffset&&1==b.nodeType&&1===b.childNodes.length&&k(a)&&!b.previousSibling&&!b.nextSibling};(tinymce.isWebKit||tinymce.isGecko)&&g(function(a,b){if(8!=b.keyCode&&46!=b.keyCode)return!0;var c=a.selection.getRng(!0),d=3==c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer;if(!e(d).closest(".wysiwyg-macro-body").size())return!0;tinymce.confluence.NodeUtils.normalize(d);return 46==b.keyCode&&
(t(c)||v(c))||8==b.keyCode&&(u(c)||w(c))?(d.lastChild&&!e(d.lastChild).is("br")&&e(d).append("<br/>"),e(d.firstChild).remove(),a.selection.select(d,1),tinymce.dom.Event.cancel(b)):!0});f._isCursorBehindOnlyCharacterInNestedElement=t;f._isCursorAfterOnlyCharacterInNestedElement=u;f._isCursorBehindOnlyChildInNestedElement=v;f._isCursorAfterOnlyChildInNestedElement=w;var y=function(a){if(a.collapsed)return!1;var b=function(a){return!a.previousSibling},c=function(a){return!a.nextSibling};return 0===a.startOffset&&
x(a.startContainer,b)&&(!a.endContainer?!1:3==a.endContainer.nodeType?a.endOffset===a.endContainer.nodeValue.length:1===a.endContainer.nodeType?1===a.endContainer.childNodes.length&&e(a.endContainer.firstChild).is("br")?0===a.endOffset:a.endOffset===a.endContainer.childNodes.length:!1)&&x(a.endContainer,c)},x=function(a,b){if(!a)return!1;if(e(a).is(".wysiwyg-macro-body"))return!0;do{if(!b(a))return!1;a=a.parentNode}while(a&&!e(a).is(".wysiwyg-macro-body"));return!0};tinymce.isWebKit&&g(function(a,
b){if(8!=b.keyCode&&46!=b.keyCode)return!0;var c=a.selection.getRng(!0);if(y(c)&&(c=e(c.startContainer).closest(".wysiwyg-macro-body"),0<c.length)){var d=e(c[0].firstChild).is("pre");a.undoManager.add();c.empty();c=d?e("<pre><br/></pre>").appendTo(c):e("<p><br/></p>").appendTo(c);a.selection.select(c[0],!0);return tinymce.dom.Event.cancel(b)}return!0});f._isMacroBodySelected=y;var z=function(a){if(!a.collapsed)return!1;var b=3==a.startContainer.nodeType?a.startContainer.parentNode:a.startContainer,
c=e(b);return 0===a.startOffset&&j(b,"p")&&c.next().is("table")};tinymce.isWebKit&&g(function(a,b){if(46==b.keyCode&&z(a.selection.getRng(!0)))return tinymce.dom.Event.cancel(b)});f._isCursorInEmptyParagraphPrecedingPlaceholder=z;var A=function(a){return!a||e(a.parentNode).is(".wysiwyg-macro td")?null:e(a.parentNode).is("p")?a.parentNode:A(a.parentNode)},l=function(a){return!a?null:3==a.nodeType?a:l(a.firstChild)||l(a.nextSibling)},m=function(a){return!a||"PRE"==a.nodeName||"TD"==a.nodeName?null:
"BR"==a.nodeName?a:m(a.previousSibling)||m(a.parentNode)},B=function(a){var b,c;0<e(a.commonAncestorContainer).closest(".wysiwyg-macro td").length&&(m(a.startContainer)||(b=l(A(a.startContainer))));if(0<(c=e(a.commonAncestorContainer).closest(".wysiwyg-macro td > pre")).length)m(a.startContainer)||(b=l(c[0]));b&&(a=a.cloneRange(),a.setStart(b,0));return a};tinymce.isWebKit&&tinymce.isMac&&g(function(a,b){var c=a.selection.getRng();if((b.metaKey||b.ctrlKey)&&b.shiftKey&&b.keyCode==i.LEFT){var d=B(c);
if(d!==c)return a.selection.setRng(d),tinymce.dom.Event.cancel(b)}});f._selectTillStart=B;h.onKeyDown.add(function(a,b){if(b.keyCode==tinymce.VK.TAB){var c=a.selection.getRng(1);if(e(3==c.startContainer.nodeType?c.startContainer.parentNode:c.startContainer).is(".wysiwyg-macro-body > pre")){a.undoManager.beforeChange();a.undoManager.add();var d=a.getDoc().createTextNode("\t");c.insertNode(d);a.selection.setCursorLocation(d,1);a.undoManager.add();return tinymce.dom.Event.prevent(b)}}})},_setTinymceControlsState:function(e,
g){tinymce.each(e.controlManager.controls,function(e){e.setDisabled(!g)})},getInfo:function(){return{longname:"Macro Place Holder plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("macroplaceholder",tinymce.plugins.MacroPlaceHolderPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/insertwiki/editor_plugin_src.js' */
(function(f,e,q){var l=!AJS.DarkFeatures.isEnabled("editor.insert-wiki-markdown"),c={DEFAULT:null,HELP_REST_API:AJS.contextPath()+"/plugins/tinymce/helplink.action",WIKI:{CONFLUENCE:{val:"CONFLUENCE",label:"Confluence wiki",helpLink:"help.insert.wiki.markup",restApi:"/rest/tinymce/1/wikixhtmlconverter"},MARKDOWN:{val:"MARKDOWN",label:"Markdown",helpLink:"help.insert.wiki.markup.markdown",
restApi:"/rest/tinymce/1/markdownxhtmlconverter"}}},n=new Confluence.localStorageCacheManager("insert-wiki-markup-dialog");f.create("tinymce.plugins.InsertWikiMarkupPlugin",{init:function(d,r){d.addCommand("InsertWikiMarkup",function(){var h={id:"insert-wiki-markup-dialog",content:l?Confluence.Templates.InsertWiki.wikiMarkupDialog():Confluence.Templates.InsertWiki.originalDefaultTempWikiMarkupDialog(),width:980,height:500,popup:!1,name:"confluence.conf_wikimarkup_desc"},s=AJS.Meta.get("content-id"),
t=AJS.Meta.get("space-key");c.DEFAULT=c.WIKI[n.get("parser")||"CONFLUENCE"];var b={getElement:function(a){b[a]=b[a]||e(a);return b[a]}},i=null,j=function(){var a=b.getElement("#wiki-parser-selection-tool");return a.length?a.val():c.DEFAULT.val},o=function(a){a=a||{};a.setBusy&&d.windowManager.setBusy(h.id,!0);e.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:a.API,data:e.toJSON({wiki:a.textToConvert,entityId:s,spaceKey:t}),dataType:"text",success:a.successCallback,error:a.errorCallback||
function(a){AJS.logError(a)},timeout:7500})},u=function(a){var b=h.id,c=j();d.windowManager.setBusy(b,!1);f.EditorManager.activeEditor.windowManager.close(b);l&&(AJS.trigger("analytics",{name:"insert-wiki-markup-dialog."+c}),"MARKDOWN"===c&&(a=e(a),a.find("img").addClass("confluence-embedded-image"),a=e("<div>").append(a.clone()).html()));d.execCommand("mceInsertContent",!1,a);f.each(d.dom.select("p > p"),function(a){try{d.dom.split(a.parentNode,a)}catch(b){AJS.logError("insertwikimarkup - splitParas()",
b)}})},v=function(a,b,c){d.windowManager.setBusy(h.id,!1);a={warningMessage:f.EditorManager.activeEditor.getLang("confluence.conf_wikimarkup_errors"),exceptionMessage:"timeout"===b?f.EditorManager.activeEditor.getLang("confluence.conf_wikimarkup_timeout"):AJS.escapeHtml(b)+" : "+AJS.escapeHtml(c)};a=Confluence.Templates.InsertWiki.wikiErrorSubDialog(a);f.EditorManager.activeEditor.windowManager.alert(a)},p=function(){var a=b.getElement("#insert-wiki-textarea"),d=a.val();e.trim(d)?o({API:AJS.params.contextPath+
c.WIKI[j()].restApi,textToConvert:d,successCallback:function(a){i.html(a)},errorCallback:function(){i.html(a.val())}}):i.html(d)},w=function(){var a=j();n.put("parser",a);b.getElement("#"+h.id).find(".dialog-help-link").load(c.HELP_REST_API,{linkUrlKey:c.WIKI[a].helpLink});p()};d.windowManager.open(h,{buttons:[{label:"confluence.conf_insert_button_title",action:function(){o({API:AJS.params.contextPath+c.WIKI[j()].restApi,successCallback:u,errorCallback:v,textToConvert:b.getElement("#insert-wiki-textarea").val(),
setBusy:!0})}}],plugin_url:r,helpLink:c.DEFAULT.helpLink,hintText:"confluence.conf_wikimarkup_hint",cssClass:"insert-wiki-markup-panel"});if(l){var m=e("#wysiwygTextarea_ifr").contents().find("head").html(),x=Confluence.Templates.InsertWiki.previewWikiIframeContent(),g=e("<iframe tabindex='-1' id='insert-wiki-markup-preview' />"),k;b.getElement("#insert-wiki-textarea-preview").append(g);g=g.contents();k=g[0];k.open();k.write(x);k.close();g.find("head").html(m);i=g.find("body");m=e(Confluence.Templates.InsertWiki.wikiParserSelector(c));
b.getElement("#insert-wiki-insert-title").append(m);b.getElement("#wiki-parser-selection-tool").on("change",w);b.getElement("#insert-wiki-textarea").on("keydown",q.debounce(p,300))}});d.addButton("insertwikimarkup",{title:"confluence.conf_wikimarkup_desc",cmd:"InsertWikiMarkup"})},getInfo:function(){return{longname:"InsertWikiMarkip",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.1"}}});f.PluginManager.add("insertwikimarkup",f.plugins.InsertWikiMarkupPlugin)})(tinymce,
AJS.$,_);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/propertypanel/editor_plugin_src.js' */
(function(f){var g=[];AJS.bind("add-handler.property-panel",function(c,d){d&&g.push(d)});tinymce.create("tinymce.plugins.PropertyPanel",{init:function(c){AJS.debug("init property panel plugin");var d,e=function(b,a,c){var d={focusedEl:c,focusedNodeName:c.nodeName&&c.nodeName.toLowerCase(),ed:b,e:f.extend({},a)};b=f(c);b.is("img")?b=b[0]:(b=b.closest("a,table,.wysiwyg-macro,.editor-inline-macro,.text-placeholder"),b=b.length?b[0]:"");var c=!!f(c).closest("table:not(.wysiwyg-macro,.editor-inline-macro)").length,
e=!!f(".toolbar-contextual").length;d.containerEl=b;AJS.trigger("user-blurred-rte-element",d);var h;if(h=b)a="click"!=a.type?!1:a.which?3==a.which:a.button?2==a.button:void 0,h=!a&&!AJS.Confluence.PropertyPanel.current&&AJS.Confluence.PropertyPanel.shouldCreate;if(h){a=0;for(h=g.length;a<h;a++)if(g[a].canHandleElement(f(b))){if(e||!c)return g[a].handle(d);(function(a){AJS.$(document).bind("shown.contextToolbar",function(){a.handle(d)})})(g[a])}}};tinymce.isIE&&c.onMouseDown.add(function(b,a){d&&d.unbind("mouseup.IEDragHandlesWorkaround");
d=AJS.$(a.target);d.filter("img, table").bind("mouseup.IEDragHandlesWorkaround",function(){e(b,a,a.target)})});AJS.bind("trigger.property-panel",function(b,a){e(c,b,a.elem)});c.onClick.add(function(b,a){e(b,a,a.target)});c.onKeyUp.addToTop(function(b,a){27!==a.keyCode&&e(b,a,b.selection.getNode())});c.onContextMenu.add(function(){AJS.Confluence.PropertyPanel.destroy()});AJS.bind("user-blurred-rte-element",function(b,a){AJS.Confluence.PropertyPanel.current&&(!a.containerEl||AJS.Confluence.PropertyPanel.current.hasAnchorChanged(a.containerEl)?
AJS.Confluence.PropertyPanel.destroy():AJS.trigger("same-anchor.property-panel"))});AJS.bind("created.property-panel",function(){setTimeout(function(){AJS.Rte.bindScroll("property-panel",function(){AJS.Confluence.PropertyPanel.destroy()})},0);AJS.$(c.getDoc()).bind("keydown.property-panel.escape",function(b){27===b.keyCode&&AJS.Confluence.PropertyPanel.current&&AJS.Confluence.PropertyPanel.destroy()})});AJS.bind("destroyed.property-panel",function(){AJS.Rte.unbindScroll("property-panel");AJS.$(c.getDoc()).unbind("keydown.property-panel.escape")})},
getInfo:function(){return{longname:"Image, Link and Macro Property Panels",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("propertypanel",tinymce.plugins.PropertyPanel)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/confmonospace/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.ConfMonospacePlugin",{init:function(a){a.addCommand("confMonospace",function(){a.formatter.toggle("monospace",void 0)});tinymce.activeEditor.onInit.add(function(a){a.formatter.register({monospace:{inline:"code"}});a.editorCommands.addCommands({confMonospace:function(){return a.formatter.match("monospace")}},"state")});a.addButton("monospace",{title:"monospace",cmd:"confMonospace"})},getInfo:function(){return{longname:"Monospace Formatting",author:"Atlassian",
authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confmonospace",tinymce.plugins.ConfMonospacePlugin)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/propertypanel/js/tinyMce-property-panel-links.js' */
(function(f){var g=0;AJS.Confluence.PropertyPanel.Link={name:"link",canHandleElement:function(c){return c.is("a")&&"#"!=c.attr("href")&&!c.hasClass("unresolved")},handle:function(c){var b=c.containerEl,e=c.ed,a=function(b){return AJS.Rte.getEditor().getLang(b)},c={anchorIframe:AJS.Rte.getEditorFrame()},d=0==f(b).attr("href").indexOf("#"),a=[{className:"link-property-panel-goto-button",text:a("propertypanel.links_goto"),tooltip:d?a("propertypanel.links_goto_disabled_tooltip"):b.href,href:b.href,disabled:d,
click:function(){AJS.Confluence.PropertyPanel.destroy();var a=window.open(b.href,tinymce.isIE?"_blank":"confluence-goto-link-"+AJS.params.pageId+"-"+g);a&&a.focus()}},{className:"link-property-panel-edit-button",text:a("propertypanel.links_edit"),tooltip:a("propertypanel.links_edit_tooltip"),disabled:f(b).hasClass("createlink")||!b.href,click:function(){AJS.Confluence.PropertyPanel.destroy();e.selection.select(b);Confluence.Editor.LinkBrowser.open()}},{className:"link-property-panel-unlink-button",
text:a("propertypanel.links_unlink"),tooltip:a("propertypanel.links_unlink_tooltip"),click:function(){AJS.Confluence.PropertyPanel.destroy();e.execCommand("mceConfUnlink",!1,b);e.focus()}}],d=[];AJS.trigger("link-property-panel-buttons.created",{buttons:d,link:b});a=a.concat(d);AJS.Confluence.PropertyPanel.createFromButtonModel(this.name,b,a,c);g++}}})(AJS.$);AJS.bind("init.rte",function(){AJS.trigger("add-handler.property-panel",AJS.Confluence.PropertyPanel.Link)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/propertypanel/js/tinyMce-property-panel-images.js' */
AJS.Confluence.PropertyPanel.Image=function(f){function l(){var a=[];f.each(buttons,function(c,b){a.push(b)});AJS.Confluence.PropertyPanel.current.panel.find(a.join(", ")).removeClass("selected")}function m(a,c,b){var g=p(a,c),b=p(a,b),e=g||b;if(e){var d=f(AJS.Confluence.PropertyPanel.current.anchor),u=d.width(),d=d.height(),h=AJS.Meta.get("max-thumb-width"),k=AJS.Meta.get("max-thumb-height");a.thumbnail=tinymce.confluence.ImageUtils.isRemoteImg(a.destination)?!1:tinymce.confluence.ImageUtils.isThumbnailUsable(g,
b,u,d,h,k);a.originalSelected=!1;c?(delete a.height,a.width=e):(delete a.width,a.height=e);i(a);l();return!0}return!1}function q(a,c){return(o?m(a,h[c]):m(a,null,h[c]))?(r(c),i(a),!0):!1}function s(a){delete a.width;delete a.height;a.thumbnail=!1;a.originalSelected=!0;l();r("original");var c=AJS.Confluence.PropertyPanel.current,b=f(c.anchor);c.updating=!0;b.one("load",function(){j(c);n(a);a.width=Math.floor(b.width());a.height=Math.floor(b.height())});tinymce.confluence.ImageUtils.updateImageElement(b,
a);tinymce.isGecko&&AJS.Rte.getEditor().execCommand("mceRepaint",!1);b.each(function(){this.complete&&f(this).trigger("load")});return!0}function r(a){AJS.Confluence.PropertyPanel.current.panel.find(buttons[a]).addClass("selected")}function t(a){f(".image-border-toggle").toggleClass("selected",!a.border);a.border=+!a.border||!1;i(a)}function i(a){var c=AJS.Confluence.PropertyPanel.current,b=f(c.anchor),g=b.attr("src"),e=b.height();c.updating=!0;tinymce.confluence.ImageUtils.updateImageElement(b,a);
tinymce.isGecko&&AJS.Rte.getEditor().execCommand("mceRepaint",!1);if(a.src!=g){var d=setInterval(function(){var a=b.height();a!=e&&(AJS.debug("updateImageElement : height changed after image src change - "+e+" to "+a),clearTimeout(d),d=null,j(c))},10);setTimeout(function(){d&&(clearTimeout(d),d=null,j(c))},1E3)}else j(c);n(a)}function n(a){a=a.width?a.width:f(AJS.Confluence.PropertyPanel.current.anchor).width();a=Math.floor(a);f("#image-size-input").val(a+"px")}function p(a,c){c=parseInt(c);if(isNaN(c))return null;
c<lowerImageSizeBound?c=lowerImageSizeBound:c>upperImageSizeBound&&(c=upperImageSizeBound);return c}var o=tinymce.confluence.ImageUtils.isScaledByWidth(),h;h=o?{small:100,medium:300,large:500}:{small:150,medium:250,large:400};buttons={small:".image-size-small",medium:".image-size-medium",large:".image-size-large",original:".image-size-original"};lowerImageSizeBound=16;upperImageSizeBound=900;var j=function(a){a.updating=!1;a.snapToElement({animate:!0,animateDuration:100})};return{pluginButtons:[],
name:"image",getPresetImageSize:function(a){return h[a]},canHandleElement:function(a){return a.is("img")&&!a.hasClass("editor-inline-macro")&&!a.hasClass("template-variable")},handle:function(a){var c="IMG"==a.nodeName?a:a.containerEl,a=f(c),b=tinymce.confluence.ImageProperties(c);if(b&&!a.attr("data-resource-id")){var g=AJS.Rte.getEditor(),e=function(a){return g.getLang(a)},d=function(a){return{className:"image-size-"+a,text:e("propertypanel.images_"+a),tooltip:e("propertypanel.images_"+a+"_tooltip"),
click:function(){q(b,a);AJS.trigger("analyticsEvent",{name:"confluence.editor.image.resize."+a})},selected:o?b.width==h[a]:b.height==h[a]}},d=[{className:"editable",tooltip:e("propertypanel.images_sizing_tooltip"),html:'<input id="image-size-input"/>'},null,d("small"),d("medium"),d("large"),{className:"image-size-original",text:e("propertypanel.images_original"),tooltip:e("propertypanel.images_original_tooltip"),click:function(){s(b);AJS.trigger("analyticsEvent",{name:"confluence.editor.image.resize.original"})},
selected:b.originalSelected},null,{className:"image-border-toggle",text:e("propertypanel.images_border"),tooltip:e("propertypanel.images_border_tooltip"),click:function(){t(b)},selected:b.border||1==b.border}];d.push(null);var j=a.parent();j.is("a[href]")?(d.push({className:"image-link-edit",text:e("propertypanel.images_link_edit"),tooltip:e("propertypanel.images_link_edit_tooltip"),click:function(){AJS.Confluence.PropertyPanel.destroy();g.selection.select(j[0]);Confluence.Editor.LinkBrowser.open()}}),
d.push({className:"image-link-remove",text:e("propertypanel.images_link_remove"),tooltip:e("propertypanel.images_link_remove_tooltip"),click:function(){AJS.Confluence.PropertyPanel.destroy();g.execCommand("mceConfUnlink",!1,c);g.focus()}})):d.push({className:"image-make-link",text:e("propertypanel.images_link_create"),tooltip:e("propertypanel.images_link_create_tooltip"),click:function(){AJS.Confluence.PropertyPanel.destroy();g.selection.select(c);Confluence.Editor.LinkBrowser.open()}});for(var i=
AJS.Confluence.PropertyPanel.Image.pluginButtons,k=0;k<i.length;k++)if(null===i[k])d.push(null);else{var l=i[k].create(a);l&&d.push(l)}AJS.Confluence.PropertyPanel.createFromButtonModel(this.name,c,d,{anchorIframe:AJS.Rte.getEditorFrame()});a=f("#image-size-input");a.bind("focus",function(){f(this).select()});a.bind("change",function(){m(b,f("#image-size-input").val())?true:n(b);AJS.trigger("analyticsEvent",{name:"confluence.editor.image.resize.custom"})});AJS.Confluence.PropertyPanel.current.imageProps=
b;n(b);return{setPresetSize:function(a){q(b,a)},setPixelSize:function(a){m(b,a)},setToOriginalSize:function(){s(b)},toggleBorder:function(){t(b)},getWidth:function(){return b.width},getHeight:function(){return b.height},getDisplayWidth:function(){return f("#image-size-input").val()},isButtonSelected:function(a){return AJS.Confluence.PropertyPanel.current.panel.find(buttons[a]).hasClass("selected")}}}}}}(AJS.$);AJS.bind("init.rte",function(){AJS.trigger("add-handler.property-panel",AJS.Confluence.PropertyPanel.Image)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/propertypanel/js/tinyMce-property-panel-macros.js' */
AJS.Confluence.PropertyPanel.Macro=function(d){var j=[],k=[],e={};return{name:"macro",registeredEvents:j,canHandleElement:function(a){return a.hasClass("editor-inline-macro")||a.hasClass("wysiwyg-macro")},handle:function(a){if(!("click"!==a.e.type&&"mouseup"!==a.e.type)){var b=a.containerEl,c=d(b),g,f=[],a=!c.hasClass("editor-inline-macro"),n=c.hasClass("wysiwyg-unknown-macro"),h=[],m={originalHeight:a&&c.height(),anchorIframe:AJS.Rte.getEditorFrame()},l=function(a,c){return a+"-button-click"+(c?
c+".macro":"")+".property-panel"};n||(g=c.attr("data-macro-name"),AJS.MacroBrowser.getMacroMetadata(g)&&(f=AJS.MacroBrowser.getMacroMetadata(g).buttons),a="macro-placeholder-property-panel-edit-button",0<f.length&&"__PROPERTY_PANEL_SPACER"==f[0].key&&(a+=" last"),h.push({className:a,text:"Edit",click:function(){AJS.Confluence.PropertyPanel.destroy();tinymce.confluence.macrobrowser.editMacro(c)}}),d.each(f,function(a,b){if(b.key!="__PROPERTY_PANEL_SPACER"){var e=
"macro-property-panel-"+b.key;a>0&&f[a-1].key=="__PROPERTY_PANEL_SPACER"&&(e=e+" first");a<f.length-1&&f[a+1].key=="__PROPERTY_PANEL_SPACER"&&(e=e+" last");h.push({className:e,text:b.label,parameterName:b.key,click:function(){d(document).trigger(l(b.key),c);d(document).trigger(l(b.key,g),c);AJS.Confluence.PropertyPanel.destroy()}})}}));a="macro-placeholder-property-panel-remove-button";0<f.length&&"__PROPERTY_PANEL_SPACER"==f[f.length-1].key&&(a+=" first");h.push({className:a,text:"Remove",
click:function(){AJS.Confluence.PropertyPanel.destroy();AJS.Rte.getEditor().execCommand("mceConfRemoveMacro",b)}});if(c.attr("data-macro-parameters")){var i=Confluence.MacroParameterSerializer.deserialize(c.attr("data-macro-parameters"));"atlassian-macro-output-type"in i&&(a=function(a){return function(b){i["atlassian-macro-output-type"]=a;c.attr("data-macro-parameters",Confluence.MacroParameterSerializer.serialize(i));a=="INLINE"?d(".macro-placeholder-property-panel-display-newline-button").removeClass("selected"):
d(".macro-placeholder-property-panel-display-inline-button").removeClass("selected");d(b).addClass("selected")}},h.push(null),h.push({className:"macro-placeholder-property-panel-display-newline-button",tooltip:"Display on new line",selected:"BLOCK"==i["atlassian-macro-output-type"],click:a("BLOCK")}),h.push({className:"macro-placeholder-property-panel-display-inline-button",tooltip:"Display inline",selected:"INLINE"==i["atlassian-macro-output-type"],
click:a("INLINE")}))}d.each(j,function(){(!this.macroName||this.macroName==g)&&d(document).bind(l(this.id,this.macroName),this.handler)});a=k;g&&e[g]&&(a=a.concat(e[g]));d.each(a,function(){try{this(b,h,m)}catch(a){AJS.debug("Property panel init handler failed for : "+g+".  Is global handler : "+(AJS.$.inArray(this,k)>-1),a)}});0<h.length&&AJS.Confluence.PropertyPanel.createFromButtonModel("macro",b,h,m)}},registerButtonHandler:function(a,b,c){Array.isArray(a)||(a=[a]);a.forEach(function(a){j.push({id:a,
handler:b,macroName:c})})},registerInitHandler:function(a,b){b?(e[b]=e[b]||[],e[b].push(a)):k.push(a)},yieldButtonFor:function(a,b){var c;d.each(a,function(){this.parameterName&&this.parameterName==b&&(c=this)});return c}}}(AJS.$);AJS.bind("init.rte",function(){AJS.trigger("add-handler.property-panel",AJS.Confluence.PropertyPanel.Macro)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/conftable/editor_plugin_src.js' */
(function(e){tinymce.create("tinymce.plugins.ConfluenceTablePlugin",{init:function(g){!tinymce.isIE8&&g.onKeyDown.add(function(d,b){if(b.altKey&&!(38!=b.keyCode&&40!=b.keyCode)){var c=d.selection.getRng(!0),a=e(c.startContainer).closest("td.confluenceTd, th.confluenceTh",".mceContent");if(0!==a.length){d.execCommand(38==b.keyCode?"mceTableInsertRowBefore":"mceTableInsertRowAfter");var a=a.parent()[38==b.keyCode?"prev":"next"]().find("td:first-child")[0],f=e(a);f.hasClass("numberingColumn")&&(a=f.next()[0]);
c.setStart(a,0);c.setEnd(a,0);d.selection.setRng(c);return tinymce.dom.Event.prevent(b)}}})},getInfo:function(){return{longname:"Confluence Table Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("conftable",tinymce.plugins.ConfluenceTablePlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/deletecommand/editor_plugin_src.js' */
(function(d){tinymce.create("tinymce.plugins.DeleteCommandPlugin",{init:function(b){b.addCommand("mceDelete",function(e,f){(function(){if(tinymce.isWebKit){var a=b.selection.getRng(1);if(a.collapsed)return!1;var c=d(a.startContainer).closest(".wysiwyg-macro-body",b.getBody())[0];if(c&&AJS.EditorUtils.isRangeAtStartOf(c,a)&&AJS.EditorUtils.isRangeAtEndOf(c,a))return a=d(c.firstChild).is("pre")?"pre":"p",a=d("<"+a+"><br data-mce-bogus='1'></"+a+">")[0],d(c).html(a),b.selection.select(a,1),!0}return!1})()||
b.getDoc().execCommand("Delete",e,f)})},getInfo:function(){return{longname:"Delete Command Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("deletecommand",tinymce.plugins.DeleteCommandPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/draggable/editor_plugin_src.js' */
(function(g){function E(a){if(1==a.which&&a.target==a.currentTarget)if(d)q(a);else{d=g(a.target);f.selection.select(a.target);a.preventDefault();h.bind({"mousemove.moveable-zone":F,"mouseup.moveable-zone":q,"keydown.moveable-zone":G,"mouseover.moveable-zone":k});var b=d.offset();t=a.pageX;u=a.pageY;y=b.top-u;z=b.left-t;r=!0;a=d;l=a.attr("style")||"";d=a}}function G(a){27==a.keyCode&&(j.cancelScrolling(),h.unbind(".moveable-zone"),f.undoManager.undo(),f.selection.select(d[0]),f.selection.collapse(!1),
d=null)}function k(){h.find(".mceSelected").removeClass("mceSelected")}function F(a){var b;if(r){b=Math.abs(t-a.pageX);var e=Math.abs(u-a.pageY);if(b<A&&e<A)return;AJS.Rte.BookmarkManager.storeBookmark();f.undoManager.beforeChange();f.undoManager.typing=!0;f.undoManager.add();(b=f.selection.getSel())&&b.removeAllRanges&&b.removeAllRanges();d.css({position:"absolute",width:d.css("width"),"max-width":"50%"});AJS.Confluence.PropertyPanel.current&&AJS.Confluence.PropertyPanel.destroy();d.detach();AJS.Rte.Cursor.fixCursorTargets(AJS.Rte.getEditor().getBody());
m.append(d);var n=d,o=function(){return h.find("#move-indicator")},q=function(a,b){var c=g(h[0].elementFromPoint(a,b)),i=!0;if(c.is(s)&&"move-indicator"!==c.attr("id")&&!(c.is("td.wysiwyg-macro-body")&&"PLAIN_TEXT"===c.closest("table").attr("data-macro-body-type")||c.is("img")&&!n.is("img"))){i=c;if(c.is("img")){var d;d=c.offset();d=a+h.scrollLeft()-d.left;c=c.width()}else d=v(c,b),c=c.height();c=d<c/2;return{target:i,before:c}}if(k?c.is(B):c.is(C)){c=c.is("div.cell")?c.children("div.innerCell").first():
c;if(0>v(c.children().first(),b))c=c.children().first();else{d=c.children().last();i=v(d,b);d=d.height();if(0<i-d)c=c.children().last();else{if(0<o().length&&0<o().parent(c).length)return null;i=c;c=n.parent(s);c.length||(c=i.find(s).last());c.length||(c=m.find(s).last())}i=!1}return{target:c,before:i}}return null},v=function(a,d){var c=a.offset();return d+h.scrollTop()-c.top},k=!!m.children(".contentLayout,.contentLayout2").length;p={positionNear:function(a,d){var c;if(c=q(a,d)){var b=c.target;c=
c.before;if("move-indicator"!==b.attr("id")){var e=o();if(!b.is(D)||!b.find(e).length){e.length?e.detach():e=g('<span id="move-indicator">|</span>');if(b.is(D)){var n=b.children().first();n.is(H)&&(b=n)}!b.is("img")&&AJS.Rte.Cursor.isTextContainerEmpty(b[0])?b.prepend(e):b.is(I)?c?b.prepend(e):b.append(e):c?b.before(e):b.after(e)}}}},replaceWith:function(b){var a=o();if(a.length){var c;if(c=b.is(J))c=a.parent(),c=k?c.is(B):c.is(C);c&&(b=g("<p></p>").append(b));a.replaceWith(b);AJS.Rte.showElement(b);
f.selection.select(b[0]);f.selection.collapse(!0)}else AJS.debug("No cursor - abort drop"),f.undoManager.undo();AJS.Rte.Cursor.fixCursorTargets(AJS.Rte.getEditor().getBody())},destroy:function(){var b=o();b.length&&(b.remove(),AJS.Rte.Cursor.fixCursorTargets(AJS.Rte.getEditor().getBody()))}};r=!1}a.preventDefault();d.hide();var e=a.clientY,l;b=w.length;e=Math.max(e,0);e<b?j.scrollUp(w[e]):(l=x.height(),e=Math.max(0,l-e),e<b?j.scrollDown(w[e]):j.cancelScrolling());p.positionNear(a.clientX,a.clientY);
b=Math.min(a.pageY+y,j.scrollHeight()-d.outerHeight());d.css({top:b,left:a.pageX+z,opacity:0.5});d.show()}function q(a){h.unbind(".moveable-zone");j.cancelScrolling();r?d=null:(a.preventDefault(),d.detach(),d.attr("style",l),p.replaceWith(d),p.destroy(),p=d=null,k(),f.undoManager.add())}if(!(g.browser.msie&&8>=g.browser.version)){var J="img",A=10,f,x,h,m,y,z,t,u,d,l,r,j,p,w=[800,800,400,400,400,300,300,300,300,300,300,300,300,300,300,200,200,200,200,200,200,200,200,200,200,200,200,200,200,200,100,
100,100,100,100,100,100,100,100,100,100,100,100,100,100],B="div.innerCell,div.cell",C="body",s="p,h1,h2,h3,h4,h5,h6,blockquote,li,td,th,img",D="li,td,th",H="p,h1,h2,h3,h4,h5,h6,blockquote",I="li,td,th";tinymce.create("tinymce.plugins.draggable",{init:function(a){f=a;a.onInit.add(function(){x=g(a.getWin());h=g(a.getDoc());m=g(a.getBody());g(x[0].parent);var b=g.browser.webkit?m:h.find("html"),d=0;j={scrollUp:function(a){d!==-a&&(d=-a,a=1E3*(b.scrollTop()/a),b.stop(!1,!1),b.animate({scrollTop:0},{duration:a}))},
scrollDown:function(a){var f;d!==a&&(d=a,f=b[0].scrollHeight,a=1E3*((f-b.scrollTop())/a),b.stop(!1,!1),b.animate({scrollTop:f},{duration:a}))},cancelScrolling:function(){d=0;b.stop(!0,!1)},scrollHeight:function(){return b[0].scrollHeight}};h.delegate("img.confluence-embedded-image,img.editor-inline-macro,table.wysiwyg-macro",{mousedown:E})})},getInfo:function(){return{longname:"Draggable objects (images, tables, placeholders) around the document via drag and drop",author:"Atlassian",authorurl:"http://www.atlassian.com",
version:"1.0"}}});tinymce.PluginManager.add("draggable",tinymce.plugins.draggable)}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'editor/atlassian-editor.js' */
(function(c){function h(a){a=a&&a.jquery?a[0]:a;if(!a)return!1;if("BR"===a.tagName||3==a.nodeType)a=a.parentNode;a&&9==a.nodeType&&(a=null);return a}var f=parseInt(c.browser.version,10);AJS.Rte=c.extend({HIDDEN_CHAR:"\ufeff",ZERO_WIDTH_WHITESPACE:"&#x200b;",editorId:"wysiwygTextArea",isQuickEdit:!1,getEditor:function(){return tinyMCE.activeEditor},getCurrentBaseUrl:function(){if(!this.currentBaseUrl){var a=document.location;this.currentBaseUrl=a.protocol+"//"+a.hostname+(a.port?":"+a.port:"")}return this.currentBaseUrl},
showSelection:function(a){AJS.Rte.showElement(tinyMCE.activeEditor.selection.getStart(),a)},isAnyPartShown:function(a){a=h(a);if(!a)return AJS.debug("AJS.Rte.isAnyPartShown: no element to find"),!1;var b=c(a),a=b.offset().top,b=a+b.outerHeight(),d=c(AJS.Rte.getEditor().getDoc()).scrollTop(),e=d+c(AJS.Rte.getEditorFrame()).height();return b>d&&a<e},showElement:function(a,b){var d=h(a);if(!d)return AJS.log("AJS.Rte.showElement: no element to show - skipping"),!1;var e=c(d),d=AJS.Rte.getEditor(),g=c(d.getDoc()),
d=e.offset().top,e=d+e.outerHeight(),g=g.scrollTop(),f=g+c(AJS.Rte.getEditorFrame()).height(),i=function(){AJS.Rte.bindScroll("AJS.Rte.showElement",function(){AJS.Rte.unbindScroll("AJS.Rte.showElement");setTimeout(b,1)})};d<g?(AJS.Rte.scrollTo(d),b&&i()):e>f?(AJS.Rte.scrollTo(Math.min(d,g+e-f)),b&&i()):b&&b()},scrollTo:function(a){var b=AJS.Rte.getEditor(),a=Math.ceil(a);c(b.getDoc()).scrollTop(a)},bindScroll:function(a,b){var d=AJS.Rte.getEditor();c(document).add(d.getDoc()).add(d.getWin()).bind("scroll."+
a,b)},unbindScroll:function(a){var b=AJS.Rte.getEditor();c(document).add(b.getDoc()).add(b.getWin()).unbind("scroll."+a)},getMainEditor:function(){var a=tinymce.EditorManager.editors[AJS.Rte.editorId];if(!a)throw Error("Main editor has not been initialised yet and is therefore not accessible via tinymce.EditorManager.editors");return a},getEditorContainer:function(){return c("#wysiwyg")},getEditorFrame:function(){return c("#"+AJS.Rte.getEditor().id+"_ifr")[0]},getEditorTable:function(){return c("#"+
AJS.Rte.getEditor().id+"_tbl")},webResourcePath:"/download/resources/com.atlassian.confluence.tinymceplugin%3Atinymceeditor/",getResourceUrlPrefix:function(){this.resourceUrlPrefix||(this.resourceUrlPrefix=this.getCurrentBaseUrl()+AJS.Meta.get("editor-plugin-resource-prefix"));return this.resourceUrlPrefix},getTinyMceBaseUrl:function(){this.absoluteUrl||(this.absoluteUrl=this.getResourceUrlPrefix()+this.webResourcePath+"tinymcesource/");return this.absoluteUrl},getMinEditorHeight:function(){return+AJS.Meta.get("min-editor-height")},
getTinyMceEditorMinHeight:function(a){var a=a||0,b=AJS.Rte.getMinEditorHeight(),d=0;if(b)return b;c("#editor-precursor,#header-precursor,#header").each(function(){d+=c(this).outerHeight(!0)});return c(window).height()-d-a},fixEditorFocus:function(){AJS.log("WARNING: The fixEditorFocus method has been deprecated and it will be removed in an upcoming Confluence release.");if(tinyMCE.isGecko&&!isNaN(f)&&30>f){var a=AJS.Rte.getEditor().getBody();AJS.log("Fixing FF cursor positioning");"true"==a.contentEditable&&
(a.contentEditable=!1,a.contentEditable=!0)}},editorFocus:function(a){if(a&&!a.destroyed){var b;b=a.dom.getRoot();tinymce.isWebKit&&!c(b).parents("body").length&&(b=c(a.getBody()).find("p:first-child")[0]);b?(a.selection.select(b,1),a.selection.collapse(1),b.focus()):AJS.log("editorFocus was called with an invalid node");a.getBody().focus();a.getWin().focus()}}},AJS.Rte);tinymce.VK=jQuery.extend({BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,
META:91},tinymce.VK)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'editor/atlassian-editor-content.js' */
(function(f){AJS.Rte.Content={offset:function(a){var a=f(a).offset(),c=f(AJS.Rte.getEditorFrame()),d=c.offset(),b=c[0].contentWindow.document,e=f(AJS.Rte.getEditor().getBody()),c=jQuery.support.boxModel&&b.documentElement.scrollTop||e.scrollTop(),b=jQuery.support.boxModel&&b.documentElement.scrollLeft||e.scrollLeft();return{top:a.top-c+d.top,left:a.left-b+d.left}},getSelectedText:function(){var a=AJS.Rte.getEditor().selection;return a.getRng().text||a.getSel()&&a.getSel().toString&&a.getSel().toString()||
""},setHtml:function(a){a&&AJS.Rte.getEditor().setContent(a)},getHtml:function(){return""+AJS.Rte.getEditor().getContent()},isEmpty:function(){var a=AJS.Rte.getEditor().getContent().replace("&nbsp;"," ");return!AJS.$.trim(a)},editorHasContentChanged:function(){return AJS.Rte.getEditor().isDirty()},editorResetContentChanged:function(){AJS.Rte.getEditor().setDirty(!1)},getChildIndex:function(a,c){for(var d=a.childNodes,b=0,e=d.length;b<e;b++)if(d[b]==c)return b;return-1}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'bookmark/atlassian-editor-bookmark-manager.js' */
(function(){var b;AJS.Rte.BookmarkManager={storeBookmark:function(){var a=tinyMCE.activeEditor,c=tinyMCE.DOM.getViewPort(tinyMCE.activeEditor.getWin());a.focus();a=a.selection.getRng();a=a.cloneRange&&"function"==typeof a.cloneRange?a.cloneRange():a.duplicate&&a.duplicate()||a;b={scrollX:c.x,scrollY:c.y,range:a}},restoreBookmark:function(){var a=tinyMCE.activeEditor.selection,c=tinyMCE.activeEditor.getWin();b&&(c.scrollTo(b.scrollX,b.scrollY),c.focus(),a.setRng(b.range))}}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'support/atlassian-editor-support.js' */
(function(){AJS.Rte.Support={inlineTasks:function(){var a=AJS.Meta.get("use-inline-tasks");return"true"===a||!0===a}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'event/tinyMce-eventDelegator.js' */
AJS.Rte.EventDelegator=function(h){var c={},f={},i=function(d,b){var a,e;for(e in c)if(c.hasOwnProperty(e)&&c[e].isEnabled)for(var g=0,f=c[e].events.length;g<f;g++)a=c[e].events[g],-1<a.type.toLowerCase().indexOf(b.type)&&(a.shouldTrigger(d,b)?a.callback.apply(this,[b.target]):a.missed&&a.missed())};return{addEventsForComponent:function(d,b){d in c||(c[d]={},c[d].events=[],c[d].isEnabled=!0);for(var a=0,e=b.length;a<e;a++)b[a].type in f||(f[b[a].type]=!0,h[b[a].type].add(i)),"function"!=typeof b[a].shouldTrigger&&
function(c){b[a].shouldTrigger=function(a,b){return b.target.tagName.toLowerCase()==c}}(b[a].shouldTrigger),c[d].events.push(b[a])},disableEventsForComponent:function(d){for(var b=0,a=c.length;b<a;b++)if(d in c)return c[d].isEnabled=!1,!0;return!1},enableEventsForComponent:function(d){for(var b=0,a=c.length;b<a;b++)if(d in c)return c[d].isEnabled=!0;return!1}}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'oninit/tinymce-cursor-fixes.js' */
(function(g){function j(a){if(0==g(a).closest("td").length)return!0;for(a=a.parentNode;"td"!=a.nodeName.toLowerCase();){if(g(a).prevAll().contents().filter(function(){return 3==this.nodeType}).length)return!1;a=a.parentNode}return!0}function k(a,b,e){if(b.compareEndPoints)return a=a.getBody().createTextRange(),a.moveToElementText(e),a.collapse(1),0===b.compareEndPoints("StartToStart",a)&&j(e);if(!a.selection.getSel().isCollapsed)return!1;e=b.startContainer;if(3==e.nodeType)return!e.previousSibling&&
0===b.startOffset&&j(e);if(g(e).is("p:first-child"))return 0===b.startOffset;if(g(e).is(".wysiwyg-macro-body"))return 1==b.startOffset&&3==b.startContainer.childNodes[0].nodeType&&"\n"==b.startContainer.childNodes[0].nodeValue}function i(a,b,e){if(b.compareEndPoints)return a=a.getBody().createTextRange(),a.moveToElementText(e),a.collapse(0),0===b.compareEndPoints("EndToEnd",a);if(!a.selection.getSel().isCollapsed)return!1;e=b.endContainer;return 3==e.nodeType?e.wholeText.length==b.endOffset:g(e.childNodes[b.endOffset]).is(":last-child")}
function h(a,b,e){var c=a.dom.create("p",0,tinymce.isIE?"&nbsp;":'<br data-mce-bogus="1" />');e?b.after(c):b.before(c);a.selection.select(c,!0);a.selection.collapse()}AJS.Rte=AJS.Rte||{};AJS.Rte.Cursor=AJS.Rte.Cursor||{};g.extend(AJS.Rte.Cursor,{insertParagraph:h,isCursorAtStart:k,isCursorAtEnd:i});AJS.bind("init.rte",function(){var a=AJS.Rte.getEditor();tinymce.isIE&&a.onKeyPress.add(function(b,a){var c=b.selection,d=c.getNode();if(13==a.keyCode&&"P"==d.nodeName&&b.dom.is(d,":first-child")&&tinymce.confluence.MacroUtils.isInMacro(d)){var f=
b.dom.create("p","&#x200b");b.dom.insertAfter(f,d);c.select(f,1);c.collapse();return tinymce.dom.Event.cancel(a)}});tinymce.isGecko&&a.onKeyPress.add(function(b,a){var c,d,f;a.charCode==g.ui.keyCode.SPACE&&(c=b.selection.getNode(),d=g(c).closest("a"),f=b.selection.getRng(),d.length&&i(b,b.selection.getRng(),c)&&(f.setStartAfter(d[0]),f.setEndAfter(d[0]),b.selection.setRng(f),b.selection.collapse()))});a.onKeyPress.addToTop(function(b,a){if(13==a.keyCode&&!a.shiftKey){var c=b.selection.getNode(),d=
g(c).closest("pre");if(d.length&&!tinymce.confluence.MacroUtils.isInMacro(d)&&i(b,b.selection.getRng(),c))return h(b,d,!0),tinymce.dom.Event.cancel(a);d=g(c).closest("blockquote");if(d.length){var f=g(c).closest("p");if(f.is(":first-child")&&k(b,b.selection.getRng(),c))return h(b,d,!1),tinymce.dom.Event.cancel(a);if(c=f.is(":last-child"))c=f.contents(),c=!c.length||1==c.length&&(c.is("br")||"&nbsp;"==c.html()||160==c.text().charCodeAt(0)||3==c[0].nodeType&&c[0].nodeValue==AJS.Rte.HIDDEN_CHAR)?!0:
!1;if(c)return b.dom.remove(f[0],!1),h(b,d,!0),tinymce.dom.Event.cancel(a)}}return!0})})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/highlightnode/editor_plugin_src.js' */
(function(b){tinymce.create("tinymce.plugins.ShowCurrentNode",{init:function(f){AJS.debug("Hightlight Current Node Plugin");var h="strong em u s sub sup a code h1 h2 h3 h4 h5 h6 pre".split(" "),e={strong:"Bold",em:"Italic",u:"Underline",s:"Strikethrough",sub:"subscript",sup:"superscript"};f.onNodeChange.add(function(a,c,d){c=b(d);$oldCurrentElement=b(".highlight-marker",a.getBody());a=-1!=b.inArray(d.nodeName.toLowerCase(),h)&&!(d.nodeName.toLowerCase()in e&&!a.queryCommandState(e[d.nodeName.toLowerCase()]))&&
!(!(d.nodeName.toLowerCase()in e)&&!a.formatter.match(d.nodeName.toLowerCase()));if(!c.hasClass("highlight-marker")||!a)$oldCurrentElement&&$oldCurrentElement.removeClass("highlight-marker"),a&&c.addClass("highlight-marker")});var g=function(a){$highlightedElement=b(".highlight-marker",a);$highlightedElement.each(function(){b(this).removeClass("highlight-marker")})};b(document).bind("mode-changed",function(a,c){"preview"===c&&g(b("iframe").contents().find("#content"))});f.onSaveContent.add(function(a,
c){$content=b("<div>"+c.content+"</div>");g($content);c.content=$content[0].innerHTML})},getInfo:function(){return{longname:"Atlassian Show Current Node",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});AJS.DarkFeatures.isEnabled("highlightnode")&&tinymce.PluginManager.add("highlightnode",tinymce.plugins.ShowCurrentNode)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/iosediting/editor_plugin_src.js' */
(function(a){tinymce.create("tinymce.plugins.iOSEditing",{init:function(){tinymce.isIDevice&&setTimeout(function(){a(AJS.Rte.getEditor().getBody()).addClass("ios")},0)},getInfo:function(){return{longname:"iOS Comments Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("iosediting",tinymce.plugins.iOSEditing)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/overrides/DOMUtils.js' */
(function(d){d.prototype.getRoot=function(){var a=AJS.Rte.getEditor(),c=a.dom,b=c.settings;if(!(b=b&&c.get(b.root_element)))a=$(a.selection.getNode()).closest("div.innerCell"),b=0<a.length?a[0]:c.doc.body;return b};d.prototype.setRoot=function(a){AJS.Rte.getEditor().dom.settings.root_element=a}})(tinymce.dom.DOMUtils);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'toolbar/toolbar-configuration-manager.js' */
(function(e){AJS.Confluence._ToolbarConfigurationManager=function(c){var d={Formatting:".rte-toolbar-group-formatting",Style:".rte-toolbar-group-style",Indentation:".rte-toolbar-group-indentation",Lists:".rte-toolbar-group-lists",Tasks:".rte-toolbar-group-task-lists",Justification:".rte-toolbar-group-justification",Links:".rte-toolbar-group-link",Table:".rte-toolbar-group-table",Insert:".rte-toolbar-group-insert",Undo:".rte-toolbar-group-undo",PageLayouts:"#page-layout-2-group",SearchReplace:".rte-toolbar-group-searchreplace",
Help:".rte-toolbar-group-help"};return{configureToolbar:function(a){if(!1===a)c.hide();else{var a=a||{},b;for(b in a)a.hasOwnProperty(b)&&d[b]&&!1===a[b]&&e(d[b],c).hide()}}}}})($);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'loader/tinymce-bootstrap.js' */
(function(b,j){var h={atlassian:!0,keep_values:!0,convert_urls:!0,relative_urls:!1,remove_script_host:!1,button_tile_map:!0,gecko_spellcheck:!0,apply_source_formatting:!1,list_outdent_on_enter:!0,visual:!1,confluence_table_style:"confluenceTable",confluence_table_cell_style:"confluenceTd",confluence_table_heading_style:"confluenceTh",confluence_table_default_rows:4,confluence_table_default_cols:3,confluence_table_default_heading:!0,cleanup:!0,cleanup_on_startup:!0,fix_list_elements:!1,fix_table_elements:!0,
valid_elements:"@[id|class|style|title|wysiwyg|dir<ltr?rtl|lang|xml::lang|onclick|ondblclick|onmousedown|onmouseup|onmouseover|onmousemove|onmouseout|onkeypress|onkeydown|onkeyup],a[*],strong/b,em/i,s,u,#p[align|user],-ol[type|compact],-ul[type|compact],li,br,img[imagetext|longdesc|usemap|src|border|alt=|title|hspace|vspace|width|height|align],-sub,-sup,-blockquote[cite|markup],-table[*],-tr[rowspan|width|height|align|valign|bgcolor|background|bordercolor],tbody,thead,tfoot,#td[colspan|rowspan|width|height|align|valign|bgcolor|background|bordercolor|scope],#th[colspan|rowspan|width|height|align|valign|scope],caption,div[*],#span[*],-code,#pre[*],address,-h1,-h2,-h3,-h4,-h5,-h6,hr[size|noshade],-font[face|size|color],dd,dl,dt,cite,abbr,acronym,del[datetime|cite],ins[datetime|cite],object[classid|width|height|codebase|*],param[name|value],embed[type|width|height|src|*],map[name],area[shape|coords|href|alt|target],bdo,button,col[align|char|charoff|span|valign|width],colgroup[align|char|charoff|span|valign|width],dfn,fieldset,form[action|accept|accept-charset|enctype|method],input[accept|alt|checked|disabled|maxlength|name|readonly|size|src|type|value],kbd,label[for],legend,noscript,optgroup[label|disabled],option[disabled|label|selected|value],q[cite],samp,select[disabled|multiple|name|size],small,textarea[cols|rows|disabled|name|readonly],tt,var,big",
extended_valid_elements:"img[*],time[class|datetime|contenteditable|onselectstart|unselectable|oncontrolselect]",formats:{removeformat:[{selector:"h1,h2,h3,h4,h5,h6,pre",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0,block:"*"},{selector:"address,article,b,big,blockquote,center,cite,code,date,dd,del,dfn,dl,dt,em,embed,font,footer,header,hgroup,i,ins,kbd,link,menu,nav,object,param,q,s,samp,script,section,small,strike,strong,style,sub,sup,time,tt,u,var",remove:"all",split:!0,expand:!1,block_expand:!0,
deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"table",attributes:["cellpadding","cellspacing","border"],split:!1,expand:!1,deep:!0},{selector:"*",attributes:["style","color","bgcolor","title","lang"],split:!1,expand:!1,deep:!0}]},forced_root_block:"p",force_p_newlines:!0,force_br_newlines:!1,oninit:"AJS.Rte.BootstrapManager.onInit",object_resizing:!1,paste_preprocess:function(a,c){b(document).trigger("prePaste",[a,c])},paste_postprocess:function(a,
c){b("img",c.node).not("[data-emoticon-name]").not(".editor-inline-macro").not(".confluence-embedded-image").not(".template-variable").addClass("confluence-embedded-image confluence-external-resource");b(document).trigger("postPaste",[a,c])}};AJS.Rte.BootstrapManager={_tinyMceHasInit:!1,_beforeInitCallbacks:[],_tinymcePluginInits:[],_settings:null,isInitComplete:function(){return this._tinyMceHasInit},isEditorActive:function(){return this.isInitComplete()&&tinyMCE&&tinyMCE.activeEditor},onInit:function(){this._tinyMceHasInit=
!0;var a=AJS.Rte.getEditor();AJS.trigger("init.rte",{editor:a});!1!==AJS.Meta.get("editor-auto-focus")?AJS.Rte.editorFocus(a):AJS.debug("Bootstrap: editor-auto-focus=false. Do not focus the editor automatically.")},addOnInitCallback:function(a){if(b.isFunction(a))this._tinyMceHasInit?a():AJS.bind("init.rte",a);else throw Error("Attempt made to register an oninit callback that is not a function. Received: "+a);},addBeforeInitCallback:function(a){this._beforeInitCallbacks.push(a)},addTinyMcePluginInit:function(a){this._tinymcePluginInits.push(a)},
preInitialise:function(a){this._settings=b.extend(h,a)},initialise:function(a){if(this._settings){var a=b.extend({},a),c=b.extend({},this._settings);AJS.Rte.isQuickEdit=a.isQuickEdit||!1;AJS.debug("Bootstrap:initialise: Initialising TinyMce version "+tinymce.majorVersion+"."+tinymce.minorVersion);b.each(this._beforeInitCallbacks,function(a,b){b(c)});for(var d=0,e=this._tinymcePluginInits.length;d<e;d++)if("function"==typeof this._tinymcePluginInits[d])this._tinymcePluginInits[d](c);d=c.language;AJS.debug("Bootstrap: set locale translations");
void 0==typeof TinyMCELang&&AJS.log("ERROR: could not find the TinyMCE language pack");var h=RegExp(TinyMCELang.ctrl_key+"\\+","g"),k=RegExp(TinyMCELang.shift_key+"\\+","g"),i=function(a){return a.replace(h,"\u2318").replace(k,"\u21e7")},f;for(f in TinyMCELang){e=TinyMCELang[f];if("object"==typeof e)for(var g in e)tinymce.isMac&&(e[g]=i(e[g]));tinymce.EditorManager.addI18n(d+"."+f,TinyMCELang[f])}tinymce.isMac&&b("#rte-toolbar .toolbar-item, #rte-toolbar .dropdown-item, #rte-savebar .aui-button").each(function(){var a=
b(this),c=a.attr("title"),d=a.attr("data-tooltip");c&&a.attr("title",i(c));d&&a.attr("data-tooltip",i(d))});(new AJS.Confluence._ToolbarConfigurationManager(b("#toolbar"))).configureToolbar(a.toolbar);f=a.plugins;a=a.excludePlugins;g=c.plugins.split(",");g=j.chain(g).union(f).difference(a).value();a=g.join(",");c.plugins=a;tinyMCE.init(c);AJS.Rte.Content.editorResetContentChanged();b(AJS.Rte.getEditorFrame()).attr("tabindex",100);tinymce.isIE&&b(AJS.Rte.getEditorFrame()).attr("hidefocus","hidefocus");
AJS.trigger("rte-ready")}else AJS.log("Bootstrap:initialise: No settings found. Has preInitialise been called?")}}})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/environment.js' */
define("confluence-editor/utils/environment",function(){return{isMac:0<=navigator.platform.indexOf("Mac"),transformCmdKeyTextBasingOnOS:function(a){var b="Ctrl";return this.isMac?a.replace(RegExp(b,"g"),"\u2318"):a}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'utils/editor-utils.js' */
AJS.EditorUtils=function(f){var e={isCursorAtStartOf:function(b,a){return a.collapsed&&e.isRangeAtStartOf(b,a)},isRangeAtStartOf:function(b,a){if(!a||!a.startContainer)throw Error("range is invalid. received: "+a);if(!b||!b.nodeType)throw Error("context is invalid. received: "+b);var c=a.startContainer,d;if(3==c.nodeType){if(0!==a.startOffset)return!1;d=c}else if(d=c.childNodes[a.startOffset],void 0===d&&0<c.childNodes.length)return!1;c=new tinymce.dom.TreeWalker(d,b);do d=c.prev(!0);while(d&&3==
d.nodeType&&0===d.nodeValue.length);return void 0===d},isCursorAtEndOf:function(b,a){return a.collapsed&&e.isRangeAtEndOf(b,a)},isRangeAtEndOf:function(b,a){if(!a||!a.endContainer)throw Error("range is invalid. received: "+a);if(!b||!b.nodeType)throw Error("container is invalid. received: "+b);var c=a.endContainer;if(3==c.nodeType){if(a.endOffset!=c.nodeValue.length)return!1}else c=c.childNodes[0===a.endOffset?a.endOffset:a.endOffset-1];var c=new tinymce.dom.TreeWalker(c,b),d;do d=c.next(!0);while(d&&
3==d.nodeType&&0===d.nodeValue.length);return void 0===d||"BR"==d.nodeName&&void 0===c.next(!0)},setCursorAtStartOfContents:function(b){if(!b)throw Error("element is required.");if(1!==b.nodeType&&3!=b.nodeType)throw Error("invalid argument: expected a DOM element or text node, got: "+b);var a=tinymce.activeEditor,c=a.dom.createRng();f(b).is("br, img")?(c.setStartBefore(b),c.setEndBefore(b),a.selection.setRng(c)):(a.selection.select(b,!0),a.selection.collapse(!0))}};return e}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/table/atlassian-table.js' */
(function(g){function k(){return AJS.$("#table-highlight-group").attr("data-highlight-colour")||""}function n(c){var h,g,d,e;h=0;for(g=c.length;h<g;h++)if(d=c.eq(h),e=d.attr("data-highlight-colour"))d.removeClass("highlight-"+e),d.removeAttr("data-highlight-colour")}function m(c,h){if(c.length){var f=AJS.Rte.getEditor(),d;d=g(AJS.Rte.getEditor().selection.getNode());d=d.length?d[0]===c[0]?!0:!!d.closest(c).length:!1;for(var e=c[0],i=e.ownerDocument.createElement(h),l=e.attributes,j=0,k=l.length;j<
k;j++){var a=l[j];i.setAttribute(a.nodeName,a.nodeValue)}for(;e.hasChildNodes();)i.appendChild(e.firstChild);e.parentNode.replaceChild(i,e);d&&(f.selection.select(i,!0),f.selection.collapse());return g(i)}}AJS.Rte=AJS.Rte||{};AJS.Rte.Table={convertToNormalCells:function(c){c.filter("th").each(function(){var c=g(this),c=m(c,"td");c.removeClass("confluenceTh");c.addClass("confluenceTd")})},convertToHeadingCells:function(c){c.filter("td").each(function(){var c=g(this),c=m(c,"th");c.removeClass("confluenceTd");
c.addClass("confluenceTh")})},areCellsHeadings:function(c){var g=c.filter("th").length;return c.length==g},isColumnHeading:function(c,h){var f=g(c).children("tbody").children("tr");return 1==f.length?!1:f.children().nthCol(h).filter("th").length===f.length},areCellsHighlighted:function(c){var g=c.filter("td[data-highlight-colour],th[data-highlight-colour]");if(c=c.length===g.length)a:{var c=k(),f,d,e;f=0;for(d=g.length;f<d;f++)if(e=g.eq(f).attr("data-highlight-colour")||"",e!==c){c=!1;break a}c=!0}return c},
isColumnHighlighted:function(c,h){var f=g(c).children("tbody").children("tr").children("th,td").nthCol(h),d=f.filter("td[data-highlight-colour],th[data-highlight-colour]").length;if(f.length!==d)return!1;for(var d=f.eq(0).attr("data-highlight-colour"),e=1,i=f.length;e<i;e++)if(d!==f.eq(e).attr("data-highlight-colour"))return!1;return!0}};AJS.bind("init.rte",function(c,h){function f(){var a=e.selection.getNode();return g(a).parents("table").is(".confluenceTable")?!e.dom.getParent(a,"UL,OL"):!1}var d,
e=h.editor,i=function(a){return g(a.selection.getNode()).closest("th.confluenceTh,td.confluenceTd")},l=function(a){var b=g(a.getBody()).find("th.confluenceTh.mceSelected,td.confluenceTd.mceSelected");return b.length?b:i(a)},j=function(a){return 0===a.find("tbody > tr > td").length};e.addCommand("mceInsertTable",function(){AJS.Rte.BookmarkManager.storeBookmark();if(!d){d=new AJS.Dialog({width:400,height:230,id:"insert-table-dialog",keypressListener:function(b){27===b.keyCode&&d.hide()}});d.addHeader("Insert Table");
d.addPanel("Panel 1","panel1");d.getCurrentPanel().html(AJS.renderTemplate("tableForm","4","3"));g("#tinymce-table-form input[type='text']").click(function(){g(this).select()});var a=function(b){b.hide();e.plugins.table.insertTable()};g("#tinymce-table-form").keypress(function(b){13==b.keyCode&&a(d)});d.addButton("Insert",a,"ok");d.addCancel("Cancel",function(b){b.hide();return!1},"cancel")}d.show()});e.addCommand("confTableRowToggleHeading",function(){var a;a=g(this.getBody()).find("td.mceSelected,th.mceSelected");
a.length||(a=g(this.selection.getNode()));a=a.closest("tr");for(var b=a.parent(),b=b.is("tbody")?a.parent().parent():b;0!=a.length&&!b.is(".confluenceTable");)a=b.closest("tr"),b=a.parent(),b=b.is("tbody")?a.parent().parent():b;var b=a.children("td,th"),c=0;AJS.Rte.Table.areCellsHeadings(b)?(j(a.closest("table"))||(b=b.filter(function(){var b=g(this),a=b.closest("table");c+=b.attr("colspan")||1;return!AJS.Rte.Table.isColumnHeading(a,c)})),AJS.Rte.Table.convertToNormalCells(b)):AJS.Rte.Table.convertToHeadingCells(b)});
e.addCommand("confTableColumnToggleHeading",function(){var a;a=l(this);var b=g([]);a.each(function(){var a=g(this),c=a.index()+1,a=a.closest("table.confluenceTable").children("tbody").children("tr");b=b.add(a.children().nthCol(c))});a=b;AJS.Rte.Table.areCellsHeadings(a)?(j(a.closest("table"))||(a=a.filter(function(){var a=g(this).parent("tr").children(),b=a.filter("th");return a.length!==b.length})),AJS.Rte.Table.convertToNormalCells(a)):AJS.Rte.Table.convertToHeadingCells(a)});e.addCommand("confTableSelectionToggleHighlight",
function(a,b){var c=b&&b.alwaysHighlight,e=l(this);e.filter("td");e.filter("th");AJS.Rte.Table.areCellsHighlighted(e)&&!c||AJS.$("#table-highlight-group").attr("data-remove-highlight")?n(e):(n(e),k()&&(c=k(),e.attr("data-highlight-colour",c),e.addClass("highlight-"+c)))});(tinymce.isIE8||!AJS.DarkFeatures.isEnabled("confluence-table-enhancements.auto-row.disabled"))&&e.onKeyDown.add(function(a,b){function c(a,b){var d=e.selection.getRng(!0),g=d.startContainer;if(d.collapsed){var f;a:{for(f=g;f!=a;){if(f[b]){f=
!1;break a}f=f.parentNode}f=!0}return 3==g.nodeType?f&&d.startOffset==("nextSibling"==b?g.length:0):g==a?d.startOffset==("nextSibling"==b?g.childNodes.length-1:0):f}return!1}if((37==b.keyCode||39==b.keyCode)&&!b.shiftKey){var d=i(this);if(d.length){var d=d[0],f;if(f=37==b.keyCode)if(f=c(d,"previousSibling"))f=e.selection.getNode(),f=g(f).parents("table").first().find("tr:first-child").children().first()[0]!=f;if(f)return e.execCommand("mceTableMoveCaretToPrevCell"),tinymce.dom.Event.cancel(b);if(f=
39==b.keyCode){if(d=c(d,"nextSibling"))d=e.selection.getNode(),d=g(d).parents("table").first().find("tr:last-child").children().last()[0]!=d;f=d}if(f)return e.execCommand("mceTableMoveCaretToNextCell"),tinymce.dom.Event.cancel(b)}}});if(tinymce.isWebKit){var m=g('<style type="text/css"></style>').html(".confluenceTable th,td { white-space: pre-wrap; }");g(e.getDoc().head).append(m)}e.onKeyDown.add(function(a,b){if(9==b.keyCode&&f())return e.execCommand(b.shiftKey?"mceTableMoveCaretToPrevCell":"mceTableMoveCaretToNextCell"),
b.preventDefault(),!1});AJS.DarkFeatures.isEnabled("confluence-table-enhancements.auto-row.disabled")||(e.onClick.add(function(){var a=i(this);a.hasClass("numberingColumn")&&!a.hasClass("confluenceTh")&&e.execCommand("mceTableMoveCaretToNextCell")}),e.onKeyDown.addToTop(function(a,b){if((38==b.keyCode||40==b.keyCode)&&f()&&i(this).hasClass("numberingColumn"))return e.execCommand("mceTableMoveCaretToNextCell"),b.preventDefault(),!1}))});if(!AJS.DarkFeatures.isEnabled("confluence-table-enhancements.auto-row.disabled")){var o=
function(){g(AJS.Rte.getEditor().getDoc().body).find(".confluenceTd.numberingColumn").attr("contenteditable","false")};AJS.bind("quickedit.success",o);AJS.bind("init.rte",o)}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/table/atlassian-table-picker.js' */
(function(f){function D(){d.css({top:f("#insert-table-dropdown").outerHeight(!0)});D=function(){}}function i(){if(!d.hasClass("hidden")){var a=f(AJS.Rte.getEditor().getDoc());j.unbind(".atlassian-table-picker");a.unbind(".atlassian-table-picker");d.addClass("hidden");p.addClass("hidden");x.removeClass("active")}}function E(a,b){AJS.debugEnabled()&&AJS.debug("setSize("+[a,b]+")");a==e&&b==q||(a=Math.max(1,Math.min(F,a)),b=Math.max(1,Math.min(G,b)),m=Math.max(M,a),r=Math.max(N,b),e=a,q=b,s.width(m*
k+1),s.height(r*l+O),t(n,m,r),t(y,e,q),t(z,m,1),t(u,e,1),H(),I.text(e+" x "+q))}function H(){z.toggleClass("hidden",!g);u.toggleClass("hidden",!g)}function t(a,b,c){a.width(k*b+1);a.height(l*c+1)}function P(a){var b=n.offset(),c=b.top-j.scrollTop(),f=b.left-j.scrollLeft(),b=c+n.outerHeight(!0)+v,d=b-l-v,g=f+n.outerWidth(!0)+v,i=g-k-v,e=a.clientY,h=a.clientX,a=m,o=r;AJS.debugEnabled()&&AJS.debug("[mouseX,spLeft,spRightShrink,spRightGrow][mouseY,spTop,spBottomShrink,spBottomGrow] = "+[h,f,i,g]+"/"+
[e,c,d,b]);h>g?(c=~~((h-g)/k+1),a+=c,AJS.debugEnabled()&&AJS.debug("grow: xdelta = "+c)):h<i&&(c=~~((h-i)/k-1),a+=c,AJS.debugEnabled()&&AJS.debug("shrink: xdelta = "+c));e>b?(c=~~((e-b)/l+1),o+=c,AJS.debugEnabled()&&AJS.debug("grow: ydelta = "+c)):e<d&&(c=~~((e-d)/l-1),o+=c,AJS.debugEnabled()&&AJS.debug("shrink: ydelta = "+c));E(a,o)}function J(a){AJS.debugEnabled()&&AJS.debug("enableHeading("+a+")");a!=g&&(g=a,H())}function A(a){var b;b=~~(~~(a.offsetX||a.originalEvent.layerX)/k)+1;var c=~~(~~(a.offsetY||
a.originalEvent.layerY)/l)+1;b=1>b||b>F||1>c||c>G?null:{width:b,height:c};a.preventDefault();AJS.debug("insertTable: size = "+(b&&[b.width,b.height]));if(b){i();a=b.width;c=b.height;b=g;var d,e;AJS.debugEnabled()&&AJS.debug("shamefulInsertTable("+a+","+c+","+b+")");d=f("#tinymce-table-form");d.length?(d.find('input[name="rows"]').val(c),d.find('input[name="cols"]').val(a)):(a=AJS.renderTemplate("tableForm",c,a),e=f("<div></div>").addClass("hidden"),e.append(a),K.append(e));f("#table-heading-checkbox").prop("checked",
b);AJS.Rte.BookmarkManager.restoreBookmark();tinymce.activeEditor.undoManager.beforeChange();tinymce.activeEditor.plugins.table.insertTable();e&&e.remove()}}function w(a){AJS.debugEnabled()&&AJS.debug("key: "+a.charCode+"/"+a.keyCode+"/"+a.shiftKey);AJS.debug("key: "+a.charCode+"/"+a.keyCode+"/"+a.shiftKey);f.browser.msie?(16==a.keyCode&&J(!a.shiftKey),27==a.keyCode&&i()):(0==a.charCode&&J(!a.shiftKey),27==a.keyCode&&0==a.charCode&&i())}function Q(){i()}var L={};AJS.Rte.TablePicker={bindToControl:function(){AJS.debugEnabled()&&
AJS.debug("Table Picker - bind to control");j=f(document);K=j.find("body");h=f("#insert-table-dropdown");B=f("#rte-button-insert-table");x=h.find(".aui-dd-parent");d=f("#table-picker-container");s=d.find(".table-picker-box");n=d.find(".picker-cell");z=d.find(".picker-heading");y=d.find(".picker-selected-cell");u=d.find(".picker-selected-heading");I=s.find(".desc");p=f("<div></div>").attr("id","table-picker-backdrop").addClass("hidden").appendTo(h);B.click(function(a){a.preventDefault();C||(AJS.Rte.BookmarkManager.storeBookmark(),
D(),g=!0,E(1,1),a=f(AJS.Rte.getEditor().getDoc()),j.bind("mousemove.atlassian-table-picker",P),j.bind("keydown.atlassian-table-picker",w),j.bind("keyup.atlassian-table-picker",w),a.bind("keydown.atlassian-table-picker",w),a.bind("keyup.atlassian-table-picker",w),p.removeClass("hidden"),d.removeClass("hidden"),x.addClass("active"),B.focus())});p.click(Q);y.click(A);u.click(A)},disable:function(){C=!0;h.addClass("disabled")},enable:function(){C=!1;h.removeClass("disabled")},close:i,_internal:L};var j,
K,p,h,B,x,d,s,n,z,y,u,I,M=4,N=4,F=15,G=20,k=25,l=17,O=20,v=0,m,r,e,q,g,C=!1;L.insertTable=A})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/table/atlassian-table-migration.js' */
(function(d){AJS.Rte.Migration=AJS.Rte.Migration||{};AJS.Rte.Migration.Table={migrateTables:function(b){var b=b||d(AJS.Rte.getEditor().getBody()),f=(new Date).getTime(),e=b.find("td.highlight,th.nohighlight,td[data-highlight-class],th[data-highlight-class]"),b=(new Date).getTime();e.each(function(){var a=d(this),b=a.attr("data-highlight-class"),c;if(a.hasClass("nohighlight"))a.removeClass("nohighlight"),AJS.Rte.Table.convertToNormalCells(a);else if(a.hasClass("highlight")&&(a.removeClass("highlight"),
b||(a.attr("data-highlight-colour","grey"),a.addClass("highlight-grey"))),b){a.removeClass(b);a.removeAttr("data-highlight-class");switch(b){case "warning":c="red";break;case "success":c="green";break;case "note":c="yellow";break;case "info":c="blue"}c&&(a.addClass("highlight-"+c),a.attr("data-highlight-colour",c))}});e=(new Date).getTime();AJS.debug("Migration duration: selector: "+(b-f)+"ms; migration: "+(e-b)+"ms")}};d(document).bind("postPaste",function(){AJS.Rte.Migration.Table.migrateTables()});
AJS.bind("init.rte",function(){AJS.Rte.Migration.Table.migrateTables()})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/placeholder/editor_plugin_src.js' */
(function(e){var n={click:!1,keypress:!0},f=tinymce.VK,h=tinymce.dom.Event,o="template"===AJS.Meta.get("content-type"),k={UL:!0,OL:!0,LI:!0,TABLE:!0,TBODY:!0};tinymce.create("tinymce.plugins.TextPlaceholderPlugin",{init:function(i){i.onInit.add(function(){if(o)AJS.trigger("cursor-target-refresh"),e("#rte-button-insert-placeholder").click(function(b){b.preventDefault();AJS.Rte.Placeholder.insertTextPlaceHolder()}),i.onKeyPress.addToTop(function(b,c){if(13==c.keyCode&&!c.shiftKey){var a=b.selection.getNode(),
d=e(a).closest(".text-placeholder");if(d.length&&AJS.Rte.Cursor.isCursorAtEnd(b,b.selection.getRng(),a))return AJS.Rte.Cursor.insertParagraph(b,d,!0),tinymce.dom.Event.cancel(c)}});else{var p=function(){var b=e(AJS.Rte.getEditor().getBody()).find(".text-placeholder.selected");b.length&&AJS.Rte.getEditor().selection.select(b[0])},j=function(b){b.onKeyDown.remove(l);b.onKeyPress.remove(g);b.onClick.remove(g)},l=function(b,c){var a=e(b.getBody()).find(".text-placeholder.selected");if(a.length){if(c.keyCode===
f.LEFT||c.keyCode===f.UP){for(var a=a[0],d=a.previousSibling;a&&!d;)a=a.parentNode,d=a.previousSibling;if(d){for(a=d;k[a.nodeName]&&a.lastChild;)a=a.lastChild;b.selection.select(a.lastChild||a);b.selection.collapse(!1);b.selection.normalize()}return h.cancel(c)}if(c.keyCode===f.RIGHT||c.keyCode===f.DOWN){a=a[0];for(d=a.nextSibling;a&&!d;)a=a.parentNode,d=a.nextSibling;if(d){for(a=d;k[a.nodeName]&&a.firstChild;)a=a.firstChild;b.selection.select(a.firstChild||a);b.selection.collapse(!0);b.selection.normalize()}return h.cancel(c)}if(c.keyCode===
f.BACKSPACE||c.keyCode===f.DELETE)return AJS.Rte.Placeholder.removePlaceholder(a),h.cancel(c)}else j(b)},g=function(b,c){if(!tinymce.isGecko||c.isChar||"keypress"!==c.type){var a=e(b.getBody()).find(".text-placeholder.selected");if(a.length){if(a.length){var d=a.attr("data-placeholder-type"),f=c.type,g=AJS.Rte.Placeholder.getPlaceholderType(d);e.extend({},n,g&&g.activation)[f]&&(AJS.Rte.Placeholder.removePlaceholder(a),AJS.trigger("editor.text-placeholder.activated",{placeholderType:d||"",triggerEvent:c}))}}else j(b)}};
i.onNodeChange.addToTop(function(b,c,a){c=e(a).closest(".text-placeholder");e(b.getBody()).find(".text-placeholder.selected").not(c).removeClass("selected");c.length?(c.hasClass("selected")||(c.addClass("selected"),b.onKeyDown.addToTop(l),b.onKeyPress.addToTop(g),b.onClick.addToTop(g)),setTimeout(p,0)):j(b)})}var m=e(AJS.Rte.getEditor().getDoc()).find("head");e.browser.msie?m.append('<style type="text/css">.wiki-content .text-placeholder { display: inline; }</style>'):m.append('<style type="text/css">.wiki-content .text-placeholder { display: inline-block; }</style>')})},
getInfo:function(){return{longname:"Text Placeholder Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("textplaceholders",tinymce.plugins.TextPlaceholderPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/placeholder/placeholder.js' */
(function(f){var d=[],c={};AJS.Rte=AJS.Rte||{};AJS.Rte.Placeholder=AJS.Rte.Placeholder||{};var e,g;tinymce.isIE?(e="\ufeff{$caret}",g="<p>{$caret}</p>"):g=e=tinymce.isWebKit?"\ufeff{$caret}<br>":"\ufeff{$caret}";f.extend(AJS.Rte.Placeholder,{insertTextPlaceHolder:function(a){var b=f("<div></div>").append(AJS.Rte.Placeholder.Templates.textPlaceholder({content:e}));a&&b.find(".text-placeholder").html(a);AJS.Rte.getEditor().execCommand("mceInsertContent",false,b.html())},removePlaceholder:function(a){var b=
AJS.Rte.getEditor(),d=f(b.getBody()),c=e;a.parent()[0].nodeName==="LI"&&(c=g);a.replaceWith('<span id="placeholder-cursor">&nbsp;</span>');a=d.find("#placeholder-cursor")[0];b.selection.select(a.firstChild);b.execCommand("mceInsertContent",false,c);b.dom.remove(a,true)},addPlaceholderType:function(a){if(!a||!a.type)AJS.log("PlaceHolderRegister : unable to register new place holder type !");else{d.push(a);c[a.type]=a}},getPlaceholderTypes:function(){return[].concat(d)},getPlaceholderType:function(a){return c[a]}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/placeholder/tinyMce-property-panel-text-placeholders.js' */
(function(f){AJS.Confluence.PropertyPanel.TextPlaceholder={name:"textplaceholder",canHandleElement:function(a){return a.hasClass("text-placeholder")},handle:function(a){function g(a,b,c){return{className:"text-placeholder-property-panel-type-item text-placeholder-property-panel-type-"+a,text:b,tooltip:c,selected:h===a,click:function(){"default"===a?d.removeAttr("data-placeholder-type"):d.attr("data-placeholder-type",a);var b=f(".text-placeholder-property-panel-type-"+a);b.parent().find(".text-placeholder-property-panel-type-item").removeClass("selected");
b.addClass("selected")}}}if(!("click"!=a.e.type&&"mouseup"!=a.e.type)){var i=AJS.Rte.Placeholder.getPlaceholderTypes(),a=a.containerEl,d=f(a),h=d.attr("data-placeholder-type"),c=[],b=g("default","Text","Instructional text is replaced with empty content when a person types.");b.selected=!h;c.push(b);for(var e=0,j=i.length;e<j;e++)b=i[e],c.push(g(b.type,b.label,b.tooltip));c.push(null);c.push({className:"text-placeholder-property-panel-remove-button",
text:"Remove",click:function(){AJS.Confluence.PropertyPanel.destroy();AJS.Rte.Placeholder.removePlaceholder(d)}});AJS.Confluence.PropertyPanel.createFromButtonModel("textplaceholder",a,c,{anchorIframe:AJS.Rte.getEditorFrame()})}}}})(AJS.$);AJS.bind("init.rte",function(){"template"===AJS.Meta.get("content-type")&&AJS.trigger("add-handler.property-panel",AJS.Confluence.PropertyPanel.TextPlaceholder)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/placeholder/placeholder.soy' */
// This file was automatically generated from placeholder.soy.
// Please don't edit this file by hand.

if (typeof AJS == 'undefined') { var AJS = {}; }
if (typeof AJS.Rte == 'undefined') { AJS.Rte = {}; }
if (typeof AJS.Rte.Placeholder == 'undefined') { AJS.Rte.Placeholder = {}; }
if (typeof AJS.Rte.Placeholder.Templates == 'undefined') { AJS.Rte.Placeholder.Templates = {}; }


AJS.Rte.Placeholder.Templates.textPlaceholder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="text-placeholder">', opt_data.content, '</span>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/plugins/imageproperties/js/image-properties-dialog.js' */
Confluence.Editor.ImageProps=function(e){function k(){d||(d=e("#image-properties-tab-items > div").map(function(){var a=e(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,b){return a.weight-b.weight}));return d}function l(){var a=c.popup.element,b=650/60,f=e('<div class="image-properties-loading-blanket"><div class="loading-data"></div></div>').appendTo(a.find(".dialog-page-body")),g=f.find(".loading-data");f.css({width:f.parent().width(),height:a.height()});
g.css({marginTop:-60,marginLeft:-60});g.spin({color:"#666",width:b,radius:25,length:25,top:0,left:0,zIndex:0,speed:1.042});var a=[],h;for(h in i)b=i[h],(b=b.saveFn&&b.saveFn())&&b.done&&a.push(b);e.when.apply(e,a).done(function(){var a=c.popup.element.find(".image-properties-loading-blanket .loading-data");a.css({marginTop:"",marginLeft:""});a.spinStop();a.closest(".image-properties-loading-blanket").remove();c.hide().remove()})}function n(){c.hide().remove()}var c,d,i={},m;return{init:function(){m||
(d=null,0<k().length&&(m=!0,AJS.Confluence.PropertyPanel.Image.pluginButtons.push(null,{create:function(){return{className:"image-properties",text:"Properties",tooltip:"Set additional image properties",click:function(a,b){AJS.trigger("analyticsEvent",{name:"confluence.editor.image-properties-trigger"});AJS.Confluence.PropertyPanel.destroy();e("#image-properties-dialog").remove();c=new AJS.ConfluenceDialog({id:"image-properties-dialog",onSubmit:l});
AJS.trigger("dialog-created.image-properties",{img:b});c.popup.element.attr("data-tab-default","0");c.addHeader("Image Properties");c.addSubmit("Save",l);c.addCancel("Cancel",n);for(var f=c,g=k(),h=0;h<g.length;h++){var d=g[h],j=i[d.key];j&&f.addPanel(d.label,j.content,j.panelClass,d.key)}1===g.length&&f.popup.element.find(".dialog-page-menu").show();AJS.trigger("dialog-before-show.image-properties");
c.show()}}}})))},registerPanel:function(a,b,c,d){i[a]={content:b,panelClass:c,saveFn:d}}}}(AJS.$);AJS.toInit(Confluence.Editor.ImageProps.init);AJS.bind("quickedit.success",Confluence.Editor.ImageProps.init);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'unpublished-changes/unpublished-changes.soy' */
// This file was automatically generated from unpublished-changes.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.UnpublishedChanges == 'undefined') { Confluence.Templates.UnpublishedChanges = {}; }


Confluence.Templates.UnpublishedChanges.lozenge = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a id="unpublished-changes-lozenge" href="#" class="view-diff-link" title="', soy.$$escapeHtml(opt_data.tooltip), '"><span class="aui-lozenge aui-lozenge-complete aui-lozenge-subtle unpublished-changes-lozenge">', soy.$$escapeHtml(opt_data.label), '</span></a>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'unpublished-changes/unpublished-changes.js' */
(function(){tinymce.create("tinymce.plugins.UnpublishedChanges",{init:function(a){var d=$(Confluence.Templates.UnpublishedChanges.lozenge({tooltip:"This page has unpublished changes",label:"Unpublished"})),e=function(b){b=_.isBoolean(b)?b:!0;Confluence.Editor.UI.setButtonState(b,$("#rte-button-publish"))},f=function(b,c){var a=c||function(){};(_.isBoolean(b)?b:1)?d.addClass("visible").fadeIn("fast",a):d.fadeOut("fast",function(){$(this).hide().removeClass("visible");
a()})},c={show:function(){d.hasClass("visible")||f(!0,e)},hide:function(){f(!1);e(!1)}};AJS.bind("rte-ready",function(){var b=$("#content-title-div");c.hide();d.insertBefore(b);d.tooltip();$("#content-title").on("keydown change",c.show);a.onChange.add(c.show);a.onKeyDown.add(c.show);a.onLoad.add(function(){$(a.startContent).text().trim()&&0<AJS.Meta.get("draft-id")&&c.show()});d.on("mouseenter.tipsy",function(){AJS.trigger("analytics",{name:"confluence.editor.unpublished-changes.lozenge.hover"})});
a.addCommand("mceConf.UnpublishedChangesLozenge.show",c.show);a.addCommand("mceConf.UnpublishedChangesLozenge.hide",c.hide)})},getInfo:function(){return{longname:"Unpublished Changes",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("unpublishedchanges",tinymce.plugins.UnpublishedChanges)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'tinymce3/settings/tinymce-default-settings.js' */

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'loader/tinymce-adapter.js' */
(function(d){AJS.toInit(function(){var a;a=Confluence.getContextPath();a={autoresize_min_height:"100%",width:"100%",height:"100%",document_base_url:Confluence.getBaseUrl()+"/",plugins:"auiwindowmanager,table,emotions,confluence,macroplaceholder,customtoolbar,insertwikimarkup,propertypanel,keyboardshortcuts,confmonospace,confcharmap,lists,confluencepaste,cursorTarget,confluencecleanupplugin,conftable,confluencepastetableplugin,confluencepastemacroplugin,pagelayoutplugin,highlightnode,iosediting,autoconvert,confluencelist,deletecommand,draggable,confluencesortabletablesplugin,textplaceholders,linkbrowser,insertfiles",
theme:"atlassian",theme_advanced_buttons1:"formatselect,bold,italic,underline,strikethrough,forecolor,separator,table,row_before,row_after,delete_row,col_before,col_after,delete_col,delete_table,separator,bullist,numlist,tasklist,outdent,indent,blockquote,justifyleft,justifycenter,justifyright,justifyfull,separator,sup,sub,separator,undo,redo,separator,confimage,conf_macro_browser,separator,code,customtoolbar,help,monospace,separator,searchreplace,linkbrowserButton",theme_advanced_toolbar_location:"top",
theme_advanced_toolbar_align:"left",theme_advanced_resizing:!1,theme_advanced_resize_horizontal:!1,theme_advanced_statusbar_location:"none",theme_advanced_path:!1,theme_advanced_blockformats:"p,h1,h2,h3,h4,h5,h6,pre,blockquote",mode:"specific_textareas",editor_selector:"tinymce-editor",body_class:"wiki-content",popup_css:!1,content_css:!1,editor_css:!1,custom_undo_redo:!0,custom_undo_redo_levels:20,context_path:a,plugin_action_base_path:a+"/plugins/tinymce",editor_plugin_action_base_path:a+"/plugins/editor/tinymce",
page_id:AJS.Meta.get("page-id"),draft_type:null,form_name:AJS.Meta.get("form-name"),space_key:encodeURI(AJS.Meta.get("space-key")),confluence_popup_width:620,confluence_popup_height:550,editor_id:"wysiwygTextarea"};0==a.page_id&&(a.page_id=null,a.draft_type=AJS.Meta.get("draft-type"));AJS.Rte.BootstrapManager.addBeforeInitCallback(function(a){a.contentCssTags=d("script[title='editor-css']").html();a.language=AJS.Meta.get("action-locale");var b=AJS.Meta.get("min-editor-height");if(b)a.autoresize_min_height=
b});var b=!(AJS.Meta.get("remote-user")&&AJS.Meta.get("confluence.prefs.editor.disable.autocomplete"));b&&(a.plugins+=",autocomplete,autocompletelink,autocompletemedia");if(AJS.Meta.get("auto-start")){b&&(a.plugins+=",autocompletemacro");b="0"===""+AJS.Meta.get("page-id");var c=AJS.Meta.get("content-type"),b="template"===c?AJS.Confluence.Editor._Profiles.createProfileForTemplateEditor():"comment"===c?AJS.Confluence.Editor._Profiles.createProfileForCommentEditor():AJS.Confluence.Editor._Profiles.createProfileForPageEditor({versionComment:!b,
notifyWatchers:!b});if(b=b.plugins.join(","))a.plugins+=","+b;AJS.Rte.BootstrapManager.preInitialise(a);AJS.Rte.BootstrapManager.initialise()}else AJS.Rte.BootstrapManager.preInitialise(a)})})($);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'com/atlassian/confluence/tinymceplugin/tinymce-adapter-deprecated.js' */
(function(f){AJS.Editor.Adapter={putCursorAtPostionInElement:function(a,b,c){var d=tinyMCE.activeEditor,e=d.getDoc(),a=f(a,c||e),a=a.contents().filter(function(){return 3==this.nodeType})[0],c=d.selection.getRng(!0);c.setStart(a,b);c.setEnd(a,b);d.selection.setRng(c)},storeCurrentSelectionState:AJS.Rte.BookmarkManager.storeBookmark,restoreSelectionState:AJS.Rte.BookmarkManager.restoreBookmark,insertLink:function(a,b){b&&AJS.Rte.getEditor().selection.select(b);Confluence.Editor.LinkAdapter.setLink(a)},
getCurrentBaseUrl:AJS.Rte.getCurrentBaseUrl,addOnInitCallback:function(a){AJS.debug("Adding callback to AJS.Rte.BootstrapManager. AJS.Rte.BootstrapManager = "+AJS.Rte.BootstrapManager);AJS.Rte.BootstrapManager.addOnInitCallback(a)},bindScroll:function(a,b){AJS.Rte.bindScroll(a,b)},unbindScroll:function(a){AJS.Rte.unbindScroll(a)},getTinyMceHasInit:function(){return AJS.Rte.BootstrapManager.isInitComplete()},getEditor:AJS.Rte.getEditor,addTinyMcePluginInit:function(a){AJS.Rte.BootstrapManager.addTinyMcePluginInit(a)},
isExternalLink:function(a){return Confluence.Link.isExternalLink(a)},isInMacroPlaceholder:function(a){return tinymce.confluence.MacroUtils.isInMacro(a)},initialiseTinyMce:function(){var a=AJS.Editor.Adapter;tinymce.EditorManager.preInit.apply(tinymce.EditorManager);tinymce.EditorManager.init(a.settings)},offset:function(a){AJS.Rte.Content.offset(a)},getSelectedText:function(){return AJS.Rte.Content.getSelectedText()},setEditorValue:function(a){AJS.Rte.Content.setHtml(a)},getEditorHTML:function(){return""+
AJS.Rte.getEditor.getContent()},editorHasContentChanged:function(){return AJS.Rte.getEditor().isDirty()},editorResetContentChanged:function(){AJS.Rte.getEditor().setDirty(!1)},getChildIndex:function(a,b){for(var c=a.childNodes,d=0,e=c.length;d<e;d++)if(c[d]==b)return d;return-1},getMainEditor:function(){return AJS.Rte.getMainEditor()},getEditorContainer:function(){return AJS.Rte.getEditorContainer()},getEditorFrame:function(){return AJS.Rte.getEditorFrame()},getEditorTable:function(){return AJS.Rte.getEditorTable()},
webResourcePath:AJS.Rte.webResourcePath,getResourceUrlPrefix:function(){return AJS.Rte.getResourceUrlPrefix()},getTinyMceBaseUrl:function(){return AJS.Rte.getTinyMceBaseUrl()},getMinEditorHeight:function(){return AJS.Rte.getMinEditorHeight()},getTinyMceEditorMinHeight:function(a){return AJS.Rte.getTinyMceEditorMinHeight(a)}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-javascript-resources', location = 'analytics/editor-analytics.js' */
(function(i){function b(a,c){if(a&&(d[a]?d[a]++:d[a]=1,c)){var b=a+"Size";d[b]=d[b]?d[b]+c:c}}function f(){d.pageID=AJS.Meta.get("page-id");AJS.Confluence.Analytics.publish("confluence.editor.action",d);d={};g=setTimeout(f,h)}var h=6E4;AJS.bind("rte-ready",function(){g=setTimeout(f,h);tinymce.activeEditor.onExecCommand.add(function(a,c){b(j[c])});tinymce.activeEditor.onKeyPress.add(function(){b("keys")});tinymce.activeEditor.onKeyUp.add(function(a,c){46===c.keyCode?b("delete",e):8===c.keyCode&&b("backspace",
e);e=a.selection.getContent().length});tinymce.activeEditor.onMouseUp.add(function(a){e=a.selection.getContent().length});tinymce.activeEditor.onPaste.add(function(a,c){b("paste",c.clipboardData.getData("text/plain").length)});i("#rte-button-insert-table").on("click",function(){b("insert.table")});window.addEventListener("beforeunload",function(){clearTimeout(g);f()})});var g,d={},e=0,j={Bold:"bold",confCharmap:"insert.symbol",confMonospace:"monospace",confTableRowToggleHeading:"table.row.toggle.heading",
confTableColumnToggleHeading:"table.column.toggle.heading",confTableSelectionToggleHighlight:"table.selection.toggle.highlight",ForeColor:"foreground.color",FormatBlock:"format.block",Indent:"indent",InsertHorizontalRule:"insert.horizontal.rule",InsertOrderedList:"insert.ordered.list",InsertUnorderedList:"insert.unordered.list",InsertWikiMarkup:"insert.wiki.markup",Italic:"italic",JustifyCenter:"justify.center",JustifyLeft:"justify.left",JustifyRight:"justify.right",mceConfimage:"insert.files.images",
mceConflink:"insert.link",mceConfMacroBrowser:"open.other.macros.browser",mceEmotion:"insert.emoticon",mceTableCopyRow:"table.copy.row",mceTableCutRow:"table.cut.row",mceTableDelete:"table.delete",mceTableDeleteCol:"table.delete.column",mceTableDeleteRow:"table.delete.row",mceTableInsertColAfter:"table.insert.column.after",mceTableInsertColBefore:"table.insert.column.before",mceTableInsertRowAfter:"table.insert.row.after",mceTableInsertRowBefore:"table.insert.row.before",mceTableMergeCells:"table.merge.cells",
mceTablePasteRowBefore:"table.paste.row.before",mceTableSplitCells:"table.split.cells",mcePageLayoutsToolbar:"page.layouts.toolbar.toggle",mcePageLayoutAddSection:"page.layouts.toolbar.add.section",mcePageLayoutRemoveSection:"page.layouts.toolbar.remove.section",mcePageLayoutMoveSectionDown:"page.layouts.toolbar.movedown.section",mcePageLayoutMoveSectionUp:"page.layouts.toolbar.moveup.section",mcePageLayoutChangeSection:"page.layouts.toolbar.change.section",mceConfShortcutDialog:"open.help.dialog",
mceSearchReplaceToolbar:"search.replace.toolbar.toggle",mceConfSearchClose:"search.replace.toolbar.close",mceConfSearch:"search",mceConfReplace:"replace",mceConfReplaceAll:"replace.all",Outdent:"outdent",Redo:"redo",Strikethrough:"strikethrough",subscript:"subscript",superscript:"superscript",Underline:"underline",Undo:"undo",InsertInlineTaskList:"insert.inline.tasklist",InsertInlineTaskListNoToggle:"insert.inline.tasklist.no.toggle"}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jiraAnalytics', location = '/jira/jiraanalytics.js' */
AJS.Editor.JiraAnalytics={events:{paste:{key:"confluence.jira.plugin.paste"},search:{key:"confluence.jira.plugin.search"},trigger:{key:"confluence.jira.plugin.trigger"},customizeColumn:{key:"confluence.jira.plugin.column.customize"}},linkTypes:{jqlDirect:"direct_jql",jql:"jql_link",xml:"xml_link",rss:"rss_link",filter:"filter_link"},getDisplayType:function(a){var b="single";if(a.container.find("#opt-table").is(":checked")){b="table"}else{if(a.container.find("#opt-total").is(":checked")){b="count"}}return b},setupAnalyticPanelActionObject:function(a,c,b){return{name:a.analyticPanelActionName,properties:this.setupPanelActionProperties(a,c,b)}},setupPanelActionProperties:function(a,d,b){var c={};if(d===AJS.Editor.JiraConnector.source.instructionalText){if(a.analyticPanelActionName==="confluence.jira.plugin.issuecreated"){c.issueType=a.container.find('select[name="issuetype"] :selected').text()}else{if(a.analyticPanelActionName==="confluence.jira.plugin.searchadded"){c.display=this.getDisplayType(a)}}c.label=b}return c},triggerPasteEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.paste.key,properties:a})},triggerPannelActionEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push(a)},triggerSearchEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.search.key,properties:a})},triggerMarkupEvent:function(a){this.triggerSearchEvent(a)},triggerPannelTriggerEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.trigger.key,properties:a})},triggerCustomizeColumnEvent:function(a){AJS.EventQueue=AJS.EventQueue||[];AJS.EventQueue.push({name:AJS.Editor.JiraAnalytics.events.customizeColumn.key,properties:a})}};(function(a){a.aop.before({target:AJS.MacroBrowser,method:"loadMacroInBrowser"},function(b,c){if(b&&b[0]&&b[0].pluginKey=="confluence.extra.jira"){AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.macroBrowser})}});a.aop.before({target:tinymce.confluence.macrobrowser,method:"macroBrowserToolbarButtonClicked"},function(b,c){if(b&&b[0]&&b[0].presetMacroMetadata&&b[0].presetMacroMetadata.pluginKey=="confluence.extra.jira"){AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:AJS.Editor.JiraConnector.source.editorBraceKey})}});AJS.bind("init.rte",function(){a.aop.before({target:tinyMCE.activeEditor,method:"execCommand"},function(l,k){if(l&&l[0]=="mceInsertContent"&&l[2]){var m=l[2];var e=AJS.$("<div></div>").html(m).children().first();var c=e.attr("data-macro-name");var h=["jira","jiraissues"];if(a.inArray(c,h)==-1){return}var j=AJS.Editor.JiraAnalytics;var n={source:"wiki_markup"};if(!e.attr("data-macro-parameters")){return}var g=e.attr("data-macro-parameters").split("|");for(var f=0;f<g.length;f++){var d=a.trim(g[f]);if(d.indexOf("jql")==0||d.indexOf("jqlQuery")==0){n.type=j.linkTypes.jqlDirect;break}else{if(d.indexOf("url")==0){var b=a.trim(d.substring(d.indexOf("=")+1,d.length));n.type=AJS.JQLHelper.checkQueryType(b);break}else{if(d.indexOf("http")==0){var b=d;n.type=AJS.JQLHelper.checkQueryType(b);break}}}}if(typeof n.type==="undefined"){n.type=j.linkTypes.jqlDirect}j.triggerMarkupEvent(n)}})})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.JiraCreateIssueForm=(function(c,a){b.defaults={formClass:"jira-interation-create-issue-form",ignoreFieldsWithDefaultValue:true,excludedField:["project","issuetype","reporter"],renderSummaryAndDescription:false,get$unsupportedFieldMessage:function(d,e){return c(jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage({unsupportedFields:d,createIssueUrl:e}))},get$unexpectedError:function(d){return c(aui.message.error({content:AJS.escapeHtml(d)}))},get$unauthorizeMessage:function(d){return c(jiraIntegration.templates.jiraCreateIssueForm.authorize({extraClasses:"jira-oauth-dialog",applicationName:d}))},get$unsupportedServerMessage:function(d){return c(jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage({serverUrl:d}))}};function b(d){this.configuration=a.extend({},b.defaults,d);if(this.configuration.renderSummaryAndDescription){this.configuration.excludedField.push("summary","description")}this._init()}b.prototype._trigger=function(d,e){var f=this.configuration[d];if(f){f.apply(this,Array.prototype.slice.call(arguments,1))}};b.prototype._bindEventListener=function(){var d=this;this.defaultFields.server.on("change",function(g){d.resetForm();var f=this.value;d.currentServerId=f;if(f){d.formIsLoading(d.defaultFields.server);jiraIntegration.JiraCreateIssueForm.Data.isIssueCreationSupported(f).done(function(e){if(e){d._loadProjectData(f);d.formLoadingCompleted(d.defaultFields.server)}else{var h=jiraIntegration.JiraCreateIssueForm.Data.getServerById(f).displayUrl;d._handleUnsupportedServer(h)}}).fail(function(e){d._handleAjaxError(e)})}else{jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(d.defaultFields.project);d.defaultFields.project.trigger("change")}d._trigger("onServerChanged",this.value)});this.defaultFields.project.on("change",function(){if(this.value){c('option[value=""]',d.defaultFields.project).remove();d._loadIssueType(d.defaultFields.server.val(),this.value)}else{jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(d.defaultFields.issueType)}d.resetForm();d.defaultFields.issueType.trigger("change");d._trigger("onProjectChanged",this.value)});this.defaultFields.issueType.on("change",function(){d.resetForm();if(this.value){d._loadRequireFields()}else{d.$containerRequireField&&d.$containerRequireField.html("");c(".aui-message",this.formEl).remove()}d._trigger("onTypeChanged",this.value)})};b.prototype._init=function(){this.container=c(this.configuration.container);if(this.container.length){this._renderForm();this._bindEventListener();this._loadServerData()}else{throw new Error("container property should be defined.")}};b.prototype._renderForm=function(){this.formEl=c(jiraIntegration.templates.jiraCreateIssueForm.form({formClass:this.configuration.formClass}));if(this.configuration.renderSummaryAndDescription){this._renderSummaryAndDescription()}this.container.append(this.formEl);this.defaultFields=this._getDefaultFields();a.each(this.defaultFields,a.bind(function(d){this.createSelect2WithIcon(c(d))},this));this.$containerRequireField=c(".create-issue-required-fields",this.container);this._trigger("onFormRendered")};b.prototype._renderSummaryAndDescription=function(){var d=c(".create-issue-default-fields",this.formEl);d.append(aui.form.textField({labelContent:"Summary",isRequired:true,name:"summary"}));d.append(aui.form.textareaField({labelContent:"Description",name:"description"}))};b.prototype._getDefaultFields=function(){var d=c("."+this.configuration.formClass,this.configuration.container);return{server:c(".server-select",d),project:c(".project-select",d),issueType:c(".issuetype-select",d)}};b.prototype._loadServerData=function(){var d=this;this.formIsLoading(this.defaultFields.server);c.when(jiraIntegration.JiraCreateIssueForm.Data.loadServers()).then(function(e){d.formLoadingCompleted(d.defaultFields.server);d._loadServerDataComplete(e)})};b.prototype._loadRequireFields=function(){var e=this;var d={serverId:this.defaultFields.server.val(),projectKey:this.defaultFields.project.val(),issueType:this.defaultFields.issueType.val()};this.formIsLoading(this.defaultFields.issueType);var f=jiraIntegration.JiraCreateIssueForm.Data.getFieldMetadata(d);f.done(function(j){var g=e._getValidRequiredFields(j);if(e.configuration.renderSummaryAndDescription){var h=j.fields.description;var i=!!(h&&h.required);e._setDescriptionAsRequiredField(i)}e._renderRequireFields(g,d);e.formLoadingCompleted(e.defaultFields.issueType)}).fail(a.bind(e._handleAjaxError,this))};b.prototype._loadServerDataComplete=function(d){if(d.length){if(d.length===1){jiraIntegration.JiraCreateIssueForm.FieldHelper.hideField(this.defaultFields.server)}jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(this.defaultFields.server,d,true);this._loadProjectData(d[0].id);this.currentServerId=d[0].id;this._hasMultiServer=d.length>1}else{this._handlerUnexpectedError("Don\'t have any JIRA server, please check the application link configuration.")}};b.prototype._loadProjectData=function(d){var e=this;this.formIsLoading(this.defaultFields.project);var f=jiraIntegration.JiraCreateIssueForm.Data.loadProjects(d);f.then(function(g){if(g.errors&&g.errors.length){var h=g.errors[0];if(h.authenticationUri){e._handleAuthorizeError(h)}else{e._handlerUnexpectedError(h.message)}}else{if(g.length){jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(e.defaultFields.project,g);jiraIntegration.JiraCreateIssueForm.FieldHelper.resetSelectField(e.defaultFields.issueType)}else{e._handlerUnexpectedError("You do not have permission to create issues on this JIRA server.")}}e.formLoadingCompleted(e.defaultFields.project)},a.bind(e._handleAjaxError,this))};b.prototype._loadIssueType=function(e,d){var f=jiraIntegration.JiraCreateIssueForm.Data.getIssueTypes(e,d);jiraIntegration.JiraCreateIssueForm.FieldHelper.fillSelectData(this.defaultFields.issueType,f,true)};b.prototype._renderRequireFields=function(d,e){this.$containerRequireField.html("");var f=a.reject(d,jiraIntegration.fields.canRender);if(f.length){this._handleUnsupportedFields(f)}else{this.$containerRequireField.html(a.map(d,function(g){return jiraIntegration.fields.renderField(null,g,null,null)}).join(""));jiraIntegration.fields.attachFieldBehaviors(this.$containerRequireField,{serverId:e.serverId,projectKey:e.projectKey},null);this._trigger("onRequiredFieldsRendered",d,f)}};b.prototype._handlerUnexpectedError=function(e){var d=this.configuration.get$unexpectedError(e);c(".aui-message",this.formEl).remove();this.formEl.prepend(d);this.formLoadingCompleted();this.formHasError()};b.prototype._handleUnsupportedFields=function(d){d=a.map(d,function(f){return AJS.escapeHtml(f.name)});var e=this.configuration.get$unsupportedFieldMessage(d,this._getCreateJiraIssueUrl());c(".aui-message",this.formEl).remove();this.formEl.prepend(e);this._trigger("onError");this.formLoadingCompleted()};b.prototype._handleUnsupportedServer=function(d){var e=this.configuration.get$unsupportedServerMessage(d);c(".aui-message",this.formEl).remove();this.formEl.prepend(e);this.formLoadingCompleted();this.formHasError()};b.prototype._handleAjaxError=function(e){var d=this;if(e.status>=500&&e.status<600){d._handlerUnexpectedError("Received the following HTTP error code from the server"+":"+e.status)}d.formHasError()};b.prototype._handleAuthorizeError=function(f){var e=this;this.formHasError();var d=this.configuration.get$unauthorizeMessage(f.applicationName);this.formEl.append(d);c(".oauth-init",d).on("click",function(g){AppLinks.authenticateRemoteCredentials(f.authenticationUri,function(){e.resetForm();e._loadProjectData(e.currentServerId)},function(){e._handlerUnexpectedError(AJS.format("You have refused to permit access to {0}.",f.applicationName))});g.preventDefault()})};b.prototype._getCreateJiraIssueUrl=function(){var f=this.defaultFields.project.find("option:selected").val();var g=this.defaultFields.issueType.find("option:selected").val();var h=jiraIntegration.JiraCreateIssueForm.Data.getServerById(this.currentServerId).displayUrl;h=h+"/secure/CreateIssueDetails!Init.jspa?pid="+f+"&issuetype="+g;var e=this._getFieldValue("summary");if(e.length){h=h+"&summary="+encodeURIComponent(e)}var d=this._getFieldValue("description");if(d.length){h=h+"&description="+encodeURIComponent(d)}return h};b.prototype._getValidRequiredFields=function(d){var e=this;return a.filter(d.fields,function(h){var g=h.schema?(h.schema.system||h.schema.custom||h.schema.customId):h;var f=a.contains(e.configuration.excludedField,g);return(h.required&&!f&&!h.hasDefaultValue)})};b.prototype._getFieldValue=function(e){var d=c("[name='"+e+"']",this.formEl);return(d)?c.trim(d.val()):""};b.prototype._setDescriptionAsRequiredField=function(d){var e=c('.field-group [name="description"]',this.formEl).prev("label");e.find(".aui-icon.aui-icon-required").remove();if(d){e.append(aui.icons.icon({icon:"required"}))}};b.prototype.resetForm=function(){c(".aui-message",this.formEl).remove();c(".field-group",this.formEl).show();if(this.configuration.renderSummaryAndDescription){this._setDescriptionAsRequiredField(false)}if(!this._hasMultiServer){jiraIntegration.JiraCreateIssueForm.FieldHelper.hideField(this.defaultFields.server)}this.$containerRequireField.html("")};b.prototype.formHasError=function(){c(".field-group",this.formEl).hide();this.$containerRequireField.html("");jiraIntegration.JiraCreateIssueForm.FieldHelper.showField(this.defaultFields.server);jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(c(".insert-issue-button"),true);this._trigger("onError");this.formLoadingCompleted()};b.prototype.getCurrentServer=function(){return jiraIntegration.JiraCreateIssueForm.Data.getServerById(this.currentServerId)};b.prototype.formIsLoading=function(d){if(d){jiraIntegration.JiraCreateIssueForm.FieldHelper.setIsLoading(d,true)}var e=c(":input",c(this.formEl));jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(e,true)};b.prototype.formLoadingCompleted=function(d){if(d){jiraIntegration.JiraCreateIssueForm.FieldHelper.setIsLoading(d,false)}else{c(".aui-icon.aui-icon-wait",this.formEl).remove()}var e=c(":input",c(this.formEl));jiraIntegration.JiraCreateIssueForm.FieldHelper.setFieldDisabled(e,false)};b.prototype.createSelect2WithIcon=function(d){if(d.is(".server-select")){d.auiSelect2({minimumResultsForSearch:-1})}else{var e=d.is(".project-select")?{formatSelection:this.projectSelectFormat,formatResult:this.projectSelectFormat,extraAttributes:this.defaultFields}:{formatSelection:this.issueTypeSelectFormat,formatResult:this.issueTypeSelectFormat,minimumResultsForSearch:-1,extraAttributes:this.defaultFields};d.auiSelect2(e)}d.auiSelect2("val","")};b.prototype.projectSelectFormat=function(f){var e=this.extraAttributes.server.find("option:selected").val();var d=jiraIntegration.JiraCreateIssueForm.Data.getProjectIconUrl(e,f.id);return jiraIntegration.templates.fields.select2WithIconOption({optionValue:f.text,iconUrl:d,isProject:true})};b.prototype.issueTypeSelectFormat=function(g){var f=this.extraAttributes.server.find("option:selected").val();var d=this.extraAttributes.project.find("option:selected").val();var e=jiraIntegration.JiraCreateIssueForm.Data.getIssueTypeIconUrl(f,d,g.id);return jiraIntegration.templates.fields.select2WithIconOption({optionValue:g.text,iconUrl:e,isProject:false})};return b})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-data.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.JiraCreateIssueForm=jiraIntegration.JiraCreateIssueForm||{};jiraIntegration.JiraCreateIssueForm.Data=(function(d){var l={};var b={};var o=AJS.contextPath()+"/plugins/servlet/jira-integration/icons?serverId={0}&iconType={1}&{2}";var h=[];function n(){return d.getJSON(AJS.contextPath()+"/rest/jira-integration/1.0/servers",function(p){if(p.length){d.each(p,function(q,r){l[r.id]=r})}})}function m(p){var q=(l[p])?l[p].projects:undefined;return q?d.Deferred().resolve(q):d.getJSON(AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+p+"/projects",function(r){if(r.length){d.each(r,function(u,w){var v=_.filter(w.issuetypes,function(x){return !x.subtask});w.issueTypes=v;var t=[];_.each(v,function(x){t[x.id]=x.iconUrl});var s={iconUrl:AJS.format(o,p,"project",w.avatarUrls["16x16"].split("/secure/projectavatar?")[1]),issueTypes:t};h[a(p,w.id)]=s});if(!l[p]){l[p]={}}l[p].projects=r}})}function f(q,p){var r=_.find(k(q),function(s){return s.id===p});return r?r.issueTypes:[]}function g(p){var q=a(p.serverId,p.projectKey,p.issueType);if(!_.has(b,q)){return d.ajax({type:"GET",url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+p.serverId+"/projects/"+p.projectKey+"/issue-types/"+p.issueType+"/fields-meta"}).pipe(function(r){b[q]=r;return b[q]})}else{return d.Deferred().resolve(b[q])}}function e(p){return l?l[p]:{}}function j(p){if(!l||!l[p]){return false}return(l[p].isSupported!=undefined)?d.Deferred().resolve(l[p].issueCreationSupported):d.ajax({type:"GET",url:AJS.contextPath()+"/rest/jira-integration/1.0/servers/"+p+"/features"}).pipe(function(q){if(q!=undefined){l[p].issueCreationSupported=_.contains(q,"CREATE_ISSUE")}return l[p].issueCreationSupported})}function k(p){return l&&l[p]?l[p].projects:[]}function i(q,p){var r=a(q,p);return h[r]?h[r].iconUrl:""}function c(r,q,s){var t=a(r,q);var p=h[t];return(p&&p.issueTypes[s])?p.issueTypes[s]:""}function a(q,p,r){return q+(p?"-"+p:"")+(r?"-"+r:"")}return{loadServers:n,loadProjects:m,getIssueTypes:f,getFieldMetadata:g,getServerById:e,getProjectIconUrl:i,getIssueTypeIconUrl:c,getProjects:k,isIssueCreationSupported:j}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form-field-helper.js' */
var jiraIntegration=window.jiraIntegration||{};jiraIntegration.JiraCreateIssueForm=jiraIntegration.JiraCreateIssueForm||{};jiraIntegration.JiraCreateIssueForm.FieldHelper=(function(c,h){function e(j,l,k){var m=k?[]:[a(j)];c.each(l,function(n,p){var o={value:p.id,text:p.name,iconUrl:p.iconUrl?p.iconUrl:(p.avatarUrls?p.avatarUrls["16x16"]:"")};if(k&&n===0){o.selected=true}m.push(aui.form.optionOrOptgroup(o))});j.html(m.join(""));j.auiSelect2("val","")}function b(j){j.html(a(j));j.auiSelect2("val","")}function a(j){var k=j.attr("data-placeholder");return aui.form.optionOrOptgroup({value:"",text:k,iconUrl:""})}function i(j){j.parent().hide()}function d(j){j.parent().show()}function f(k,j){j?k.disable():k.enable()}function g(k,j){return j?k.after(aui.icons.icon({icon:"wait"})):k.next(".aui-icon.aui-icon-wait").remove()}return{fillSelectData:e,resetSelectField:b,hideField:i,showField:d,setFieldDisabled:f,setIsLoading:g}})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.integration.jira.jira-integration-plugin:jira-create-issue-form', location = '/jira-create-issue-form/jira-create-issue-form.soy' */
// This file was automatically generated from jira-create-issue-form.soy.
// Please don't edit this file by hand.

if (typeof jiraIntegration == 'undefined') { var jiraIntegration = {}; }
if (typeof jiraIntegration.templates == 'undefined') { jiraIntegration.templates = {}; }
if (typeof jiraIntegration.templates.jiraCreateIssueForm == 'undefined') { jiraIntegration.templates.jiraCreateIssueForm = {}; }


jiraIntegration.templates.jiraCreateIssueForm.form = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.form.form({id: 'jira-create-form', extraClasses: opt_data.formClass, method: 'post', action: '#', content: '<fieldset class="create-issue-default-fields"><div class="field-group"><label>' + soy.$$escapeHtml("Server") + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box server-select" name="server" data-placeholder="' + soy.$$escapeHtml("Select a server") + '"><option disabled selected value="">' + soy.$$escapeHtml("Select a server") + '</option></select></div><div class="field-group"><label>' + soy.$$escapeHtml("Project") + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box project-select" name="project" data-placeholder="' + soy.$$escapeHtml("Select a project") + '"><option disabled selected value="">' + soy.$$escapeHtml("Select a project") + '</option></select></div><div class="field-group"><label>' + soy.$$escapeHtml("Issue Type") + '<span class="aui-icon icon-required"> required</span></label><select class="jira-select2-drop-box issuetype-select" name="issue-type" data-placeholder="' + soy.$$escapeHtml("Select an issue type") + '"><option disabled selected value="">' + soy.$$escapeHtml("Select an issue type") + '</option></select></div></fieldset><fieldset class="create-issue-required-fields"></fieldset>'}, output);
  return opt_sb ? '' : output.toString();
};


jiraIntegration.templates.jiraCreateIssueForm.unsupportedFieldsMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param29 = new soy.StringBuilder();
  if (opt_data.unsupportedFields.length == 1) {
    var field__soy32 = new soy.StringBuilder('<strong>', soy.$$escapeHtml(opt_data.unsupportedFields), '</strong>');
    field__soy32 = field__soy32.toString();
    param29.append(AJS.format("The required field {0} is not available in this form. You will need to",field__soy32));
  } else {
    var fieldList__soy39 = new soy.StringBuilder();
    jiraIntegration.templates.jiraCreateIssueForm.buildFieldList({fields: opt_data.unsupportedFields}, fieldList__soy39);
    fieldList__soy39 = fieldList__soy39.toString();
    param29.append(AJS.format("The required fields {0} are not available in this form. You will need to",fieldList__soy39));
  }
  param29.append(' <a href="', soy.$$escapeHtml(opt_data.createIssueUrl), '" target="_blank">', soy.$$escapeHtml("create your issue directly in JIRA"), '</a>.');
  aui.message.warning({content: param29.toString()}, output);
  return opt_sb ? '' : output.toString();
};


jiraIntegration.templates.jiraCreateIssueForm.buildFieldList = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var joinText__soy51 = new soy.StringBuilder((opt_data.fields.length == 2) ? ' ' + soy.$$escapeHtml("and") + ' ' : ', ');
  joinText__soy51 = joinText__soy51.toString();
  var fieldList59 = opt_data.fields;
  var fieldListLen59 = fieldList59.length;
  for (var fieldIndex59 = 0; fieldIndex59 < fieldListLen59; fieldIndex59++) {
    var fieldData59 = fieldList59[fieldIndex59];
    output.append((! (fieldIndex59 == 0)) ? soy.$$escapeHtml(joinText__soy51) : '', '<strong>', soy.$$escapeHtml(fieldData59), '</strong>');
  }
  return opt_sb ? '' : output.toString();
};


jiraIntegration.templates.jiraCreateIssueForm.authorize = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var applicationNameEscaped__soy68 = new soy.StringBuilder(soy.$$escapeHtml(opt_data.applicationName));
  applicationNameEscaped__soy68 = applicationNameEscaped__soy68.toString();
  aui.message.info({content: AJS.format("{0}Log in and approve{1} to retrieve data from {2}",'<a class="oauth-init" href="#">','</a>',applicationNameEscaped__soy68)}, output);
  return opt_sb ? '' : output.toString();
};


jiraIntegration.templates.jiraCreateIssueForm.unsupportedServerMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.message.warning({content: AJS.format("The version of selected JIRA server is not supported. You may want to upgrade to at least version 5.x or {0}create issue in JIRA{1}.",'<a href="' + opt_data.serverUrl + '" target="_blank">','</a>')}, output);
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/datatable.js' */
(function(a){AJS.DataTable=function(h,d,b){var g=null;if(h&&h.jquery){g=h}else{if(typeof h=="string"){g=a(h)}}g.addClass("data-table");if(d&&d.length){this.columns=d;var f=a("<tr></tr>").appendTo(g);f.addClass("data-table-header");for(var c=0;c<d.length;c++){var e=d[c];f.append('<th class="'+e.className+'">'+e.title+"</th>")}}this.tbl=g;this.rowIdx=0};AJS.DataTable.prototype.addRow=function(e){var f=a("<tr></tr>").appendTo(this.tbl);var c=this.columns;for(var b=0;b<this.columns.length;b++){var d=c[b];var g=a("<td></td>").appendTo(f);g.addClass(d.className);d.renderCell(g,e)}f.data("row-data",e);this._bindRowJs(f,this.rowIdx,"selected","hover");this.rowIdx+=1;f.attr("tabindex","-1")};AJS.DataTable.prototype.selectRow=function(b){var c=a("tbody tr",this.tbl)[b+1];a(c).focus()};AJS.DataTable.prototype._bindRowJs=function(f,g,c,b){var e=this;f.click(function(i){if(c){a(e.tbl).find("."+c).removeClass(c);a(this).addClass(c)}var h=f.data("row-data");e.tbl.trigger("row-select",[h])});var d=function(k){switch(k.keyCode){case 13:var j;var h=f.data("row-data");f.keyup(j=function(l){e.tbl.trigger("row-action",[h]);f.unbind("keyup",j);return AJS.stopEvent(l)});return AJS.stopEvent(k);break;case 38:if(g>0){f.prev().focus()}return AJS.stopEvent(k);case 40:var i=a("tbody tr",e.tbl).length;if(g<i-1){f.next().focus()}return AJS.stopEvent(k)}};if(a.browser.mozilla){f.keypress(d)}else{f.keydown(d)}f.focus(function(h){f.click()});if(b){f.hover(function(){a(this).addClass(b)},function(){a(this).removeClass(b)})}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/dialogs.js' */
(function(){tinymce.create("tinymce.plugins.JiraLink",{init:function(a){a.addCommand("mceJiralink",AJS.Editor.JiraConnector.hotKey);a.onPostRender.add(function(b){AJS.$.get(Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",function(c){AJS.Editor.JiraConnector.servers=c});AJS.$("#jiralink").click(function(c){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorDropdownLink,true);return AJS.stopEvent(c)});AJS.$("#insert-menu .macro-jiralink").show();b.addShortcut("ctrl+shift+j","","mceJiralink")})},getInfo:function(){return{longname:"Confluence Jira Connector",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("jiraconnector",tinymce.plugins.JiraLink)})();AJS.Editor.Adapter.addTinyMcePluginInit(function(b){b.plugins+=",jiraconnector";var c=b.theme_advanced_buttons1;var a=c.indexOf("confimage");b.theme_advanced_buttons1=c.substring(0,a)+"jiralinkButton,"+c.substring(a)});AJS.Editor.JiraConnector=(function(j){var f="";var c="Insert JIRA Issue/Filter";var a="Insert";var h="Cancel";var l=function(){var q=navigator.platform.toLowerCase().indexOf("mac")!=-1;return q?"Cmd":"Ctrl"};var b={macroBrowser:"macro_browser",editorBraceKey:"editor_brace_key",editorHotKey:"editor_hot_key",editorDropdownLink:"editor_dropdown_link",instructionalText:"instructional text"};var p=AJS.format("Hint: type \"{0}+Shift+J\" in the editor to quickly access this dialog.",l());var n,m,d;var i=function(){var q=j("#createPageLabelsString");if(q.length>0){m=q.val().split(" ").join();AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:n,label:m});return}j.getJSON(AJS.Meta.get("base-url")+"/rest/ui/1.0/content/"+AJS.Meta.get("page-id")+"/labels",function(s){var r=[];j.each(s.labels,function(u,t){r.push(t.name)});m=r.join();AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:n,label:m})})};var g=function(q,r){if(AJS.Editor.JiraAnalytics){AJS.Editor.JiraConnector.analyticPanelActionObject=AJS.Editor.JiraAnalytics.setupAnalyticPanelActionObject(r,n,m);if(q.customizedColumn){AJS.Editor.JiraAnalytics.triggerCustomizeColumnEvent({columns:q.customizedColumn})}}};var o=function(q){q.focusForm&&q.focusForm()};var e=function(t){if(!d){d=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-connector"});d.addHeader(c);var s=AJS.Editor.JiraConnector.Panels;for(var u=0;u<s.length;u++){d.addPanel(s[u].title());var w=d.getCurrentPanel();var r=s[u];r.init(w)}d.addLink("Select Macro",function(){d.hide();AJS.MacroBrowser.open(false)},"dialog-back-link");d.addHelpText(p);j("#jira-connector .dialog-tip").attr("title",p);d.addButton(a,function(){var z=d.getCurrentPanel().id;var y=s[z];var x=s[0];g(x,y);y.insertLink()},"insert-issue-button");AJS.$(".insert-issue-button").disable();d.addCancel(h,function(){AJS.Editor.JiraConnector.closePopup()});d.gotoPanel(0);if(AJS.Editor.JiraConnector.servers){for(var u=0;u<AJS.Editor.JiraConnector.servers.length;u++){var v=AJS.Editor.JiraConnector.servers[u];AppLinks.makeRequest({appId:v.id,type:"GET",url:"/rest/api/2/field",dataType:"json",serverIndex:u,success:function(x){if(x&&x.length){AJS.Editor.JiraConnector.servers[this.serverIndex].columns=x}},error:function(){AJS.log("Jira Issues Macro: unable to retrieve fields from AppLink: "+v.id)}})}}j("#jira-connector ul.dialog-page-menu").append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-chart-dialog",label:"JIRA Charts"}));j("#jira-connector .dialog-page-menu button").click(function(){var x=AJS.Editor.JiraConnector.Panels[d.getCurrentPanel().id];x.setInsertButtonState&&x.setInsertButtonState();o(x)});j("#open-jira-chart-dialog").click(function(){AJS.Editor.JiraConnector.closePopup();if(AJS.Editor.JiraChart){AJS.Editor.JiraChart.open()}})}AJS.Editor.JiraConnector.Panels[0].refreshSearchForm();if(t){d.gotoPanel(1);var q=AJS.Editor.JiraConnector.Panels[1];q.setSummary(t);setTimeout(function(){o(q)},0)}else{d.gotoPanel(0)}d.overrideLastTab();d.show()};var k=function(){if(AJS.Editor.JiraConnector.clickConfigApplink){AJS.$.ajax({url:Confluence.getContextPath()+"/rest/jiraanywhere/1.0/servers",async:false}).done(function(q){AJS.Editor.JiraConnector.servers=q})}if(typeof(AJS.Editor.JiraConnector.servers)=="undefined"||AJS.Editor.JiraConnector.servers.length==0){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));return false}AJS.Editor.JiraConnector.clickConfigApplink=false;if(AJS.Editor.JiraConnector.refreshAppLink){AJS.Editor.JiraConnector.refreshAppLink.call();AJS.Editor.JiraConnector.refreshAppLink=false}return true};return{warningPopup:function(s){var q=new AJS.ConfluenceDialog({width:600,height:400,id:"warning-applink-dialog"});var r="Connect Confluence To JIRA";q.addHeader(r);var t=Confluence.Templates.ConfluenceJiraPlugin.warningDialog({isAdministrator:s});q.addPanel("Panel 1",t);q.get("panel:0").setPadding(0);if(s){q.addButton("Set connection",function(u){AJS.Editor.JiraConnector.clickConfigApplink=true;u.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();window.open(Confluence.getContextPath()+"/admin/listapplicationlinks.action")},"create-dialog-create-button app_link");q.popup.element.find(".create-dialog-create-button").removeClass("button-panel-button").addClass("aui-button aui-button-primary")}else{q.addButton("Contact admin",function(u){u.hide();tinymce.confluence.macrobrowser.macroBrowserCancel();window.open(Confluence.getContextPath()+"/wiki/contactadministrators.action")})}q.addLink("Cancel",function(u){u.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()});q.show();q.gotoPanel(0)},closePopup:function(){d.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},open:function(s,t){if(!k()){return}AJS.Editor.Adapter.storeCurrentSelectionState();n=s;if(AJS.Editor.JiraAnalytics&&n){if(n===AJS.Editor.JiraConnector.source.instructionalText){i()}else{m=null;AJS.Editor.JiraAnalytics.triggerPannelTriggerEvent({source:n})}}var r=tinymce.confluence.macrobrowser,q=r.getCurrentNode();if(r.isMacroTag(q)&&"jira"==j(q).attr("data-macro-name")){r.editMacro(q);return}AJS.Editor.JiraConnector.openCleanDialog(t)},openCleanDialog:function(s){var r=s&&tinyMCE.activeEditor.selection&&tinyMCE.activeEditor.selection.getContent({format:"text"});e(r);var q=AJS.Editor.JiraConnector.Panels[0];q.setMacroParams(null)},edit:function(u){if(!k()){return}if(typeof(u.params)=="undefined"){AJS.Editor.JiraConnector.openCleanDialog(false);return}n=f;m=f;var w=function(z){if(z.hasOwnProperty("jqlQuery")){return z.jqlQuery}var y=/^([0-9]\d*)$/;var x=["count","columns","title","renderMode","cache","width","height","server","serverId","anonymous","baseurl","showSummary"];for(var A in z){if(j.inArray(A,x)==-1&&z.hasOwnProperty(A)){if(y.test(A)){return z[A]}return A+=" = "+z[A]}}return""};var r=function(z){var A={};if(z.params.url){A.searchStr=z.params.url;return A}A.maximumIssues=z.params.maximumIssues;var x=z.defaultParameterValue||w(z.params);if(typeof(x)=="undefined"){A.searchStr=f}else{A.searchStr=x}if(typeof(z.params.server)!="undefined"){A.serverName=z.params.server}else{for(var y=0;y<AJS.Editor.JiraConnector.servers.length;y++){if(AJS.Editor.JiraConnector.servers[y].selected){A.serverName=AJS.Editor.JiraConnector.servers[y].name;break}}}return A};var t=function(z){var A=r(z);var y=z.params.count;if(typeof y==="undefined"){y="false"}A.count=y;var x=z.params.columns;if(typeof(x)!="undefined"){if(x.length){A.columns=x}}return A};var s=t(u);if(u&&!AJS.Editor.inRichTextMode()){j("#markupTextarea").selectionRange(u.startIndex,u.startIndex+u.markup.length)}e();if(s.searchStr){d.gotoPanel(0);var q=AJS.Editor.JiraConnector.Panels[0];q.setMacroParams(s);var v={searchValue:s.searchStr,serverName:s.serverName,isJqlQuery:u.params.hasOwnProperty("jqlQuery"),isAutoSearch:true};q.doSearch(v)}},source:b}})(AJS.$);AJS.MacroBrowser.setMacroJsOverride("jira",{opener:AJS.Editor.JiraConnector.edit});AJS.MacroBrowser.setMacroJsOverride("jiraissues",{opener:AJS.Editor.JiraConnector.edit});AJS.Editor.JiraConnector.Panels=[];AJS.Editor.JiraConnector.clickConfigApplink=false;AJS.Editor.JiraConnector.hotKey=function(){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.editorHotKey,true)};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/panelhelper.js' */
AJS.Editor.JiraConnector.Panel=function(){};AJS.Editor.JiraConnector.Panel.prototype={SHOW_MESSAGE_ON_TOP:false,insertIssueLink:function(a){this.insertIssueLinkWithParams({key:a})},insertJqlLink:function(a){this.insertIssueLinkWithParams({jqlQuery:a})},insertIssueLinkWithParams:function(e){var f=function(g){tinymce.confluence.macrobrowser.macroBrowserComplete(g)};e.server=this.selectedServer.name;e.serverId=this.selectedServer.id;if(AJS.Editor.inRichTextMode()){f({name:"jira",params:e})}else{var a="{jira:";for(var b in e){a=a+b+"="+e[b]+"|"}if(a.charAt(a.length-1)=="|"){a=a.substr(0,a.length-1)}var d=AJS.$("#markupTextarea");var c=d.selectionRange();d.selectionRange(c.start,c.end);d.selection(a);c=d.selectionRange();d.selectionRange(c.end,c.end)}if(AJS.Editor.JiraAnalytics&&AJS.Editor.JiraConnector.analyticPanelActionObject){AJS.Editor.JiraAnalytics.triggerPannelActionEvent(AJS.Editor.JiraConnector.analyticPanelActionObject);AJS.Editor.JiraConnector.analyticPanelActionObject=null}AJS.Editor.JiraConnector.closePopup()},disableInsert:function(){AJS.$(".insert-issue-button").disable()},isInsertDisabled:function(){return AJS.$(".insert-issue-button").is(":disabled")},getOAuthRealm:function(d){var b=d.getResponseHeader("WWW-Authenticate")||"";var a=/OAuth realm\=\"([^\"]+)\"/;var c=a.exec(b);if(c){return c[1]}else{return null}},enableInsert:function(){AJS.$(".insert-issue-button").enable()},handleInsertWaiting:function(b){var a=AJS.$(".insert-issue-button");return b?a.before(aui.icons.icon({icon:"wait"})):a.prev(".aui-icon.aui-icon-wait").remove()},msg:function(a,c,b){if(aui&&aui.message){try{var h=AJS.$('<div class="aui-message-container"/>');var f=c;if(c.html){f=c.html()}var i={content:f};var d;switch(b){case"error":d=aui.message.error(i);break;case"success":d=aui.message.success(i);break;case"warning":d=aui.message.warning(i);break;default:d=aui.message.info(i)}h.append(d);c=h}catch(g){if(AJS&&AJS.logError){AJS.logError("jira-connector",g)}}}a.append(c)},errorMsg:function(a,c){this.removeError(a);var b=this.SHOW_MESSAGE_ON_TOP?AJS.$('<div class="jira-error"></div>').prependTo(a):AJS.$('<div class="jira-error"></div>').appendTo(a);this.msg(b,c,"error")},warningMsg:function(a,b){this.removeError(a);var c=this.SHOW_MESSAGE_ON_TOP?AJS.$('<div class="jira-error"></div>').prependTo(a):AJS.$('<div class="jira-error"></div>').appendTo(a);this.msg(c,b,"warning")},noServerMsg:function(a,b){var d=AJS.$('<div class="data-table jiraSearchResults" ></div>').appendTo(a);var c=this.SHOW_MESSAGE_ON_TOP?AJS.$('<div class="message-panel"/>').prependTo(d):AJS.$('<div class="message-panel"/>').appendTo(d);this.msg(c,b,"info")},ajaxError:function(c,b){if(c.status==401){var a=this.getOAuthRealm(c);this.selectedServer.authUrl=a;b.call(this)}else{this.errorMsg(this.container,"Received the following HTTP error code from the server"+":"+c.status)}},removeError:function(a){AJS.$("div.jira-error",a).remove()},setActionOnEnter:function(a,c,b){a.unbind("keydown").keydown(function(d){if(d.which==13){var f=function(g){a.unbind("keyup",f);c(b);return AJS.stopEvent(g)};a.keyup(f);return AJS.stopEvent(d)}})},createOauthForm:function(e){var d=this.selectedServer;var c={onSuccess:function(){d.authUrl=null;e(d)},onFailure:function(){}};var a='<a class="oauth-init" href="#">'+"Login & Approve"+"</a> "+"to retrieve data from"+" "+AJS.escapeHtml(this.selectedServer.name);var b=AJS.$('<div class="jira-oauth-message-marker"/>');if(!(aui&&aui.message)){b.addClass("oauth-message")}this.msg(b,a,"info");AJS.$(".oauth-init",b).click(function(f){AppLinks.authenticateRemoteCredentials(d.authUrl,c.onSuccess,c.onFailure);f.preventDefault()});return b},applinkServerSelect:function(a,b){var c=AJS.Editor.JiraConnector.servers;AJS.$(c).each(function(){var d="<option ";if(this.selected){selectedServer=this;d+='selected="selected"'}d+='value="'+this.id+'"></option>';d=AJS.$(d);d.text(this.name);AJS.$(a).append(d);d.data("jiraapplink",this)});AJS.$(a).change(function(g){var d=AJS.$("option:selected",a);var f=d.data("jiraapplink");b(f)})},showSpinner:function(d,a,c,b){AJS.$.data(d,"spinner",Raphael.spinner(d,a,"#666"));if(c){AJS.$(d).css("marginLeft",-a*1.2)}if(b){AJS.$(d).css("marginTop",-a*1.2)}},hideSpinner:function(a){AJS.$(a).css("marginTop","");AJS.$(a).css("marginLeft","");var b=AJS.$.data(a,"spinner");if(b){b();delete b;AJS.$.data(a,"spinner",null)}},setSelectedIssue:function(a){this.selectedIssue=a;this.enableInsert()},insertSelected:function(){if(this.selectedIssue){this.insertIssueLink(this.selectedIssue.key)}},createIssueTableFromUrl:function(c,k,b,a,d,h,i,f,e){AJS.$("div.data-table",c).remove();var j=AJS.$('<div class="data-table jiraSearchResults" ></div>').appendTo(c);var l=AJS.$('<div class="loading-data"></div>').appendTo(j);this.removeError(c);this.showSpinner(l[0],50,true,true);var g=this;this.currentXhr=AppLinks.makeRequest({appId:k,type:"GET",url:b,dataType:"xml",success:function(q){l.remove();var r=AJS.$("item",q);AJS.$(":disabled",c).enable();if(r.length){var u=AJS.$('<table class="my-result aui"></table>');AJS.$(".jiraSearchResults",c).append(u);var o=[];if(e){var t={className:"issue-checkbox-column",title:'<input type="checkbox" name="jira-issue-all" checked/>',renderCell:function(y,w){var x=Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox({issueKey:w.key});AJS.$(x).appendTo(y)}};o.push(t)}var s=[{className:"issue-key-column",title:"Key",renderCell:function(y,x){var w=Confluence.Templates.ConfluenceJiraPlugin.issueKey({issueIconUrl:x.iconUrl,issueKey:x.key});AJS.$(w).appendTo(y)}},{className:"issue-summary-column",title:"Summary",renderCell:function(x,w){x.text(w.summary)}}];o=o.concat(s);var m=new AJS.DataTable(u,o);AJS.$(r).each(function(){var w={iconUrl:AJS.$("type",this).attr("iconUrl"),key:AJS.$("key",this).text(),summary:AJS.$("summary",this).text(),url:AJS.$("link",this).text()};m.addRow(w)});u.bind("row-action",function(x,w){d.call(g,w)});u.bind("row-select",function(x,w){a.call(g,w)});m.selectRow(0);if(i){var n=AJS.$("issue",q).attr("total");i.call(g,n)}}else{if(h){h()}var v="No search results found.";var p=AJS.$('<div class="message-panel"/>');g.msg(p,v,"info");AJS.$(".jiraSearchResults",c).append(p)}},error:function(m){AJS.$(":disabled",c).enable();l.remove();f.call(g,m)}})},retrieveJson:function(c,a,d,b){AppLinks.makeRequest({appId:c,type:"GET",url:a,dataType:"json",success:d,error:b})}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/searchpanel.js' */
AJS.Editor.JiraConnector.Panel.Search=function(){this.jql_operators=/=|!=|~|>|<|!~| is | in /i};AJS.Editor.JiraConnector.Select2=AJS.Editor.JiraConnector.Select2||{};AJS.Editor.JiraConnector.Select2.getKeyColumnsSelectedOptions=function(b){var a=[];var d=b.select2("data");for(var c=0;c<d.length;c++){a[c]=d[c].id}return a.join()};AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Search.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Search.prototype,{defaultColumns:"key,summary,type,created,updated,due,assignee,reporter,priority,status,resolution",DEFAULT_MAX_ISSUES_VAL:20,MAXIMUM_MAX_ISSUES_VAL:1000,MINIMUM_MAX_ISSUES_VAL:1,title:function(){return "Search"},init:function(a){a.html('<div id="my-jira-search"></div>');var f=this;var b=AJS.$("#my-jira-search");this.container=b;var h=function(){b.children(":not(div.jira-search-form)").remove()};var e=function(){AJS.$("input.text",b).enable();AJS.$("button",b).enable()};var l=function(){AJS.$("button",b).disable();AJS.$("input.text",b).disable()};var i=function(n){h();f.disableInsert();if(n){f.selectedServer=n}if(f.selectedServer.authUrl){l();var m=f.createOauthForm(function(){h();e()});b.append(m)}else{e();AJS.$(".search-help").show()}};this.authCheck=i;var g=function(x){var m=x&&x.searchValue;var o=x&&x.serverName;if(m){AJS.$("input:text",b).val(m)}if(o&&o!=this.selectedServer.name){var y=AJS.Editor.JiraConnector.servers;var q=false;for(var r=0;r<y.length;r++){if(y[r].name==o){AJS.$('option[value="'+y[r].id+'"]',b).attr("selected","selected");AJS.$("select",b).change();q=true;break}}if(!q){c(AJS.Meta.get("is-admin"));return}}if(this.currentXhr&&this.currentXhr.readyState!=4){return}var p=m||AJS.$("input",b).val();if(AJS.Editor.JiraAnalytics){var w=AJS.JQLHelper.checkQueryType(p);if(w){AJS.Editor.JiraAnalytics.triggerSearchEvent({type:w,source:"dialog"})}}var s=function(C,E,D){var B=b.find("#jiraIssueColumnSelector");var A=B.val()&&B.val().join();AJS.$("select",b).disable();l();f.lastSearch=C;f.createIssueTableFromUrl(b,f.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery="+encodeURIComponent(C)+"&returnMax=true&tempMax=20&field=summary&field=type&field=link",f.selectHandler,f.insertLinkFromForm,function(){f.addDisplayOptionPanel();f.loadMacroParams(A);f.bindEventToDisplayOptionPanel(true,x);f.enableInsert()},function(F){f.addDisplayOptionPanel();f.loadMacroParams(A);f.bindEventToDisplayOptionPanel(false,x);f.updateTotalIssuesDisplay(F);f.checkAutoSelectColumns();x&&x.isAutoSearch&&f.focusForm()},function(F){f.disableInsert();if(F.status==400){if(D){D()}else{AJS.$("div.data-table",b).remove();f.warningMsg(b,AJS.format("The JIRA server didn\'\'t understand your search query. If you entered JQL, please ensure that it\'\'s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))}}else{AJS.$("div.data-table",b).remove();f.ajaxError(F,i)}x&&x.isAutoSearch&&f.focusForm()},true)};if(AJS.JQLHelper.isFilterUrl(p)){var n=decodeURIComponent(p);var v=AJS.JQLHelper.findServerIndexFromUrl(n,AJS.Editor.JiraConnector.servers);if(v!=-1){var t=AJS.Editor.JiraConnector.servers[v].id;AJS.$('option[value="'+t+'"]',b).attr("selected","selected");AJS.$("select",b).change();var z=AJS.JQLHelper.getFilterFromFilterUrl(n);if(z){AJS.$("input",b).val(z);s(z)}else{h();f.warningMsg(b,AJS.format("The JIRA server didn\'\'t understand your search query. If you entered JQL, please ensure that it\'\'s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}",Confluence.Templates.ConfluenceJiraPlugin.learnMore()))}}else{h();f.disableInsert();c(AJS.Meta.get("is-admin"))}}else{if(AJS.JQLHelper.isIssueUrlOrXmlUrl(p)){var n=decodeURIComponent(p);var u=AJS.JQLHelper.getJqlAndServerIndexFromUrl(n,AJS.Editor.JiraConnector.servers);if(d(u)){AJS.$("input",b).val(u.jqlQuery);s(u.jqlQuery,false,null)}}else{if(p.match(f.jql_operators)){s(p,false,null)}else{if(AJS.JQLHelper.isSingleKeyJQLExp(p)){s("key = "+p,true)}else{if(AJS.JQLHelper.isMultipleSingleKeyJQLExp(p)){s("key in ("+p+")",true)}else{s('summary ~ "'+p+'" OR description ~ "'+p+'"',false,null)}}}}}};this.doSearch=g;f.addSearchForm();var d=function(m){var n;if(m.serverIndex!=-1){AJS.$('option[value="'+AJS.Editor.JiraConnector.servers[m.serverIndex].id+'"]',b).attr("selected","selected");AJS.$("select",b).change();if(m.jqlQuery.length==0){h();f.errorMsg(b,"The JIRA server didn\'t understand your search query. If you entered JQL, please ensure that it\'s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it. {0}")}else{n=m.jqlQuery}}else{h();f.disableInsert();c(AJS.Meta.get("is-admin"))}return n};f.processJiraParams=d;var c=function(m){var o=Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer({isAdministrator:m,contextPath:Confluence.getContextPath()});f.noServerMsg(b,o);var n=AJS.$("#open_applinks");n.bind("click",function(){AJS.Editor.JiraConnector.clickConfigApplink=true;AJS.Editor.JiraConnector.refreshAppLink=function(){f.refreshSearchForm()}})};f.bindPasteEvent();AJS.$(a).select(function(){f.validate()});var k=AJS.$(".jql-display-opts-open.disabled");var j={live:true,title:function(){return AJS.$(".jql-display-opts-open.disabled").data("title")},gravity:"s",delayIn:300,delayOut:0};k.tooltip(j)},focusForm:function(){AJS.$('input[name="jiraSearch"]',this.container).focus()},addSearchForm:function(){var d=this;d.container.empty();var f=AJS.Editor.JiraConnector.servers;d.selectedServer=f[0];var a=false;if(f.length>1){a=true}var e=Confluence.Templates.ConfluenceJiraPlugin.searchForm({isMultiServer:a});var c=AJS.$(e).appendTo(d.container);if(f.length>1){var b=AJS.$('<select class="select" tabindex="0"></select>').insertAfter("div.search-input",c);d.applinkServerSelect(b,d.authCheck)}d.authCheck(d.selectedServer);AJS.$("button",d.container).click(function(){d.doSearch()});d.setActionOnEnter(AJS.$("input.text",d.container),d.doSearch)},bindPasteEvent:function(){var a=this;AJS.$("#my-jira-search input:text").bind("paste",function(){var b=this;setTimeout(function(){var d=AJS.$(b).val();if(AJS.JQLHelper.isFilterUrl(d)){a.doSearch()}else{if(AJS.JQLHelper.isIssueUrlOrXmlUrl(d)){var e=decodeURIComponent(d);var c=AJS.JQLHelper.getJqlAndServerIndexFromUrl(e,AJS.Editor.JiraConnector.servers);if(a.processJiraParams(c)){AJS.$(b).val(c.jqlQuery);a.doSearch()}}}},100)})},refreshSearchForm:function(){this.container.empty();this.addSearchForm();this.bindPasteEvent()},validate:function(e,d){var c=this.container;var f=AJS.$("input:checkbox[name=jira-issue]",c);var b=AJS.Editor.JiraConnector.Panel.Search.prototype;if(f.length||e){var a=AJS.$("input:checkbox[name=jira-issue]:checked",c).length;if(a>0||e){b.enableInsert()}else{b.disableInsert()}b.changeInsertOptionStatus(a,e,d)}else{if(AJS.$(".jira-oauth-message-marker",c).length){b.authCheck(this.selectedServer)}AJS.$("input",c).focus();b.disableInsert()}if(b.isInsertDisabled()){return}b.validateMaxIssues()},isValidMaxIssues:function(a){return AJS.$.isNumeric(a)&&(this.MINIMUM_MAX_ISSUES_VAL<=a&&a<=this.MAXIMUM_MAX_ISSUES_VAL)},validateMaxIssues:function(i){var b=AJS.$("#jira-maximum-issues");function d(){b.next("#jira-max-number-error").remove()}function f(){b.attr("disabled","disabled")}function h(){b.removeAttr("disabled")}function c(){d();b.after(Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues())}switch(AJS.$("input:radio[name=insert-advanced]:checked").val()){case"insert-single":case"insert-count":d();f();break;case"insert-table":var a=AJS.Editor.JiraConnector.Panel.Search.prototype;h();var g=b.val();if(AJS.$.trim(g)===""){if(i&&i.type==="keyup"){d();break}if(i&&i.type==="blur"){g=a.MAXIMUM_MAX_ISSUES_VAL;b.val(g);break}}if(a.isValidMaxIssues(g)){d();a.enableInsert()}else{c();a.disableInsert()}break}},customizedColumn:null,parseColumnsStringToArray:function(g){var f="";var b=[];var a=null;var c=function(i,h){i=AJS.$.trim(i);if(i!=""){h.push(i)}};for(var e=0;e<g.length;e++){var d=g.charAt(e);if(d!==","&&d!=='"'&&d!=="'"){f+=d}if(d==='"'||d==="'"){if(a==null){a=d}else{if(a===d){c(f,b);f="";a=null}}}else{if(d===","){if(a==null){c(f,b);f=""}else{f+=d}}}}c(f,b);return b},parseArrayToColumnString:function(b){var a="";for(var c=0;c<b.length;c++){var d=AJS.$.trim(b[c]);if(d!=""){if(d.indexOf(",")>=0){d='"'+d+'"'}if(c!=0){a+=","}a+=d}}},checkAndSetDefaultValueMaximumIssues:function(a){if(!a){AJS.log("Cannot set default value for Maximum Issues");return}var b=a.element||AJS.$("#jira-maximum-issues");var d=a.defaultVal||this.MAXIMUM_MAX_ISSUES_VAL;var c=AJS.$.trim(b.val());if(c===""){b.val(d)}},setMacroParams:function(a){this.macroParams=a},getMacroParamsFromUserInput:function(){var e=((AJS.$("input:radio[name=insert-advanced]:checked").val()=="insert-count")?true:false);var d=[];var a=[];AJS.$("#my-jira-search .my-result.aui input:checkbox[name=jira-issue]").each(function(f){var g=AJS.$(this);if(g.is(":checked")){d[d.length]=g.val()}else{a[a.length]=g.val()}});var c={};if(e){c.count="true"}else{if(!AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox){c.columns=this.defaultColumns;return}c.columns=AJS.Editor.JiraConnector.Select2.getKeyColumnsSelectedOptions(AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox);if(!c.columns){c.columns=this.defaultColumns}}var b=AJS.$("input:radio[name=insert-advanced]:checked").val();if(b==="insert-single"){c.key=d.toString()}else{if(a.length==0){c.jqlQuery=this.lastSearch+" "}else{if(d.length==1){c.jqlQuery="key = "+d.toString()}else{c.jqlQuery="key in ("+d.toString()+")"}}}if(b==="insert-table"){c.maximumIssues=AJS.$("#jira-maximum-issues").val()}return c},insertLinkFromForm:function(){var c=this;var b=c.container;var d=AJS.$("input:checkbox[name=jira-issue]",b);if(d.length){var a=AJS.$("input:checkbox[name=jira-issue]:checked",b).length;if(a>0){c.insertLink()}}},insertLink:function(c){var a;if(c&&typeof c.insertIssueLinkWithParams==="function"){a=c}else{a=this}var b=a.getMacroParamsFromUserInput();a.insertIssueLinkWithParams(b);return true},loadMacroParams:function(a){var b=this.macroParams;if(!b){this.prepareColumnInput(a||this.defaultColumns);this.checkAndSetDefaultValueMaximumIssues({defaultVal:20})}else{b.columns=a||b.columns||this.defaultColumns;if(!b.maximumIssues){AJS.$("#jira-maximum-issues").attr("disabled","disabled")}if(b.count=="true"){AJS.$("#opt-total").prop("checked",true)}else{AJS.$("#opt-table").prop("checked",true);AJS.$("#jira-maximum-issues").removeAttr("disabled");var c=b.maximumIssues||this.DEFAULT_MAX_ISSUES_VAL;this.checkAndSetDefaultValueMaximumIssues({defaultVal:c})}this.prepareColumnInput(b.columns)}},selectHandler:function(){var a=this.container;var b=a.find("tr.selected");if(b.length){b.unbind("keydown.space").bind("keydown.space",function(c){if(c.which==32||c.keyCode==32){var d=b.find("[type=checkbox]");d.trigger("click")}})}},addDisplayOptionPanel:function(){var a=Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml;AJS.$(".jiraSearchResults").after(a());AJS.$("#jiraMacroDlg").unbind("submit").on("submit",function(b){return false})},updateTotalIssuesDisplay:function(b){var a=this.selectedServer.url+"/issues/?jql="+this.lastSearch;if(b>20){AJS.$(".my-result.aui").after(Confluence.Templates.ConfluenceJiraPlugin.viewAll({jiraIssuesLink:a}))}var c=AJS.format("{0} issues",b);AJS.$(".total-issues-text").html(c);AJS.$(".total-issues-link").attr("href",a)},prepareColumnInput:function(c){var b=c.split(/\s*,\s*/);for(var a in b){var g=b[a];if(g&&typeof g.toLowerCase==="function"){b[a]=g.toLowerCase()}}var f=this.selectedServer;var d={issuekey:"key",duedate:"due",issuetype:"type"};var e=function(j){var p=[];var s=AJS.$("#jiraIssueColumnSelector");var l="";var o="";var r;for(var k=0;k<j.length;k++){var q=j[k];if(q.navigable){if(d[q.id]){q.id=d[q.id]}if(q.custom===true){r=q.name.toLowerCase()}else{r=q.id.toLowerCase()}var n=AJS.template("<option value='{value}'>{displayValue}</option>");p[r]=q.name;if(AJS.$.inArray(r,b)<0){l+=n.fill({value:r,displayValue:q.name})}}}p.key="Key";for(var k=0;k<b.length;k++){var h=AJS.template("<option selected='true' value='{value}'>{displayValue}</option>");r=b[k].toLowerCase();if(p[r]!=null){o+=h.fill({value:r,displayValue:p[r]})}}var m=o+l;s.hide();s.html(m);s.show();s.auiSelect2({width:"415px",containerCssClass:"select2-container-jira-issue-columns"});AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox=s};if(f.columns&&f.columns.length>0){e(f.columns);return}this.retrieveJson(f.id,"/rest/api/2/field",function(h){if(h&&h.length){f.columns=h;e(f.columns)}})},expandDisplayOptPanel:function(){var b=AJS.$(".jql-display-opts-overlay");var c=b.height();var d=40;b.css("top","");var a=-(c-d);b.css("bottom",a+"px");b.animate({bottom:0},500)},minimizeDisplayOptPanel:function(){var a=AJS.$(".jql-display-opts-overlay");a.css("top",a.position().top+"px");a.css("bottom","");a.animate({top:420},500)},disableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",false)},enableAutoSelectColumns:function(){AJS.Editor.JiraConnector.Panel.Search.jiraColumnSelectBox.auiSelect2("enable",true)},checkAutoSelectColumns:function(){if(AJS.$("#opt-table").prop("checked")){this.enableAutoSelectColumns()}else{this.disableAutoSelectColumns();this.enableInsert()}},bindEventToDisplayOptionPanel:function(f,h){var d=this;var b=AJS.$(".jql-display-opts-close, .jql-display-opts-open"),c=AJS.$(".jql-display-opts-overlay"),i=AJS.$(".jql-display-opts-inner .radio"),a=AJS.$("#my-jira-search input:checkbox[name=jira-issue-all]"),e=AJS.$("#my-jira-search input:checkbox[name=jira-issue]");var g=AJS.$("#jira-maximum-issues");g.on("blur keyup",AJS.Editor.JiraConnector.Panel.Search.prototype.validateMaxIssues);c.css("top","420px");b.click(function(j){j.preventDefault();if(AJS.$(this).hasClass("disabled")){return}var k=AJS.$(this).hasClass("jql-display-opts-open");if(k){d.expandDisplayOptPanel();jQuery(this).addClass("jql-display-opts-close");jQuery(this).removeClass("jql-display-opts-open")}else{d.minimizeDisplayOptPanel();jQuery(this).removeClass("jql-display-opts-close");jQuery(this).addClass("jql-display-opts-open")}});i.change(function(){d.checkAutoSelectColumns();d.validateMaxIssues()});a.bind("click",function(){var j=AJS.$(this);if(j.prop("checked")){e.prop("checked","checked")}else{e.removeAttr("checked")}d.validate()});e.change(function(){var j=AJS.$("#my-jira-search input:checkbox[name=jira-issue]:not(:checked)").length;if(j>0){a.removeAttr("checked")}else{a.prop("checked","checked")}d.validate()});d.validate(f,h)},changeInsertOptionStatus:function(q,n,f){var r=this;var g=AJS.$("#opt-single");var d=AJS.$("#opt-total");var m=AJS.$("#opt-table");var j=AJS.$("#my-jira-search input:checkbox[name=jira-issue]:checked");var i=AJS.$("#my-jira-search input:checkbox[name=jira-issue-all]").attr("checked")==="checked";var l=j.length===1;var p=j.length>1;var h=j.length===0;var b=AJS.JQLHelper.isSingleKeyJQLExp(AJS.$("#my-jira-search input[name=jiraSearch]").val());var c=function(){if(f&&f.isJqlQuery){m.click()}else{g.click()}};var k=function(){d.attr("disabled","disabled");m.removeAttr("disabled");g.removeAttr("disabled");c();setTimeout(function(){c()},100)};var e=function(){g.attr("disabled","disabled");d.removeAttr("disabled");if(AJS.$("input[name=insert-advanced]:checked").val()==="insert-single"){setTimeout(function(){m.removeAttr("disabled").click()},100)}};var o=function(){m.removeAttr("disabled","disabled");d.removeAttr("disabled","disabled");g.removeAttr("disabled","disabled");var s=AJS.$("input:radio[name=insert-advanced]:checked").val();if(s==="insert-single"){setTimeout(function(){m.click()},100)}};var a=function(){g.attr("disabled","disabled");d.attr("disabled","disabled");m.attr("disabled","disabled");AJS.$(".jql-display-opts-close").click();AJS.$(".jql-display-opts-open").addClass("disabled")};AJS.$(".jql-display-opts-open").removeClass("disabled");g.removeAttr("disabled");d.removeAttr("disabled");m.removeAttr("disabled");if(i&&l&&b){k()}else{if(i&&l&&!b){o()}else{if(p){e()}else{if(l&&!i){k()}else{if(n){e()}else{if(h){a()}}}}}}},isInsertTableType:function(){return AJS.$("input:radio[name=insert-advanced]:checked").val()==="insert-table"},setInsertButtonState:function(){var a=AJS.$(".jql-display-opts-close, .jql-display-opts-open");var b=AJS.$("#jira-maximum-issues");if(!a.length||(a.length&&this.isInsertTableType()&&!this.isValidMaxIssues(b.val()))){this.disableInsert()}else{this.enableInsert()}},analyticPanelActionName:"confluence.jira.plugin.searchadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Search());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/jip_createissuepanel.js' */
AJS.Editor.JiraConnector.Panel.Create=function(){};AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Create.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Create.prototype,{DEFAULT_PROJECT_VALUE:"-1",SHOW_MESSAGE_ON_TOP:true,EXCLUDED_FIELDS:["project","issuetype","summary","description"],PROJECTS_META:{},setSummary:function(b){var a=AJS.$('.field-group [name="summary"]',this.jipForm.formEl);a.length&&a.val(b)},resetIssue:function(){AJS.$(".issue-summary",this.container).empty();AJS.$(".issue-description",this.container).empty()},focusForm:function(){var a=AJS.$("select.server-select",this.container);if(a.length){a.focus()}else{var b=AJS.$(".project-select",this.container);b.length&&b.focus()}},authCheck:function(){this.selectedServer=this.jipForm.getCurrentServer();if(this.selectedServer.authUrl){this.showOauthChallenge()}else{this.serverSelect()}},ajaxAuthCheck:function(b){var a=this;this.endLoading();this.ajaxError(b,function(){a.authCheck(a.jipForm.getCurrentServer())})},showOauthChallenge:function(){AJS.$("div.field-group",this.container).not(".servers").hide();AJS.$(".jira-oauth-message-marker",this.container).remove();var a=this;var b=this.createOauthForm(function(){a.serverSelect()});this.container.append(b)},projectOk:function(){var a=AJS.$(".project-select option:selected",this.container).val();return a&&a.length&&a!=this.DEFAULT_PROJECT_VALUE},setInsertButtonState:function(){if(this.formHasError===false&&this.projectOk()){this.enableInsert();return true}else{this.disableInsert();return false}},startLoading:function(){this.removeError(this.container);AJS.$(".loading-blanket",this.container).removeClass("hidden");AJS.$("input,select,textarea",this.container).disable();this.disableInsert();this.handleInsertWaiting(true)},endLoading:function(){AJS.$(".loading-blanket",this.container).addClass("hidden");AJS.$("input,select,textarea",this.container).enable();if(AJS.$(".project-select",this.container).val()===this.DEFAULT_PROJECT_VALUE){AJS.$(".issuetype-select",this.container).disable()}this.setInsertButtonState();this.handleInsertWaiting(false)},bindEvent:function(){var b=this;var a=AJS.$('.field-group [name="summary"]',this.jipForm.formEl);a.keyup(function(){b.setInsertButtonState()});this.container.on("focus","input[data-aui-dp-uuid]",function(){var c=AJS.$(this).attr("data-aui-dp-uuid");setTimeout(function(){AJS.$("[data-aui-dp-popup-uuid="+c+"]").parents(".aui-inline-dialog").addClass("datepicker-patch")},0)})},title:function(){return "Create New Issue"},init:function(b){var c=this;b.html('<div class="create-issue-container"></div>');this.container=AJS.$("div.create-issue-container");var a=this.container;var d=AJS.Editor.JiraConnector.servers;this.selectedServer=d[0];this.jipForm=new jiraIntegration.JiraCreateIssueForm({container:".create-issue-container",renderSummaryAndDescription:true,onError:function(){AJS.$(".field-group .error",this.container).remove();c.formHasError=true;c.disableInsert()},onServerChanged:function(){AJS.$(".field-group .error",this.container).remove();c.setInsertButtonState();c.selectedServer=this.getCurrentServer()},onRequiredFieldsRendered:function(f,e){AJS.$(".field-group .error",this.container).remove();c.formHasError=!!e.length;c.setInsertButtonState()}});b.onselect=function(){c.onselect()};this.bindEvent()},convertFormToJSON:function(b){if(!jiraIntegration){AJS.logError("Jira integration plugin is missing!");return""}var c={};c.issues=[];var a={};a.fields={project:{id:AJS.$(".project-select option:selected",b).val()},issuetype:{id:AJS.$(".issuetype-select option:selected",b).val()},summary:AJS.$('.field-group [name="summary"]',b).val(),description:AJS.$('.field-group [name="description"]',b).val()};b.children(".create-issue-required-fields").children(".jira-field").children("input,select,textarea").not(".select2-input").each(function(d,e){var f=AJS.$(e);a.fields[f.attr("name")]=jiraIntegration.fields.getJSON(f)});c.issues.push(a);return JSON.stringify(c)},validateRequiredFieldInForm:function(b){var d=true;var a="placeholder" in document.createElement("input");var c=b.find(".field-group .icon-required, .field-group .aui-icon-required");c.each(function(h,l){var k=AJS.$(l).parent();var g=k.text();var i=k.nextAll("input,select,textarea");var j=AJS.$.trim(i.val());if(!j||(!a&&j==i.attr("placeholder"))){d=false;var f=k.parent();var e=AJS.format("{0} is required",g);f.append(aui.form.fieldError({message:e}))}});return d},clearFieldErrors:function(){AJS.$("form div.error",this.container).remove()},insertLink:function(){var b=this;var c=Confluence.getContextPath()+"/rest/jira-integration/1.0/issues";var a=AJS.$("div.create-issue-container form");var d=this.jipForm.getCurrentServer();b.clearFieldErrors();if(!b.validateRequiredFieldInForm(a)){return}this.startLoading();AJS.$.ajax({type:"POST",contentType:"application/json",url:c+"?applicationId="+this.selectedServer.id,data:this.convertFormToJSON(a),success:function(h){var f=h&&h.issues&&h.issues[0]&&h.issues[0].issue&&h.issues[0].issue.key;if(!f){if(!_.isEmpty(h.errors[0].elementErrors.errorMessages)){var g=h.errors[0].elementErrors.errorMessages;var i=Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel({errors:g,serverUrl:d.displayUrl});b.errorMsg(AJS.$("div.create-issue-container"),i)}var e=h.errors[0].elementErrors.errors;_.each(e,function(l,k){var j=aui.form.fieldError({message:l});AJS.$(AJS.format(".field-group [name={0}]",k),a).after(j)})}else{b.insertIssueLink(f,d.displayUrl+"/browse/"+f);b.resetIssue()}b.endLoading()},error:function(f,e){b.ajaxAuthCheck(f)}})},onselect:function(){var a=!!AJS.$(".aui-message > .oauth-init",this.container).length;if(this.selectedServer&&!this.selectedServer.authUrl&&a){this.jipForm.defaultFields.server.trigger("change")}else{this.setInsertButtonState()}},analyticPanelActionName:"confluence.jira.plugin.issuecreated"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Create());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = '/jira/recentlyviewedpanel.js' */
AJS.Editor.JiraConnector.Panel.Recent=function(){};AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,AJS.Editor.JiraConnector.Panel.prototype);AJS.Editor.JiraConnector.Panel.Recent.prototype=AJS.$.extend(AJS.Editor.JiraConnector.Panel.Recent.prototype,{title:function(){return "Recently Viewed"},init:function(a){var d=AJS.Editor.JiraConnector.servers;a.html('<div id="my-recent-issues" '+(d.length>1?'class="multi-server" ':"")+"></div>");var c=this;this.selectedServer=d[0];if(d.length>1){var b=AJS.$('<div class="jira-server-select"><form action="#" method="post" class="aui"><div class="field-group"><label>Server</label><select class="select" ></select></div></form></div>').appendTo("div#my-recent-issues");this.applinkServerSelect(AJS.$(".select",b),function(e){c.selectedServer=e;c.onselect()})}a.onselect=function(){c.onselect()}},insertLink:function(){this.insertSelected()},onselect:function(){var c=this;var b=AJS.$("div#my-recent-issues");this.container=b;var d=function(){b.children().not(".jira-server-select").remove()};var e;var a=function(){if(c.selectedServer.authUrl){d();var f=c.createOauthForm(function(){e()});b.append(f)}else{e()}};e=function(){if(c.currentXhr&&c.currentXhr.readyState!=4){return}var f=AJS.$(".select",b);f.disable();d();var g="key+in+issueHistory()+ORDER+BY+lastViewed+DESC";c.createIssueTableFromUrl(b,c.selectedServer.id,"/sr/jira.issueviews:searchrequest-xml/temp/SearchRequest.xml?jqlQuery="+g+"&field=summary&field=type&field=link&tempMax=50&returnMax=true",c.setSelectedIssue,c.insertLink,c.disableInsert,function(){f.length&&f.focus()},function(h){AJS.$("div.data-table",b).remove();c.ajaxError(h,a)},false)};a()},analyticPanelActionName:"confluence.jira.plugin.recentlyviewadded"});AJS.Editor.JiraConnector.Panels.push(new AJS.Editor.JiraConnector.Panel.Recent());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/dialog.soy' */
// This file was automatically generated from dialog.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.displayOptsHtml = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'jql-display-opts-bar data-table\'><a href=\'#\' class=\'jql-display-opts-open\' data-title="', soy.$$escapeHtml("Display options panel is not available without a selection."), '"><span></span><strong>', soy.$$escapeHtml("Display options"), '</strong></a></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.displayOptsOverlayHtml = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'jql-display-opts-overlay data-table\'><form id="jiraMacroDlg" class="aui" action="#"><div class=\'jql-display-opts-inner\'><a href=\'#\' class=\'jql-display-opts-open\' data-title="', soy.$$escapeHtml("Display options panel is not available without a selection."), '"><span></span><strong>', soy.$$escapeHtml("Display options"), '</strong></a><fieldset class="group"><legend><span>', soy.$$escapeHtml("Display as"), '</span></legend><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-single\' value=\'insert-single\'><label for=\'opt-single\'>', soy.$$escapeHtml("Single issue"), '</label><div class=\'description\'>', soy.$$escapeHtml("Display the macro as a single issue."), '</div></div><div class="radio"><input type=\'radio\' class=\'radio\' name=\'insert-advanced\' id=\'opt-total\' value=\'insert-count\'><label for=\'opt-total\'>', soy.$$escapeHtml("Total issue count"), '</label><div class=\'description\'>', soy.$$escapeHtml("Display total number of issues as a link. E.g."), '<a class=\'total-issues-link\' target=\'_blank\' href=\'#\'><span class=\'total-issues-text\'>', soy.$$escapeHtml(AJS.format("{0} issues",12)), '</span></a></div></div><div class="radio"><input type=\'radio\' class=\'radio\' checked=\'checked\' name=\'insert-advanced\' id=\'opt-table\' value=\'insert-table\'><label for=\'opt-table\'>', soy.$$escapeHtml("Table"), '</label><div class=\'description\'>', soy.$$escapeHtml("Customise your columns below."), '</div></div></fieldset><fieldset><div class="field-group"><label>', soy.$$escapeHtml("Maximum issues"), '</label><input type="text" name="jira-maximum-issues" id="jira-maximum-issues" class="text short-field" /><div class="description">', soy.$$escapeHtml("Leave empty to get all issues."), '</div></div></fieldset><fieldset><div class="field-group"><label>', soy.$$escapeHtml("Columns to display"), '</label><select id="jiraIssueColumnSelector" data-placeholder="', soy.$$escapeHtml("Start typing to see possible columns"), '" multiple="true" class="select long-field"></select></div></fieldset></div></form></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.searchForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'jira-search-form\'><form class=\'aui\'><fieldset class=\'inline\'>', (opt_data.isMultiServer == true) ? '<div class=\'search-input\'><input type=\'text\' class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml("e.g. filter \x3d \x22My JIRA filter\x22") + '"/></div>' : '<div class=\'search-input one-server\'><input type=\'text\' class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml("e.g. filter \x3d \x22My JIRA filter\x22") + '"/></div>', '<button type=\'button\' title="', soy.$$escapeHtml("Search"), '" class=\'button\'><span class="aui-icon aui-icon-small aui-iconfont-search"></span></button></fieldset><div class=\'search-help\'>', soy.$$escapeHtml("Search using any issue key, search URL, JIRA link, JQL, plain text or filter"), '</div></form></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.warningDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'warning-body\'><p>', soy.$$escapeHtml("If you connect Confluence to JIRA you can easily link issues..."), '</p>', (opt_data.isAdministrator == false) ? '<p>' + soy.$$escapeHtml("Your administrator can set this up.") + '</p>' : '', '</div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.issueCheckbox = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<input type=\'checkbox\' name=\'jira-issue\' value=\'', soy.$$escapeHtml(opt_data.issueKey), '\' checked/>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.issueKey = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span><img class="icon" src="', soy.$$escapeHtml(opt_data.issueIconUrl), '"/> ', soy.$$escapeHtml(opt_data.issueKey), '</span>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.showMessageNoServer = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.isAdministrator == true) ? soy.$$escapeHtml("No server found match with your URL.") + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml("Click here to set this up") + '</a>' : soy.$$escapeHtml("No server found match with your URL. Your administrator can set this up.") + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml("Click here to contact your admin") + '</a>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.viewAll = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class=\'view-all\'>', soy.$$escapeHtml("Displaying first 20 results."), '<a href=\'', soy.$$escapeHtml(opt_data.jiraIssuesLink), '\' target=\'_blank\'>', soy.$$escapeHtml("View all."), '</a></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.learnMore = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a href="', soy.$$escapeHtml("JIRA+Issues+Macro"), '" target=\'_blank\'>', soy.$$escapeHtml("Learn More"), '</a>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="jira-chart-content-', soy.$$escapeHtml(opt_data.chartType), '"><div class=\'jira-chart-search\'><form class=\'aui\'><fieldset class=\'inline\'>', (opt_data.isMultiServer == true) ? '<div class=\'jira-chart-search-input\'><input type=\'text\' id="jira-chart-search-input" class=\'text search-text\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml("e.g. filter \x3d \x22My JIRA filter\x22") + '"/></div><select id="jira-chart-servers" class="select" name="server" tabindex="0" />' : '<div class=\'jira-chart-search-input one-server\'><input type=\'text\' id="jira-chart-search-input" class=\'text one-server long-field\' name=\'jiraSearch\' placeholder="' + soy.$$escapeHtml("e.g. filter \x3d \x22My JIRA filter\x22") + '"/></div>', '<button id="jira-chart-search-button" type=\'button\' class=\'button\'>', soy.$$escapeHtml("Preview"), '</button></fieldset><div class=\'search-help\'>', soy.$$escapeHtml("Search using any issue key, search URL, JIRA link, JQL, plain text or filter"), '</div></form></div><div class="jira-chart-img"></div><div class="jira-chart-option"><form action="#" class="aui" id="jiraChartMacroOption"><div class="jiraChartOption"><a class="jirachart-display-opts-open" href="#"><span class="display-option-icon"></span><strong>', soy.$$escapeHtml("Display options"), '</strong></a>');
  if (opt_data.chartType == 'pie') {
    Confluence.Templates.ConfluenceJiraPlugin.piechartForm(null, output);
  } else if (opt_data.chartType == 'createdvsresolved') {
    Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved(null, output);
  } else if (opt_data.chartType == 'twodimensional') {
    Confluence.Templates.ConfluenceJiraPlugin.twoDimensional(null, output);
  }
  output.append('</div></form></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.piechartForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset><div class="field-group"><label for="jira-chart-statType">', soy.$$escapeHtml("Chart by"), '</label><select name="type" id="jira-chart-statType" class="select"></select></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">', soy.$$escapeHtml("Width"), '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="', soy.$$escapeHtml("Enter pixels, percent or leave blank to auto-resize."), '"></span><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-pie-chart-show-border">', soy.$$escapeHtml("Show border"), '</label></div><div class="checkbox"><input type="checkbox" id="jira-pie-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-pie-chart-show-infor">', soy.$$escapeHtml("Show chart information"), '</label></div></div></fieldset>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.createdVsResolved = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset><div class="field-group"><label for="created-vs-resolved-chart-periodName">', soy.$$escapeHtml("Period"), '</label><select class="select" id="created-vs-resolved-chart-periodName" name="created-vs-resolved-chart-periodName"><option value="hourly">', soy.$$escapeHtml("Hourly"), '</option><option value="daily">', soy.$$escapeHtml("Daily"), '</option><option value="weekly">', soy.$$escapeHtml("Weekly"), '</option><option value="monthly">', soy.$$escapeHtml("Monthly"), '</option><option value="quarterly">', soy.$$escapeHtml("Quarterly"), '</option><option value="yearly">', soy.$$escapeHtml("Yearly"), '</option></select><div class="error"></div></div><div class="field-group"><label for="created-vs-resolved-chart-daysprevious">', soy.$$escapeHtml("Days previously"), '<span class="aui-icon icon-required"></span></label><input type="text" class="text" id="created-vs-resolved-chart-daysprevious" value="30"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment daysPreviousInfo" title="', soy.$$escapeHtml("Number of days to include (counting back from today)."), '"></span><div class="error days-previous-error"></div></div><fieldset class="group"><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-cumulative" name="created-vs-resolved-chart-cumulative" class="checkbox"><label for="created-vs-resolved-chart-cumulative">', soy.$$escapeHtml("Cumulative totals"), '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment cumulativeInfo" title="', soy.$$escapeHtml("Progressively add totals (1, 2, 3) or show individual values (1,1,1)."), '"></span></div><div class="checkbox"><input type="checkbox" id="created-vs-resolved-chart-showunresolvedtrend" name="created-vs-resolved-chart-showunresolvedtrend" class="checkbox"><label for="created-vs-resolved-chart-showunresolvedtrend">', soy.$$escapeHtml("Show unresolved trend"), '</label><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment showunresolvedtrendInfo" title="', soy.$$escapeHtml("Include a subplot showing unresolved issues."), '"></span></div></fieldset><div class="field-group"><label for="created-vs-resolved-chart-versionLabel">', soy.$$escapeHtml("Show versions"), '</label><select class="select" id="created-vs-resolved-chart-versionLabel" name="created-vs-resolved-chart-versionLabel"><option value="all">', soy.$$escapeHtml("All versions"), '</option><option value="major">', soy.$$escapeHtml("Only major versions"), '</option><option value="none">', soy.$$escapeHtml("None"), '</option></select><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment versionLabelInfo" title="', soy.$$escapeHtml("Mark version release dates in the chart."), '"></span><div class="error"></div></div></fieldset><fieldset class="group"><div class="field-group"><label for="jira-chart-width">', soy.$$escapeHtml("Width"), '</label><input type="text" name="jira-chart-width" id="jira-chart-width" class="text short-field"><span class="aui-icon aui-icon-small aui-iconfont-help help-aligment widthInfo" title="', soy.$$escapeHtml("Enter pixels, percent or leave blank to auto-resize."), '"></span><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-border" class="checkbox jira-chart-show-border"><label for="jira-createdvsresolved-chart-show-border">', soy.$$escapeHtml("Show border"), '</label></div><div class="checkbox"><input type="checkbox" id="jira-createdvsresolved-chart-show-infor" class="checkbox jira-chart-show-infor"><label for="jira-createdvsresolved-chart-show-infor">', soy.$$escapeHtml("Show chart information"), '</label></div></div></fieldset>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.twoDimensional = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<fieldset><div id="jira-chart-support-all-version" class="hidden"/><div class="field-group"><label for="twodimensional-xaxis">', soy.$$escapeHtml("XAxis"), '</label><select class="select" id="twodimensional-xaxis"><option value="statuses">', soy.$$escapeHtml("Status"), '</option><option value="priorities">', soy.$$escapeHtml("Priority"), '</option><option value="assignees">', soy.$$escapeHtml("Assignee"), '</option><option value="allFixfor">', soy.$$escapeHtml("Fix For Versions (all)"), '</option><option value="components">', soy.$$escapeHtml("Component"), '</option><option value="issuetype">', soy.$$escapeHtml("Issue Type"), '</option></select></div><div class="field-group"><label for="twodimensional-yaxis">', soy.$$escapeHtml("YAxis"), '</label><select class="select" id="twodimensional-yaxis"><option value="statuses">', soy.$$escapeHtml("Status"), '</option><option value="priorities">', soy.$$escapeHtml("Priority"), '</option><option value="assignees">', soy.$$escapeHtml("Assignee"), '</option><option value="allFixfor">', soy.$$escapeHtml("Fix For Versions (all)"), '</option><option value="components">', soy.$$escapeHtml("Component"), '</option><option value="issuetype">', soy.$$escapeHtml("Issue Type"), '</option></select></div><div class="field-group"><label for="twodimensional-number-of-result">', soy.$$escapeHtml("Rows to display"), '</label><input type="text" name="twodimensional-number-of-result" id="twodimensional-number-of-result" class="text short-field"><div class="error twodimensional-number-of-result-error"></div></div></fieldset>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message-container"><div class="aui-message error closeable shadowed"><p class="title"><span class="aui-icon icon-error"></span><strong></strong></p><span class=\'message\'>', soy.$$escapeHtml(opt_data.message), '</span><span class="aui-icon icon-close" role="button" tabindex="0"></span></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.noServerWarning = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message-container"><div class="aui-message warning">', (opt_data.isAdministrator == true) ? soy.$$escapeHtml("No server found match with your URL.") + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/admin/listapplicationlinks.action">' + soy.$$escapeHtml("Click here to set this up") + '</a>' : soy.$$escapeHtml("No server found match with your URL. Your administrator can set this up.") + '<a id="open_applinks" target="_blank" href="' + soy.$$escapeHtml(opt_data.contextPath) + '/wiki/contactadministrators.action">' + soy.$$escapeHtml("Click here to contact your admin") + '</a>', '<span class="aui-icon icon-warning"></span></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.addMoreToComeLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="page-menu-item"><button class="item-button moreToCome"><a target="_blank" href="http://go.atlassian.com/confluencejiracharts">', soy.$$escapeHtml("More to come..."), '</a></button></li>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="page-menu-item"><hr><span class="aui-nav-heading jira-padding-left-10px"><strong>', soy.$$escapeHtml("OTHER JIRA CONTENT"), '</strong></span><nav class="aui-navgroup aui-navgroup-vertical"><div class="aui-navgroup-inner"><ul class="aui-nav"><li><button class="item-button jira-left-panel-link" id="', soy.$$escapeHtml(opt_data.id), '">', soy.$$escapeHtml(opt_data.label), '</button></li></ul></div></nav></li>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="aui-message-container"><div class="aui-message warning">', soy.$$escapeHtml("The JIRA server didn\x27t understand your search query. If you entered JQL, please ensure that it\x27s correctly formed. If you entered an issue key, ensure that it exists and you have permission to view it."), '<span class="aui-icon icon-warning"></span></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="error width-error">', (opt_data.error == 'wrongFormat') ? soy.$$escapeHtml("The width must be in correct format") : (opt_data.error == 'wrongNumber') ? soy.$$escapeHtml("The width must be a number between 100 and 9000") : '', '</div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.warningValMaxiumIssues = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="jira-max-number-error" class="error">', soy.$$escapeHtml("Must be a number between 1 and 1000."), '</div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="jira-unsupported-version aui-message-container"><div class="aui-message warning">', soy.$$escapeHtml("JIRA Charts are not available for your version of JIRA. Upgrade to JIRA 6.1.1 or later to use this macro."), '<span class="aui-icon icon-warning"></span></div></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:dialogsJs', location = 'templates/soy/create_issues.soy' */
// This file was automatically generated from create_issues.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.ConfluenceJiraPlugin == 'undefined') { Confluence.Templates.ConfluenceJiraPlugin = {}; }


Confluence.Templates.ConfluenceJiraPlugin.createIssuesForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui" id="create-issues-form"><div class="loading-blanket hidden"><div class="loading-data"/></div><div class="field-group servers"><label>', soy.$$escapeHtml("Server"), '</label><select class="select server-select"></select></div><div class="field-group project-select-parent" ><label>', soy.$$escapeHtml("Project"), '</label><select class="select project-select" name="pid"></select></div><div class="field-group type-select-parent issues-type-group" ><label>', soy.$$escapeHtml("Issue Type"), '</label><select class="select type-select" name="issuetype"></select></div><div class="field-group"><label>', soy.$$escapeHtml("Summary"), '<span class="aui-icon icon-required"/></label><input class="text issue-summary" type="text" name="summary"/></div><div id="jira-required-fields-panel"></div><div class="field-group"><label>', soy.$$escapeHtml("Description"), '</label><textarea class="issue-description textarea" rows="5" name="description"/></div></form>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.renderOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var optionList15 = opt_data.options;
  var optionListLen15 = optionList15.length;
  for (var optionIndex15 = 0; optionIndex15 < optionListLen15; optionIndex15++) {
    var optionData15 = optionList15[optionIndex15];
    output.append('<option value="', soy.$$escapeHtml(optionData15.id), '">', soy.$$escapeHtml(optionData15.name), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.renderOption = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<option value="', soy.$$escapeHtml(opt_data.option.id), '" data-jira-option-key="', soy.$$escapeHtml(opt_data.option.key), '">', soy.$$escapeHtml(opt_data.option.name), '</option>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.ConfluenceJiraPlugin.renderCreateErrorPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml("There were errors creating an issue in"), '<a target="_blank" href=', soy.$$escapeHtml(opt_data.serverUrl), '>JIRA</a></div><ul>');
  var errorList36 = opt_data.errors;
  var errorListLen36 = errorList36.length;
  for (var errorIndex36 = 0; errorIndex36 < errorListLen36; errorIndex36++) {
    var errorData36 = errorList36[errorIndex36];
    output.append('<li>', soy.$$escapeHtml(errorData36), '</li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-core', location = 'js/autoconvert/tinymce-autoconvert.js' */
(function(e){function h(a){for(var c=h.options,a=c.parser[c.strictMode?"strict":"loose"].exec(a),d={},b=14;b--;)d[c.key[b]]=a[b]||"";d[c.q.name]={};d[c.key[12]].replace(c.q.parser,function(a,b,e){b&&(d[c.q.name][b]=e)});return d}tinymce.plugins.Autoconvert=function(a){a.onUndo.add(this.cleanLinks);this.editor=a;this.weightedHandlers=[];this.handlers=[]};tinymce.plugins.Autoconvert.prototype.addHandler=function(a,c){this.weightedHandlers.push({handler:a,weight:c||0});this.weightedHandlers.sort(function(a,
b){return a.weight-b.weight});this.handlers=[];for(var d=this.weightedHandlers.length,b=0;b<d;b++)this.handlers.push(this.weightedHandlers[b].handler)};tinymce.plugins.Autoconvert.prototype.cleanLinks=function(a){e("a.atlassian-autoconvert",a.getDoc()).removeClass("atlassian-autoconvert");return!0};tinymce.plugins.Autoconvert.prototype.callHandlers=function(a){function c(c){if(c&&(1!==c.length||!c.attr("href")))return b(c);if(c)a=c,g=0,j=h(a.attr("href")),d(f.handlers[g],j,a);else if(g++,g<f.handlers.length)d(f.handlers[g],
j,a);else return b(a)}function d(a,b,d){var e=c,i;i=setTimeout(function(){AJS.log("Autoconvert: Callback #"+g+" failed to call continuation in time. If there is no subsequent log, the handler is improperly implemented and should be uninstalled.");e=function(){AJS.log("Autoconvert: Callback #"+g+" did eventualy return. Probably a slow async call.")};c()},tinymce.plugins.Autoconvert.callbackTimeout);a(b,d,function(){var a=g;clearTimeout(i);e.apply(f,arguments);e=function(){AJS.log("Autoconvert: Callback #"+
a+" called the continuation multiple times.")}})}function b(a){f.editor.undoManager.beforeChange();var b=f.editor.selection,c=f.editor.selection.getBookmark();i.replaceWith(a);b.moveToBookmark(c);f.editor.undoManager.add()}var g=0,f=this,i=e(a),a=e(a).clone(),k=a.attr("href"),j=h(k.replace(/^(.*?\/\/[^/]*?\/.*?)(@)/,"$1%40"));0!==this.handlers.length&&d(this.handlers[0],j,a)};tinymce.plugins.Autoconvert.callbackTimeout=5E3;tinymce.plugins.Autoconvert.convertMacroToDom=function(a,c,d){a={macro:a,contentId:AJS.Meta.get("content-id")};
e.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:AJS.params.contextPath+"/rest/tinymce/1/macro/placeholder",data:e.toJSON(a),dataType:"text",success:c,error:d,timeout:45E3})};tinymce.plugins.Autoconvert.convertMacroToDomViaWikiText=function(a,c,d){var b=["{",a.name],g=!0;a.defaultParameterValue&&(b.push(":",a.defaultParameterValue),g=!1);for(var f in a.params)g?(b.push(":"),g=!1):b.push("|"),b.push(f,"=",a.params[f]);b.push("}");tinymce.plugins.Autoconvert.getHtmlFromWikiMarkup(b.join(""),
function(a){c(e(a)[0])},function(){d()})};tinymce.plugins.Autoconvert.getHtmlFromWikiMarkup=function(a,c,d){a={wiki:a,entityId:AJS.Meta.get("content-id"),spaceKey:AJS.Meta.get("space-key")};e.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:AJS.params.contextPath+"/rest/tinymce/1/wikixhtmlconverter",data:e.toJSON(a),dataType:"text",success:c,error:d,timeout:45E3})};h.options={strictMode:!1,key:"source protocol authority userInfo user password host port relative path directory file query anchor".split(" "),
q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};tinymce.create("tinymce.plugins.AutoconvertPlugin",{init:function(a){function c(b,c,f){b=e(f.node).children("a");
1===b.length&&("A"===b[0].tagName&&b.text()===b.attr("href"))&&(b.attr("class","atlassian-autoconvert"),setTimeout(function(){var b=e("a.atlassian-autoconvert",e(a.selection.getNode().ownerDocument)).removeClass("atlassian-autoconvert");d.callHandlers(b)},0))}var d=tinymce.plugins.Autoconvert.autoConvert=new tinymce.plugins.Autoconvert(a);a.onInit.add(function(){AJS.$(document).bind("postPaste",c);a.addCommand("addAutoconverter",function(a,c){d.addHandler(c)})});a.onRemove.add(function(){AJS.$(document).unbind("postPaste",
c)})},getInfo:function(){return{longname:"Atlassian Autoconvert",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("autoconvert",tinymce.plugins.AutoconvertPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:autoconvert-jira', location = '/jira/jirapaste.js' */
(function(){AJS.bind("init.rte",function(){AJS.Editor.JiraConnector.Paste={issueKeyOnlyRegEx:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+$)/,singleTicketXMLEx:/\/jira\.issueviews:issue-xml\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)\//,issueKeyWithinRegex:/\/(i#)?browse\/([\x00-\x19\x21-\x22\x24\x27-\x3E\x40-\x7F]+-[0-9]+)(?:\?|#)/,jqlRegEx:/jqlQuery\=([^&]+)/,jqlRegExAlternateFormat:/jql\=([^&]+)/,pasteHandler:function(e,g,k){var n=AJS.Editor.JiraConnector.servers;var m=AJS.Editor.JiraAnalytics;var d={};var o;if(!n){k();return}for(var l in n){var h=n[l];if(e.source.indexOf(h.url)==0){o=h;break}}var f;if(o){var b=AJS.Editor.JiraConnector.Paste.jqlRegEx.exec(e.source)||AJS.Editor.JiraConnector.Paste.jqlRegExAlternateFormat.exec(e.source);var a=AJS.JQLHelper.isFilterUrl(e.source);var j=AJS.Editor.JiraConnector.Paste.issueKeyOnlyRegEx.exec(e.source)||AJS.Editor.JiraConnector.Paste.issueKeyWithinRegex.exec(e.source);if(j){j=j[2];if(m){d.type=m.linkTypes.jql}}else{j=AJS.Editor.JiraConnector.Paste.singleTicketXMLEx.exec(e.source);if(j){j=j[1];if(m){d.type=m.linkTypes.xml}}}if(b){d.is_single_issue=false;d.type=AJS.JQLHelper.checkQueryType(e.source);f={name:"jira",params:{server:o.name,serverId:o.id,jqlQuery:decodeURIComponent(b[1].replace(/\+/g,"%20"))}}}else{if(a){var c=e.source;d.is_single_issue=false;d.type=AJS.JQLHelper.checkQueryType(c);f={name:"jira",params:{server:o.name,serverId:o.id,jqlQuery:AJS.JQLHelper.getFilterFromFilterUrl(c)}}}else{if(j){d.is_single_issue=true;f={name:"jira",params:{server:o.name,serverId:o.id,key:j}}}}}}if(f){tinymce.plugins.Autoconvert.convertMacroToDom(f,k,k);if(m){m.triggerPasteEvent(d)}}else{k()}}};tinymce.plugins.Autoconvert.autoConvert.addHandler(AJS.Editor.JiraConnector.Paste.pasteHandler)})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:text-placeholders-jira', location = '/jira/placeholder.js' */
(function(){AJS.bind("init.rte",function(){AJS.bind("editor.text-placeholder.activated",function(b,a){if(a&&a.placeholderType==="jira"){AJS.Editor.JiraConnector.open(AJS.Editor.JiraConnector.source.instructionalText)}});if(AJS.Rte.Placeholder&&AJS.Rte.Placeholder.addPlaceholderType){AJS.Rte.Placeholder.addPlaceholderType({type:"jira",label:"JIRA Macro",tooltip:"Instructional text is replaced with a JIRA Macro on click.",activation:{click:true,keypress:false}})}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-dialog.js' */
AJS.Editor.JiraChart=(function(j){var m=-1;var A=6109;var e=6155;var d="Insert";var q="Cancel";var x="Insert JIRA Chart";var c;var g;var E=function(H){if(!c){c=new AJS.ConfluenceDialog({width:840,height:590,id:"jira-chart"});c.addHeader(x);g=AJS.Editor.JiraChart.Panels;for(var G=0;G<g.length;G++){if(typeof(g[G].title)==="function"){c.addPanel(g[G].title())}else{if(g[G].title!==undefined){c.addPanel(g[G].title)}}var J=c.getCurrentPanel();g[G].init(J)}j("#jira-chart ul.dialog-page-menu").show().append(Confluence.Templates.ConfluenceJiraPlugin.addCrossMacroLink({id:"open-jira-issue-dialog",label:"JIRA Issue/Filter"}));c.addButton(d,function(){var K=g[c.getCurrentPanel().id];if(b(K.chartType)&&K.isImageChartExisted()){var L=K.getMacroParamsFromDialog();C(L);AJS.Editor.JiraChart.close()}else{y(j("#jira-chart-content-"+K.chartType))}},"insert-jira-chart-macro-button");c.addLink("Select Macro",function(){c.hide();AJS.MacroBrowser.open(false)},"dialog-back-link");c.addCancel(q,function(){AJS.Editor.JiraChart.close()})}AJS.$("#jira-chart .dialog-page-menu button").click(function(){var M=g[c.getCurrentPanel().id];var L=c.getCurrentPanel().body;var K=AJS.Editor.JiraChart.Helper.getSelectedServer(L);n(L,K);p(L);M.handleInsertButton();M.focusForm();M.resetDisplayOption()});var I=c.getCurrentPanel().body;p(I);var F=F||function(L){var K={};_.each(L,function(M,N){K[M.chartType]=N});return K}(g);f(F,H);a();c.gotoPanel(r(F,H));c.overrideLastTab();c.show();i()};var r=function(F,G){if(G&&G.params){return F[G.params.chartType]}return 0};var s=function(){_.each(AJS.Editor.JiraChart.Panels,function(F){F.preBinding&&typeof F.preBinding==="function"&&F.preBinding()})};var i=function(){j("#open-jira-issue-dialog").click(function(){AJS.Editor.JiraChart.close();if(AJS.Editor.JiraConnector){AJS.Editor.JiraConnector.openCleanDialog(false)}})};var D=function(F){if(AJS.Editor.JiraConnector.servers.length>0){AJS.Editor.JiraConnector.Panel.prototype.applinkServerSelect(F.find("#jira-chart-servers"),function(G){l(F);if(p(F)){n(F,G);B(F)}})}};var b=function(G){var F=c.getCurrentPanel().body;return F.find("#jira-chart-content-"+G).length>0};var k=function(F){F(g[c.getCurrentPanel().id])};var y=function(F){if(AJS.Editor.JiraChart.Helper.convertSearchTextToJQL(F)===undefined){return}k(function(G){G.renderChart()})};var p=function(F){if(F.find("#jira-chart-support-all-version").length){return true}var G=AJS.Editor.JiraChart.Helper.getSelectedServer(F);if(w(G)){t(F);z(F);return false}return true};var C=function(F){var G=function(H){tinymce.confluence.macrobrowser.macroBrowserComplete(H)};if(AJS.Editor.inRichTextMode()){G({name:"jirachart",params:F})}};var f=function(F,H){for(var G=0;G<g.length;G++){g[G].resetDialogValue()}s();if(H&&H.params){var I=g[F[H.params.chartType]];I.bindingDataFromMacroToForm(H.params)}};var v=function(){if(AJS.Editor.JiraConnector.servers===undefined||AJS.Editor.JiraConnector.servers.length===0){AJS.Editor.JiraConnector.warningPopup(AJS.Meta.get("is-admin"));return false}return true};var l=function(F){F.find(".jira-oauth-message-marker").remove();F.find(".jira-chart-img").empty();F.find("#jira-chart-search-input").empty()};var a=function(){j("#jira-chart").find(".insert-jira-chart-macro-button").disable()};var h=function(){var F=AJS.$("#jira-chart").find(".insert-jira-chart-macro-button");if(F.is(":disabled")){F.enable()}};var o=function(F){F.find("#jira-chart-search-button").disable()};var u=function(F){if(F.find("#jira-chart-search-button").is(":disabled")){F.find("#jira-chart-search-button").enable()}};var n=function(H,G){j(".jira-oauth-message-marker",H).remove();var I={selectedServer:G,msg:AJS.Editor.JiraConnector.Panel.prototype.msg};if(G&&G.authUrl){var F=AJS.Editor.JiraConnector.Panel.prototype.createOauthForm.call(I,function(){j(".jira-oauth-message-marker",H).remove();AJS.Editor.JiraChart.search(H)});H.find("div.jira-chart-search").append(F)}};var t=function(F){F.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.showJiraUnsupportedVersion())};var z=function(G){G.find("#jira-chart-search-input").attr("disabled","disabled");G.find("#jira-chart-search-button").attr("disabled","disabled");var F=G.find(".jirachart-display-opts-close, .jirachart-display-opts-open");if(F.hasClass("jirachart-display-opts-close")){F.click()}F.addClass("disabled");a()};var B=function(F){F.find("#jira-chart-search-input").removeAttr("disabled");F.find("#jira-chart-search-button").removeAttr("disabled");F.find(".jirachart-display-opts-open").removeClass("disabled")};var w=function(G){var F=G.buildNumber;return F==m||(F>=A&&F<e)};return{close:function(){c.hide();tinymce.confluence.macrobrowser.macroBrowserCancel()},edit:function(F){if(!v()){return}E(F);var H=c.getCurrentPanel().body;if(!p(H)){return}B(H);if(F.params!==undefined&&F.params.serverId!==undefined){y(H)}var G=AJS.Editor.JiraChart.Helper.getSelectedServer(H);n(H,G)},search:y,disableInsert:a,enableInsert:h,disableSearch:o,enableSearch:u,insertJiraChartMacroWithParams:C,open:E,clearChartContent:l,loadServers:D,validateServerSupportedChart:p}})(AJS.$);AJS.Editor.JiraChart.Panels=[];AJS.MacroBrowser.setMacroJsOverride("jirachart",{opener:AJS.Editor.JiraChart.edit});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-helper.js' */
AJS.Editor.JiraChart.Helper=(function(g){var a=/^\d+$/;var m={};var f=function(o){o=(o&&typeof o==="string")?o.replace("px",""):"";if(o==="auto"){o=""}if(o.indexOf("%")>0){o=o.replace("%","")*4}return o};var n=function(o){return a.test(o)};var k=function(o){var p=AJS.Editor.JiraConnector.servers;if(p.length>1){return o.find("#jira-chart-servers option:selected").data("jiraapplink")}return p[0]};var h=function(p){var u=AJS.Editor.JiraConnector.servers;var r;var q=p.find("#jira-chart-search-input").val();if(q.indexOf("http")===0){var t=AJS.JQLHelper.findServerIndexFromUrl(q,u);if(t!==-1){r=u[t].id;p.find("#jira-chart-servers").val(r)}else{var s=Confluence.Templates.ConfluenceJiraPlugin.noServerWarning({isAdministrator:AJS.Meta.get("is-admin"),contextPath:Confluence.getContextPath()});p.find(".jira-chart-img").html(s);AJS.Editor.JiraChart.disableInsert();return}}var o=AJS.JQLHelper.convertToJQL(q,r);if(o){p.find("#jira-chart-search-input").val(o)}else{p.find(".jira-chart-img").html(Confluence.Templates.ConfluenceJiraPlugin.jqlInvalid());AJS.Editor.JiraChart.disableInsert()}return o};var d=function(o,q){var s=k(o);if(q){var p=s.id;var t=m[p];if(!t){AppLinks.makeRequest({appId:s.id,type:"GET",url:"/rest/gadget/1.0/statTypes",dataType:"json",async:false,success:function(u){if(u){m[s.id]=u;t=u}},error:function(u){if(u){m[s.id]=JSON.parse(u.responseText);t=JSON.parse(u.responseText)}AJS.log("Jira Chart Macro: unable to retrieve statTypes from AppLink: "+s.id)}}).fail(function(u){if(u){m[s.id]=JSON.parse(u.responseText);t=JSON.parse(u.responseText)}})}var r="";_.each(t.stats,function(u){r+="<option value = '"+u.value+"'>"+AJS.escapeHtml(u.label)+" </option>"});q.html(r)}};var l=function(o){o.next().next(".width-error").remove();var p=f(o.val());var q;if(p){if(n(p)){if(p<100||p>9000){q="wrongNumber"}}else{q="wrongFormat"}}if(q){o.next().after(Confluence.Templates.ConfluenceJiraPlugin.warningValWidthColumn({error:q}));AJS.Editor.JiraChart.disableInsert();return false}return true};var j=function(o){return{jql:o.find("#jira-chart-search-input"),width:o.find("#jira-chart-width"),border:o.find(".jira-chart-show-border"),showinfor:o.find(".jira-chart-show-infor"),displayOption:o.find(".jirachart-display-opts-close, .jirachart-display-opts-open"),server:o.find("#jira-chart-servers")}};var c=function(p,o){p.jql.val(decodeURIComponent(o.jql));p.width.val(o.width);p.border.attr("checked",(o.border==="true"));p.showinfor.attr("checked",(o.showinfor==="true"));if(AJS.Editor.JiraConnector.servers.length>1){p.server.val(o.serverId)}};var b=function(q,o){var p=k(o);return{jql:encodeURIComponent(q.jql.val()),width:f(q.width.val()),border:q.border.prop("checked"),showinfor:q.showinfor.prop("checked"),serverId:p.id,server:p.name,isAuthenticated:!p.authUrl}};var i=function(p,o){return{contentId:AJS.Meta.get("page-id"),macro:{name:"jirachart",params:{jql:p.jql,serverId:p.serverId,width:p.width,border:p.border,showinfor:p.showinfor,chartType:o}}}};var e=function(o){if(o){return AJS.$.trim(o.val())!==""&&o.val()!==o.attr("placeholder")}return false};return{getSelectedServer:k,bindingCommonChartElements:j,bindingCommonDataFromMacroToForm:c,getCommonMacroParamsFromDialog:b,getCommonChartParamsRequest:i,convertSearchTextToJQL:h,convertFormatWidth:f,isChartWidthValid:l,isNumber:n,isJqlNotEmpty:e,populateStatType:d}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/jirachart-panel.js' */
AJS.Editor.JiraChart.Panel=function(){};AJS.Editor.JiraChart.Panel.prototype={init:function(a){var b=this.chartType;var c=Confluence.Templates.ConfluenceJiraPlugin.contentJiraChart({isMultiServer:AJS.Editor.JiraConnector.servers.length>1,chartType:b});a.html(c);this.container=AJS.$(this.containerId);AJS.Editor.JiraChart.clearChartContent(this.container);AJS.Editor.JiraChart.loadServers(this.container);this.bindingChartElements();this.bindingActions()},bindingActions:function(){var e=this;var d=function(){if(e.isFormValid()){AJS.Editor.JiraChart.search(e.container)}else{AJS.Editor.JiraChart.disableInsert()}};var b=e.container.find(e.clickableElements);b.click(d);var f=e.container.find(e.onChangeElements);f.change(d);e.chartElements.jql.change(function(){if(this.value!==e.jqlWhenEnterKeyPress){e.container.find(".jira-chart-img").empty();AJS.Editor.JiraChart.disableInsert()}e.jqlWhenEnterKeyPress=""}).bind("paste",function(){setTimeout(function(){if(e.isFormValid()){e.jqlWhenEnterKeyPress=e.chartElements.jql.val();AJS.Editor.JiraChart.search(e.container)}},100)});var a=e.container.find("input[type='text']");var c=function(g){if(g.attr("id")==="jira-chart-search-input"){e.jqlWhenEnterKeyPress=g.val()}};a.unbind("keydown").keydown(function(g){if(g.which==13){var h=function(i){a.unbind("keyup",h);if(e.isFormValid()){AJS.Editor.JiraChart.search(e.container)}c(a);return AJS.stopEvent(i)};a.keyup(h);return AJS.stopEvent(g)}});e.bindSelectOption();e.bindingServerChange()},bindingServerChange:function(){var a=this;a.chartElements.server.change(function(){if(a.isFormValid()&&AJS.Editor.JiraChart.validateServerSupportedChart(a.container)){AJS.Editor.JiraChart.search(a.container)}else{AJS.Editor.JiraChart.disableInsert()}})},renderChart:function(){var e=this;var b=this.getChartParamsRequest();var a=Confluence.getContextPath()+"/rest/tinymce/1/macro/preview";var d=this.container.find(".jira-chart-img");d.html('<div class="loading-data"></div>');var c=d.find(".loading-data")[0];AJS.$.data(c,"spinner",Raphael.spinner(c,50,"#666"));if(e.request){e.request.abort()}e.request=AJS.$.ajax({url:a,type:"POST",contentType:"application/json",data:JSON.stringify(b)}).done(function(f){d.html("").hide();var i=AJS.$('<iframe frameborder="0" id="chart-preview-iframe"></iframe>');i.appendTo(d);var h=i[0].contentWindow,g=h.document;i.on("load",function(){h.AJS.$("#main").addClass("chart-preview-main");d.show();e.handleInsertButton()});f=f.replace("window.onload","var chartTest");g.open();g.write(f);g.close()}).error(function(f){if(f.statusText!="abort"){AJS.log("Jira Chart Macro - Fail to get data from macro preview");d.html(Confluence.Templates.ConfluenceJiraPlugin.jiraChartErrorMessage({message:"Unable to render JIRA chart macro due to an execution error."}))}AJS.Editor.JiraChart.disableInsert()})},resetDialogValue:function(){var a=AJS.$("input",this.container);a.filter(":text").val("");a.filter(":checked").removeAttr("checked");this.container.find("#jira-chart-search-input").val();this.container.find(".jira-chart-img").empty();this.resetDisplayOption()},resetDisplayOption:function(){var b=this;var a=this.chartElements.displayOption;a.addClass("jirachart-display-opts-open");a.removeClass("jirachart-display-opts-close");setTimeout(function(){var c=b.container.find(".jira-chart-option");c.scrollTop(0);c.css({overflow:"hidden",top:"430px"})},0)},bindSelectOption:function(){var c=this;var b=c.container.find(".jira-chart-option");var d=function(g){var f=40;var i=b.position().top+"px";var e="";var h={top:430};if(g){i="";e=f-b.find("#jiraChartMacroOption").height()+"px";h={bottom:0};b.css("overflow","auto")}else{b.css("overflow","hidden")}b.css("top",i);b.css("bottom",e);b.animate(h,500)};b.css("top","430px");var a=this.chartElements.displayOption;a.click(function(g){var f=AJS.$(this);g.preventDefault();if(f.hasClass("disabled")){return}var h=f.hasClass("jirachart-display-opts-open");if(h){d(true);f.addClass("jirachart-display-opts-close");f.removeClass("jirachart-display-opts-open")}else{d();f.removeClass("jirachart-display-opts-close");f.addClass("jirachart-display-opts-open")}})},isImageChartExisted:function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-img").length>0},focusForm:function(){this.container.find("#jira-chart-search-input").focus()},handleInsertButton:function(){if(this.isFormValid()&&this.isResultValid()){AJS.Editor.JiraChart.enableInsert()}else{AJS.Editor.JiraChart.disableInsert()}}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/piechart-panel.js' */
AJS.Editor.JiraChart.Panel.PieChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var a="Pie Chart";var c="pie";var b=this;this.title=a;this.chartType=c;this.containerId="#jira-chart-content-pie";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor";this.onChangeElements="#jira-chart-statType, #jira-chart-width";this.isFormValid=function(){return AJS.Editor.JiraChart.Helper.isChartWidthValid(b.chartElements.width)&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.bindingActions=function(){var e=this;AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(e);e.container.find(".widthInfo").tooltip({gravity:"w"})};this.bindingServerChange=function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.statType);if(b.isFormValid()){AJS.Editor.JiraChart.search(b.container)}else{AJS.Editor.JiraChart.disableInsert()}})};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.statType=this.container.find("#jira-chart-statType")};this.getChartParamsRequest=function(){var f=this.getMacroParamsFromDialog();var e=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(f,this.chartType);e.macro.params.statType=f.statType;return e};this.getMacroParamsFromDialog=function(){var e=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);e.chartType=c;e.statType=this.chartElements.statType.val();return e};this.bindingDataFromMacroToForm=function(e){if(e){AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(this.chartElements,e);this.chartElements.statType.val(e.statType)}};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#jira-chart-statType"))}};AJS.Editor.JiraChart.Panel.PieChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.PieChart.prototype.constructor=AJS.Editor.JiraChart.Panel.PieChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.PieChart(AJS.$));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/createdvsresolvedchart-panel.js' */
AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart=function(e){AJS.Editor.JiraChart.Panel.call(this);var d="createdvsresolved";var c=this;var a=function(){c.container.find("#created-vs-resolved-chart-periodName").val("daily");c.container.find("#created-vs-resolved-chart-daysprevious").val("30")};var b=function(){var h=c.chartElements.periodName.val();var g=e.trim(c.chartElements.daysprevious.val());var f=c.container.find(".days-previous-error");if(g===""){c.container.find(".days-previous-error").html("Days Previously is required field.");return false}if(!AJS.Editor.JiraChart.Helper.isNumber(g)||g<0){f.html("Days Previously must be a number and positive.");return false}switch(h){case"hourly":isValid=g<=10;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",10,h))}break;case"daily":isValid=g<=300;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",300,h))}break;case"weekly":isValid=g<=1750;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",1750,h))}break;case"monthly":isValid=g<=7500;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",7500,h))}break;case"quarterly":isValid=g<=22500;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",22500,h))}break;case"yearly":isValid=g<=36500;if(!isValid){f.html(AJS.format("Days must not exceed {0} for {1} period",36500,h))}break;default:isValid=false}if(isValid){f.empty()}return isValid};this.title="Created vs Resolved";this.chartType=d;this.containerId="#jira-chart-content-createdvsresolved";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #created-vs-resolved-chart-cumulative, #created-vs-resolved-chart-showunresolvedtrend";this.onChangeElements="#created-vs-resolved-chart-periodName, #created-vs-resolved-chart-daysprevious, #created-vs-resolved-chart-versionLabel, #jira-chart-width";this.isFormValid=function(){var f=AJS.Editor.JiraChart.Helper.isChartWidthValid(c.chartElements.width);return b()&&f&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(c.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".jira-chart-macro-wrapper").length};this.init=function(f){AJS.Editor.JiraChart.Panel.prototype.init.call(this,f);a()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.periodName=this.container.find("#created-vs-resolved-chart-periodName");this.chartElements.daysprevious=this.container.find("#created-vs-resolved-chart-daysprevious");this.chartElements.isCumulative=this.container.find("#created-vs-resolved-chart-cumulative");this.chartElements.showUnresolvedTrend=this.container.find("#created-vs-resolved-chart-showunresolvedtrend");this.chartElements.versionLabel=this.container.find("#created-vs-resolved-chart-versionLabel")};this.bindingActions=function(){AJS.Editor.JiraChart.Panel.prototype.bindingActions.call(this);this.container.find(".widthInfo").tooltip({gravity:"w"});this.container.find(".showunresolvedtrendInfo").tooltip({gravity:"w"});this.container.find(".cumulativeInfo").tooltip({gravity:"w"});this.container.find(".versionLabelInfo").tooltip({gravity:"w"});this.container.find(".daysPreviousInfo").tooltip({gravity:"w"})};this.getChartParamsRequest=function(){var g=this.getMacroParamsFromDialog();var f=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(g,this.chartType);f.macro.params.periodName=g.periodName;f.macro.params.daysprevious=g.daysprevious;f.macro.params.isCumulative=g.isCumulative;f.macro.params.showUnresolvedTrend=g.showUnresolvedTrend;f.macro.params.versionLabel=g.versionLabel;return f};this.getMacroParamsFromDialog=function(){var f=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);f.chartType=d;f.periodName=this.chartElements.periodName.val();f.daysprevious=e.trim(this.chartElements.daysprevious.val());f.isCumulative=this.chartElements.isCumulative.prop("checked");f.showUnresolvedTrend=this.chartElements.showUnresolvedTrend.prop("checked");f.versionLabel=this.chartElements.versionLabel.val();return f};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);a()};this.bindingDataFromMacroToForm=function(f){if(f){AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(c.chartElements,f);c.chartElements.isCumulative.attr("checked",(f.isCumulative!=="false"));c.chartElements.showUnresolvedTrend.attr("checked",(f.showUnresolvedTrend==="true"));c.chartElements.periodName.val(f.periodName===""?"daily":f.periodName);c.chartElements.versionLabel.val(f.versionLabel);c.chartElements.daysprevious.val(f.daysprevious===""?"30":f.daysprevious)}}};AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart.prototype.constructor=AJS.Editor.JiraChart.Panels.CreatedVsResolvedChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.CreatedVsResolvedChart(AJS.$));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.extra.jira:jirachart-macro', location = '/jirachart/twodimensionalchart-panel.js' */
AJS.Editor.JiraChart.Panel.TwoDimensionalChart=function(d){AJS.Editor.JiraChart.Panel.call(this);var c="twodimensional";var f=5;var b=this;var e=function(){var h=d(".twodimensional-number-of-result-error");var g=b.chartElements.numberToShow.val();if(AJS.Editor.JiraChart.Helper.isNumber(g)&&g>0){h.empty();return true}h.html("The number of rows should be a positive integer");return false};var a=function(){b.chartElements.numberToShow.val(f);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.title="Two Dimensional";this.chartType=c;this.containerId="#jira-chart-content-twodimensional";this.clickableElements=".jira-chart-search button, .jira-chart-show-border, .jira-chart-show-infor, #twodimensional-show-total";this.onChangeElements="#twodimensional-xaxis, #twodimensional-yaxis, #twodimensional-number-of-result";this.isFormValid=function(){var g=e();return g&&AJS.Editor.JiraChart.Helper.isJqlNotEmpty(b.chartElements.jql)};this.isResultValid=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length};this.init=function(g){AJS.Editor.JiraChart.Panel.prototype.init.call(this,g);a()};this.bindingChartElements=function(){this.chartElements=AJS.Editor.JiraChart.Helper.bindingCommonChartElements(this.container);this.chartElements.xstattype=this.container.find("#twodimensional-xaxis");this.chartElements.ystattype=this.container.find("#twodimensional-yaxis");this.chartElements.sortBy=this.container.find("#twodimensional-sortby");this.chartElements.sortDirection=this.container.find("#twodimensional-sort-direction");this.chartElements.showTotals=this.container.find("#twodimensional-show-total");this.chartElements.numberToShow=this.container.find("#twodimensional-number-of-result")};this.getChartParamsRequest=function(){var h=this.getMacroParamsFromDialog();var g=AJS.Editor.JiraChart.Helper.getCommonChartParamsRequest(h,this.chartType);g.macro.params.xstattype=h.xstattype;g.macro.params.ystattype=h.ystattype;g.macro.params.sortBy=h.sortBy;g.macro.params.sortDirection=h.sortDirection;g.macro.params.showTotals=h.showTotals;g.macro.params.numberToShow=h.numberToShow;return g};this.getMacroParamsFromDialog=function(){var g=AJS.Editor.JiraChart.Helper.getCommonMacroParamsFromDialog(this.chartElements,this.container);g.chartType=c;g.xstattype=this.chartElements.xstattype.val();g.ystattype=d.trim(this.chartElements.ystattype.val());g.sortBy=d.trim(this.chartElements.sortBy.val());g.sortDirection=d.trim(this.chartElements.sortDirection.val());g.showTotals=this.chartElements.showTotals.prop("checked");g.numberToShow=this.chartElements.numberToShow.val();return g};this.bindingDataFromMacroToForm=function(g){if(g){AJS.Editor.JiraChart.Helper.bindingCommonDataFromMacroToForm(b.chartElements,g);b.chartElements.xstattype.val(g.xstattype);b.chartElements.ystattype.val(g.ystattype);b.chartElements.sortBy.val(g.sortBy);b.chartElements.sortDirection.val(g.sortDirection);b.chartElements.showTotals.attr("checked",g.showTotals==="true");b.chartElements.numberToShow.val(g.numberToShow)}};this.resetDialogValue=function(){AJS.Editor.JiraChart.Panel.prototype.resetDialogValue.call(this);a()};this.isImageChartExisted=function(){return this.container.find("#chart-preview-iframe").contents().find(".two-dimensional-chart-table").length>0};this.preBinding=function(){AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-xaxis"));AJS.Editor.JiraChart.Helper.populateStatType(this.container,this.container.find("#twodimensional-yaxis"));b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees")};this.bindingServerChange=function(){b.chartElements.server.change(function(){AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.xstattype);AJS.Editor.JiraChart.Helper.populateStatType(b.container,b.chartElements.ystattype);b.chartElements.xstattype.val("statuses");b.chartElements.ystattype.val("assignees");if(b.isFormValid()){AJS.Editor.JiraChart.search(b.container)}else{AJS.Editor.JiraChart.disableInsert()}})}};AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype=AJS.Editor.JiraChart.Panel.prototype;AJS.Editor.JiraChart.Panel.TwoDimensionalChart.prototype.constructor=AJS.Editor.JiraChart.Panel.TwoDimensionalChart;AJS.Editor.JiraChart.Panels.push(new AJS.Editor.JiraChart.Panel.TwoDimensionalChart(AJS.$));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/ajs/class/class.js' */
(function(){var i=function(d){var a=function(){};a.prototype=d;return new a},h=!1,j=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;this.Class=function(){};Class.extend=function(){function d(){!h&&this.init&&this.init.apply(this,arguments)}var a,f=this.prototype;if(1<arguments.length){var c=AJS.$.makeArray(arguments);a=c.pop();var g;AJS.$.each(c,function(b,a){g=g?g.extend(a):a});return g.extend(this.prototype).extend(a)}a=arguments[0];h=!0;c=new this;h=!1;for(var b in a)if(c[b]="function"==typeof a[b]&&
"function"==typeof f[b]&&j.test(a[b]))c[b]=function(a,b){return function(){var c=this._super;this._super=f[a];var d=b.apply(this,arguments);this._super=c;return d}}(b,a[b]);else if("object"===typeof f[b]){var e=i(a[b]);AJS.$.each(f[b],function(a,b){if(e[a]){if("object"===typeof e[a]){var c=i(e[a]);AJS.$.each(b,function(a,b){c[a]||(c[a]=b)});e[a]=c}}else e[a]=b});c[b]=e}else c[b]=a[b];d.prototype=c;d.constructor=d;d.extend=arguments.callee;return d}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/ajs/control/control.js' */
AJS.jiraTrigger=function(a,b){a=new jQuery.Event(a);jQuery(b||window.top.document).trigger(a);return!a.isDefaultPrevented()};
AJS.Control=Class.extend({INVALID:"INVALID",_throwReadOnlyError:function(a){Error(this.CLASS_SIGNATURE+": Sorry ["+a+"] is a read-only property")},_assignEvents:function(a,b){this._unassignEvents(a,b);if("string"===typeof b)for(var c in this._events[a])AJS.$(document).delegate(b,c,this._getDispatcher(a,c));else for(c in b=jQuery(b),this._events[a])b.bind(c,this._getDispatcher(a,c)),AJS.debug("AJS.Control bound eventType '"+c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")},_unassignEvents:function(a,
b){if("string"===typeof b)for(var c in this._events[a])AJS.$(document).undelegate(b,c,this._getDispatcher(a,c));else{b=jQuery(b);try{for(c in this._events[a])b.unbind(c,this._getDispatcher(a,c))}catch(g){var d=b.data("events");if(d)for(c in d)if(c in this._events[a]){for(var h=this._getDispatcher(a,c),f=d[c],e=0;e<f.length;e++)if(f[e]===h){f.splice(e,1);break}AJS.debug("AJS.Control unbound eventType '"+c+"' for group '"+a+"' on target '"+(b[0].type||b[0])+"'")}}}},_getDispatcher:function(a,b){var c=
a+"/"+b;this._dispatchers||(this._dispatchers={});if(!this._dispatchers[c]){var g=this._events[a][b],d=this;this._dispatchers[c]=function(c){AJS.debug("AJS.Control dispatching eventType '"+b+"' for group '"+a+"' on instance '"+d.type+"'");return g.call(d,c,AJS.$(this))}}return this._dispatchers[c]},_isValidInput:function(){return!0},_handleKeyEvent:function(a){if(this._isValidInput(a)){var b=AJS.Keyboard.SpecialKey,c=AJS.Keyboard.shortcutEntered(a);if(c){if(this.keys[c]){this.keys[c].call(this,a);
return}if((c===b.BACKSPACE||c===b.DELETE)&&this.keys.onEdit){this.keys.onEdit.call(this,a);return}}(b=AJS.Keyboard.characterEntered(a))&&this.keys.onEdit&&this.keys.onEdit.call(this,a,b)}},getCustomEventName:function(a){return(this.CLASS_SIGNATURE||"")+"_"+a},_getCustomEventArgs:function(){return[this]},trigger:function(a){return AJS.jiraTrigger(a,this)},_supportsBoxShadow:function(){var a=document.body.style;return void 0!==a.WebkitBoxShadow||void 0!==a.MozBoxShadow||void 0!==a.boxShadow},_setOptions:function(a){var b,
c,a=a||{};if(a instanceof AJS.$||"string"===typeof a||"object"===typeof a&&a.nodeName)a={element:a};b=AJS.$(a.element);c=b.getOptionsFromAttributes();this.options=AJS.$.extend(!0,this._getDefaultOptions(a),c,a);if(0===b.length)return this.INVALID},getCaret:function(a){var b=a.selectionStart;if(0<=b)return a.selectionEnd>b?-1:b;if(document.selection&&(b=document.selection.createRange(),0===b.text.length)){var c=b.duplicate();c.moveToElementText(a);c.setEndPoint("EndToStart",b);return c.text.length}return-1},
_render:function(){var a,b=arguments[0],c=[];for(a=1;a<arguments.length;a++)c.push(arguments[a]);return this._renders[b].apply(this,c)}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/ajs/input/keyboard.js' */
AJS.Keyboard={};
(function(e){function b(a,b,c){g[b]=a;h[a]=b;c&&(i[b]=!0);return a}function f(a){a=a.originalEvent||a;return null==a.which?a.keyCode:0!=a.which&&0!=a.charCode?a.which:null}function j(a){var a=a.originalEvent||a,b=AJS.Keyboard.specialKeyEntered(a);if(b)return b;if(e.browser.mozilla){if("keypress"===a.type&&(a=f(a),null!==a))return String.fromCharCode(a).toLowerCase()}else if("keypress"!==a.type)return String.fromCharCode(a.keyCode).toLowerCase()}var g={},h={},i={},c=AJS.Keyboard.SpecialKey={BACKSPACE:b("backspace",
8,!0),TAB:b("tab",9,!0),RETURN:b("return",13,!0),SHIFT:b("shift",16),CTRL:b("ctrl",17),ALT:b("alt",18),PAUSE:b("pause",19),CAPS_LOCK:b("capslock",20),ESC:b("esc",27,!0),SPACE:b("space",32,!0),PAGE_UP:b("pageup",33),PAGE_DOWN:b("pagedown",34),END:b("end",35),HOME:b("home",36),LEFT:b("left",37),UP:b("up",38),RIGHT:b("right",39),DOWN:b("down",40),INSERT:b("insert",45),DELETE:b("del",46),F1:b("f1",112),F2:b("f2",113),F3:b("f3",114),F4:b("f4",115),F5:b("f5",116),F6:b("f6",117),F7:b("f7",118),F8:b("f8",
119),F9:b("f9",120),F10:b("f10",121),F11:b("f11",122),F12:b("f12",123),NUMLOCK:b("numlock",144),SCROLL:b("scroll",145),META:b("meta",224)};c.eventType=function(){return e.browser.mozilla?"keypress":"keydown"};c.fromKeyCode=function(a){return g[a]};c.toKeyCode=function(a){return h[a]};c.isAscii=function(a){return!!i[a]};c.isSpecialKey=function(a){return!!c.toKeyCode(a)};AJS.Keyboard.characterEntered=function(a){a=a.originalEvent||a;if("keypress"===a.type&&(a=f(a),null!==a&&(!c.isAscii(a)||c.fromKeyCode(a)===
c.SPACE)))return String.fromCharCode(a)};AJS.Keyboard.specialKeyEntered=function(a){a=a.originalEvent||a;if(e.browser.mozilla){if("keypress"===a.type){var b=f(a);if(null===b)return c.fromKeyCode(a.keyCode);if(c.isAscii(b))return c.fromKeyCode(b)}}else if("keypress"!==a.type)return c.fromKeyCode(a.keyCode)};AJS.Keyboard.shortcutEntered=function(a){a=a.originalEvent||a;if(a.type===AJS.Keyboard.SpecialKey.eventType()){var b=AJS.Keyboard.specialKeyEntered(a),d="";a.altKey&&b!==c.ALT&&(d+=c.ALT+"+");a.ctrlKey&&
b!==c.CTRL&&(d+=c.CTRL+"+");a.metaKey&&(!a.ctrlKey&&b!==c.META)&&(d+=c.META+"+");a.shiftKey&&b!==c.SHIFT&&(d+=c.SHIFT+"+");if(b)return d+b;if(0<d.length&&"shift+"!==d&&(a=j(a)))return d+a}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/ajs/input/mouse.js' */
(function(d){AJS.Mouse={};var b=AJS.Mouse.MotionDetector=function(){this.reset()};b.prototype.reset=function(){this._y=this._x=this._handler=null;this.moved=!1};b.prototype.wait=function(b){var a=this;a._handler||(this.reset(),d(window.top.document).bind("mousemove",a._handler=function(c){!a._x&&!a._y?(a._x=c.pageX,a._y=c.pageY):c.pageX===a._x&&c.pageY===a._y||(a.unbind(),a.moved=!0,b&&b.call(this,c))}))};b.prototype.unbind=function(){this._handler&&(d(window.top.document).unbind("mousemove",this._handler),
this.reset())}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/ajs/group/group.js' */
AJS.Group=AJS.Control.extend({init:function(){this.type=this.type||"Group";this.items=[];this.index=-1;this._assignEvents("instance",this)},addItem:function(a){this.items.push(a);this._assignEvents("item",a)},removeItem:function(a){var b=AJS.$.inArray(a,this.items);if(0>b)throw Error("AJS.Group: item ["+a+"] is not a member of this group");a.trigger("blur");b<this.index&&this.index--;this.items.splice(b,1);this._unassignEvents("item",a)},removeAllItems:function(){for(var a=0;a<this.items.length;a++)this._unassignEvents("item",
this.items[a]),this.items[a].trigger("blur");this.index=-1;this.items.length=0;this._unassignEvents("keys",document)},shiftFocus:function(a){AJS.debug("Group.shiftFocus called with offset: "+a);-1===this.index&&1===a&&(a=0);0<this.items.length&&(a=(Math.max(0,this.index)+this.items.length+a)%this.items.length,this.items[a].trigger("focus"))},prepareForInput:function(){this._assignEvents("keys",document)},_events:{instance:{focus:function(){0!==this.items.length&&(0>this.index?this.items[0].trigger("focus"):
this._assignEvents("keys",document))},blur:function(){0<=this.index?this.items[this.index].trigger("blur"):this._unassignEvents("keys",document)}},keys:{"keydown keypress":function(a){this._handleKeyEvent(a)}},item:{focus:function(a){var b=this.index;this.index=AJS.$.inArray(a.target,this.items);0>b?this.trigger("focus"):b!==this.index&&this.items[b].trigger("blur")},blur:function(a){this.index===AJS.$.inArray(a.target,this.items)&&(this.index=-1,this.trigger("blur"))},remove:function(a){this.removeItem(a.target)}}},
keys:{}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/components/select-grid.js' */
(function(e){AJS.SelectGrid=AJS.Group.extend({init:function(a){this.type=this.type||"SelectGrid";this._super();var b=e(Confluence.Templates.SelectGrid.gridOutline()),c=b.find("thead tr");e(a.columns).each(function(a,b){var d=AJS("th").addClass(b.getClassName()).text(b.heading);c.append(d)});this.gridContainer=e(a.gridContainer).append(b);this.getRowId=a.getRowId;this.table=b;this.columns=a.columns;this.selectionCallback=a.selectionCallback;this.body=b.find("tbody");this.body.delegate("a","click",
function(a){a.preventDefault()});this.dontShiftFocus=a.dontShiftFocus||function(){}},keys:{up:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(-1),a.preventDefault())},down:function(a){this.table.is(":visible")&&!this.dontShiftFocus()&&(this.shiftFocus(1),a.preventDefault())}},_addRow:function(a,b,c,f){e.isFunction(c)&&(f=c,c=!1);c?this.body.prepend(a):this.body.append(a);a=new h({row:a,data:b,callback:f,getRowId:this.getRowId,selectionCallback:f});this.addItem(a);return a},
clear:function(){this.removeAllItems();this.body.children().remove()},_addRows:function(a,b){var c=this,f=[];e(a).each(function(a,d){var h=c.columns,g,i,j,k;g=AJS("tr");e(h).each(function(a,b){i={outerClass:b.getClassName(d)||"",href:b.getHref&&b.getHref(d)||"",innerClass:b.getInnerClass&&b.getInnerClass(d)||"",title:b.getTitle&&b.getTitle(d)||"",text:b.getText(d)||""};j=i.href?"cellWithLink":"cellWithoutLink";k=Confluence.Templates.SelectGrid[j](i);g.append(k)});g.attr("data-id",c.getRowId(d));f.push(c._addRow(g,
d,b,c.selectionCallback))});return f},update:function(a){this.clear();!a||!a.length?AJS.debug("SelectGrid.update called with no data, returning."):(this._addRows(a),this.prepareForInput())},prependAndSelect:function(a,b){!a||!a.length?AJS.debug("SelectGrid.prependAndSelect called with no data, returning."):this._addRows(a,!0)[b||0].selectRow()},findItem:function(a){for(var b=0;b<this.items.length;b++)if(this.items[b].getRowId()==a)return this.items[b];AJS.debug("SelectGrid.findItem didn't find item, returning null.");
return null},select:function(a){(a=this.findItem(a))&&a.selectRow()},selectIndex:function(a){a=a||0;this.items[a]?this.items[a].selectRow():AJS.debug("SelectGrid.selectIndex couldn't select row with index "+a+", not found")},show:function(){this.gridContainer.removeClass("hidden")},hide:function(){this.gridContainer.addClass("hidden")},isVisible:function(){return!this.gridContainer.hasClass("hidden")}});var h=AJS.Control.extend({init:function(a){this.type="SelectableRow";this.$row=AJS.$(a.row);this.$row.data("properties",
a.data);this.getRowId=function(){return a.getRowId(a.data)};this.selectionCallback=a.selectionCallback;this._assignEvents("element",this.$row);this._assignEvents("instance",this);AJS.debug("SelectableRow initialized")},_events:{instance:{focus:function(){var a=this.$row;a.addClass("selected");this.selectionCallback(a,a.data("properties"))},blur:function(){this.$row.removeClass("selected")}},element:{click:function(){this.trigger("focus")}}},selectRow:function(){this.trigger("focus")}});AJS.SelectGrid.Column=
function(a){var b=function(b){return b[a.key]};return{key:a.key,heading:a.heading,getClassName:a.getClassName||function(){return a.className||a.key+"-field"},getHref:a.getHref,getInnerClass:a.getInnerClass,getTitle:a.getTitle,getText:a.getText||b}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/components/select-grid.soy' */
// This file was automatically generated from select-grid.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.SelectGrid == 'undefined') { Confluence.Templates.SelectGrid = {}; }


Confluence.Templates.SelectGrid.gridOutline = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table class="select-grid aui"><thead><tr class="data-table-header"></tr></thead><tbody></tbody></table>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.SelectGrid.cellWithLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="', soy.$$escapeHtml(opt_data.outerClass), '"><a class="', soy.$$escapeHtml(opt_data.innerClass), '" href="', soy.$$escapeHtml(opt_data.href), '" title="', soy.$$escapeHtml(opt_data.title), '"><span>', soy.$$escapeHtml(opt_data.text), '</span></a></td>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.SelectGrid.cellWithoutLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<td class="', soy.$$escapeHtml(opt_data.outerClass), '"><span class="', soy.$$escapeHtml(opt_data.innerClass), '" title="', soy.$$escapeHtml(opt_data.title), '">', soy.$$escapeHtml(opt_data.text), '</span></td>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:jira-controls', location = '/includes/js/components/result-grid.js' */
(function(e){AJS.ResultGrid=AJS.Control.extend({init:function(a){this.type=this.type||"ResultGrid";var c,f,j,g,i,d,h;f=a.gridContainer||e(a.baseElement).find(".data-table");f.length||AJS.debug("gridContainer for AJS.ResultGrid not found!");j=function(b){return b.id};c=new AJS.SelectGrid({gridContainer:f,columns:a.columns,selectionCallback:a.selectionCallback,getRowId:a.getRowId||j,dontShiftFocus:a.dontShiftFocus});d=a.messageHandler||AJS.MessageHandler({baseElement:e(a.baseElement).find(".message-panel")});
h=a.noResultMessage||"There are no results.";e.extend(this,{update:function(b,a){d.clearMessages();g&&(g(),i.remove(),g=null);c.clear();if(!b||!b.length){c.hide();var k=e.isFunction(h)?h(a):h;d.displayMessages(k);return!1}c.update(b);c.show();return!0},updateAndSelect:function(b,c,a){this.update(b,c)&&this.selectIndex(a)},prependAndSelect:function(b,a){!b||!b.length?AJS.debug("ResultGrid.prependAndSelect called with no data, returning."):(d.clearMessages(),c.prependAndSelect(b,
a),c.show())},select:function(b){c.select(b)},selectIndex:function(b){c.selectIndex(b)},clear:function(){d.clearMessages();c.hide()},loading:function(){c.show();var b=f.width(),a=f.height();this.clear();if(!g){var d,e;d=b/2-73;e=a/2-73;i=AJS("div").addClass("spinner-container").width(b-d).height(a-e).css({"padding-left":d,"padding-top":e}).insertAfter(f);g=Raphael.spinner(i[0],60,"#666")}},isVisible:function(){return c.isVisible()}})}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/js/dialog-breadcrumbs.js' */
jQuery.fn.renderBreadcrumbs=function(e){var h=jQuery,i=this,b=[],a=0,g=e.length-1,c=e[a];c.url.indexOf("~");var f=i.closest(".breadcrumbs-container").width(),j=function(){return i.width()<f};for(b.push(Confluence.Templates.Dialog.breadcrumbItem({text:c.title,title:c.title,className:a==g?"last":""}));a++<g;)c=e[a],b.push(Confluence.Templates.Dialog.breadcrumbItem({text:c.title,title:c.title,className:a==g?"last":""}));this.html(b.join(""));e=h("li a span",this);e.each(function(a){0!=a&&a!=g&&h(this).shortenUntil(j)});
h(e.get(0)).shortenUntil(j);h(e.get(g)).shortenUntil(j);return this};
AJS.toInit(function(e){var h=e("#confluence-context-path").attr("content");AJS.MoveDialog||(AJS.MoveDialog={});var i={};AJS.MoveDialog.getBreadcrumbs=function(a,g,c){var f=a.userName?a.userName:a.pageId?a.pageId+":"+a.fileName:a.spaceKey+":"+a.title+":"+a.postingDay+":"+a.fileName;f in i?g(i[f],"success"):e.ajax({type:"GET",dataType:"json",data:a,url:h+"/pages/breadcrumb.action",error:c||function(){},success:function(a,b){if(!a||!a.breadcrumbs)c(a,b);else{for(var d=e.makeArray(a.breadcrumbs);d[0]&&
a.type!="userinfo"&&/peopledirectory\.action$/.test(d[0].url);)d.shift();a.type=="page"&&(d[1]&&/pages\.action/.test(d[1].url))&&d.splice(1,1);d.type=a.type;i[f]=d;g(d,b)}}})};AJS.MoveDialog.Breadcrumbs=function(a,g){var c=0;return{update:function(f,j){a.html(Confluence.Templates.Dialog.breadcrumbLoading());var b=c=c+1,d=function(){if(b!=c){AJS.debug("Breadcrumb response for ",f," is stale, ignoring.");return true}return false};(g||AJS.MoveDialog.getBreadcrumbs)(f,function(c,g){if(!d())if(g!="success"||
!c)a.html(Confluence.Templates.Dialog.breadcrumbError());else{var b=f.spaceKey;a.renderBreadcrumbs(c);if(!(b=b!=AJS.Meta.get("space-key")))a:{for(b=1;b<c.length;b++)if(c[b].title==AJS.Meta.get("page-title")){b=false;break a}b=true}if(b){j.clearErrors();e(j.moveButton).prop("disabled",false)}else{j.error("You cannot move a page to be underneath itself or its children.");e("li:last-child",a).addClass("warning")}}},function(b){if(!d()){a.html(Confluence.Templates.Dialog.breadcrumbError());b.status==404&&j.error("The specified page was not found.")}})}}};
AJS.Breadcrumbs={};AJS.Breadcrumbs.getBreadcrumbs=function(a,b,c){if(!a.id)throw Error("id is a required parameter in 'options'");if(!a.type)throw Error("type is a required parameter in 'options'");var f=a.id+":"+a.type;f in i?b(i[f],"success"):e.ajax({type:"GET",dataType:"json",data:a,url:Confluence.getContextPath()+AJS.REST.getBaseUrl()+"breadcrumb",error:c||function(){},success:function(a,h){if(!a||!a.breadcrumbs)c(a,h);else{for(var d=e.makeArray(a.breadcrumbs);d[0]&&a.type!="userinfo"&&/peopledirectory.action$/.test(d[0].url);)d.shift();
d.type=a.type;i[f]=d;b(d,h)}}})};Confluence.Dialogs||(Confluence.Dialogs={});Confluence.Dialogs.Breadcrumbs=AJS.Breadcrumbs;Confluence.Dialogs.Breadcrumbs.Controller=AJS.MoveDialog.Breadcrumbs;Confluence.Dialogs.Breadcrumbs.defaultGetBreadcrumbs=AJS.MoveDialog.getBreadcrumbs;var b=null;Confluence.PageLocation={get:function(){return b?b:{spaceName:AJS.Meta.get("space-name"),spaceKey:AJS.Meta.get("space-key"),parentPageTitle:AJS.Meta.get("parent-page-title")}},set:function(a){b=a}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.resources:dialog-breadcrumbs', location = '/includes/soy/dialog-breadcrumbs.soy' */
// This file was automatically generated from dialog-breadcrumbs.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Dialog == 'undefined') { Confluence.Templates.Dialog = {}; }


Confluence.Templates.Dialog.breadcrumbItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li><a class="', soy.$$escapeHtml(opt_data.className), '" title="', soy.$$escapeHtml(opt_data.title), '" tabindex="-1"><span>', soy.$$escapeHtml(opt_data.text), '</span></a></li>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Dialog.breadcrumbLoading = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="loading"><span>', "Loading breadcrumbs\u2026", '</span></li>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Dialog.breadcrumbError = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="warning last"><span>', soy.$$escapeHtml("Error retrieving breadcrumbs."), '</span></li>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-object.js' */
(function(c){function i(a){return c.nodeName(a,"img")?a:a.hasChildNodes()&&1==a.childNodes.length&&c.nodeName(a,"a")&&c.nodeName(a.firstChild,"img")?a.firstChild:null}function j(a){return!a?"":c(a).attr("data-linked-resource-default-alias")||c(a).attr("src")}function g(a){var b={};"A"==a.nodeName&&c(a.attributes).each(function(){b[this.name]=this.value});return b}function h(a,b){for(var c=a;c&&c!=b;){if(3!=c.nodeType)return!1;c=c.nextSibling}return 3==b.nodeType}Confluence.Link={isLink:function(a){return a&&
!!a.fillNode}};var e=function(a){if(Confluence.Link.isLink(a))return a;var b={insert:function(){return Confluence.Editor.LinkAdapter.setLink(b)},fillNode:function(a){var b=this.attrs;b.href=b.href||"#";a.attr(b);this.classes&&this.classes.length&&a.addClass(this.classes.join(" "));a.html(this.body.html);return a},getData:function(){var a={},b;for(b in this)this.hasOwnProperty(b)&&!c.isFunction(this[b])&&(a[b]=this[b]);return a},getLinkedImage:function(){return this.body&&this.body.jquery?1==this.body.length&&
this.body.is("img")&&this.body:null},getResourceId:function(){return this.attrs["data-linked-resource-id"]||""},getResourceVersion:function(){return this.attrs["data-linked-resource-version"]||""},isToConfluenceEntity:function(){return this.attrs["data-linked-resource-id"]},isToAttachmentOnSamePage:function(a){return"attachment"==this.attrs["data-linked-resource-type"]&&this.attrs["data-linked-resource-container-id"]==a},isCustomAtlassianContentLink:function(){return this.classes&&this.classes.length?
-1!=c.inArray("confluence-link",this.classes):!1},hasAnchor:function(){return this.attrs["data-anchor"]},getResourceType:function(){return this.attrs["data-linked-resource-type"]},getDefaultAlias:function(){return this.attrs["data-linked-resource-default-alias"]},getHref:function(){return this.attrs.href},getAnchor:function(){return this.attrs["data-anchor"]},getHtml:function(){return this.body.html},getShortcut:function(){return this.attrs["data-linked-resource-shortcut"]},isHrefValid:function(){return this.attrs.href&&
"http://"!=this.attrs.href},isImage:function(){return this.body.isImage},isNewLink:function(){return c.isEmptyObject(this.attrs)},isShortcutLink:function(){return"shortcut"===this.getResourceType()},showsBreadcrumbs:function(){return!0}};if(a&&a.attrs){var e={},f=null;c.each(a.attrs,function(a,b){"class"==a?f=b:e[a]=b});a.attrs=e;if(f){var d=f.split(" ");a.classes=a.classes&&a.classes.length?a.classes.concat(d):d}}c.extend(b,a);return b};Confluence.Link.fromData=function(a){return e(a)};Confluence.Link.fromNode=
function(a,b){e({attrs:{},body:{html:b,text:b}});return e({attrs:g(a),body:{html:b,text:b}})};Confluence.Link.fromSelectedAnchor=function(a,b){var k=c(a),f=i(a),d=!f&&h(a.firstChild,a.lastChild);return e({attrs:g(a),body:{isEditable:d,isImage:!!f,html:k.html(),imgName:j(f),text:b}})};Confluence.Link.fromSelection=function(a,b,c,f){var b=i(b),d;if(d=!b)if(a.collapsed)d=!0;else if(d=a.startContainer,d==a.endContainer)d=3==d.nodeType?!0:h(d.childNodes[a.startOffset],d.childNodes[a.endOffset-1]);else{var g=
tinymce.activeEditor.dom;d=g.isBlock(a.startContainer)?a.startContainer.childNodes[a.startOffset]:a.startContainer;a=g.isBlock(a.endContainer)?a.endContainer.childNodes[a.endOffset-1]:a.endContainer;a=d&&a&&d.parentNode==a.parentNode?{start:d,end:a}:null;d=!!a&&h(a.start,a.end)}return e({attrs:{},body:{isEditable:d,isImage:!!b,html:c,imgName:j(b),text:f}})};Confluence.Link.fromREST=function(a){var b=e({attrs:{"data-base-url":AJS.Confluence.getBaseUrl(),"data-linked-resource-id":a.id,"data-linked-resource-type":a.type,
"data-linked-resource-content-type":a.contentType,href:AJS.REST.findLink(a.link),"data-linked-resource-default-alias":a.title},body:{html:AJS.escapeHtml(a.title),text:AJS.escapeHtml(a.title)},classes:["confluence-link"]});"user"==a.type&&(b.attrs["data-linked-resource-type"]="userinfo");return b};Confluence.Link.createLinkToNewPage=function(a,b){return e({attrs:{"data-space-key":b,"data-content-title":a,href:AJS.contextPath()+"/pages/createpage.action?spaceKey="+b+"&title="+a},body:{html:AJS.escapeEntities(a),
text:a},classes:["createlink","confluence-link"]})};Confluence.Link.makeExternalLink=function(a){return e({attrs:{href:a},body:{html:a,text:a}})};Confluence.Link.isExternalLink=function(a){return a&&(a.match(/^(\/\/|mailto:|file:|http:|https:)/)||0===a.indexOf("\\"))}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-adapter.js' */
Confluence.Editor.LinkAdapter=function(d){return{setLink:function(a){var b=AJS.Rte.getEditor(),b=d(b.dom.create("a"),b.getDoc());a.fillNode(b);a=tinymce.confluence.NodeUtils.replaceSelection(b);d("#comments-section").length&&AJS.Rte.fixEditorFocus();return a},getLink:function(){var a,b,c;a=AJS.Rte.getEditor().selection;var e=a.getNode();if(c=d(e).parents().andSelf().filter("a[href]")[0])return a.select(c),b=a.getContent({format:"text"}),Confluence.Link.fromSelectedAnchor(c,b);c=a.getRng(!0);b=a.getContent({format:"text"});
a=a.getContent();return Confluence.Link.fromSelection(c,e,a,b)}}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser.js' */
Confluence.Editor.LinkBrowser=function(i){function p(){if(!d.prop("disabled")){d.prop("disabled",!0);AJS.debug("link-browser.js: submit");g.preSubmit&&g.preSubmit();var a=e.getLink();m();a.insert();AJS.trigger("closed.link-browser")}}function m(){j.hide().remove();AJS.Rte.BookmarkManager.restoreBookmark()}function n(){m();AJS.trigger("closed.link-browser")}function q(a,d,k){var b=d.key,d=d.label,c=b+"-panel",f=Confluence.Templates.LinkBrowser[b+"Panel"]({atlToken:AJS.Meta.get("atl-token")});j.addPanel(d,
f,c,c+"-id");var a=j.get("panel:"+a),h=k.tabs[b];h.panelObj=a;h.key=b;h.createPanel({baseElement:i(a[0].body)});a[0].onblur=h.onDeselect;a[0].onselect=function(){var a=!!h.hasBreadcrumbs;AJS.debug("Link Browser: on tab select, breadcrumbs enabled: "+a);h.onSelect();e.refresh(a);g=h};return h}var j,e,d,g;return{SEARCH_PANEL:"search",ATTACHMENTS_PANEL:"attachments",WEBLINK_PANEL:"weblink",ADVANCED_PANEL:"advanced",open:function(a){if(i(".aui-dialog:visible").length)return null;a=a||{};AJS.Rte.BookmarkManager.storeBookmark();
a.linkInfo=a.linkInfo||Confluence.Editor.LinkAdapter.getLink();if(a.opener)return a.opener(a.linkInfo.alias,a.linkInfo);var o=a,a={tabs:{},setLink:function(r,a){e.setLink(r,a)},getLink:function(){return e.getLink()},getSelectedDataTableItem:function(){return i(".data-table:visible tr.selected")},linkValid:function(a){d.prop("disabled",!a)},focusLinkText:function(){e.focusLinkText()||(AJS.debug("LinkBrowser: focusing submit button"),d.focus())},getLinkText:function(){return e.getLinkText()},isLinkTextVisible:function(){return e.isLinkTextVisible()},
hasBreadcrumbs:function(a){return e.hasBreadcrumbs(a)},getLocationPresenter:function(){return e},doSearch:function(a){this.tabs.search.doSearch(a)},getSearchTextField:function(){return this.tabs.search.getSearchTextField()},moveLocationPanel:function(a){e.moveLocationPanel(a)},restoreLocationPanel:function(){e.restoreLocationPanel()},gotoPanel:function(a){this.popup.gotoPanel(a)},getCurrentPanel:function(){return this.popup.getCurrentPanel()},setWebLinkURL:function(a){var b=this.tabs.weblink;g!=b?
AJS.debug("Cannot set URL "+a+" on hidden Web Link panel"):b.setURL(a)},getWebLinkUrl:function(){var a=this.tabs.weblink;return g!=a?(AJS.debug("Cannot get URL "+url+" on hidden Web Link panel"),null):a.getURL()},getTitle:function(){return this.popup.getTitle()},getSubmitButtonText:function(){return d.text()},isSubmitButtonEnabled:function(){return d.is(":enabled")},isVisible:function(){return this.popup.isVisible()},getAdvancedTextField:function(){var a=this.tabs.advanced;return g!=a?(AJS.debug("Cannot get link text on hidden advanced panel"),
null):a.getLink()},setAdvancedTextField:function(a){var b=this.tabs.advanced;g!=b?AJS.debug("Cannot set link text on hidden advanced panel"):b.setLink(a)},submit:p,cancel:n},k=o.linkInfo,b=k.isNewLink(),c,f;c=new AJS.ConfluenceDialog({width:840,height:590,id:"insert-link-dialog",onCancel:n,onSubmit:p});f=b?"Insert link":"Edit link";b=b?"Insert":"Save";c.addHeader(f);
c.addButton(b,p);c.addCancel("Cancel",n);c.addHelpText("Hint: type \"[\" in the editor to see a list of suggested pages and insert a link.");f=i("#insert-link-dialog .dialog-tip");f.attr("title",f.text());i("#insert-link-dialog .dialog-components .dialog-title").prepend(Confluence.Templates.LinkBrowser.helpLink());d=c.get("button:0")[0].item;d.attr("id","link-browser-insert");d.prop("disabled",!0);j=c;a.popup=j;AJS.trigger("dialog-created.link-browser",[a]);e=Confluence.Editor.LinkBrowser.LinkInfoPresenter(a);
e.setLinkBody(k.body);o=o.panelKey;c=i("#link-browser-tab-items").find("div").map(function(){var a=i(this);return{key:a.text(),weight:a.attr("data-weight"),label:this.title}}).sort(function(a,b){return a.weight-b.weight});var h="template"!==AJS.Meta.get("content-type");c=i.grep(c,function(a){return h||"attachments"!==a.key});var m;f=null;for(var b=0,s=c.length;b<s;b++){var l=q(b,c[b],a);0==b&&(m=l);!k.isNewLink()&&i.isFunction(l.handlesLink)&&l.handlesLink(k)?(f=l,l.openedLink=k):o==l.key&&(f=l)}f?
a.popup.overrideLastTab():f=m;g=f;j.popup.element.find(".dialog-page-body:first").append(e.getContainer());g.panelObj.select();g.openedLink=null;j.show();AJS.trigger("dialog-shown.link-browser",j);return a},cancel:n}}(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-location.js' */
(function(t){Confluence.Editor.LinkBrowser.LinkInfoPresenter=function(u){function i(){return AJS.escapeHtml(n())}function n(){return d.val()}function o(a){f.closest(".row").toggleClass("hidden",!a);b.toggleClass("has-breadcrumbs",!!a)}function p(){return d.is(":visible")}var b,f,j,e,d,k,q,r,l,g,m,c,h;b=t(Confluence.Templates.LinkBrowser.locationPanel());f=b.find("#breadcrumbs-container");j=Confluence.Dialogs.Breadcrumbs.Controller(f,AJS.Breadcrumbs.getBreadcrumbs);q=b.find(".link-image");r=b.find(".link-mixed");
g=b.find("#link-image-filename");l=b.find("#link-mixed-content");k=b.find(".link-text");d=k.find("input");d.change(function(a){a.keyCode=a.keyCode||a.which;a.keyCode&&13!=a.keyCode&&d.removeClass("default-alias")});return{setLink:function(a,b){AJS.debug("Link Browser: setting link : "+a);var c=a.attrs["data-linked-resource-default-alias"]||a.getHtml();if(""==i()||d.hasClass("default-alias"))d.addClass("default-alias"),d.val(c);if(b&&a.getResourceId()&&a.getResourceType()){var s={clearErrors:function(){},
error:function(){},select:function(a){j.update(a,s)}},c={id:a.getResourceId(),type:a.getResourceType()};j.update(c,s)}o(b);e=a;u.linkValid(e&&e.isHrefValid())},getLink:function(){if(!e)return null;var a=m;a||((a=i())||(a=e.getDefaultAlias()||e.getHref()),a={html:a});e.body=a;return e},refresh:function(a){e&&o(a)},setLinkBody:function(a){m||(a.isEditable?d.val(a.text):a.isImage?g.text(a.imgName):l.text(a.text),m=a.isEditable?null:a,k.toggleClass("hidden",!a.isEditable),q.toggleClass("hidden",!a.isImage),
r.toggleClass("hidden",a.isEditable||a.isImage))},getContainer:function(){return b},isLinkTextVisible:p,isLinkImageVisible:function(){return g.is(":visible")},isLinkMixedContentVisible:function(){return l.is(":visible")},focusLinkText:function(){return p()?(AJS.debug("LinkInfoPresenter.focusLinkText focusing alias"),d.select(),!0):!1},getLinkText:i,getRawLinkText:n,getLinkImageName:function(){return g.text()},moveLocationPanel:function(a){c||(c=b.find(".row:not(.hidden) .field-group"),h=c.parent());
a.append(c);b.hide()},restoreLocationPanel:function(){h&&(h.append(c),b.show(),h=c=null)},hasBreadcrumbs:function(a){if(!f.is(":visible"))return!1;var b=a.length,d=f.find("li");if(d.length!=b)return!1;for(var c=0;c<b;c++)if(d.eq(c).text()!=a[c])return!1;return!0}}}})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-search.js' */
"undefined"===typeof jQuery.expr[":"].focus&&(jQuery.expr[":"].focus=function(c){return c===document.activeElement&&(c.type||c.href)});
(function(c){AJS.bind("dialog-created.link-browser",function(m,h){var b,e,f,k,l=AJS.REST.getBaseUrl()+"search.json",i=function(a,c){Confluence.Link.isLink(a)||(a=Confluence.Link.fromREST(a));c&&b.val(a.attrs["data-linked-resource-default-alias"]);h.setLink(a,true);h.focusLinkText()},j=function(a){AJS.debug("link-browser-tab-search.js: doing search");b.trigger("hide.autocomplete");var d=c.trim(b.val());if(d){f.loading();AJS.getJSONWrap({url:l,data:{search:"site",query:d,spaceKey:e.val()},successCallback:function(d){if(c.isFunction(a)){f.update(d.result);
a()}else f.updateAndSelect(d.result);b.trigger("hide.autocomplete")},messageHandler:k})}else c.isFunction(a)&&a()};h.tabs.search={hasBreadcrumbs:true,createPanel:function(a){var d=a.baseElement;b=d.find("#link-search-text");e=d.find("#search-panel-space");var g=Confluence.PageLocation.get();e.find("option:eq(1)").text(g.spaceName).val(g.spaceKey);e.change(function(){b.attr("data-spacekey",e.val());b.trigger("clearCache.autocomplete")});Confluence.Binder.autocompleteSearch(b.parent());b.bind("selected.autocomplete-content",
function(a,b){if(b.searchFor)j();else{f.clear();i(b.content,false)}});g=[AJS.SelectGrid.Column({key:"title",heading:"Title",getHref:function(a){return AJS.REST.findLink(a.link)},getInnerClass:function(a){return a.iconClass||"content-type-"+a.type}}),AJS.SelectGrid.Column({key:"space",heading:"Space",getText:function(a){return a.space&&a.space.title||""}}),AJS.SelectGrid.Column({key:"last-modified",heading:"Last Modified",
getText:function(a){return a.lastModifiedDate&&a.lastModifiedDate.friendly||""},getTitle:function(a){return a.lastModifiedDate&&a.lastModifiedDate.date||""}})];k=AJS.MessageHandler({baseElement:a.baseElement.find(".message-panel")});f=new AJS.ResultGrid({baseElement:a.baseElement,columns:g,selectionCallback:function(a,b){i(b)},noResultMessage:"No search results found.",dontShiftFocus:function(){return c(b).add(e).is(":focus")}});d.find(".search-form").submit(function(){j();
return false}).keydown(function(a){if(a.keyCode===13&&!c(".aui-dropdown:visible .active",this).length){c("#search-panel-button").focus();a.stopPropagation()}})},onSelect:function(){AJS.debug("Link Browser Search panel selected");var a=this.openedLink;if(a){AJS.debug("Link Browser Search panel setting link info");i(a,true)}else b.focus()},handlesLink:function(a){return a.isCustomAtlassianContentLink()&&!a.hasAnchor()&&!a.isShortcutLink()&&!a.isToAttachmentOnSamePage(AJS.Meta.get("content-id"))},doSearch:function(a,
c){b.val(a);j(c)},isResultGridVisible:function(){return f.isVisible()},getSearchTextField:function(){return b}}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-history.js' */
(function(){AJS.bind("dialog-created.link-browser",function(g,d){var c=AJS.REST.makeUrl("session/history.json?max-results=20"),e,f;d.tabs.recentlyviewed={createPanel:function(b){var c=[AJS.SelectGrid.Column({key:"title",heading:"Title",getHref:function(a){return AJS.REST.findLink(a.link)},getInnerClass:function(a){return a.iconClass||"content-type-"+a.type}}),AJS.SelectGrid.Column({key:"space",heading:"Space",
getText:function(a){return a.space&&a.space.title||""}}),AJS.SelectGrid.Column({key:"last-modified",heading:"Last Modified",getText:function(a){return a.lastModifiedDate&&a.lastModifiedDate.friendly||""},getTitle:function(a){return a.lastModifiedDate&&a.lastModifiedDate.date||""}})];f=AJS.MessageHandler({baseElement:b.baseElement.find(".message-panel")});e=new AJS.ResultGrid({baseElement:b.baseElement,columns:c,getRowId:function(a){return a.attachmentId},
selectionCallback:function(a,b){var c=Confluence.Link.fromREST(b);d.setLink(c);d.focusLinkText()},messageHandler:f,noResultMessage:"You have no recently viewed content."})},onSelect:function(){e.loading();AJS.getJSONWrap({url:c,messageHandler:f,successCallback:function(b){e.update(b.content);AJS.trigger("updated.link-browser-recently-viewed")}})}}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-attachment.js' */
(function(k){"template"!==AJS.Meta.get("content-type")&&AJS.bind("dialog-created.link-browser",function(l,g){var e=AJS.REST.makeUrl("content/"+AJS.Meta.get("attachment-source-content-id")+"/attachments.json"),f,i,j,c;g.tabs.attachments={hasBreadcrumbs:!1,createPanel:function(a,b){var d=a.baseElement.find(".attach-file-form");f=k.extend({getUploaderController:function(){return Confluence.AttachmentUploader({baseElement:d},function(){return{onUploadSuccess:function(h){for(var a=0,b=h.length;a<b;a++)h[a].type=
"attachment";c.prependAndSelect(h)}}})}},b&&b(a));i=f.getUploaderController(a);j=i.getMessageHandler();var e=[AJS.SelectGrid.Column({key:"title",heading:"Name",getHref:function(a){return a.link?AJS.REST.findLink(a.link):a.url},getInnerClass:function(a){return a.iconClass}}),AJS.SelectGrid.Column({key:"size",heading:"Size",getText:function(a){return a.niceFileSize}}),AJS.SelectGrid.Column({key:"comment",heading:"Comment"})];
c=new AJS.ResultGrid({baseElement:a.baseElement,columns:e,selectionCallback:function(a,b){var c=Confluence.Link.fromREST(b);c.attrs["data-linked-resource-container-id"]=AJS.Meta.get("content-id");if(AJS.$.isArray(b.link))for(var d=0,e=b.link.length;d<e;d++){var f=b.link[d];"download"==f.rel&&(c.attrs.href=f.href)}g.setLink(c);g.focusLinkText()},noResultMessage:"There are no files on this page."})},onSelect:function(){var a=this.openedLink,b=g.getLink();c.loading();AJS.getJSONWrap({url:e,
messageHandler:j,successCallback:function(d){c.update(d.attachment);b?"attachment"==b.getResourceType()&&c.select(b.getResourceId()):a?c.select(a.getResourceId()):d.attachment.length&&c.select(d.attachment[0].id);AJS.debug("Loaded attachments")}})},handlesLink:function(a){return a.isToAttachmentOnSamePage(AJS.Meta.get("content-id"))}}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-weblink.js' */
(function(h){AJS.bind("dialog-created.link-browser",function(j,c){function d(){return h.trim(b.val())}function e(){var a=d();if(!(AJS.Validate.url(a)||0==a.indexOf("mailto:"))){if(AJS.Validate.email(a))a="mailto:"+a;else{if(i.test(a))return;a="http://"+a}AJS.debug("Updating Link Browser Web Link URL to: "+a);b.val(a);a=Confluence.Link.makeExternalLink(a);c.setLink(a)}}var b,f,g,i=/[:/]/;g=c.tabs.weblink={createPanel:function(a){f=a.baseElement;b=f.find("input[name='destination']");b.keyup(function(){var a=
d();(a=a?Confluence.Link.makeExternalLink(a):null)&&c.setLink(a)});b.change(e);b.bind("paste",function(){AJS.debug("Link Browser web link url pasted");setTimeout(e,0)})},onSelect:function(){c.moveLocationPanel(f.find("form"));this.openedLink&&(g.setURL(this.openedLink.attrs.href),c.setLink(this.openedLink));setTimeout(function(){b.focus()})},onDeselect:c.restoreLocationPanel,preSubmit:e,handlesLink:function(a){return!a.isCustomAtlassianContentLink()},setURL:function(a){b.val(a);b.keyup();b.change()},
getURL:d}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'js/link-browser-tab-advanced.js' */
(function(h){AJS.bind("dialog-created.link-browser",function(k,d){var b,e,f,g,i=function(a){a=h(a);if(a.length){var c=a.find("a:first");c.length?c.hasClass("unresolved")?(a=c.attr("shortcut-key"),c=c.attr("data-space-key"),a?e.text(AJS.format("{0} is not a recognised shortcut",a)):c&&e.text(AJS.format("{0} is not a recognised space",c))):(a=Confluence.Link.fromNode(c[0],b.val()),d.setLink(a)):e.text("The markup provided is not valid link markup")}},j=
function(a,c,b){AJS.debug("Error during conversion: textStatus = "+c+", errorThrown = "+b);e.text("An internal server error occurred")};tab=d.tabs.advanced={createPanel:function(a){f=a.baseElement;b=f.find("input[name='advanced-link']");e=f.find("div[name='advanced-error']");f.find("form").keydown(function(a){13==a.keyCode&&!d.isSubmitButtonEnabled()&&a.preventDefault()});b.keyup(function(){clearTimeout(g);e.text("");b.val()&&(g=setTimeout(function(){var a={wiki:"["+b.val()+
"]",entityId:AJS.Meta.get("content-id"),spaceKey:AJS.Meta.get("space-key")};AJS.$.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:AJS.params.contextPath+"/rest/tinymce/1/wikixhtmlconverter",data:AJS.$.toJSON(a),dataType:"text",success:i,error:j,timeout:1E4})},200))})},setLink:function(a){b.val(a);b.keyup();b.change()},getLink:function(){return b.val()},onSelect:function(){d.moveLocationPanel(f.find("form"));this.openedLink&&(this.openedLink.isShortcutLink()?tab.setLink(this.openedLink.getShortcut()):
this.openedLink.getResourceId()?tab.setLink(this.openedLink.getDefaultAlias()):tab.setLink("#"+this.openedLink.getAnchor()),d.setLink(this.openedLink));setTimeout(function(){b.focus()})},onDeselect:function(){d.restoreLocationPanel()},handlesLink:function(a){return a.isShortcutLink()||a.hasAnchor()}}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-resources', location = 'templates/link-browser.soy' */
// This file was automatically generated from link-browser.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.LinkBrowser == 'undefined') { Confluence.Templates.LinkBrowser = {}; }


Confluence.Templates.LinkBrowser.searchPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui search-form" onsubmit="return false;"><fieldset class="inline"><div class="search-input"><label for="link-search-text" id="linkSearch-label" class="assistive">', soy.$$escapeHtml("Search"), '</label><input id="link-search-text" type="text" tabindex="0" class="text autocomplete-search" name="linkSearch" autocomplete="off" data-search-link-message="', soy.$$escapeHtml("Search for \x26lsquo;{0}\x26rsquo;"), '"></div><select tabindex="0" class="search-space select" id="search-panel-space"><option value="">', soy.$$escapeHtml("All content"), '</option><option value=""> </option></select><button type="submit" tabindex="0" class="aui-button" id="search-panel-button">', soy.$$escapeHtml("Search"), '</button></fieldset></form><div class="message-panel hidden"></div><div id="search-results-table" class="data-table hidden"></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.LinkBrowser.recentlyviewedPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="recently-viewed-panel"><div class="message-panel hidden"></div><div class="data-table"></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.LinkBrowser.attachmentsPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="attach-file-form"><form method="post" enctype="multipart/form-data" id="attachments-attachfile-form" action="', soy.$$escapeHtml("/confluence"), '/pages/attachfile.action" class="aui"><p>', soy.$$escapeHtml("Link to a file that is attached to this page or attach a new one."), '</p><div class="upload-field field-group"><label for="file_0">', soy.$$escapeHtml("Upload file"), '</label> <input type="file" name="file_0" class="upfile" id="file_0"> <input type="hidden" name="minorEdit_0" value="true"></div><input type="hidden" name="atl_token" value="', soy.$$escapeHtml(opt_data.atlToken), '" /></form><div class="upload-in-progress upload-field hidden">', soy.$$escapeHtml("Upload in progress\u2026"), '</div><div class="warning"><ul class="hidden message-panel"></ul></div></div><div class="message-panel hidden"></div><div id="attachments-table" class="attachment-list data-table"></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.LinkBrowser.weblinkPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui" onsubmit="return false;"><div class="field-group"><label id="destination-label" for="weblink-destination">', soy.$$escapeHtml("Address"), '</label><input type="text" tabindex="0" class="text" id="weblink-destination" name="destination"><div class="web-link-desc description">', soy.$$escapeHtml("Web, email or any other internet address"), '</div></div></form>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.LinkBrowser.advancedPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui" onsubmit="return false;"><div class="advanced-desc title">', AJS.format("Here you can insert a link into the page using \x3ca href\x3d\x22{0}\x22 target\x3d\x22_blank\x22\x3ewiki markup\x3c/a\x3e.","https://docs.atlassian.com/confluence/docs-58/Working+with+Links"), '</div><div class="field-group"><label id="advanced-label" for="advanced-link">', soy.$$escapeHtml("Link"), '</label><input type="text" tabindex="0" class="text" id="advanced-link" name="advanced-link"><div class="advanced-desc description">', soy.$$escapeHtml("To insert a link to a new page, type in the desired page title."), '<br/>', soy.$$escapeHtml("To insert an anchor link, type #anchorname."), '</div><div name="advanced-error" class="advanced-error error"></div></div></form>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.LinkBrowser.locationPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="link-browser-location" class="location-info"><form class="aui"><div class="row hidden field-group"><label class="link-location-label" for="breadcrumbs-link">', soy.$$escapeHtml("Link location"), '</label><div class="breadcrumbs-container" id="breadcrumbs-link"><div class="breadcrumbs-line"><ol id="breadcrumbs-container" class="breadcrumbs"></ol></div></div></div></form><div class="row link-text"><form class="aui" onsubmit="return false;"><div class="field-group"><label for="alias" id="alias-label">', soy.$$escapeHtml("Link text"), '</label><input type="text" tabindex="0" class="text" name="alias" id="alias"></div></form></div><div class="row link-image hidden"><div class="readonly"><label for="link-image-filename">', soy.$$escapeHtml("Link image"), '</label><span id="link-image-filename" class="content-type-attachment-image"></span></div></div><div class="row link-mixed hidden"><div class="readonly"><label for="link-mixed-content">', soy.$$escapeHtml("Link text"), '</label><span id="link-mixed-content"></span></div></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.LinkBrowser.helpLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="dialog-help-link"><a href="', soy.$$escapeHtml("https://docs.atlassian.com/confluence/docs-58/Working+with+Links"), '" target="_blank">', soy.$$escapeHtml("Help"), '</a></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-link-browser:link-browser-editor-resources', location = 'tinymce/editor_plugin_src.js' */
tinymce.create("tinymce.plugins.LinkBrowser",{init:function(a){var b=Confluence.Editor.LinkBrowser;a.addButton("linkbrowserButton",{title:"confluence.conflink_desc",cmd:"mceConflink","class":"mce_conflink"});a.addCommand("mceConflink",b.open);a.addCommand("mceConfAttachments",function(){return b.open({panelKey:b.ATTACHMENTS_PANEL})})},getInfo:function(){return{longname:"Confluence Link Browser",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});
tinymce.PluginManager.add("linkbrowser",tinymce.plugins.LinkBrowser);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:editor-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/move-hidden-fields-hack.js' */
AJS.toInit(function(a){a("fieldset.create-content-template-fields > input").appendTo("form.editor")});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-create-content-plugin:create-from-template-macro-browser-resources', location = 'com/atlassian/confluence/plugins/createcontent/js/create-from-template-macro-fields.js' */
AJS.toInit(function(f){function b(h,i){h=h||AJS.Meta.get("space-key");Confluence.Blueprint.Dialog.requestWebItems(h,false).done(function(j){var k=Confluence.Blueprint.Dialog.loadedWebitems[h];if(_.isEmpty(k)){AJS.log("create-from-template-macro-fields: No Create dialog web items found for spaceKey >"+h+"<");return}i(j,k)}).fail(function(){AJS.log("create-from-template-macro-fields: requestWebItems call for spaceKey >"+h+"< failed")})}function c(h,i){b(i,function(k,l){var j=h.val();h.empty();_.each(l,function(m){var o=m.itemModuleCompleteKey;if((o=="com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blank-page"||o=="com.atlassian.confluence.plugins.confluence-create-content-plugin:create-blog-post")){return}if(!(m.templateId||m.contentBlueprintId)){return}var n=f("<option></option>").text(m.name);n.attr("data-template-id",m.templateId);n.attr("data-blueprint-module-complete-key",m.blueprintModuleCompleteKey);n.attr("data-content-blueprint-id",m.contentBlueprintId);n.attr("data-create-result",m.createResult);n.val(m.templateId||m.contentBlueprintId);h.append(n)});h.val(j)})}var g={fields:{spacekey:{spaceKey:function e(k){var j=AJS.MacroBrowser.ParameterFields.spacekey(k),h=j.input.val();var i=function(){var l=j.input.val();if(l!=h){c(AJS.MacroBrowser.fields.templateName.input,l)}h=l};j.input.bind("selected.autocomplete-content",i);j.input.blur(i);return j}}},beforeParamsSet:function a(i,h){i.buttonLabel=i.buttonLabel||i.createButtonLabel||"Create from template";c(f("#macro-param-templateName"),i.spaceKey);return i},beforeParamsRetrieved:function d(j,k,h){var i=AJS.MacroBrowser.fields.templateName.input.find("option:selected");j.blueprintModuleCompleteKey=i.data("blueprint-module-complete-key");j.contentBlueprintId=i.data("content-blueprint-id");j.templateId=i.data("template-id");j.createResult=i.data("create-result");return j}};AJS.MacroBrowser.setMacroJsOverride("create-from-template",g)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/tinyMce-autocomplete-settings.js' */
Confluence.Editor.Autocompleter={Settings:{},log:function(c){return function(d,e,a){var b=null!=a&&"object"!=typeof a;AJS.debug(c+" - "+d+" : "+(e||null)+(null!=a?b?" = "+a:" >":""));a&&!b&&AJS.debug(a)}}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/tinyMce-autocomplete-util.js' */
Confluence.Editor.Autocompleter.Util=function(k){var g=function(a,c,f,b,d){var e;a.statusMessage?e=[[{html:a.statusMessage,className:"error"}]]:(a=c?AJS.REST.makeRestMatrixFromSearchData(a):AJS.REST.makeRestMatrixFromData(a,b),e=AJS.REST.convertFromRest(a));f(e,c,function(a,b){d&&typeof d=="function"&&d(e,a,b)})};return{dropdownLink:function(a,c,f){return"<a href='#' class='"+(c||"")+"'><span class='icon "+(f||"")+"'></span><span>"+a+"</span></a>"},getRestData:function(a,c,f,b,d,e,h){var i=c(b),j=
a.settings.cacheManager,c=j.get(b);i?(a=k.ajax({type:"GET",url:i,data:f(a,b),dataType:"json",global:!1,timeout:5E3}),a.done(function(a){j.put(b,a)}),c?g(c,b,d,e,h):(a.done(function(a){g(a,b,d,e,h)}),a.fail(function(a,c){"timeout"==c&&g({statusMessage:"Timeout",query:b},b,d,e)}))):d([],b)}}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/tinyMce-autocomplete-control.js' */
(function(i){Confluence.Editor.Autocompleter.Control=function(c,k){var a,d,g=Confluence.Editor.Autocompleter.log("Autocompleter.Control"),b={},p=c.selection,r=p.getRng(!0),n=r.startOffset,q=r.startContainer;d=q.nodeValue;var l=k.leadingChar,t=c.getDoc(),m=k.backWords||0,f=Confluence.Editor.Autocompleter.Settings[l||"["];a=!f||"undefined"===typeof f.preventStartNodes?"div.code, a[href], img, pre":f.preventStartNodes;if(i("#autocomplete",t).length)return AJS.debug("init","Autocomplete already exists, returning null."),
null;b.backWords=m;b.maxResults=k.maxResults||10;null==d&&(r.collapsed&&n&&q.childNodes[n-1])&&(q=q.childNodes[n-1],n=(d=q.nodeValue)&&d.length||0);var o="";if(null!=d)for(var o=(d+"").substring(0,n),j=q.previousSibling;j&&3==j.nodeType;)o=j.nodeValue+o,j=j.previousSibling;var j=[/([("'<\(\u201c\u2018]\[|[\ufeff\u200b\u2014\s\xa0].)$/,/(\([^!])$/,/(\/\/)$/],e;if(e=!m)if(e=o){a:{o+=l;e=0;for(var z=j.length;e<z;e++)if(j[e].test(o)){j=!0;break a}j=!1}e=!j}if(e)return g("init","Cursor is in wrong word location to start autocomplete, returning null."),
null;if(AJS.$(q).closest(a).length)return g("init","Cursor is in wrong node to start autocomplete, returning null."),null;Confluence.PropertyPanel&&Confluence.PropertyPanel.current&&(Confluence.PropertyPanel.shouldCreate=!1,Confluence.PropertyPanel.destroy());!l&&null==d&&(AJS.debug("init","No text available for suggestion, range is",r),d="");b.getContainer=function(){return i("#autocomplete",t)};a="";if(r.collapsed&&m&&d){a=q;d=n;j=function(b,h,a){!h.global&&(h=RegExp(h.source,"g"+"i".slice(0,h.ignoreCase)+
"m".slice(0,h.multiLine)));a==null?a=b.length:a<0&&(a=0);for(var b=b.substring(0,a+1),a=-1,c=0;(result=h.exec(b))!=null;){a=result.index;h.lastIndex=++c}return a};for(o=0;o<m;o++){e=a.nodeValue.substring(0,d);for(d=j(e,/\s+/,d);-1==d;)if((e=a.previousSibling)&&3==e.nodeType)a=e,(e=e.nodeValue)&&(d=j(e,/\s+/,e.length));else{o=m;break}}d+=1;tinymce.isIE&&1==m?(m=p.getRng(),m.moveStart("character",d-n),m.select()):(m=p.getRng(!0),m.setStart(a,d),m.setEnd(q,n),p.setRng(m))}a=p.getContent({format:"text"}).replace("\n",
"");g("init","suggestionHtml",a);n=AJS("span").attr("id","autocomplete");l&&n.append(AJS("span").attr("id","autocomplete-trigger").text(l));l=AJS("span").attr("id","autocomplete-search-text");l.text(AJS.Rte.HIDDEN_CHAR);n.append(l);p.setNode(n[0]);var s=b.getContainer();b.previousSearchText="";b.settings=f;!1!==f.cache&&!f.cacheManager?f.cacheManager=new AJS.Confluence.localStorageCacheManager(f.ch):!1===f.cache&&!f.cacheManager&&(f.cacheManager={get:i.noop,put:i.noop});f=i("#autocomplete-search-text",
b.getContainer());l=i(t.createElement("span")).text(a||AJS.Rte.HIDDEN_CHAR);f.empty().append(l);p.select(l[0],!0);p.collapse();var v=function(a,h){if(b.onBeforeKey&&!b.onBeforeKey(h,b.text())){tinymce.dom.Event.cancel(h);g("before","blocked by onBeforeKey: "+h.keyCode);return false}},w=function(a,h){var c=p.getRng(true),d=b.getContainer(),e=c.startContainer,c=e.parentNode;e.nodeType===3&&(c=c.parentNode);var f=(e=c?c.parentNode:null)?e.parentNode:null,d=c!==d[0]&&e!==d[0]&&f!==d[0];if(h.keyCode==
27||d){g("after","dying because of: "+(d?"outside search span":"escape pressed"));b.die()}else if(b.onAfterKey&&!b.onAfterKey(h,b.text())){tinymce.dom.Event.cancel(h);g("after","blocked by onAfterKey: "+h.keyCode);return false}},x=function(a,c){if(b.onKeyPress&&!b.onKeyPress(c,b.text())){tinymce.dom.Event.cancel(c);g("press","blocked by onKeyPress: "+c.keyCode);return false}},y=function(c,a){if(b.getContainer()[0]!=a.target.parentNode){g("click","Clicked outside of autocomplete, closing.");b.die()}};
c.onKeyDown.addToTop(v);c.onKeyUp.addToTop(w);c.onKeyPress.addToTop(x);c.onClick.addToTop(y);b.word="";k.keepAlias?g("init","No suggestion based on previous or selected text"):b.word=a;AJS.Rte.showElement(s[0]);f=tinymce.DOM.getPos(s[0]);l=s.height();b.left=f.x;b.top=f.y+l;b.text=function(a){var c=i("#autocomplete-search-text",b.getContainer());if(a!=null){c.html(a);return this}a=AJS.escapeEntities(c.text());return a.replace(AJS.Rte.HIDDEN_CHAR,"")};b.plainText=function(a){var c=i("#autocomplete-search-text",
b.getContainer());if(a!=null){c.text(a);return this}a=c.text();return a.replace(AJS.Rte.HIDDEN_CHAR,"")};var u=function(a,c){var d=b.getContainer();return Confluence.Editor.Autocompleter.Control.replaceWithTextAndGetRange(d,a,c)};b.replaceWithSelectedSearchText=function(){var a=b.text();g("replaceWithSelectedSearchText",a);u(a,false);return a};b.die=function(a){if(b.dying)AJS.debug("die","Already dying, returning.");else{b.dying=true;if(Confluence.PropertyPanel)Confluence.PropertyPanel.shouldCreate=
true;if(b.getContainer().length){g("die","Tearing down autocomplete, cleaning up autocompleter");a=(a||k.backWords?"":b.settings.ch)+b.text();r=u(a,true)}setTimeout(function(){g("die","Removing autocomplete-control keyboard listeners.");c.onKeyDown.remove(v);c.onKeyUp.remove(w);c.onClick.remove(y);c.onKeyPress.remove(x)},1);AJS.Rte.unbindScroll("autocomplete");i(document).unbind("click.autocomplete-outside");this.onDeath&&this.onDeath()}};AJS.Rte.bindScroll("autocomplete",function(a){AJS.debug("scrolling:",
a);if(AJS.Rte.isAnyPartShown(s))b.onScroll();else b.die()});i(document).bind("click.autocomplete-outside",function(a){i(a.target).closest("#autocomplete-dropdown, .aui-datepicker-dialog, .ui-datepicker-header").length||b.die()});AJS.Rte.getEditor().onBeforeExecCommand.add(function(a,c){c=="mceConfSavePage"&&b.die()});b.update=function(a){AJS.Rte.BookmarkManager.storeBookmark();u("",true);this.settings.update(this,a)};b.removeSpan=function(){b.getContainer().remove()};return b};Confluence.Editor.Autocompleter.Control.removeOrphanedControl=
function(){var c=i(AJS.Rte.getEditor().getDoc()),k=c.find("#autocomplete"),a;if(!k.length)return null;a=c.find("#autocomplete-trigger").text();c=c.find("#autocomplete-search-text").text();Confluence.Editor.Autocompleter.Control.replaceWithTextAndGetRange(k,c,!1);return{leadingChar:a,content:c}};Confluence.Editor.Autocompleter.Control.replaceWithTextAndGetRange=function(c,k,a){if(c.length){var k=k||"",a=a||!k,d=AJS.Rte.getEditor(),g=c[0].parentNode,b=AJS.Rte.Content.getChildIndex(g,c[0]),i=a?1:0,a=
d.selection.getRng(!0);a.setStart(g,b+i);a.setEnd(g,b+1);c.before(k||AJS.Rte.HIDDEN_CHAR).remove();d.selection.setRng(a);return a}AJS.log("replaceWithTextAndGetRange Error: attempting to replace a non-existent element")}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/tinyMce-autocomplete-manager.js' */
Confluence.Editor.Autocompleter.Manager=function(k){Confluence.Editor.Autocompleter.log("Autocompleter.Manager");var c,a,g=function(i){c=Confluence.Editor.Autocompleter.Control(AJS.Rte.getEditor(),i);if(!c)return!1;var h=AJS.$(window).width(),e,g=function(b){var f=k("#autocomplete-dropdown"),d=c.getContainer(),a,i,g,l,j;f.length||(f=AJS("div").addClass("aui-dd-parent quick-nav-drop-down").attr("id","autocomplete-dropdown").appendTo("body"));a=AJS.Position.spaceAboveBelow(AJS.Rte.getEditorFrame(),
d);b.find("ol:has(a.menu-header)").addClass("top-menu-item");b.find("ol:empty").hide();f.append(b);g=AJS.Rte.Content.offset(d);l=Math.max(f.width()+g.left-h+10,0);i=g.left-l-0;b=b.outerHeight(!0);j=b+10;if(e){var m;m=1==e?a.above>=j:a.below>=j;m||(e=null)}e||(e=a.below>=j?2:a.above>=j?1:a.below>a.above?2:1);a=f.find(".autocomplete-dropdown-arrow");a.length||(a=k('<div class="autocomplete-dropdown-arrow"></div>'));1===e?(a.addClass("autocomplete-dropdown-bottom-arrow").css({top:b-1}),d=g.top-b-10):
(a.removeClass("autocomplete-dropdown-bottom-arrow").css("top",""),d=g.top+d.height()+10);a.css({left:l}).appendTo(f);f.css({position:"absolute",top:d,left:i})};a=AJS.inputDrivenDropdown({onShow:function(b){AJS.trigger("rte-autocomplete-on-show",{triggerChar:c.settings.ch});var a=AJS.Rte.getEditorFrame();a&&a.shim&&a.shim.hide();b.find("a.menu-header").unbind().click(function(b){b.preventDefault();c.die()});this.reset();c.settings.selectFirstItem&&b.find("a:not('.menu-header')").length&&AJS.dropDown.current.moveDown()},
dropdownPlacement:g,onDeath:function(){k("#autocomplete-dropdown").remove()},ajsDropDownOptions:{selectionHandler:function(b,a){b.preventDefault();var d=AJS.$.data(a[0],"properties");d&&"function"==typeof d.callback?d.callback(c):"menu-header"!=d.className&&c.update(d);c.die()},moveHandler:function(b,a){var c=AJS.dropDown.current;b&&b.find("a").is(".menu-header")&&("up"==a?c.moveUp():c.moveDown())},className:"autocomplete "+c.settings.dropDownClassName},getDataAndRunCallback:function(b){c&&c.settings.getDataAndRunCallback&&
c.settings.getDataAndRunCallback(c,b,function(f,d,e){f.unshift([{className:"menu-header dropdown-prevent-highlight",href:"#",name:c.settings.getHeaderText(c,b)}]);f.push(c.settings.getAdditionalLinks(c,b,e));a&&a.show(f,d,[d])})},dropDownDelay:c.settings.dropDownDelay});c.onBeforeKey=function(b,a){return 40==b.keyCode||38==b.keyCode||13==b.keyCode?(tinymce.dom.Event.cancel(b),!1):27==b.keyCode||9==b.keyCode||8==b.keyCode&&!a?(this.die(8==b.keyCode),!1):!0};c.onKeyPress=function(b){var a=String.fromCharCode(AJS.$.browser.msie?
b.keyCode:b.which);if(13==b.keyCode)return tinymce.dom.Event.cancel(b),!1;-1!=AJS.indexOf(this.settings.endChars,a)&&c.die();return!0};var n=/\S{2,}/;c.onAfterKey=function(b,e){if(40==b.keyCode||38==b.keyCode||13==b.keyCode){var d=AJS.dropDown.current;if(!d)return!1;if(-1==d.getFocusIndex()&&13==b.keyCode)return c.die(),c=null,!0;b.which||(b.which=b.keyCode);return d.moveFocus(b)}((d=8==b.keyCode&&!e)||n.test(e))&&a.change(e,d);return!0};c.onDeath=function(){a&&(a.remove(),a.closing=!0)};c.onScroll=
function(){a.dd&&g(a.dd.$)};a.change(c.text(),"force");return!0};return{getInputDrivenDropdown:function(){return a},triggerListener:function(c,h){if(h.metaKey)return!0;var e=AJS.$.browser.msie?h.keyCode:h.which;a&&a.closing&&(a=null);e=String.fromCharCode(e);!a&&e in Confluence.Editor.Autocompleter.Settings&&g({leadingChar:e})&&tinymce.dom.Event.cancel(h);return!0},shortcutFired:function(i,h){var e=h?0:1;a&&a.closing&&(a=null);a&&(e=h?0:c.backWords+1,c.die(),c=null);return g({leadingChar:i,backWords:e})},
reattach:function(){var a=Confluence.Editor.Autocompleter.Control.removeOrphanedControl();a&&Confluence.Editor.Autocompleter.Manager.shortcutFired(a.leadingChar)}}}(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.AutoComplete",{init:function(a){Confluence.Editor.Autocompleter.Settings={};a.onPostRender.add(function(){AJS.debug("Autocomplete enabled, adding keyPress listener");a.onKeyPress.addToTop(Confluence.Editor.Autocompleter.Manager.triggerListener);AJS.trigger("ready-editor-autocomplete")});a.onUndo.add(Confluence.Editor.Autocompleter.Manager.reattach);a.onRedo.add(Confluence.Editor.Autocompleter.Manager.reattach)},getInfo:function(){return{longname:"Auto Complete",
author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("autocomplete",tinymce.plugins.AutoComplete)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-link/tinyMce-autocomplete-settings-links.js' */
define("confluence-editor/tinymce3/plugins/autocomplete-link/tinyMce-autocomplete-settings-links",["jquery","ajs"],function(j,d){return function(){var g=Confluence.Editor.Autocompleter,h=function(a){return a?Confluence.getContextPath()+"/rest/prototype/1/search.json":d.Meta.get("remote-user")?Confluence.getContextPath()+"/rest/prototype/1/session/history.json":null},i=function(a,b){var c={"max-results":a.maxResults};b&&(c.query=Confluence.unescapeEntities(b),c.search="name",c.preferredSpaceKey=d.Meta.get("space-key"));
return c};Confluence.Editor.Autocompleter.Settings["["]={ch:"[",cache:!1,endChars:["]"],dropDownClassName:"autocomplete-links",selectFirstItem:!0,getHeaderText:function(){return "Link suggestions"},getAdditionalLinks:function(a,b,c){b?(a="Search for &lsquo;{0}&rsquo;",a=d.format(a,b)):a="Search";var e=Confluence.Editor.LinkBrowser,a=[{className:"search-for",name:a,href:"#",callback:function(a){a.replaceWithSelectedSearchText();
a=e.open({panelKey:e.SEARCH_PANEL});a.doSearch(a.getLocationPresenter().getRawLinkText())}},{className:"dropdown-insert-link",html:g.Util.dropdownLink("Insert web link","dropdown-prevent-highlight","editor-icon"),callback:function(a){a.replaceWithSelectedSearchText();e.open({panelKey:e.WEBLINK_PANEL})}}];c&&c(b,a);return a},getDataAndRunCallback:function(a,b,c){Confluence.Editor.Autocompleter.Util.getRestData(a,h,i,b,c,"content",function(a,b,c){if(b){var f;if(!(f=
2>a.length))a=a[1][0].restObj,a="page"==a.type?a.space.key==d.Meta.get("space-key")&&a.title.toLowerCase()==b.toLowerCase():!1,f=!a;f&&c.push({className:"insert-create-page-link",html:g.Util.dropdownLink("Insert link to create page","dropdown-prevent-highlight","editor-icon"),callback:function(a){var c=Confluence.unescapeEntities(b),c=Confluence.Link.createLinkToNewPage(c,d.Meta.get("space-key"));a.update(c)}})}})},update:function(a,b){b.restObj&&(b=Confluence.Link.fromREST(b.restObj));
b.insert()}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-link/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.AutoCompleteLink",{init:function(a){require(["confluence-editor/tinymce3/plugins/autocomplete-link/tinyMce-autocomplete-settings-links"],function(b){a.addCommand("mceConfAutocompleteLink",function(){Confluence.Editor.Autocompleter.Manager.shortcutFired("[")});a.addShortcut("ctrl+shift+k",a.getLang("AutoComplete"),"mceConfAutocompleteLink");b()})},getInfo:function(){return{longname:"Auto Complete Link",author:"Atlassian",authorurl:"http://www.atlassian.com",
version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("autocompletelink",tinymce.plugins.AutoCompleteLink)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-media/tinyMce-autocomplete-settings-media.js' */
define("confluence-editor/tinymce3/plugins/autocomplete-media/tinyMce-autocomplete-settings-media",["jquery","ajs","confluence-editor/utils/attachments-insert"],function(g,d,h){return function(){var i=function(c){var b=d.params.attachmentSourceContentId||d.Meta.get("content-id");return c?Confluence.getContextPath()+"/rest/prototype/1/search.json":+b?Confluence.getContextPath()+"/rest/prototype/1/content/"+b+"/attachments.json":null},j=function(c,b){var a=d.MacroBrowser.getMacroMetadata("view-file")?
[]:"image word excel pdf powerpoint multimedia".split(" ");return b?{type:"attachment",attachmentType:a,search:"name","max-results":c.maxResults,query:b}:{attachmentType:a,"max-results":c.maxResults}};Confluence.Editor.Autocompleter.Settings["!"]={ch:"!",cache:!1,endChars:["!"],dropDownClassName:"autocomplete-media",selectFirstItem:!0,getHeaderText:function(){return d.MacroBrowser.getMacroMetadata("view-file")?"File suggestions":"Media suggestions"},
getAdditionalLinks:function(){var c="Open file library";return[{className:"dropdown-insert-image",html:Confluence.Editor.Autocompleter.Util.dropdownLink(c,"dropdown-prevent-highlight","editor-icon"),callback:function(b){b.replaceWithSelectedSearchText();Confluence.Editor.defaultInsertImageDialog()}},{className:"dropdown-insert-macro",html:Confluence.Editor.Autocompleter.Util.dropdownLink("Insert other media","dropdown-prevent-highlight",
"editor-icon"),callback:function(b){b.replaceWithSelectedSearchText();tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked({selectedCategory:"media"})}}]},getDataAndRunCallback:function(c,b,a){Confluence.Editor.Autocompleter.Util.getRestData(c,i,j,b,a,"attachment")},update:function(c,b){d.trigger("rte-autocomplete-on-insert",{triggerChar:"!",selectedFile:b});var a=b.restObj,e=d.REST.wikiLink(a),f=a&&a.title||b.name;"Image"==a.niceType?(e.destination&&e.destination.replace(/^\^/,""),a=
g.extend({filename:f,contentId:b.ownerId||a.ownerId},e.params),tinymce.confluence.ImageUtils.insertFromProperties(a)):d.MacroBrowser.getMacroMetadata("view-file")&&"Multimedia"!==a.niceType?h.insertFilePlaceholder({name:f,page:a.parentTitle,space:a.space?a.space.key:"",date:a.datePath,ownerId:a.ownerId}):this._insertFile(f,b,e)},_insertFile:function(c,b,a){var e;switch(b.restObj.niceType){case "PDF Document":e="viewpdf";break;case "Word Document":e="viewdoc";break;case "Excel Spreadsheet":e="viewxls";
break;case "PowerPoint Presentation":e="viewppt";break;case "Multimedia":e="multimedia"}c={page:a.destination.substring(0,a.destination.indexOf("^")),name:c};d.MacroBrowser.getMacroJsOverride("viewdoc").beforeParamsRetrieved(c);c.page||delete c.page;e={contentId:d.Meta.get("content-id")||"0",macro:{name:e,params:c,body:""}};tinymce.confluence.MacroUtils.insertMacro(e)}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-media/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.AutoCompleteMedia",{init:function(a){require(["confluence-editor/tinymce3/plugins/autocomplete-media/tinyMce-autocomplete-settings-media"],function(b){a.addCommand("mceConfAutocompleteImage",function(){Confluence.Editor.Autocompleter.Manager.shortcutFired("!")});a.addShortcut("ctrl+shift+m",a.getLang("AutoComplete"),"mceConfAutocompleteImage");b()})},getInfo:function(){return{longname:"Auto Complete Media",author:"Atlassian",authorurl:"http://www.atlassian.com",
version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("autocompletemedia",tinymce.plugins.AutoCompleteMedia)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-media/tinyMce-autocomplete-analytics-media.js' */
require(["ajs"],function(a){a.bind("init.rte",function(){a.bind("rte-autocomplete-on-show",function(d,c){"!"===c.triggerChar&&a.trigger("analytics",{name:"confluence.editor.autocomplete.trigger",data:{type:"media"}})});a.bind("rte-autocomplete-on-insert",function(d,c){if("!"===c.triggerChar){var b=c.selectedFile;b&&b.name&&(b={extension:b.name.split(".").pop(),type:"media"},a.trigger("analytics",{name:"confluence.editor.autocomplete.insert",data:b}))}})});a.bind("rte-destroyed",function(){a.unbind("rte-autocomplete-on-insert");
a.unbind("rte-autocomplete-on-show")})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-macro/tinyMce-autocomplete-settings-macros.js' */
define("confluence-editor/tinymce3/plugins/autocomplete-macro/tinyMce-autocomplete-settings-macros",["jquery","underscore","ajs"],function(g,o,b){return function(){function k(c){g("#autocomplete-dropdown .top-menu-item").spin(c)}var d=function(c,a){var e=a.presetMacroMetadata;c.replaceWithSelectedSearchText();e?b.MacroBrowser.hasRequiredParameters(e)||e.alwaysShowConfig?tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked(a):(b.Rte.BookmarkManager.storeBookmark(),tinymce.confluence.MacroUtils.insertMacro({contentId:b.Meta.get("content-id")||
"0",macro:{name:e.macroName,body:""}})):tinymce.confluence.macrobrowser.macroBrowserToolbarButtonClicked(a)},l=function(c){if(c.hidden&&!b.MacroBrowser.isHiddenMacroShown(c))return null;var a={className:"autocomplete-macro-"+c.macroName,callback:function(b){d(b,{ignoreEditorSelection:!0,presetMacroMetadata:c})}};c.icon?(a.name=c.title,a.href="#",a.icon=(c.icon.relative?b.params.staticResourceUrlPrefix:"")+c.icon.location):a.html=Confluence.Editor.Autocompleter.Util.dropdownLink(c.title);return a};
Confluence.Editor.Autocompleter.Settings["{"]={ch:"{",cache:!1,endChars:["}",":","{"],dropDownClassName:"autocomplete-macros",dropDownDelay:0,selectFirstItem:!0,getHeaderText:function(){return "Macro suggestions"},getAdditionalLinks:function(){return[{className:"dropdown-insert-macro",html:Confluence.Editor.Autocompleter.Util.dropdownLink("Open macro browser","dropdown-prevent-highlight","editor-icon"),callback:function(b){var a=
b.text();d(b,{searchText:a})}}]},getDataAndRunCallback:function(c,a,e){function d(a){a.preventDefault();a.stopPropagation();b.trigger("analytics",{name:"autocomplete-macrobrowser.load-retry"});b.MacroBrowser.reset();b.MacroBrowser.preLoadMacro();h.getDataAndRunCallback.apply(h,i)}var f=b.MacroBrowser.getMetadataPromise(),h=this,i=arguments;h.alreadyBinded||(h.alreadyBinded=!0,f.always(function(){var d;if(a){d=[];for(var f=b.MacroBrowser.searchSummaries(a,{keywordsField:"keywordsNoDesc"}),j=0,i=f.length;j<
i;j++){var m=l(f[j]);if(m&&d.push(m)==c.maxResults)break}}else{var p=b.MacroBrowser.metadataList,n=[];g("#macro-insert-list li").each(function(){var b=g(this),a=o.find(p,function(a){return a.macroName===b.attr("data-macro-name")});a&&(a=l(a))&&n.push(a)});d=n}k(!1);e([d],a);h.alreadyBinded=!1}),f.fail(function(){b.trigger("analytics",{name:"autocomplete-macrobrowser.fail-to-load"});b.messages.warning("#autocomplete-dropdown ol:nth(1)",{title:"Failed to get macro details",
body:'<p><a id="macro-retry-link" href="#">'+"Try again"+"</a></p>"});g("#macro-retry-link").click(d);g("#autocomplete-dropdown ol:nth(1)").show()}));"pending"===f.state()&&(e([],a),k(!0))},update:function(){throw Error("All items in the Macro Autocomplete dropdown must have a callback function");}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/autocomplete-macro/editor_plugin_src.js' */
(function(){tinymce.create("tinymce.plugins.AutoCompleteMacro",{init:function(){require(["confluence-editor/tinymce3/plugins/autocomplete-macro/tinyMce-autocomplete-settings-macros"],function(a){a()})},getInfo:function(){return{longname:"Auto Complete Macro",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("autocompletemacro",tinymce.plugins.AutoCompleteMacro)})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/searchreplace/editor_plugin_src.js' */
(function(d){var f=null,g=!1,e=function(b,c){c.preventDefault();c.stopPropagation()},i=function(b,c){e(b,c);var a=c.which;a||(a=c.charCode?c.charCode:c.keyCode);48>a||f.push(a)},h=function(b){var c=d("#rte-button-searchreplace a");c.length&&(b?c.unbind("click",!1):c.bind("click",!1))};tinymce.create("tinymce.plugins.AtlassianSearchReplacePlugin",{init:function(b){b.addCommand("mceSearchReplaceToolbar",function(){if(!g){g=!0;var c=d("#rte-button-searchreplace"),a=!c.hasClass("active"),b=d("body"),
b=!b.hasClass("no-tools")||b.hasClass("no-tools-toolbars-visible");a?(c.addClass("active"),Confluence.Editor.searchManager||(Confluence.Editor.searchManager=new Confluence.Editor.SearchManager("searchreplace")),d(document).trigger("createContextToolbarRow.Toolbar",{id:"searchreplace",buttons:Confluence.Editor.searchToolbar.Buttons,topToolbar:!0,editorAdjacent:!0,animate:b,onVisible:function(){var a;a=AJS.Rte.getEditor();a.onKeyDown.remove(i);a.onKeyPress.remove(e);a.onKeyUp.remove(e);var c="";for(a=
0;a<f.length;a++){var b;b=f[a];if(b>65535){b=b-65536;b=String.fromCharCode(55296+(b>>10),56320+(b&1023))}else b=String.fromCharCode(b);c=c+b}a=c.toLowerCase();Confluence.Editor.searchManager.onVisible(a);h(true);g=false;Confluence.Editor.searchManager.initialised=true}}).trigger("enableContextToolbarRow.Toolbar"),c=AJS.Rte.getEditor(),f=[],c.onKeyDown.add(i),c.onKeyPress.add(e),c.onKeyUp.add(e),Confluence.Editor.searchManager.init(),h(!1)):(c.removeClass("active"),Confluence.Editor.searchManager.onHide(),
d(document).trigger("removeContextToolbarRow.Toolbar",{id:"searchreplace",animate:b,onHide:function(){d(document).trigger("contextToolbarRowRemoved.Toolbar");h(!0);g=!1;Confluence.Editor.searchManager.initialised=!1}}),h(!1),tinymce.isGecko||frames.wysiwygTextarea_ifr.focus(),tinyMCE.activeEditor.focus())}});b.addCommand("mceConfSearch",function(b,a){Confluence.Editor.searchManager&&(a=a||{},a.backwards&&!tinyMCE.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-previous-button")?
Confluence.Editor.searchManager.focus():!a.backwards&&!tinyMCE.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-find-next-button")?Confluence.Editor.searchManager.focus():Confluence.Editor.searchManager.find(a.backwards,a.onFound,a.onNotFound))});b.addCommand("mceConfReplace",function(b,a){Confluence.Editor.searchManager&&(a=a||{},tinyMCE.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replace-button")?Confluence.Editor.searchManager.replace(a.onFound,
a.onNotFound):a.onInactive&&a.onInactive())});b.addCommand("mceConfReplaceAll",function(b,a){Confluence.Editor.searchManager&&(a=a||{},tinyMCE.activeEditor.plugins.customtoolbar.isToolbarButtonEnabled("search-toolbar-replaceall-button")&&Confluence.Editor.searchManager.replaceAll(a.onReplaced,a.onNotReplaced))});b.addCommand("mceConfSearchClose",function(){Confluence.Editor.searchManager&&b.execCommand("mceSearchReplaceToolbar",!1,null)});b.addButton("searchreplace",{title:"searchreplace.search_desc",
cmd:"mceSearchReplaceToolbar"});tinyMCE.isIE8||b.addShortcut("ctrl+f","searchreplace.search_desc",function(){Confluence.Editor.searchManager&&Confluence.Editor.searchManager.isVisible()?Confluence.Editor.searchManager.focus():b.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0})})},getInfo:function(){return{longname:"Search/Replace",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("searchreplace",
tinymce.plugins.AtlassianSearchReplacePlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/searchreplace/searchreplace.js' */
(function(){"undefined"==typeof Confluence&&(Confluence={});Confluence.Editor||(Confluence.Editor={});Confluence.Editor.SearchManager=function(a){var b=null,c=null,d=null,j=null,k=null,n=function(i,a){a.content=a.content.replace(RegExp('<mark class="find-current">',"g"),"");a.content=a.content.replace(RegExp("</mark>","g"),"")};this.initialised=false;this.find=function(i,a,g){var c=b.getFindInput().val();(i=d.findText(c,true,i))&&a?a():!i&&g&&g()};this.replace=function(a,c){var g=b.getFindInput(),
l=b.getReplaceInput(),h="";l&&(h=l.val());(g=d.replaceText(g.val(),h,true))&&a?a():!g&&c&&c()};this.replaceAll=function(a,c){var g=b.getFindInput(),l=b.getReplaceInput(),h="";l&&(h=l.val());(g=d.replaceAll(g.val(),h))&&a?a():!g&&c&&c()};this.focus=function(){b.focusFindTextBox()};this.isVisible=function(){return b!=null};this.init=function(){b=new Confluence.Editor.SearchManager.UI(a,j,k);c=new Confluence.Editor.SearchManager.MarkManager;c.addListener(b);d=null;d=tinyMCE.isIE?new Confluence.Editor.SearchManager.implIE(b):
new Confluence.Editor.SearchManager.impl(b,c);tinyMCE.activeEditor.undoManager.onAdd.add(n)};this.onVisible=function(a){if(a!=null&&a.length>0){var c=b.getFindInput(),g=c.val();c.val(g+a)}b.onVisible()};this.onHide=function(){j=b.getFindInput().val();k=b.getReplaceInput().val();d.destroy();d=null;b.destroy();b=null;c.destroy();c=null;tinyMCE.activeEditor.undoManager.onAdd.remove(n)};this._clearSavedValues=function(){k=j=null}};Confluence.Editor.SearchManager.utils={moveCursorToEnd:function(a){if(tinyMCE.isIE){a=
a.createTextRange();a.execCommand("SelectAll");a.move("textedit");a.select()}else if(tinyMCE.isGecko){var b=AJS.$(a).val().length;a.setSelectionRange(b,b)}},createTextRange:function(a,b){return a.selection?a.selection.createRange():b.getBody().createTextRange()}};Confluence.Editor.SearchManager.impl=function(a,b){var c=new tinymce.html.Writer,d=b,j=function(a,c,b){function o(){d.markCurrentlySelectedRange();return true}function g(){d.removeCurrentMark(true);tinyMCE.activeEditor.selection.isCollapsed()||
tinyMCE.activeEditor.selection.collapse();return false}if(!a)return false;var l=tinyMCE.activeEditor,h=l.selection,f=l.getWin();d.isCursorAtCurrentMark()&&(h=d.selectCurrentMark());h.isCollapsed()||h.collapse(b);if(tinymce.isGecko){if(f.find(a,false,b))return o();if(c){h.select(l.getBody(),false);h.collapse(!b);return j(a,false,b)}return g()}return f.find(a,false,b,true,false,false,false)?o():g()};this.findText=j;this.replaceText=function(a,c,b){if(!d.hasCurrentMark())return j(a,b);(c=d.replaceCurrentMark(c))&&
tinyMCE.activeEditor.selection.select(c);return j(a,b)};this.replaceAll=function(a,b){var i=tinyMCE.activeEditor,j=i.getWin();d.removeCurrentMark(false);i.execCommand("selectAll");i.selection.collapse(true);for(var g=0;j.find(a,false,false,false,false,false,false);){var l=tinyMCE.activeEditor;c.text(b);l.selection.setContent(c.getContent(),{format:"raw"});c.reset();l.selection.collapse(true);g++}i.undoManager.add();if(g==0)AJS.Confluence.EditorNotification.notify("info",i.getLang("searchreplace_dlg.notfound"));
else if(g==1)AJS.Confluence.EditorNotification.notify("success",i.getLang("searchreplace_dlg.allreplacedsingular"));else if(g>1){i=i.getLang("searchreplace_dlg.allreplacedplural");AJS.Confluence.EditorNotification.notify("success",i.replace("{0}",g))}return g};this.destroy=function(){c=d=null}};Confluence.Editor.SearchManager.implIE=function(a){var b=a,c=null,d=new tinymce.html.Writer,j=Confluence.Editor.SearchManager.utils.createTextRange,k=function(a,d,h){if(!a)return false;var f=tinyMCE.activeEditor,
m=f.getDoc(),e=this.storedRange=this.storedRange||j(m,f);f.focus();c&&c.select();f.selection.collapse(!h);i();if(h&&c){m=j(m,f);m.moveToElementText(AJS.$("p:first",f.getBody())[0]);e.setEndPoint("StartToStart",m);m=c.text;if(m.length){m=m.replace(/s+$/,"");m.length&&e.moveEnd("character",-m.length)}m=e.text.length;e.moveEnd("word",-1);e.text.length>=m&&e.moveEnd("character",-1);e.select();e.collapse(false)}c=null;if(e.findText(a,h?-1:1,0)){e.scrollIntoView();a=e;a.pasteHTML('<mark class="find-current">'+
a.htmlText+"</mark>");b.marked();d=tinyMCE.activeEditor;d.onChange.add(n);d.onBeforeSetContent.add(n);e=a;e.select();c=e;return true}if(d){f.selection.select(tinyMCE.activeEditor.getBody(),true);f.selection.collapse(!h);return k(a,false,h)}this.storedRange=null},n=function(){i()},i=function(){var a=tinyMCE.activeEditor;a.onChange.remove(n);a.onBeforeSetContent.remove(n);var a=tinyMCE.activeEditor,c=AJS.$("mark",a.getDoc());if(c.length){var h=false,f=a.selection.getRng(true).commonAncestorContainer;
AJS.$(f).closest("mark").length&&(h=true);c.each(function(a,e){$markElement=AJS.$(e);$markElement.contents().each(function(a,e){$markElement.before(e)})}).remove();h&&a.execCommand("RemoveFormat")}b.markRemoved()},o=function(){i()};this.findText=k;this.replaceText=function(a,b,h){var f=tinyMCE.activeEditor;if(c){var d=f.getDoc().createTextNode(b),e=AJS.$("mark",f.getDoc());e.parent()[0].replaceChild(d,e[0]);f.undoManager.add();e=f.getDoc().createElement("mark");e.setAttribute("class","current");d.parentNode.insertBefore(e,
d);e.appendChild(f.getDoc().createTextNode(b));e.parentNode.removeChild(d)}return k(a,h)};this.replaceAll=function(a,c){var b=tinyMCE.activeEditor,f=b.selection;b.getWin();var m=b.undoManager,e=b.getDoc();i();f.select(b.getBody(),false);f.collapse(true);b.focus();e=j(e,b);for(f=0;e.findText(a,1,0);){e.scrollIntoView();e.select();d.text(c);b.selection.setContent(d.getContent(),{format:"raw"});d.reset();f++;e.moveStart("character",c.length)}m.add();if(f==0)AJS.Confluence.EditorNotification.notify("info",
b.getLang("searchreplace_dlg.notfound"));else if(f==1)AJS.Confluence.EditorNotification.notify("success",b.getLang("searchreplace_dlg.allreplacedsingular"));else if(f>1){b=b.getLang("searchreplace_dlg.allreplacedplural");AJS.Confluence.EditorNotification.notify("success",b.replace("{0}",f))}return f};this.destroy=function(){tinyMCE.activeEditor.onBeforeGetContent.remove(o);i();d=c=b=null};tinyMCE.activeEditor.onBeforeGetContent.add(o)};Confluence.Editor.SearchManager.UI=function(a,b,c){var d=null,
j=Confluence.Editor.SearchManager.utils.moveCursorToEnd;tinyMCE.activeEditor&&(tinyMCE.activeEditor.plugins&&tinyMCE.activeEditor.plugins.customtoolbar)&&(d=tinyMCE.activeEditor.plugins.customtoolbar.getToolbarRow(a));var k=function(){var a=AJS.$(".toolbar-find-input",d);return!a.length?null:a},n=function(){var a=AJS.$(".toolbar-replace-input",d);return!a.length?null:a},i=function(a){if(a){tinyMCE.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-next-button");tinyMCE.activeEditor.plugins.customtoolbar.enableToolbarButton("search-toolbar-find-previous-button")}else{tinyMCE.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-next-button");
tinyMCE.activeEditor.plugins.customtoolbar.disableToolbarButton("search-toolbar-find-previous-button")}},o=function(a){var b=k(),e;e=AJS.$(".search-toolbar-find-next-button",d).closest(".aui-button");e=e.length?e:null;e.toggleClass("default-action",a&&b.val().length>0)},g=function(a){var b=tinyMCE.activeEditor.plugins.customtoolbar;a?b.enableToolbarButton("search-toolbar-replace-button"):b.disableToolbarButton("search-toolbar-replace-button")},l=function(a){var b=tinyMCE.activeEditor.plugins.customtoolbar;
a?b.enableToolbarButton("search-toolbar-replaceall-button"):b.disableToolbarButton("search-toolbar-replaceall-button")};this.getFindInput=k;this.getReplaceInput=n;this.focusFindTextBox=function(){top.focus();k().focus()};this.onVisible=function(){var a=k();a.focus();if(a.val().length>0){j(a[0]);i(true);l(true)}};this.destroy=function(){};this.marked=function(){g(true)};this.markRemoved=function(){g(false)};var h=k(),a=false;if(b&&b.length){h.val(b);a=true}c&&c.length&&n().val(c);b=function(a,b){a&&
(tinymce.isIE9?a[0].attachEvent("onpropertychange",b):a.bind(tinymce.isIE8?"propertychange":"input",b))};c=k();b(c,function(a){if(a.type=="input"||a.type=="propertychange"){a=k();a=a!=null&&a.val().length>0;i(a);o(a)}});b(c,function(){var a=k();l(a&&a.val())});AJS.$(d).focusin(function(){o(true)}).focusout(function(){o(false)});c.focus(function(){o(true)});i(a);l(a);g(false);return this};Confluence.Editor.SearchManager.MarkManager=function(){var a=null,b=new tinymce.html.Writer,c=null,d=[],j=function(){i()},
k=function(){if(!a)return null;var e=tinyMCE.activeEditor;e.selection.select(a[0]);return e.selection},n=function(e){m();if(o(a,e)||c&&tinyMCE.activeEditor.selection.getRng(true).toString()==c){c=a=null;AJS.$.each(d,function(a,e){e.markRemoved()})}},i=function(){m();AJS.$("mark",tinyMCE.activeEditor.getDoc()).each(function(a,b){o(AJS.$(b),false)});c=a=null;AJS.$.each(d,function(a,b){b.markRemoved()})},o=function(a,b){var c=tinyMCE.activeEditor.selection.getRng(true);if(!a)return false;var d=a[0];
if(c.intersectsNode)c=c.intersectsNode(d);else{var f=tinyMCE.activeEditor.getDoc().createRange();f.selectNodeContents(d);c=c.compareBoundaryPoints(Range.START_TO_END,f)<=0||c.compareBoundaryPoints(Range.END_TO_START,f)>=0?false:true}var g=null,h=null;a.contents().each(function(b,c){a.before(c);g||(g=c);h=c});if(c||b){c=tinyMCE.activeEditor.selection.getRng(true);c.setStartBefore(g);c.setEndAfter(h);b||c.collapse(false);tinyMCE.activeEditor.selection.setRng(c)}a.remove();return true},g=function(){if(a)return true;
if(c)return tinyMCE.activeEditor.selection.getRng(true).toString()==c},l=function(){i()},h=function(){m();AJS.$.each(d,function(a,b){b.markRemoved()})},f=function(a){var b=tinyMCE.activeEditor;b.onChange.add(j);b.onBeforeSetContent.add(j);if(a){b.onClick.add(h);b.onDblClick.add(h)}},m=function(){var a=tinyMCE.activeEditor;a.onChange.remove(j);a.onBeforeSetContent.remove(j);a.onClick.remove(h);a.onDblClick.remove(h)};this.markCurrentlySelectedRange=function(){var b=tinyMCE.activeEditor;if(a){var g=
b.selection.getBookmark();n(false);b.selection.moveToBookmark(g)}c=null;g=b.selection.getRng(true);a=AJS.$('<mark class="find-current"></mark>',b.getDoc());try{g.surroundContents(a[0]);f(false)}catch(h){if(h.code==1){c=g.toString();a=null;f(true)}}AJS.$.each(d,function(a,b){b.marked()});c||k().collapse()};this.removeCurrentMark=n;this.removeAllMarks=i;this.selectCurrentMark=k;this.isCursorAtCurrentMark=function(){if(!a)return false;var b=tinyMCE.activeEditor.selection;b.isCollapsed()||b.collapse();
var c=b.getRng(true);if(c.startContainer.nodeType==3){c.startContainer.parentNode.normalize();return c.startContainer.nextSibling===a[0]||c.startContainer.previousSibling===a[0]}if(c.startContainer.nodeType==1){b=c.startContainer.childNodes;c=c.startOffset;return c>0&&b[c-1]===a[0]||c+1<b.length&&b[c+1===a[0]]?true:false}};this.hasCurrentMark=g;this.replaceCurrentMark=function(c){var d;if(a||!g())d=false;else{d=tinyMCE.activeEditor;b.text(c);d.selection.setContent(b.getContent(),{format:"raw"});b.reset();
d.undoManager.add();n(false);d=true}if(d||!a)return null;var f=[];a.contents().each(function(a,b){f.push(b)});n(false);d=tinyMCE.activeEditor;for(var c=AJS.$(f[0]).before(d.getDoc().createTextNode(c))[0].previousSibling,h=f.length-1;h>=0;h--)AJS.$(f[h]).remove();d.undoManager.add();return c};this.addListener=function(a){d.push(a)};this.destroy=function(){n(true);tinyMCE.activeEditor.onBeforeGetContent.remove(l)};tinyMCE.activeEditor.onBeforeGetContent.add(l)}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-autocomplete-resources-only', location = 'tinymce3/plugins/searchreplace/tinyMce-search-toolbar.js' */
AJS.$(document).bind("initContextToolbars.Toolbar",function(o,b){var f=function(a){if(tinyMCE.isIE)a=a.createTextRange(),a.execCommand("SelectAll"),a.move("textedit"),a.select();else if(tinyMCE.isGecko){var b=AJS.$(a).val().length;a.setSelectionRange(b,b)}},d=function(a){top.focus();tinyMCE.activeEditor.plugins.customtoolbar.focusToolbarButton(a)},c=function(){top.focus();var a=AJS.$("#search-toolbar-find-text");a.focus();f(a[0])},g=function(){top.focus();var a=AJS.$("#search-toolbar-replace-text");
a.focus();f(a[0])},i=function(){tinyMCE.isIE&&frames.wysiwygTextarea_ifr.focus();if(tinyMCE.isIE||tinyMCE.isGecko){var a=tinyMCE.activeEditor;a.focus();a.selection.select(a.getBody());a.selection.collapse(!1);a.focus()}},e=new Confluence.Editor.Toolbar.Components.TextBox({id:"search-toolbar-find-text",text:b.getLang("searchreplace_dlg.findlabel"),name:"find",keydown:function(a){!tinyMCE.isIE8&&(a.ctrlKey||tinymce.isMac&&a.metaKey)&&"70"==a.which?a.preventDefault():"13"==a.which?(a.preventDefault(),
tinyMCE.activeEditor.execCommand("mceConfSearch",!1,{backwards:!1,onFound:c,onNotFound:c},{skip_undo:!0})):"27"==a.which&&(a.preventDefault(),tinyMCE.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0}))},cssClass:"toolbar-find-input"}),j=new Confluence.Editor.Toolbar.Components.TextBox({id:"search-toolbar-replace-text",text:b.getLang("searchreplace_dlg.replacelabel"),name:"replace",keydown:function(a){!tinyMCE.isIE8&&(a.ctrlKey||tinymce.isMac&&a.metaKey)&&"70"==a.which?a.preventDefault():
"13"==a.which?(a.preventDefault(),tinyMCE.activeEditor.execCommand("mceConfReplace",!1,{onFound:g,onNotFound:c,onInactive:function(){tinyMCE.activeEditor.execCommand("mceConfSearch",false,{backwards:false,onFound:g,onNotFound:c},{skip_undo:true})}},{skip_undo:!0})):"27"==a.which&&(a.preventDefault(),tinyMCE.activeEditor.execCommand("mceSearchReplaceToolbar",!1,!1,{skip_undo:!0}))},cssClass:"toolbar-replace-input"}),k=new Confluence.Editor.Toolbar.Components.TextButton({text:b.getLang("searchreplace_dlg.findprevious"),
click:function(){b.execCommand("mceConfSearch",!1,{backwards:!0,onFound:function(){top.focus();d("search-toolbar-find-previous-button")},onNotFound:c},{skip_undo:!0})},textClass:"search-toolbar-find-previous-button"}),h=new Confluence.Editor.Toolbar.Components.TextButton({text:tinyMCE.isIE?b.getLang("searchreplace_dlg.findlabel"):b.getLang("searchreplace_dlg.findnext"),click:function(){b.execCommand("mceConfSearch",!1,{backwards:!1,onFound:function(){top.focus();d("search-toolbar-find-next-button")},
onNotFound:c},{skip_undo:!0})},textClass:"search-toolbar-find-next-button"}),l=new Confluence.Editor.Toolbar.Components.TextButton({text:b.getLang("searchreplace_dlg.replace"),click:function(){b.execCommand("mceConfReplace",!1,{onFound:function(){top.focus();d("search-toolbar-replace-button")},onNotFound:c},{skip_undo:!0})},textClass:"search-toolbar-replace-button"}),m=new Confluence.Editor.Toolbar.Components.TextButton({text:b.getLang("searchreplace_dlg.replaceall"),click:function(){b.execCommand("mceConfReplaceAll",
!1,{onReplaced:i,onNotReplaced:c})},textClass:"search-toolbar-replaceall-button"}),n=new Confluence.Editor.Toolbar.Components.Button({text:b.getLang("searchreplace_dlg.close"),iconClass:"icon-close",click:function(){b.execCommand("mceConfSearchClose",!1,null)}}),e=[new Confluence.Editor.Toolbar.Components.Group([n],{groupClass:"close"}),new Confluence.Editor.Toolbar.Components.Group([e,j],{groupClass:"no-separator"}),new Confluence.Editor.Toolbar.Components.Group(tinyMCE.isIE?[h]:[k,h]),new Confluence.Editor.Toolbar.Components.Group([l,
m])];Confluence.Editor.searchToolbar={Buttons:e}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.editor:editor-insert-files', location = 'tinymce3/plugins/insert-files/insert-files-plugin.js' */
require(["ajs","jquery","confluence-editor/utils/environment"],function(a,d,b){tinymce.create("tinymce.plugins.InsertFiles",{init:function(c){c.addButton("confluence-insert-files",{title:"Files",tooltip:"Insert files and images"+" ("+b.transformCmdKeyTextBasingOnOS("Ctrl+M")+")",cmd:"mceConfimage",className:"insert-files",locationGroup:"rte-toolbar-group-files",weight:0})},getInfo:function(){return{longname:"Insert Files",
author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com/",version:"1.0"}}});tinymce.PluginManager.add("insertfiles",tinymce.plugins.InsertFiles)},void 0,!0);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-manager.js' */
(function(e){function g(c,a){var b=c.toLocaleLowerCase(),d=a.toLocaleLowerCase(),b=b.localeCompare(d);0==b&&(b=c.localCompare(a));return b}function f(c){return e.extend(!0,{},Confluence.VariableManager.defaults[c]||Confluence.VariableManager.defaults.string)}"template"===AJS.Meta.get("content-type")&&(Confluence.VariableManager=function(){var c={};return{find:function(a){var a=a.toLocaleLowerCase(),b={},d;for(d in c)if(c.hasOwnProperty(d)&&(!a.length||0===d.toLocaleLowerCase().indexOf(a)))b[d]=c[d];
return b},contains:function(a){return!!c[a]},get:function(a){return c[a]},getAll:function(){return e.extend(!0,{},c)},getSortedNames:function(){var a=[],b;for(b in c)a.push(b);return a.sort(g)},add:function(a,b){c[a]=b||f();AJS.trigger("add.confluence-variable",{name:a,details:e.extend(!0,{},b)})},del:function(a){var b=c[a];delete c[a];AJS.trigger("delete.confluence-variable",{name:a,details:e.extend(!0,{},b)})},rename:function(a,b){var d=c[a];delete c[a];d&&(c[b]=d,AJS.trigger("rename.confluence-variable",
{oldName:a,newName:b,details:e.extend(!0,{},details)}))},createDefault:f}},Confluence.VariableManager.defaultVariableManager=Confluence.VariableManager(),Confluence.VariableManager.defaults={textarea:{type:"textarea",rows:5,columns:100},list:{type:"list",options:[]},string:{type:"string"}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-placeholder.js' */
(function(c){"template"===AJS.Meta.get("content-type")&&(Confluence.VariablePlaceHolder={insertPlaceholder:function(b,d){var a;a="$"+b;var e=AJS.Rte.getEditor();AJS.Rte.BookmarkManager.storeBookmark();a={title:a,src:AJS.Meta.get("context-path")+"/plugins/servlet/confluence/placeholder/template-variable?name="+encodeURIComponent(b),"data-variable-name":b,"class":"template-variable",alt:"$"+b};d&&c.extend(a,d);a=c("<img/>").attr(a);e.selection.setNode(a[0])}},AJS.bind("init.rte",function(){c(AJS.Rte.getEditor().getBody()).delegate("img.template-variable",
"dragstart",function(b){b.preventDefault()})}))})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-toolbar.js' */
(function(f){AJS.bind("init.rte",function(){if("template"===AJS.Meta.get("content-type")){var e=Confluence.VariableManager.defaultVariableManager,a=f("#template-menu"),g=a.find(".variables-list");AJS.bind("add.confluence-variable,delete.confluence-variable,rename.confluence-variable",function(){var b=e.getSortedNames(),d=b.length,c="";g.toggleClass("hidden",!d);for(var a=0;a<d;a++)c+=Confluence.Templates.Variables.renderVariableItem({variableName:"$"+b[a],tooltip:AJS.format("Insert the \'\'{0}\'\' field into the page for the template user to fill out.",
b[a])});g.html(c)});a.delegate(".variables-list a","click",function(){var b=f(this).attr("data-variable-name");!e.contains(b)&&e.add(b);Confluence.VariablePlaceHolder.insertPlaceholder(b)});a.delegate(".variables-add","click",function(b){var a=Confluence.Editor.Autocompleter.Manager.getInputDrivenDropdown();AJS.Rte.getEditor().focus();(!a||a.inactive)&&Confluence.Editor.Autocompleter.Manager.shortcutFired("$",!0);b.stopPropagation()});AJS.$(document).bind("showLayer",function(b,d,c){"dropdown"===
d&&c.$.closest(a).length&&c.reset()})}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/tinyMce-autocomplete-settings-variables.js' */
AJS.bind("init.rte",function(){function j(a,b){return{callback:function(e){e.replaceWithSelectedSearchText();!c.contains(a)&&c.add(a);Confluence.VariablePlaceHolder.insertPlaceholder(a,b)},name:AJS.escapeHtml(a),href:"#"}}function k(a,b){return!a&&!b?0:!a?-1:!b?1:a.toLocaleLowerCase().localeCompare(b.toLocaleLowerCase())}if("template"===AJS.Meta.get("content-type")){Confluence.Editor.Autocompleter||(Confluence.Editor.Autocompleter=tinymce.confluence.Autocompleter);var c=Confluence.VariableManager.defaultVariableManager;
Confluence.Editor.Autocompleter.Settings.$={ch:"$",cache:!1,endChars:[],dropDownDelay:0,preventStartNodes:"",dropDownClassName:"autocomplete-variables",selectFirstItem:!0,getHeaderText:function(a,b){return b?"Variable suggestions":"Variable suggestions"},getAdditionalLinks:function(a,b){var e=Confluence.unescapeEntities(b);return c.get(e)||b.length==0?[]:[{className:"dropdown-create-variable",href:"#",callback:function(a){var b=
a.plainText();a.replaceWithSelectedSearchText();!c.contains(b)&&c.add(b);Confluence.VariablePlaceHolder.insertPlaceholder(b,void 0)},name:AJS.format("Create variable \'\'{0}\'\'",b)}]},getDataAndRunCallback:function(a,b,e){var d,h,a=Confluence.unescapeEntities(b),g=c.find(a),f=[],i=[];for(d in g)g.hasOwnProperty(d)&&f.push(d);f.sort(k);a=0;for(h=f.length;a<h;a++){d=f[a];i.push(j(d,g[d]))}e([i],b)},update:function(){}}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/tinyMce-property-panel-variables.js' */
(function(c){AJS.Confluence.PropertyPanel.Variable={name:"variable",canHandleElement:function(c){return c.hasClass("template-variable")},handle:function(e){function j(a){AJS.debug("clicked type: "+a);var b=c("#property-panel");b.find(".panel-buttons").toggleClass("no-inputs","string"===a);b.find(".textarea-section,.list-section,.string-section").addClass("hidden");b.find("."+a+"-section").removeClass("hidden");"textarea"===a?(c("#variable-property-panel-textarea-rows").val(d.rows),c("#variable-property-panel-textarea-columns").val(d.columns)):
"list"===a&&c("#variable-property-panel-list-values").val(d.options.join(","))}function g(a,b,e){return{className:"variable-property-panel-type-item variable-property-panel-type-"+a,text:b,tooltip:e,selected:k===a,click:function(){d.type=a;d=h.createDefault(a);h.add(i,d);c(".variable-property-panel-type-item").removeClass("selected");c(".variable-property-panel-type-"+a).addClass("selected");j(a)}}}function f(a){return k===a?"":" hidden"}if(!("click"!=e.e.type&&"mouseup"!=e.e.type)){var e=e.containerEl,
l=c(e),i,b=[],m={originalHeight:l.height(),anchorIframe:AJS.Rte.getEditorFrame()};i=l.attr("data-variable-name");var h=Confluence.VariableManager.defaultVariableManager,d=h.get(i),k=d&&d.type||"string";b.push(g("string","Text","Single line text input field."));b.push(g("textarea","Multi-line Text","Multi-line text input field."));b.push(g("list",
"List","Drop down list."));b.push(null);b.push({className:"editable textarea-section"+f("textarea"),tooltip:"Number of rows to display for the field.",html:'<input id="variable-property-panel-textarea-rows"/>'});b.push({className:"variable-property-panel-textarea-split textarea-section"+f("textarea"),tooltip:"",html:"<span>x</span>"});b.push({className:"editable textarea-section"+
f("textarea"),tooltip:"Number of columns to display for the field.",html:'<input id="variable-property-panel-textarea-columns"/>'});b.push(null);b.push({className:"editable list-section"+f("list"),tooltip:"Enter each item for the list, separating each with a comma.",html:"<input id=\"variable-property-panel-list-values\" size='50'/>"});AJS.Confluence.PropertyPanel.createFromButtonModel("variable",e,b,m);j(d.type);c("#variable-property-panel-textarea-rows").change(function(){d.rows=
+c(this).val()||Confluence.VariableManager.defaults.textarea.rows});c("#variable-property-panel-textarea-columns").change(function(){d.columns=+c(this).val()||Confluence.VariableManager.defaults.textarea.columns});c("#variable-property-panel-list-values").change(function(){var a,b,e,f=c(this).val().split(",");d.options=[];a=0;for(b=f.length;a<b;a++)(e=c.trim(f[a]))&&d.options.push(e)});c("#variable-property-panel-textarea-rows,#variable-property-panel-textarea-columns,#variable-property-panel-list-values").keypress(function(a){13===
a.which&&c(this).blur()})}}}})(AJS.$);AJS.bind("init.rte",function(){AJS.trigger("add-handler.property-panel",AJS.Confluence.PropertyPanel.Variable)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-resources', location = 'js/variable-marshaller.js' */
(function(c){function q(a){var b=a.attr("data-variable-type");return"textarea"===b?{type:b,rows:+a.attr("data-variable-rows")||h,columns:+a.attr("data-variable-columns")||r}:"list"===b?{type:b,options:a.find("li").map(function(){return c(this).attr("data-variable-option")}).toArray()}:{type:"string"}}function l(){var a=c(AJS.Rte.getEditor().getBody()).find("img[data-variable-name]"),b={};c.map(a,function(a){var e={};c(a).attr("data-variable-raw-xhtml")&&(e={"data-variable-raw-xhtml":!0});b[c(a).attr("data-variable-name")]=
e});return b}if("template"===AJS.Meta.get("content-type")){var h=5,r=100;AJS.bind("init.rte",function(){function a(b){for(var a in b)b.hasOwnProperty(a)&&!e.contains(a)&&(AJS.debug("adding: ",a),e.add(a,b[a]))}var b=AJS.Rte.getEditor(),h=c(b.getBody()),e=Confluence.VariableManager.defaultVariableManager;b.onGetContent.add(function(b,h){var m=c("<div></div>"),n=c("<ul></ul>").attr("data-variable-declarations","true"),d;m.append(n);var o=l();a(o);var p=e.getAll(),k;for(k in p)if(o.hasOwnProperty(k)){var i=
k;d=p[k];var f=void 0,j=void 0,f=d.type,g=AJS.$("<li></li>");g.attr("data-variable-name",i);g.attr("data-variable-type",f);g.text(i);if("textarea"===f)g.attr("data-variable-rows",d.rows),g.attr("data-variable-columns",d.columns);else if("list"===f){f=c("<ul></ul>");i=void 0;for(i in d.options)j=d.options[i],j=c("<li></li>").text(j).attr("data-variable-option",j),f.append(j);g.append(f)}d=g;n.append(d)}h.content=m.html()+h.content});b=h.find("ul[data-variable-declarations]");b.remove();b.find("li[data-variable-name]").each(function(){var a=
c(this);e.add(a.attr("data-variable-name"),q(a))});a(l())})}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-templates:template-editor-variables-template-resources', location = 'js/variable-templates.soy' */
// This file was automatically generated from variable-templates.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Variables == 'undefined') { Confluence.Templates.Variables = {}; }


Confluence.Templates.Variables.renderVariableItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="dropdown-item" data-tooltip="', soy.$$escapeHtml(opt_data.tooltip), '"><a href="#" class="item-link variable-item" title="', soy.$$escapeHtml(opt_data.variableName), '" data-variable-name="', soy.$$escapeHtml(opt_data.variableName), '">', soy.$$escapeHtml(opt_data.variableName), '</a></li>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.status-macro:editor_status', location = 'js/status-editor.js' */
(function(d){var v="macro-placeholder-property-panel-edit-button";var n="status-macro-title first last editable";var r=13;var f=27;var o="status";var q=["Grey","Red","Yellow","Green","Blue"];var k=q[0];var t;var u,m,a;function s(){e();var z=Confluence.MacroParameterSerializer.deserialize(d(u).attr("data-macro-parameters")),A=false,y=false;if(z&&m){A=z.title!==m.title;y=z.colour!==m.colour}return A||y}function e(){if(a){var y=(b(m)==a.val());var z=(a.val()==="");if(y||z){delete m.title}else{m.title=a.val()}}}function p(){if(t&&t.state&&t.state()==="pending"){AJS.log("Macro update already in progress.");return}e();var z={contentId:Confluence.Editor.getContentId(),macro:{name:o,params:m,defaultParameterValue:"",body:""}};t=tinymce.confluence.MacroUtils.insertMacro(z,u);function y(A){AJS.Rte.getEditor().selection.select(A);AJS.Rte.BookmarkManager.storeBookmark();AJS.Rte.getEditor().selection.collapse()}t.done(function(A,B){u=A;y(u)}).fail(function(A){AJS.logError("Failed to load status macro - "+A)})}function b(y){return((y.colour||y.color)||k)}function j(){a=null;return true}function c(y){var z=d("<input/>");z.attr("class",n);z.keyup(function(A){if(A.keyCode===r){AJS.Confluence.PropertyPanel.destroy();return false}return true});z.keydown(function(A){if(A.keyCode===f){return j()}return true});return z}function x(y){a=c(m);a.val(y.find("span.panel-button-text").text());y.replaceWith(a);a.select().focus()}function h(){d.each(q,function(y,A){var z=function(C,B){m.colour=A;AJS.Confluence.PropertyPanel.destroy()};AJS.Confluence.PropertyPanel.Macro.registerButtonHandler(A,z,o)})}function i(y){return y.title||b(y)}function g(y){return{className:n,text:AJS.escapeHtml(y),click:x}}function l(z){for(var y=0;y<z.length;y++){if(z[y].className.indexOf(v)>-1){return z[y]}}return null}function w(y){var z=l(y);var A=function(B){tinymce.confluence.macrobrowser.editMacro(d(B))};z.click=function(){AJS.Confluence.PropertyPanel.destroy();if(!s()){A(u)}else{t.always(A)}}}AJS.Confluence.PropertyPanel.Macro.registerInitHandler(function(A,z,y){u=A;w(z);m=Confluence.MacroParameterSerializer.deserialize(d(u).attr("data-macro-parameters"));a=null;z.splice(1,0,g(i(m)))},"status");h();AJS.bind("destroyed.property-panel",function(y){if(s()){p()}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:editor-autocomplete-mentions', location = 'js/editor_plugin_src.js' */
(function(b){AJS.EventQueue=AJS.EventQueue||[];function c(){AJS.EventQueue.push({name:"confluencementioninsert"});Confluence.Editor.Autocompleter.Manager.shortcutFired("@",true)}function a(d){return d&&d.shiftKey&&!d.ctrlKey&&!d.altKey&&!d.altGraphKey&&!d.metaKey&&d.which===64}tinymce.create("tinymce.plugins.InsertMention",{init:function(d){b("#insertmention-button").click(function(e){e.stopPropagation();e.preventDefault();var f=Confluence.Editor.Autocompleter.Manager.getInputDrivenDropdown();if(!f||f.inactive){tinymce.execCommand("mceFocus",false,d.id);c()}});AJS.bind("editor.text-placeholder.activated",function(g,f){if(f&&f.placeholderType==="mention"){if(a(f.triggerEvent)){tinymce.dom.Event.cancel(f.triggerEvent)}c()}});if(AJS.Rte.Placeholder&&AJS.Rte.Placeholder.addPlaceholderType){AJS.Rte.Placeholder.addPlaceholderType({type:"mention",label:"User mention",tooltip:"Instructional text is replaced with suggested people when a person types."})}},getInfo:function(){return{longname:"Insert Mention",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("insertmention",tinymce.plugins.InsertMention)})(AJS.$);AJS.Rte.BootstrapManager.addTinyMcePluginInit(function(a){a.plugins+=",insertmention"});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-mentions-plugin:editor-autocomplete-mentions', location = 'js/tinyMce-autocomplete-settings-mentions.js' */
AJS.Rte.BootstrapManager.addOnInitCallback(function(){if(!Confluence.Editor.Autocompleter){Confluence.Editor.Autocompleter=tinymce.confluence.Autocompleter}var b=function(e){if(e){return AJS.params.contextPath+"/rest/prototype/1/search.json"}else{if(AJS.Meta.get("remote-user")){return AJS.params.contextPath+"/rest/mentions/1/network.json"}}return null},c=function(g,f){var e={"max-results":g.maxResults||10};if(f){e.query=Confluence.unescapeEntities(f);e.search="user"}return e},a=function(m,f,l,h,g){var k=m.statusMessage;var i;if(k){i=[[{html:m.statusMessage,className:"error"}]]}else{var e=[];i=[e];if(m.result){AJS.$.each(m.result,function(n,p){var o=AJS.$.extend({},p);o.key=o.username;o.linkAlias=o.title;o.title=o.title+" ("+o.username+")";e.push(o)})}i=AJS.REST.convertFromRest(i)}function j(o,n){if(g&&typeof g=="function"){g(i,o,n)}}l(i,f,j)},d=function(g,i,m,f,l,o,j){var e=i(f),k=g.settings.cacheManager,h=k.get(f),n;if(e){n=$.ajax({type:"GET",url:e,data:m(g,f),dataType:"json",global:false,timeout:10000});n.done(function(p){k.put(f,p)});if(h){a(h,f,l,o,j)}else{n.done(function(p){a(p,f,l,o,j)});n.fail(function(q,p){if(p=="timeout"){a({statusMessage:"Timeout",query:f},f,l,o)}})}}else{l([],f)}};Confluence.Editor.Autocompleter.Settings["@"]={ch:"@",endChars:[],dropDownClassName:"autocomplete-mentions",selectFirstItem:true,getHeaderText:function(f,e){if(e){return "User suggestions"}else{return "Mention someone by typing their name..."}},getAdditionalLinks:function(h,f,g){var e=[];g(f,e);return e},getDataAndRunCallback:function(g,e,f){d(g,b,c,e,f,"content",function(h,j,i){if(j!==""&&h.length<2){if(i.length==0){i.push({html:'<span class="no-result">'+"No user found"+"</span>"})}}else{i.length=0}})},update:function(g,e){if(e.restObj){var f=AJS.$.extend(e.restObj,{title:e.restObj.linkAlias});e=Confluence.Link.fromREST(f)}e.insert()}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.keyboardshortcuts:confluence-tinymce-keyboard-shortcuts', location = 'js/tinymce-plugin.js' */
(function(){tinymce.create("tinymce.plugins.KeyboardShortcutsPlugin",{init:function(a){AJS.debug("Init Editor Keyboard shortcuts plugin");for(var b=function(b){return function(){a.execCommand("FormatBlock",!1,b)}},c=1;7>c;c++)a.addCommand("FormatBlock-h"+c,b("h"+c));a.addCommand("FormatBlock-p",b("p"));a.addCommand("FormatBlock-pre",b("pre"));a.addCommand("FormatBlock-blockquote",b("blockquote"));a.addCommand("mceConfShortcutDialog",Confluence.KeyboardShortcuts.openDialog);a.addButton("help",{title:"confluence.conf_shortcuts_help_desc",
cmd:"mceConfShortcutDialog"})},getInfo:function(){return{longname:"Atlassian Editor Keyboard Shortcuts Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("keyboardshortcuts",tinymce.plugins.KeyboardShortcutsPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.web.components:editor-notifications', location = '/includes/js/components/editor-notifications.js' */
AJS.bind("init.rte",function(){var a;AJS.Confluence.EditorNotification={notify:function(b,c){var d=require("aui/flag");void 0!==a&&"true"!==a.getAttribute("aria-hidden")&&a.close();a=d({type:b,body:c,close:"error"===b?"manual":"auto"})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save', location = 'js/reliable-save.js' */
(function(g){AJS.bind("rte.init.ui",function(){function d(){Confluence.Editor.UI.toggleSavebarBusy(!1)}function i(a){if(403===a.status&&(AJS.trigger("rte.safe-save.invalid-xsrf-token"),!e)){var a=AJS.Meta.get("content-id"),b=function(a,b){e=!0;a?(Confluence.Editor.addErrorMessage(f,"There was an error processing the request."),AJS.logError(a)):(AJS.debug("xsrf token updated"),g("input[name=atl_token]",c).val(b),AJS.Meta.set("atl-token",b),AJS.trigger("analyticsEvent",{name:"reliable-save-xsrf-token-expired"}),
d(),Confluence.Editor.UI.saveButton.click())},a=Confluence.getContextPath()+"/rest/tinymce/1/content/"+a+".json",a=g.ajax({url:a,cache:!1});a.success(function(a){b(null,a.atlToken)});a.error(function(){b("error accessing the rest endpoint")});return}e=!1;AJS.trigger("rte.safe-save.error");Confluence.Editor.addErrorMessage(f,"Unable to communicate with server. Saving is not possible at the moment.");Confluence.Editor.heartbeatType.recovery();d()}function j(){return Confluence.Editor.UI.isFormEnabled()}if(AJS.DarkFeatures.isEnabled("editor.ajax.save")){var f=
"rte_safe_save_offline_error_container";Confluence.Editor=Confluence.Editor||{};Confluence.Editor.SafeSave=Confluence.Editor.SafeSave||{};Confluence.Editor.SafeSave._internal=Confluence.Editor.SafeSave._internal||{};Confluence.Editor.SafeSave._internal.onSuccessfulResponse=function(a){AJS.trigger("rte.safe-save.success",a);(a=a.redirectUrl)?window.location=0!=a.indexOf("/")?a:AJS.params.contextPath+a:AJS.logError("expected redirectUrl field not found in response")};var e=!1,c=g("form.editor");if(c.length){var b=
c.attr("action"),b=b.replace("docreatepage.action","docreatepage_ajax.action"),b=b.replace("doeditpage.action","doeditpage_ajax.action"),b=b.replace("docreateblogpost.action","docreateblogpost_ajax.action"),b=b.replace("doeditblogpost.action","doeditblogpost_ajax.action");if(-1==b.indexOf("_ajax"))AJS.logError("no ajaxified action found on safe-save plugin");else{c.attr("action",b);c.ajaxForm({beforeSubmit:j,error:i,success:function(a){e=!1;Confluence.Editor.heartbeatType.normal();if(a.actionErrors){a=
a.actionErrors;AJS.trigger("rte.safe-save.invalid",a);for(var b=0;b<a.length;b++)Confluence.Editor.addErrorMessage("validation",a[b]);d()}else Confluence.Editor.SafeSave._internal.onSuccessfulResponse(a)}});AJS.debug("reliable save ready!");var h=!1;AJS.bind("rte.heartbeat-error",function(){AJS.debug("reliable-save: heartbeat - error");Confluence.Editor.addErrorMessage(f,"Unable to communicate with server. Saving is not possible at the moment.");h=!0;Confluence.Editor.UI.toggleSavebarBusy(!0)});AJS.bind("rte.heartbeat",function(){h&&
(AJS.debug("reliable-save: heartbeat - back to business!"),AJS.$("#"+f).fadeOut().remove(),h=!1,d())})}}}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.reliablesave:reliable-save', location = 'js/ajax-login.js' */
AJS.toInit(function(f){function t(j,e){var a=o.call(f,j,e),h=j&&j.url;if(p&&(!e||e&&!e.preventAjaxLogin)&&h&&(i&&0===h.indexOf(i)||q&&0===h.indexOf(q))){var s=function(a,u,v,h){function i(){b.readyState=a.readyState;b.status=a.status;b.statusText=a.statusText;a.responseXML?b.responseXML=a.responseXML:b.responseText=a.responseText;u.apply(v,h)}var l=a.getResponseHeader("X-AUSERNAME");p===l?i():(k.push({deferred:d,url:j,settings:e,defaultCallback:i}),m||(n=!1,g||(g=new AJS.Dialog(840,700),g.addPanel("ajax-login",
"ajax-login-content","ajax-login-panel",1),l=f(".ajax-login-panel"),c=f("<iframe></iframe>"),c.bind("load",function(){var a=c[0].contentDocument.location.pathname;a&&0<=a.indexOf("/"+r)&&(m=!1,n=!0,g.hide(),c.attr("src","about:blank"))}),l.append(c),f(document).bind("hideLayer",function(a,b,d){if("popup"===b&&d===g.popup){AJS.debug("hiding login dialog");if(n){a=k;b=0;for(d=a.length;b<d;b++){var c=a[b];AJS.debug("Rerunning ajax query to: "+c.url,c);o.call(f,c.url,c.settings).done(function(){AJS.debug("Rerunning done");
c.deferred.resolve(arguments)}).fail(function(){AJS.debug("Rerunning failed");c.deferred.reject(arguments)})}}else{a=k;b=0;for(d=a.length;b<d;b++){var e=a[b];AJS.debug("Executing with original response for: "+e.url,e);e.defaultCallback&&e.defaultCallback()}}k=[]}})),c.attr("src",w),g.show(),m=!0))};AJS.debug("Using authenticatingPromise");var b={abort:function(){a.abort.apply(a,arguments)},getAllResponseHeaders:function(){a.getAllResponseHeaders.apply(a,arguments)},getResponseHeader:function(){a.getResponseHeader.apply(a,
arguments)},overrideMimeType:function(){a.overrideMimeType.apply(a,arguments)},readyState:a.readyState,setRequestHeader:function(b,c){a.setRequestHeader.apply(a,arguments)},state:function(){a.state.apply(a,arguments)},status:a.status,statusCode:function(){a.statusCode.apply(a,arguments)},statusText:a.statusText},d=f.Deferred();d.promise(b);b.success=b.done;b.error=b.fail;a.done(function(a,b,c){s(c,d.resolve,d,arguments)});a.fail(function(a,b,c){s(a,d.reject,d,arguments)});return b}return a}if(AJS.DarkFeatures.isEnabled("ajax.login")){AJS.debug("AJAX login support enabled");
var m=!1,g,c,n,k=[],o=f.ajax,p=AJS.Meta.get("remote-user"),i=AJS.Meta.get("base-url"),q=AJS.Meta.get("context-path"),r="ajaxlogincomplete.action",w=AJS.Meta.get("context-path")+"/login.action?os_destination=%2F"+r;f.ajax=t}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/vendor/jquery.stickytableheaders.js' */
/*! Modified by Atlassian | Copyright (c) 2011 by Jonas Mosbech - https://github.com/jmosbech/StickyTableHeaders
	MIT license info: https://github.com/jmosbech/StickyTableHeaders/blob/master/license.txt */

;(function ($, window, undefined) {
	'use strict';

	var name = 'stickyTableHeaders',
		id = 0,
		defaults = {
			fixedOffset: 0,
			leftOffset: 0,
			marginTop: 0,
			objDocument: document,
			objHead: 'head',
			objWindow: window,
			scrollableArea: window,
			cacheHeaderHeight: false
		};

	function Plugin (el, options) {
		// To avoid scope issues, use 'base' instead of 'this'
		// to reference this class from internal events and functions.
		var base = this;

		// Access to jQuery and DOM versions of element
		base.$el = $(el);
		base.el = el;
		base.id = id++;

		// Listen for destroyed, call teardown
		base.$el.bind('destroyed',
			$.proxy(base.teardown, base));

		// Cache DOM refs for performance reasons
		base.$clonedHeader = null;
		base.$originalHeader = null;

		// Cache header height for performance reasons
		base.cachedHeaderHeight = null;

		// Keep track of state
		base.isSticky = false;
		base.hasBeenSticky = false;
		base.leftOffset = null;
		base.topOffset = null;

		base.init = function () {
			base.setOptions(options);

			base.$el.each(function () {
				var $this = $(this);

				// remove padding on <table> to fix issue #7
				$this.css('padding', 0);

				base.$originalHeader = $('thead:first', this);
				base.$clonedHeader = base.$originalHeader.clone();
				$this.trigger('clonedHeader.' + name, [base.$clonedHeader]);

				base.$clonedHeader.addClass('tableFloatingHeader');
				base.$clonedHeader.css('display', 'none');

				base.$originalHeader.addClass('tableFloatingHeaderOriginal');

				base.$originalHeader.after(base.$clonedHeader);

				base.$printStyle = $('<style type="text/css" media="print">' +
					'.tableFloatingHeader{display:none !important;}' +
					'.tableFloatingHeaderOriginal{position:static !important;}' +
					'</style>');
				base.$head.append(base.$printStyle);
			});

			base.updateWidth();
			base.toggleHeaders();
			base.bind();
		};

		base.destroy = function (){
			base.$el.unbind('destroyed', base.teardown);
			base.teardown();
		};

		base.teardown = function(){
			if (base.isSticky) {
				base.$originalHeader.css('position', 'static');
			}
			$.removeData(base.el, 'plugin_' + name);
			base.unbind();

			base.$clonedHeader.remove();
			base.$originalHeader.removeClass('tableFloatingHeaderOriginal');
			base.$originalHeader.css('visibility', 'visible');
			base.$printStyle.remove();

			base.el = null;
			base.$el = null;
		};

		base.bind = function(){
			base.$scrollableArea.on('scroll.' + name, base.toggleHeaders);
			if (!base.isWindowScrolling) {
				base.$window.on('scroll.' + name + base.id, base.setPositionValues);
				base.$window.on('resize.' + name + base.id, base.toggleHeaders);
			}
			base.$scrollableArea.on('resize.' + name, base.toggleHeaders);
			base.$scrollableArea.on('resize.' + name, base.updateWidth);
		};

		base.unbind = function(){
			// unbind window events by specifying handle so we don't remove too much
			base.$scrollableArea.off('.' + name, base.toggleHeaders);
			if (!base.isWindowScrolling) {
				base.$window.off('.' + name + base.id, base.setPositionValues);
				base.$window.off('.' + name + base.id, base.toggleHeaders);
			}
			base.$scrollableArea.off('.' + name, base.updateWidth);
		};

		// We debounce the functions bound to the scroll and resize events
		base.debounce = function (fn, delay) {
			var timer = null;
			return function () {
				var context = this, args = arguments;
				clearTimeout(timer);
				timer = setTimeout(function () {
					fn.apply(context, args);
				}, delay);
			};
		};

		base.toggleHeaders = base.debounce(function () {
			if (base.$el) {
				base.$el.each(function () {
					var $this = $(this),
						newLeft,
						newTopOffset = base.isWindowScrolling ? (
									isNaN(base.options.fixedOffset) ?
									base.options.fixedOffset.outerHeight() :
									base.options.fixedOffset
								) :
								base.$scrollableArea.offset().top + (!isNaN(base.options.fixedOffset) ? base.options.fixedOffset : 0),
						offset = $this.offset(),

						scrollTop = base.$scrollableArea.scrollTop() + newTopOffset,
						scrollLeft = base.$scrollableArea.scrollLeft(),

						headerHeight = base.options.cacheHeaderHeight ? base.cachedHeaderHeight : base.$clonedHeader.height(),

						scrolledPastTop = base.isWindowScrolling ?
								scrollTop > offset.top :
								newTopOffset > offset.top,
						notScrolledPastBottom = (base.isWindowScrolling ? scrollTop : 0) <
								(offset.top + $this.height() - headerHeight - (base.isWindowScrolling ? 0 : newTopOffset));

					if (scrolledPastTop && notScrolledPastBottom) {
						newLeft = offset.left - scrollLeft + base.options.leftOffset;
						base.$originalHeader.css({
							'position': 'fixed',
							'margin-top': base.options.marginTop,
							'left': newLeft,
							'z-index': 3 // #18: opacity bug
						});
						base.leftOffset = newLeft;
						base.topOffset = newTopOffset;
						base.$clonedHeader.css('display', '');
						if (!base.isSticky) {
							base.isSticky = true;
							// make sure the width is correct: the user might have resized the browser while in static mode
							base.updateWidth();
							$this.trigger('enabledStickiness.' + name);
						}
						base.setPositionValues();
					} else if (base.isSticky) {
						base.$originalHeader.css('position', 'static');
						base.$clonedHeader.css('display', 'none');
						base.isSticky = false;
						base.resetWidth($('td,th', base.$clonedHeader), $('td,th', base.$originalHeader));
						$this.trigger('disabledStickiness.' + name);
					}
				});
			}
		}, 0);

		base.setPositionValues = base.debounce(function () {
			var winScrollTop = base.$window.scrollTop(),
				winScrollLeft = base.$window.scrollLeft();
			if (!base.isSticky ||
					winScrollTop < 0 || winScrollTop + base.$window.height() > base.$document.height() ||
					winScrollLeft < 0 || winScrollLeft + base.$window.width() > base.$document.width()) {
				return;
			}
			base.$originalHeader.css({
				'top': base.topOffset - (base.isWindowScrolling ? 0 : winScrollTop),
				'left': base.leftOffset - (base.isWindowScrolling ? 0 : winScrollLeft)
			});
		}, 0);

		base.updateWidth = base.debounce(function () {
			if (!base.isSticky) {
				return;
			}
			// Copy cell widths from clone
			if (!base.$originalHeaderCells) {
				base.$originalHeaderCells = $('th,td', base.$originalHeader);
			}
			if (!base.$clonedHeaderCells) {
				base.$clonedHeaderCells = $('th,td', base.$clonedHeader);
			}
			var cellWidths = base.getWidth(base.$clonedHeaderCells);
			base.setWidth(cellWidths, base.$clonedHeaderCells, base.$originalHeaderCells);

			// Copy row width from whole table
			base.$originalHeader.css('width', base.$clonedHeader.width());

			// If we're caching the height, we need to update the cached value when the width changes
			if (base.options.cacheHeaderHeight) {
				base.cachedHeaderHeight = base.$clonedHeader.height();
			}
		}, 0);

		base.getWidth = function ($clonedHeaders) {
			var widths = [];
			$clonedHeaders.each(function (index) {
				var width, $this = $(this);

				if ($this.css('box-sizing') === 'border-box') {
					var boundingClientRect = $this[0].getBoundingClientRect();
					if(boundingClientRect.width) {
						width = boundingClientRect.width; // #39: border-box bug
					} else {
						width = boundingClientRect.right - boundingClientRect.left; // ie8 bug: getBoundingClientRect() does not have a width property
					}
				} else {
					var $origTh = $('th', base.$originalHeader);
					if ($origTh.css('border-collapse') === 'collapse') {
						if (window.getComputedStyle) {
							width = parseFloat(window.getComputedStyle(this, null).width);
						} else {
							// ie8 only
							var leftPadding = parseFloat($this.css('padding-left'));
							var rightPadding = parseFloat($this.css('padding-right'));
							// Needs more investigation - this is assuming constant border around this cell and it's neighbours.
							var border = parseFloat($this.css('border-width'));
							width = $this.outerWidth() - leftPadding - rightPadding - border;
						}
					} else {
						width = $this.width();
					}
				}

				widths[index] = width;
			});
			return widths;
		};

		base.setWidth = function (widths, $clonedHeaders, $origHeaders) {
			$clonedHeaders.each(function (index) {
				var width = widths[index];
				$origHeaders.eq(index).css({
					'min-width': width,
					'max-width': width
				});
			});
		};

		base.resetWidth = function ($clonedHeaders, $origHeaders) {
			$clonedHeaders.each(function (index) {
				var $this = $(this);
				$origHeaders.eq(index).css({
					'min-width': $this.css('min-width'),
					'max-width': $this.css('max-width')
				});
			});
		};

		base.setOptions = function (options) {
			base.options = $.extend({}, defaults, options);
			base.$window = $(base.options.objWindow);
			base.$head = $(base.options.objHead);
			base.$document = $(base.options.objDocument);
			base.$scrollableArea = $(base.options.scrollableArea);
			base.isWindowScrolling = base.$scrollableArea[0] === base.$window[0];
		};

		base.updateOptions = function (options) {
			base.setOptions(options);
			// scrollableArea might have changed
			base.unbind();
			base.bind();
			base.updateWidth();
			base.toggleHeaders();
		};

		// Run initializer
		base.init();
	}

	// A plugin wrapper around the constructor,
	// preventing against multiple instantiations
	$.fn[name] = function ( options ) {
		return this.each(function () {
			var instance = $.data(this, 'plugin_' + name);
			if (instance) {
				if (typeof options === 'string') {
					instance[options].apply(instance);
				} else {
					instance.updateOptions(options);
				}
			} else if(options !== 'destroy') {
				$.data(this, 'plugin_' + name, new Plugin( this, options ));
			}
		});
	};

})(jQuery, window);

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/utils.js' */
/**
 * Stickytable headers for confluence
 */
define("sticky-table-headers/utils", [
    "jquery"
], function(
    $
) {
    "use strict";

    /**
     * isNotAlreadyEnabled - is table already enabled
     *
     * @param {JqueryHTMLElement} table jquery table element
     * @return {Boolean}
     */
    var isNotAlreadyEnabled = function($table) {
        return !$table.hasClass("stickyTableHeaders");
    };

    /**
     * isNotNestedTable - is table inside a nested table
     *
     * @param {JqueryHTMLElement} table jquery table element
     * @return {Boolean}
     */
    var isNotNestedTable = function($table) {
        return !$table.parents("table").length > 0;
    };

    /**
     * isTheadTheFirstChild - is thead present as the first element of a table
     *
     * @param {JqueryHTMLElement} table jquery table element
     * @return {Boolean}
     */
    var isTheadTheFirstChild = function($table) {
        return $table.find("> :first-child").is("thead");
    };

    /**
     * hasTheadGotOnlyOneChild - Do we have only a single row inside the thead
     *
     * This will fix problems when people copy tables from the viewpage inside the editor and
     * add extra rows after the header. We should not enable sticky headers on tables that have more than
     * one TR inside the Thead
     *
     * @param {JqueryHTMLElement} table jquery table element
     * @return {Boolean}
     */
    var hasTheadGotOnlyOneChild = function($table) {
        return $table.find("thead").children().length === 1;
    };

    /**
     * isNotInsidePageLayout - is table inside a page layouts
     *
     * @param {JqueryHTMLElement} table jquery table element
     * @return {Boolean}
     */
    var isNotInsidePageLayout = function($table) {
        return !$table.closest(".columnLayout").length > 0;
    };

    /**
     * isNotDocumentationTheme
     *
     * Documentation theme is incompatible with stickyheaders
     *
     * @param {JqueryHTMLElement} table jquery table element
     * @return {Boolean}
     */
    var isNotDocumentationTheme = function() {
        return !$("body").hasClass("theme-documentation");
    };

    /**
     * areAllConfluenceThInTheSameRow - confluenceTh on different rows should be disabled
     *
     * We don't support vertical headers
     *
     * @param {JqueryHTMLElement} table jquery table element
     * @return {Boolean}
     */
    var areAllConfluenceThInTheSameRow = function($table) {
        return $table.find(".confluenceTh").parent().length === 1;
    };

    /**
     * areAllAdjacentCellsConfluenceTh - All cells in the same row needs to be confluenceTh
     *
     * Stickyheaders should only be applied if all cells are headers to avoid scrolling without
     * background problems
     *
     * @param {JqueryHTMLElement} table jquery table element
     * @return {Boolean}
     */
    var areAllAdjacentCellsConfluenceTh = function($table) {
        return $table.find(".confluenceTh").siblings().hasClass("confluenceTh");
    };

    /**
     * isAValidTable - Check if an html table can be used for sticky headers
     *
     * @param {HTMLElement} table HTMLElement
     * @return {Boolean} is a valid table element for stickyheaders
     */
    var isAValidTable = function(table) {
        var $table = $(table);

        return isNotDocumentationTheme() &&
               isNotAlreadyEnabled($table) &&
               isNotInsidePageLayout($table) &&
               isNotNestedTable($table) &&
               isTheadTheFirstChild($table) &&
               hasTheadGotOnlyOneChild($table) &&
               areAllConfluenceThInTheSameRow($table) &&
               areAllAdjacentCellsConfluenceTh($table);
    };

    /**
     * CONFDEV-33100 - The sticky headers library re-renders the sticky header if the window scrolls but not if you scroll
     * inside the table-wrap div, which is required for horizontal scrolling
     *
     * @param {JqueryHTMLTableElement} $tables tables to bind the scroll event to
     * @param {JqueryHTMLWindowElement} $win window to trigger the scroll event
     */
    var bindHorizontalScrolling = function($tables, $win) {
        var $window = $win || $(window);

        $tables.closest('.table-wrap').scroll(function() {
            $window.trigger('scroll.stickyTableHeaders');
        });
    };

    /**
     * moveHeaderRowsToTHead - Moves first row confluence th to a thead
     *
     * @param {HTMLTableElement|JqueryHTMLTableElement} table Html table element
     */
    var moveHeaderRowsToTHead = function(table) {
        $(table).each(function() {
            var $thisTable = $(this);
            var hasMergedColumns = $thisTable.find(".confluenceTh[rowspan]").length > 0;
            var $th = $thisTable.find("> :first-child > :first-child .confluenceTh");
            var alredyWrappedOnAThead = $th.length && $th.closest('thead').length > 0;
            var isFirstRow = $th.length && $th.parent().index() === 0;

            // we don't have a thead, so lets create one, but only if the confluenceTh are the first tr
            if (isNotNestedTable($thisTable) && isNotInsidePageLayout($thisTable) && !alredyWrappedOnAThead && isFirstRow && !hasMergedColumns) {
                // move to a thead
                var $headerElement = $("<thead />").append($th.parent());

                $thisTable.prepend($headerElement);
            }
        });
    };

    return {
        isAValidTable: isAValidTable,
        bindHorizontalScrolling: bindHorizontalScrolling,
        moveHeaderRowsToTHead: moveHeaderRowsToTHead,
        isNotDocumentationTheme: isNotDocumentationTheme
    };
});

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/viewpage.js' */
/**
 * Stickytable headers for confluence
 */
define("sticky-table-headers/viewpage", [
    "jquery",
    "sticky-table-headers/utils"
], function(
    $,
    Utils
) {
    "use strict";

    /**
     * setupTable - Enable sticky tables for a group of table elements
     *
     * @param {HTMLElement|JqueryHtmlElement} table Setup stickyheaders for tables with a defined parameter for valid tables
     * @param {Object} options StickyTableHeaders jquery plugin options
     */
    var setupTable = function(table, options) {
        // setup stalky table headers
        var $validTables = $(table).filter(function() {
            return Utils.isAValidTable(this);
        });

        $validTables.stickyTableHeaders(options).addClass('stickyTableHeaders');

        Utils.bindHorizontalScrolling($validTables);
    };

    /**
     * initialize stickyheaders for all confluence tables
     *
     */
    var initialize = function() {
        var $table = $(".confluenceTable");
        var $win = $(window);

        // We need to abort ASAP if we're in the documentation space
        if (!Utils.isNotDocumentationTheme()) {
            return;
        }

        // the editor structure by default does not have a thead
        Utils.moveHeaderRowsToTHead($table);

        // We use mutation observer in order to trigger resizing
        if (window.MutationObserver) {

            // we need to listen to all outer container that could cause reflow
            var target = document.querySelector("#page");

            // we need to exclude stickyheaders own mutations
            var stickyHeadersMutationTarget = /sticky|tableFloating|confluenceTh/;

            // listen for changes in order to make sure tableHeaders are repositioned upon reflow
            var observer = new MutationObserver(
                $.debounce(function(mutations) {
                    var validtriggerFlag = false;
                    var className;

                    for(var i=0, len=mutations.length; i<len; i++) {
                        className=mutations[i].target.className;

                        if (!stickyHeadersMutationTarget.test(className)) {
                            validtriggerFlag = true;
                            break;
                        }
                    }

                    if (validtriggerFlag) {
                        $win.trigger('resize.stickyTableHeaders');
                    }
                }, 0)
            );

            // start observing
            observer.observe(target, {
                subtree: true,
                attributes: true,
                childList: true
            });
        }

        // enable all confluence tables
        setupTable($table, {
            cacheHeaderHeight: true
        });
    };

    return {
        initialize: initialize,
        setupTable: setupTable
    };
});

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/lib/editor.js' */
/**
 * Stickytable headers for confluence
 */
define("sticky-table-headers/editor", [
    "ajs",
    "jquery",
    "sticky-table-headers/utils",
], function(
    AJS,
    $,
    Utils
) {
    "use strict";

    /**
     * getDefaultConfig - Get default configuration to enable sticky headers in the editor
     *
     * @param {TinymceActiveEditor} editor tinymce active editor instance
     * @return {Object} default configuration for sticky headers to work on the editor
     */
    var getDefaultConfig = function(editor) {
        var defaults = {};
        defaults.objWindow = $(editor.getWin());
        defaults.scrollableArea = defaults.objWindow;
        defaults.objDocument = $(editor.getDoc());
        defaults.objHead = defaults.objDocument.find('head');

        return defaults;
    };

    /**
     * setupTable - Enable sticky tables for a group of table elements
     *
     * @param {HTMLElement|JqueryHtmlElement} table Setup stickyheaders for tables with a defined parameter for valid tables
     * @param {Object} options StickyTableHeaders jquery plugin options
     */
    var setupTable = function(table, options) {
        var editor = AJS.Rte.getEditor();

        if (editor) {
            var defaults = getDefaultConfig(editor);
            var settings = $.extend({}, defaults, options);
            var $validTables = $(table).filter(function() {
                return Utils.isAValidTable(this);
            });

            $validTables.stickyTableHeaders(settings).addClass('stickyTableHeaders');

            Utils.bindHorizontalScrolling($validTables, settings.objWindow);
        }
    };

    /**
     * initialize stickyheaders for all confluence tables
     *
     */
    var initialize = function() {
        var editor = AJS.Rte.getEditor();

        if (editor) {
            var $table = $(editor.getBody()).find(".confluenceTable");

            // the editor structure by default does not have a thead
            Utils.moveHeaderRowsToTHead($table);

            // enable all confluence tables
            setupTable($table);
        }
    };

    return {
        initialize: initialize,
        setupTable: setupTable
    };
});

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.sticky-table-headers:stickytableheaders-resources', location = '/js/stickytableheaders.js' */
/**
 * Stickytable headers for confluence
 *
 * Adds stalking headers for viewpage and editor dependeds on a modified version of stalky headers
 * that allow extra options to be passed
 */
define("sticky-table-headers", [
    "ajs",
    "sticky-table-headers/viewpage",
    "sticky-table-headers/editor"
], function(
    AJS,
    StickyViewpage,
    StickyEditor
) {
    "use strict";

    return {
        initialize: function() {
            if (!AJS.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers.disabled")) {
                // auto initialize for the viewpage
                AJS.toInit(StickyViewpage.initialize);
            }

            if (AJS.DarkFeatures.isEnabled("confluence-table-enhancements.sticky-headers-editor")) {
                // auto initialize for the editor
                AJS.bind("rte-ready", StickyEditor.initialize);

                // this is to make stickyheaders works with quick-edit
                AJS.bind("rte-quick-edit-push-state", StickyEditor.initialize);
                AJS.bind("rte-quick-edit-push-hash", StickyEditor.initialize);
            }
        }
    };
});

// auto start
require("sticky-table-headers").initialize();

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.image.effects.ImageEffectsPlugin:propertiespanel', location = 'com/atlassian/confluence/image/effects/property-panel.js' */
AJS.toInit(function(e){var p,i=/(\?|\&)(effects\=[^&]+)($|&)/,t=/(^|\&)(effects\=([^&]+))($|&)/,s=null,j=[],h=2000;q();if(Confluence.Editor.ImageProps){f()}else{l()}function f(){AJS.bind("dialog-created.image-properties",function(x,y){p=y.img;var z="image-effects",w="image-effects-panel";if(!a()){Confluence.Editor.ImageProps.registerPanel(z,c("Image effects can\'t be applied to web images"),w,null)}else{if(!n()){Confluence.Editor.ImageProps.registerPanel(z,c("The image\'s pixel count is too large to apply effects."),w,null)}else{Confluence.Editor.ImageProps.registerPanel("image-effects",c(),"image-effects-panel",r)}}});AJS.bind("dialog-before-show.image-properties",function(){b();o(m(e(p)))})}function l(){var w=new AJS.Dialog({width:600,height:500,id:"image-effects-dialog"});w.addHeader("Add Image Effect");w.addPanel("",c(),"");b();w.addSubmit("Save",function(){var x=v();x.done(function(){w.hide()})});w.addCancel("Close",function(){w.hide()});AJS.Confluence.PropertyPanel.Image.pluginButtons.push(null,{create:function(x){p=x[0];var z=m(x),y=!a();return{className:"image-effects",text:"Effects...",tooltip:y?"Image effects can\'t be applied to web images":"Add an image effect like drop shadow or picture frame",click:function(){if(!n()){alert("The image\'s pixel count is too large to apply effects.");return false}o(m(e(p)));AJS.Confluence.PropertyPanel.destroy();w.show()},disabled:y,selected:!!z}}})}function g(y,A){var B=y.attr("src");var x=i.exec(B);var w=A?"effects="+A:"";if(x){B=B.replace(x[2],w)}else{if(A){B=B+(B.indexOf("?")!=-1?"&":"?")+w}}y.attr("src",B);y.attr("data-mce-src",B);var z=y.attr("confluence-query-params");if(z){var x=t.exec(z);if(x){z=z.replace(x[2],w)}else{z=z+"&"+w}}else{z=w}y.attr("confluence-query-params",z)}function m(x){var y=x.attr("confluence-query-params");var w=t.exec(y);if(w){return w[3]}}function o(w){e(".image-effect-preview.selected").removeClass("selected");if(w){e(j).each(function(x,y){if(y.effects==w){e(e(".image-effect-preview")[x]).addClass("selected");return false}})}else{e(".image-effect-preview.image-effect-none").addClass("selected")}s=w}function q(){j.push({name:"None",effects:null});j.push({name:"Taped",effects:"border-simple,blur-border,tape"});j.push({name:"Instant Camera",effects:"border-polaroid,blur-border"});j.push({name:"Curl Shadow",effects:"border-simple,shadow-kn"});j.push({name:"Snapshot",effects:"border-simple,blur-border"});j.push({name:"Drop Shadow",effects:"drop-shadow"})}function c(w){if(w){return'<div class="aui-message warning"><span class="aui-icon icon-warning"></span>'+w+"</div>"}return'<div class="image-effects"><ul class="image-list"></ul></div>'}function b(){var x=e("div.image-effects ul.image-list");var z=Math.floor(Math.random()*22)+1;for(var y=0;y<j.length;y++){var w=e('<li class="attached-image image-effect-preview'+(!j[y].effects?" image-effect-none":"")+'"><div class="image-container"><img class="thumbnail" src="'+AJS.contextPath()+"/plugins/servlet/imgFilter.png?preview=true&id="+z+"&effects="+j[y].effects+'" title="'+j[y].name+'" style="margin-top: 5px"></div><span class="caption filename" title="'+j[y].name+'">'+j[y].name+"</span></li>");w.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")});x.append(w);var A=j[y];w.click(A,function(B){e(".image-effect-preview.selected").removeClass("selected");e(this).addClass("selected");s=B.data.effects})}}function a(){return !e(p).hasClass("confluence-external-resource")}function n(){return !(p.naturalHeight&&p.naturalWidth&&(p.naturalHeight*p.naturalWidth)>(h*h))}function r(){return u()}function v(){return u(d,k)}function u(w,z){var y=e.Deferred();w&&w();p.onload=A;var x=p.src;g(e(p),s);if(p.src==x){A()}function A(){z&&z();y.resolve();p.onload=null;tinyMCE.activeEditor.undoManager.add()}return y}function d(){var C=dialog.popup.element,x=50,z=x*13/60,D=x*30/60,w=x-D,y=e('<div class="image-properties-loading-blanket"><div class="loading-data"></div></div>').appendTo(C.find(".dialog-page-body")),B=y.find(".loading-data");y.css({width:y.parent().width(),height:C.height()});B.css({marginTop:-x*1.2,marginLeft:-x*1.2});var A={color:"#666",width:z,radius:D,length:w,top:0,left:0,zIndex:0,speed:1.042};B.spin(A)}function k(){var w=dialog.popup.element.find(".image-properties-loading-blanket .loading-data");w.css({marginTop:"",marginLeft:""});w.spinStop();w.closest(".image-properties-loading-blanket").remove()}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-browser-metrics:editor', location = '/js/editor.js' */
require(["internal/browser-metrics","jquery"],function(b,c){function a(){var e=AJS.Meta.get("content-type");var d=AJS.Meta.getBoolean("new-page")?"create":"edit";if(e&&d){b.start({key:"confluence."+e+"."+d+".view",ready:".active-richtext",isInitial:true})}}c(a)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:soy-resources', location = 'soy/image-attributes-panel.soy' */
// This file was automatically generated from image-attributes-panel.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Editor == 'undefined') { Confluence.Templates.Editor = {}; }
if (typeof Confluence.Templates.Editor.ImageAttributes == 'undefined') { Confluence.Templates.Editor.ImageAttributes = {}; }


Confluence.Templates.Editor.ImageAttributes.content = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="aui" onsubmit="return false;"><div class="field-group"><label for="image-title-attribute">', soy.$$escapeHtml("Title text"), '</label><input class="text" type="text" id="image-title-attribute" name="image-title-attribute" value="', (opt_data.imgTitle) ? soy.$$escapeHtml(opt_data.imgTitle) : '', '"><div class="description">', soy.$$escapeHtml("Appears when the cursor hovers over the image"), '</div></div><div class="field-group"><label for="image-alt-attribute">', soy.$$escapeHtml("Alt text"), '</label><input class="text" type="text" id="image-alt-attribute" name="image-alt-attribute" value="', (opt_data.imgAlt) ? soy.$$escapeHtml(opt_data.imgAlt) : '', '"><div class="description">', soy.$$escapeHtml("Used by screen readers and when the image cannot be shown"), '</div></div></form>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-image-attributes:image-attributes', location = 'js/image-attributes-panel.js' */
AJS.toInit(function(g){function h(){var a=c.val();d.attr({"data-element-title":a,title:i(d.attr("data-location"),a),alt:e.val()})}function i(a,b){return a&&0<a.length&&b&&0<b.length?a+" ("+b+")":a&&0<a.length?a:b&&0<b.length?"("+b+")":""}AJS.bind("dialog-created.image-properties",function(a,b){d=g(b.img);var f=g(Confluence.Templates.Editor.ImageAttributes.content({imgTitle:d.attr("data-element-title"),imgAlt:d.attr("alt")}));c=f.find("#image-title-attribute");e=f.find("#image-alt-attribute");c.val()===
e.val()&&(c.bind("input.chained",function(){e.val(c.val())}),e.on("change",function(){c.unbind("input.chained")}));Confluence.Editor.ImageProps.registerPanel(j,f,k,h)});var j="image-attributes",k="image-attributes-panel",d,c,e});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.ext.newcode-macro-plugin:editor-scripts', location = 'scripts/paste-cleanup.js' */
AJS.$(document).bind("postPaste",function(b,a,c){AJS.$(c.node).find('span[class|="code"]').contents().unwrap();AJS.$(c.node).find('pre[class|="code"]').each(function(d,f){f.className=f.className.replace(/\bcode-.[^\s]*\b/gi,"")})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-helper.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.Helper={getPosXOnMonthTimeline:function(g,e){var j=moment(g.startDate).startOf("month");var f=moment(e).startOf("month");var d=c.DateUtilities.getNumberOfMonths(j,f);var i=d*Roadmap.MONTH_WIDTH;var h=c.DateUtilities.getMilisecondsFromStartMonth(e)*Roadmap.MONTH_WIDTH/c.DateUtilities.getMilisecondsInMonth(e);return Math.round(i+h)},getPosXOnWeekTimeline:function(g,d){var e=moment(g.startDate).startOf("isoWeek");var f=moment(d).diff(e,"weeks",true);var h=f*Roadmap.WEEK_WIDTH;return Math.round(h)},getWidthTimeline:function(f,e){var d=e.duration;if(f.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){d*=Roadmap.MONTH_WIDTH}else{d*=Roadmap.WEEK_WIDTH}return d<Roadmap.EXTRA_SPACE_AROUND?0:Math.round(d-Roadmap.EXTRA_SPACE_AROUND)},getMonthStartDateByPosition:function(i,h){var d=Math.floor(h/Roadmap.MONTH_WIDTH);var g=moment(i.startDate).startOf("month");var e=g.add(d,"months").toDate();var f=Math.abs(h)%Roadmap.MONTH_WIDTH;if(f!==0&&d<0){f=Roadmap.MONTH_WIDTH-f}var j=c.DateUtilities.getMilisecondsInMonth(e)*f/Roadmap.MONTH_WIDTH;return new Date(e.getTime()+j)},getWeekStartDateByPosition:function(f,e){var h=moment(f.startDate).startOf("isoWeek");var d=e/Roadmap.WEEK_WIDTH;var g=d*c.DateUtilities.MILLISECONDS_A_WEEK;return new Date(h.valueOf()+g)},guid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(f){var e=Math.random()*16|0,d=f=="x"?e:(e&3|8);return d.toString(16)})}};c.ColorHelper={resetColorCounts:function(){a.each(Roadmap.COLORS,function(d){d.count=0})},findColor:function(d){return a.find(Roadmap.COLORS,function(e){return e.lane===d.lane})},adjustColorCount:function(e,f){var d=c.ColorHelper.findColor(e);if(d){d.count=d.count+f}},getColor:function(){return a.min(Roadmap.COLORS,function(d){return d.count})}}}(AJS.$,window._));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-utilities-resources', location = 'utils/roadmap-utilities.js' */
(function(b,a){var c=Confluence.Roadmap=Confluence.Roadmap||{};c.DateUtilities={MILLISECONDS_A_DAY:86400000,MILLISECONDS_A_WEEK:604800000,parseDate:function(e){var d=moment(e,Roadmap.SHORT_DATE_FORMAT,true);if(d.isValid()){return d}d=moment(e,Roadmap.TWO_YY_SHORT_DATE_FORMAT,true);return d.isValid()?d:null},getDateStringFromDate:function(e,d){if(d){return moment(e).format(d)}return moment(e).format(Roadmap.DATE_FORMAT)},getDateFromDateString:function(e,d){return moment(e,d||Roadmap.DATE_FORMAT).toDate()},getNumberOfMonths:function(e,d){var g=moment(e),f=moment(d);return f.diff(g,"months")},getMilisecondsInMonth:function(d){return moment(d).daysInMonth()*c.DateUtilities.MILLISECONDS_A_DAY},getMilisecondsFromStartMonth:function(d){return d.getTime()-moment(d).startOf("month").valueOf()},calculateDurationInformation:function(d){var g=c.DateUtilities.getMilisecondsInMonth(d.toDate());var e=c.DateUtilities.getMilisecondsFromStartMonth(d.toDate());var f=g-e;return{totalMillisOfMonth:g,millisFromStartMonth:e,millisRemainingOfMonth:f,durationOfMonth:e/g,remainingDurationOfMonth:f/g}},convertToWeekDuration:function(e,g){var l=moment(e);var j=l.clone();var m=c.DateUtilities.calculateDurationInformation(l);if(g<=m.remainingDurationOfMonth){var f=g*m.totalMillisOfMonth;j=j.add(f,"ms")}else{j=j.add(m.millisRemainingOfMonth,"ms");g=g-m.remainingDurationOfMonth;var h=Math.floor(g);if(h>0){j=j.add(h,"months")}var k=g%1;var i=c.DateUtilities.getMilisecondsInMonth(j.toDate());var d=k*i;j.add(d,"ms")}return j.diff(l,"weeks",true)},convertToMonthDuration:function(e,j){var k=moment(e);var f=j*c.DateUtilities.MILLISECONDS_A_WEEK;var i=k.clone().add(f,"ms");var h=i.get("year")*12+i.get("month");h=h-(k.get("year")*12+k.get("month"));var l=c.DateUtilities.calculateDurationInformation(k);if(h===0){return f/l.totalMillisOfMonth}else{var g=l.remainingDurationOfMonth;var d=c.DateUtilities.calculateDurationInformation(i);g=g+d.durationOfMonth;g=g+(h-1);return g}}};c.FieldUtilities={fixDatePickerFields:function(d){var e=d.find("input[data-aui-dp-uuid]");e.each(function(f,g){var i=b(g),h=i.attr("data-aui-dp-uuid");i.on("click focus",function(){var j=b("[data-aui-dp-popup-uuid="+h+"]");if(AJS.version<="5.4.5"){var k=j.datepicker("option","onSelect");j.datepicker("option","onSelect",function(m,l){k(m,l);i.change()})}j.parents(".aui-inline-dialog").addClass("datepicker-roadmap-patch")})})}}}(AJS.$,window._));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/model.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bar=Backbone.Model.extend({defaults:function(){return{id:Confluence.Roadmap.Helper.guid(),title:"New Bar",description:"",startDate:new Date(),duration:1,rowIndex:0,pageLink:{}}}});Roadmap.Lane=Backbone.Model.extend({defaults:function(){return{title:"New Lane",color:Confluence.Roadmap.ColorHelper.getColor(),bars:[]}},initialize:function(){var a=new Roadmap.Bars(this.get("bars"));this.set("bars",a)},getNumberOfRows:function(){var a=this.get("bars");if(a.length===0){return 0}var b=0;a.each(function(c){b=Math.max(c.get("rowIndex"),b)});return b+1}});Roadmap.Marker=Backbone.Model.extend({defaults:function(){return{title:"Marker"}}});Roadmap.Timeline=Backbone.Model.extend({defaults:function(){return{displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH}},validate:function(a){var d=[];var c=Confluence.Roadmap.DateUtilities.parseDate(a.startDateString);var b=Confluence.Roadmap.DateUtilities.parseDate(a.endDateString);if(!c||!b){d.push({name:"date",message:"Enter dates in yy-mm-dd"})}else{if(c.diff(b)>=0){d.push({name:"endDate",message:"Start date needs to be before the end date"})}else{if(b.diff(c,"years",true)>Roadmap.TIMELINE_YEARS_LIMIT){d.push({name:"endDate",message:AJS.format("You cannot plan more than {0} years ahead.",Roadmap.TIMELINE_YEARS_LIMIT)})}}}return d.length>0?d:false},calculateTimelineColumns:function(){var d=this.get("startDate");var f=this.get("endDate");var c=[];var e;if(this.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){e=moment(d).clone().startOf("month");var b=moment(f).clone().endOf("month");do{c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(e,Roadmap.MONTH_FORMAT),year:e.get("year")});e.add(1,"months")}while(e.diff(b)<0)}else{e=moment(d).clone().startOf("isoWeek");var a=moment(f).clone().endOf("isoWeek");do{c.push({month:Confluence.Roadmap.DateUtilities.getDateStringFromDate(e,Roadmap.WEEK_FORMAT),year:e.get("year")});e.add(1,"weeks")}while(e.diff(a)<0)}this.attributes.displayTimelineColumns=c}});Roadmap.Roadmap=Backbone.Model.extend({defaults:function(){return{title:"Roadmap Planner",lanes:[],markers:[]}},initialize:function(){var a=new Roadmap.Lanes(this.get("lanes"));this.set("lanes",a);var c=new Roadmap.Markers(this.get("markers"));this.set("markers",c);var b=new Roadmap.Timeline(this.get("timeline"));this.set("timeline",b)},parse:function(a){if(!a.timeline){return Roadmap.getDefaultRoadmapData()}return this.fromMacroData(a)},fromMacroData:function(c){var b=c.timeline;b.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(b.endDate);var a=c.lanes;_.each(a,function(e){var f=e.bars;_.each(f,function(g){g.startDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(g.startDate);if(!g.id){g.id=Confluence.Roadmap.Helper.guid()}});e.bars=f});c.lanes=a;var d=c.markers;_.each(d,function(e){e.markerDate=Confluence.Roadmap.DateUtilities.getDateFromDateString(e.markerDate)});c.markers=d;return c},toMacroData:function(){var c=this.toJSON();var b=c.timeline.toJSON();b.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.startDate);b.endDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(b.endDate);delete b.displayTimelineColumns;c.timeline=b;var a=c.lanes.toJSON();_.each(a,function(e){var f=e.bars.toJSON();_.each(f,function(g){g.startDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(g.startDate)});e.bars=f});c.lanes=a;var d=c.markers.toJSON();_.each(d,function(e){e.markerDate=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.markerDate)});c.markers=d;return c},updateDurationUnit:function(a){this.get("lanes").each(function(b){b.get("bars").each(function(c){var d;d=a===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Confluence.Roadmap.DateUtilities.convertToMonthDuration(c.get("startDate"),c.get("duration")):Confluence.Roadmap.DateUtilities.convertToWeekDuration(c.get("startDate"),c.get("duration"));c.attributes.duration=d})})}})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-models', location = '/models/collection.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.Bars=Backbone.Collection.extend({model:Roadmap.Bar});Roadmap.Lanes=Backbone.Collection.extend({model:Roadmap.Lane});Roadmap.Markers=Backbone.Collection.extend({model:Roadmap.Marker})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar-templates.soy' */
// This file was automatically generated from toolbar-templates.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.toolbar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="roadmap-editor-toolbar" class="aui-toolbar2"><div class="aui-toolbar2-inner"><div class="aui-toolbar2-group"><div class="aui-toolbar2-primary">');
  var param4 = new soy.StringBuilder();
  aui.buttons.button({id: 'toolbar-button-add-lane', text: ' ' + soy.$$escapeHtml("Add lane"), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}, param4);
  aui.buttons.button({id: 'toolbar-button-add-bar', text: ' ' + soy.$$escapeHtml("Add bar"), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}, param4);
  aui.buttons.button({id: 'toolbar-button-add-marker', text: ' ' + soy.$$escapeHtml("Add marker"), iconType: 'aui', iconClass: 'aui-icon-small aui-iconfont-add', iconText: 'Add'}, param4);
  aui.buttons.buttons({content: param4.toString()}, output);
  output.append('</div><div class="aui-toolbar2-secondary">');
  Confluence.Templates.Roadmap.timelineOptionsForm(null, output);
  output.append('</div></div></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.timelineOptionsForm = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param36 = new soy.StringBuilder('<fieldset>');
  aui.form.selectField({id: 'timeline-display-options-select', labelContent: soy.$$escapeHtml("View by"), options: [{'text': "Months", 'value': 'MONTH'}, {'text': "Weeks", 'value': 'WEEK'}], extraClasses: 'view-by'}, param36);
  aui.form.textField({id: 'timeline-startdate-input', name: 'startDate', isRequired: true, extraClasses: 'roadmap-toolbar-date start-date aui-date-picker'}, param36);
  param36.append(' - ');
  aui.form.textField({id: 'timeline-enddate-input', name: 'endDate', isRequired: true, extraClasses: 'roadmap-toolbar-date end-date aui-date-picker'}, param36);
  param36.append('<div class="field-group timeline-field-group-error"><div id="roadmap-timeline-error" class="error" /></div></fieldset>');
  aui.form.form({id: 'timeline-options-form', action: '#', content: param36.toString()}, output);
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-toolbar-view-resources', location = 'view/roadmap-editor/toolbar/toolbar.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.ToolbarView=Backbone.View.extend({className:"roadmap-toolbar",events:{"click #toolbar-button-add-bar":"onAddBarClick","click #toolbar-button-add-lane":"onAddLaneClick","click #toolbar-button-add-marker":"onAddMarkerClick","change #timeline-display-options-select":"onTimelineOptionChange"},initialize:function(){a.bindAll(this,"render")},render:function(){b(this.$el).html(Confluence.Templates.Roadmap.toolbar());this._initVariables();this._setupTimelineOptionsForm();return this},onAddBarClick:function(i){i.preventDefault();var d=this.model.get("lanes").at(0);var c=d.get("bars");var g=this.model.get("timeline");var f=this.model.get("timeline").get("startDate");var h=g.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?moment(f).startOf("month"):moment(f).startOf("isoWeek");c.add(new Roadmap.Bar({rowIndex:d.getNumberOfRows(),startDate:h.toDate()}))},onAddLaneClick:function(d){d.preventDefault();var c=this.model.get("lanes");c.add(new Roadmap.Lane())},onAddMarkerClick:function(f){var g=this.model.get("markers");var d=this.model.get("timeline");var h=moment(d.get("startDate"));var c=d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?h.date(15):h.isoWeekday(4);g.add(new Roadmap.Marker({markerDate:c.toDate()}))},onTimelineOptionChange:function(d){var c=this.model.get("timeline");c.set({displayOption:this.$timelineSelect.val()})},_initVariables:function(){this.$timelineForm=this.$el.find("#timeline-options-form");this.$startDateInput=this.$timelineForm.find("#timeline-startdate-input");this.$endDateInput=this.$timelineForm.find("#timeline-enddate-input");this.$timelineSelect=this.$timelineForm.find("#timeline-display-options-select");this.$timelineError=this.$timelineForm.find("#roadmap-timeline-error");this.newTimeline=new Roadmap.Timeline()},_clearTimelineErrors:function(){this.$timelineError.empty()},_showTimelineErrors:function(){var c=this;a.each(c.newTimeline.validationError,function(d){c.$timelineError.append(d.message)})},_applyNewTimeline:function(){var c=this.model.get("timeline");var e=Confluence.Roadmap.DateUtilities.parseDate(this.$startDateInput.val());var d=Confluence.Roadmap.DateUtilities.parseDate(this.$endDateInput.val());c.set({startDate:e.toDate(),endDate:d.toDate()});this._showTimeLineFormat()},_showTimeLineFormat:function(){var c=this.model.get("timeline");this.$startDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.get("startDate"),Roadmap.SHORT_DATE_FORMAT));this.$endDateInput.val(Confluence.Roadmap.DateUtilities.getDateStringFromDate(c.get("endDate"),Roadmap.SHORT_DATE_FORMAT))},_validate:function(){this._clearTimelineErrors();if(this.newTimeline.isValid()){this._applyNewTimeline()}else{this._showTimelineErrors()}},_setupTimelineOptionsForm:function(){var e=this.model.get("timeline");var g=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.get("startDate"),Roadmap.SHORT_DATE_FORMAT),c=Confluence.Roadmap.DateUtilities.getDateStringFromDate(e.get("endDate"),Roadmap.SHORT_DATE_FORMAT);this.$startDateInput.val(g);this.$endDateInput.val(c);this.newTimeline.set({startDateString:g,endDateString:c});this.$timelineSelect.val(e.get("displayOption"));var f={overrideBrowserDefault:true,firstDay:1};this.$startDateInput.datePicker(f);this.$endDateInput.datePicker(f);Confluence.Roadmap.FieldUtilities.fixDatePickerFields(this.$timelineForm);var d=this;this.$startDateInput.on("change",function(){d.newTimeline.set({startDateString:d.$startDateInput.val()});d._validate()});this.$endDateInput.on("change",function(){d.newTimeline.set({endDateString:d.$endDateInput.val()});d._validate()})}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-templates.soy' */
// This file was automatically generated from timeline-templates.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.timeline = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var displayTimelineList3 = opt_data.displayTimelines;
  var displayTimelineListLen3 = displayTimelineList3.length;
  for (var displayTimelineIndex3 = 0; displayTimelineIndex3 < displayTimelineListLen3; displayTimelineIndex3++) {
    var displayTimelineData3 = displayTimelineList3[displayTimelineIndex3];
    output.append('<div class="roadmap-column-title">', (displayTimelineIndex3 == 0 || displayTimelineData3.year != opt_data.displayTimelines[displayTimelineIndex3 - 1].year) ? '<span class="roadmap-column-year">' + soy.$$escapeHtml(displayTimelineData3.year) + '</span><br/>' : '', soy.$$escapeHtml(displayTimelineData3.month), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.timelineColumn = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var iLimit14 = opt_data.numberOfColumns;
  for (var i14 = 0; i14 < iLimit14; i14++) {
    output.append('<div class="roadmap-column-item">&nbsp;</div>');
  }
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};var c={};c.Helper=Confluence.Roadmap.Helper;Roadmap.TimelineView=Backbone.View.extend({className:"roadmap-frame-title",initialize:function(){a.bindAll(this,"render")},render:function(){this.model.calculateTimelineColumns();this.$el.html(Confluence.Templates.Roadmap.timeline({displayTimelines:this.model.get("displayTimelineColumns")}));return this},update:function(){this.render()},getBarPosition:function(d){if(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){return{left:c.Helper.getPosXOnMonthTimeline(this.model.attributes,d.startDate),width:c.Helper.getWidthTimeline(this.model.attributes,d)}}return{left:c.Helper.getPosXOnWeekTimeline(this.model.attributes,d.startDate),width:c.Helper.getWidthTimeline(this.model.attributes,d)}},getBarDuration:function(d){return(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)?(d/Roadmap.MONTH_WIDTH):(d/Roadmap.WEEK_WIDTH)},getBarStartDate:function(d){return(this.model.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH)?c.Helper.getMonthStartDateByPosition(this.model.attributes,d):c.Helper.getWeekStartDateByPosition(this.model.attributes,d)}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-timeline-view-resources', location = 'view/roadmap-editor/timeline/timeline-column.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.TimelineColumnView=Backbone.View.extend({className:"roadmap-frame-content",initialize:function(){a.bindAll(this,"render")},render:function(){var c=this.model.get("displayTimelineColumns").length;this.$el.html(Confluence.Templates.Roadmap.timelineColumn({numberOfColumns:c}));return this},updateHeight:function(c){this.$el.height(c)},update:function(){this.render()},getSizeAndPosition:function(){return{width:this.$el.width(),height:this.$el.height(),left:this.$el.position().left,top:this.$el.position().top}}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/templates.soy' */
// This file was automatically generated from templates.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.Roadmap == 'undefined') { Confluence.Templates.Roadmap = {}; }


Confluence.Templates.Roadmap.roadmapPopupPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id=\'', soy.$$escapeHtml(opt_data.roadmapPopupPanelId), '\'></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.roadmapEditor = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="roadmap-editor-edit-area"><div id="roadmap-editor-edit-content"><!-- START GENERATE ROADMAP --><div id="roadmap-container"><div class="roadmap-drag-area"></div><div class="roadmap-frame"><div class="roadmap-marker"></div></div><div class="roadmap-content"></div></div><!-- END GENERATE ROADMAP --></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.lane = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="roadmap-lane-title" style="background-color: ', soy.$$escapeHtml(opt_data.color.lane), '; color: ', soy.$$escapeHtml(opt_data.color.text), '" title="', soy.$$escapeHtml(opt_data.title), '"><div class="title-outer"><div class="title-inner">', soy.$$escapeHtml(opt_data.title), '</div></div></div><div class="roadmap-separate-content">&nbsp;</div><div class="roadmap-lane-content"></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.marker = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="marker-drag-placeholder" /><div class="marker-title-wrapper"><span class="marker-title" title="', soy.$$escapeHtml(opt_data.title), '">', soy.$$escapeHtml(opt_data.title), '</span></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.bar = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<p class="roadmap-bar-title">', soy.$$escapeHtml(opt_data.title), '</p>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.newRowLine = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<hr class="new-row-line" />');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.deprecationDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<section role="dialog" id="', soy.$$escapeHtml(opt_data.id), '" class="aui-layer aui-dialog2 aui-dialog2-medium" aria-hidden="true"><header class="aui-dialog2-header"><h1 class="aui-dialog2-header-main">', soy.$$escapeHtml("Macro unavailable"), '</h1></header><div class="aui-dialog2-content">', "\x3cp\x3eThe roadmap macro has been deprecated as of version 12. You can still view your existing roadmap macros but you will no longer be able to edit them or create new ones.\x3c/p\x3e\x3cp\x3ePlease use our new Roadmap Planner macro to plan your roadmap.\x3c/p\x3e", '<div class="new-roadmap-thumb"></div></div><footer class="aui-dialog2-footer"><div class="aui-dialog2-footer-actions"><button id="dialog-close-button" class="aui-button aui-button-link">', soy.$$escapeHtml("Close"), '</button></div></footer></section>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.newRowPlaceholder = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<hr class= "new-row-placeholder" />');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.laneDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.buttons.button({id: 'add-bar-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {'title': "Add bar"}, iconClass: 'aui-icon-small aui-iconfont-add'}, output);
  aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {'title': "Rename lane"}, iconClass: 'aui-icon-small aui-iconfont-edit'}, output);
  Confluence.Templates.Roadmap.laneColorSelect(opt_data, output);
  if (opt_data.canDelete) {
    aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {'title': "Delete lane"}, iconClass: 'aui-icon-small delete-icon'}, output);
  }
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.markerDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  aui.buttons.button({id: 'rename-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {'title': "Rename marker"}, iconClass: 'aui-icon-small aui-iconfont-edit'}, output);
  aui.buttons.button({id: 'delete-button', type: 'subtle', iconType: 'aui', extraClasses: 'aui-button-compact', text: '', extraAttributes: {'title': "Delete marker"}, iconClass: 'aui-icon-small delete-icon'}, output);
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.markerRenameDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param92 = new soy.StringBuilder();
  aui.form.input({extraClasses: 'marker-title', name: 'marker-title', type: 'text', value: opt_data.markerTitle}, param92);
  aui.buttons.button({extraClasses: 'rename-button', text: "Save"}, param92);
  aui.form.form({action: '', content: param92.toString()}, output);
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.laneRenameDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var param104 = new soy.StringBuilder();
  aui.form.input({extraClasses: 'lane-title', name: 'lane-title', type: 'text', value: opt_data.laneTitle}, param104);
  aui.buttons.button({extraClasses: 'rename-button', text: "Save"}, param104);
  aui.form.form({action: '', content: param104.toString()}, output);
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.laneColorSelect = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<a id="lane-color-select" href="#" aria-owns="lane-color-picker" aria-haspopup="true" class="aui-button aui-button-subtle aui-button-compact aui-dropdown2-trigger aui-style-default" title="', soy.$$escapeHtml("Lane color"), '"><span class="color-item" style="background-color: ', soy.$$escapeHtml(opt_data.laneColor), ';">&nbsp;</span></a></a><div id="lane-color-picker" class="aui-dropdown2"><ul class="aui-list-truncate">');
  var colorList120 = opt_data.colors;
  var colorListLen120 = colorList120.length;
  for (var colorIndex120 = 0; colorIndex120 < colorListLen120; colorIndex120++) {
    var colorData120 = colorList120[colorIndex120];
    output.append('<li class="color-display-item"><a href="#" ><span class="color-item ', (colorData120.lane == opt_data.laneColor) ? 'aui-icon aui-icon-small aui-iconfont-success' : '', '" style="background-color: ', soy.$$escapeHtml(colorData120.lane), ';"></span></a></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.Roadmap.linkPageTitle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="link-page-title" />');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar.js' */
(function(b,a){Roadmap.BarView=Backbone.View.extend({className:"roadmap-bar",events:{click:"_showDialog",dragstart:"_onDragstart",dragstop:"_onDragStop",dropover:"_onDropOver",dropout:"_onDropOut"},attributes:function(){return{cid:this.cid}},initialize:function(){a.bindAll(this,"render","_updateBar","_beforeResize","updateMaxWidth","_deleteBar","_updateTitle");this._addEvents()},_addEvents:function(){var c=this;this.$el.draggable({opacity:0.3,cursor:"move",appendTo:".roadmap-drag-area",snap:".roadmap-bar-row, .new-bar-row",snapMode:"inner",snapTolerance:17,scroll:true,zIndex:4020,helper:function(){return c.$el.clone().addClass("roadmap-bar-clone").data("View",c)}});this.$el.droppable({accept:".roadmap-bar",tolerance:"touch",hoverClass:"bar-hover-bar"});this.$el.data("View",this)},render:function(){this.updateColor(this.options.color);var c=this.options.timelineView.getBarPosition(this.model.attributes);this.$el.css({left:c.left+"px",width:c.width+"px"});this.$el.attr("title",this.model.get("title"));this.$el.append(Confluence.Templates.Roadmap.bar({title:this.model.get("title")}));this.$el.resizable({handles:"e, w",minWidth:Roadmap.barMinWidth,start:this._beforeResize,stop:this._updateBar});return this},updateMaxWidth:function(d){this.$el.resizable("option","maxWidth",d);var c=this.$el.resizable("option","minWidth");if(d<c){this.$el.resizable("option","minWidth",d)}},_beforeResize:function(d,c){this._barDialog&&this._barDialog.remove();this.trigger("beforeResize",this,this._checkHandleDirection(d))},_checkHandleDirection:function(c){var d=b(c.toElement?c.toElement:c.originalEvent.target);if(d.hasClass("ui-resizable-w")){return"left"}else{if(d.hasClass("ui-resizable-e")){return"right"}}throw"Unsupport resize direction handling = "+d},_updateBar:function(d,c){if(c.originalPosition.left!=c.position.left){this.model.set({startDate:this.options.timelineView.getBarStartDate(c.position.left),duration:this.options.timelineView.getBarDuration(c.element.outerWidth())})}else{if(c.originalSize.width!=c.size.width){this.model.set("duration",this.options.timelineView.getBarDuration(c.element.outerWidth()))}}},appendTo:function(c){this.$el.appendTo(c)},updateColor:function(c){this.$el.css({"background-color":c.bar,"border-color":c.lane,color:c.text})},updatePositionLeft:function(c){this.$el.css("left",c)},_onDragStop:function(d,c){this.options.lane.cleanLaneAfterDrop();this.$el.trigger("BarView.dragstop")},updateDeleteBar:function(c){this.options.deleteBar=c},_showDialog:function(c){if(!b(c.target).is(".ui-resizable-handle")){this._barDialog&&this._barDialog.remove();this._barDialog=this._createDialog();this._barDialog.show();Confluence.Roadmap.Analytics.openBarDialogInEdit()}},_createDialog:function(){return new Roadmap.BarDialogView({trigger:this.$el,model:this.model,timelineWidth:this.options.timelineView.$el.width(),renderOption:{isEditMode:true,editInplace:{title:true,pageLink:true,description:true}},linkPageEditable:true,deleteBar:this._deleteBar,updateTitle:this._updateTitle,updateDescription:this._updateDescription,updatePageLink:this._updatePageLink,createLinkPageCallback:this._goToCreateLinkPage})},_deleteBar:function(){this.options.deleteBar(this)},_updateTitle:function(c){this.model.set("title",c);this.$el.attr("title",c);this.$el.find(".roadmap-bar-title").html(AJS.escapeHtml(c))},_updateDescription:function(c){this.model.set("description",c)},_updatePageLink:function(c){this.model.set("pageLink",c)},_onDragstart:function(d,c){Roadmap.DragDrop.barDraggingOver={};this.$el.trigger("BarView.dragstart",[c])},_onDropOver:function(d,c){Roadmap.DragDrop.barDraggingOver[this.cid]=this.cid;if(Roadmap.DragDrop.barDraggingOver&&c.helper.data("isAddingNewRow")!==true){c.helper.addClass("roadmap-bar-overlapped")}},_onDropOut:function(f,d){var c=this;delete Roadmap.DragDrop.barDraggingOver[c.cid];d.helper.removeClass("roadmap-bar-overlapped");a.each(Roadmap.DragDrop.barDraggingOver,function(g){var e=d.helper.data("isAddingNewRow")!==true;if(e){if(typeof g==="string"){d.helper.addClass("roadmap-bar-overlapped")}else{if(g.className==="roadmap-bar-row"){g.$el.addClass("roadmap-bar-drag-hover")}}}})},_goToCreateLinkPage:function(f){f.preventDefault();var e=this.me;var c=parseInt(AJS.Meta.get("page-id"));var d=c>0?c:AJS.Meta.get("parent-page-id");var g={roadmapBarId:e.model.id,roadmapContentId:d,updateRoadmap:false};Confluence.RoadmapLink.addCreateLinkPageListener(g,function(i){var h=e._updatePageLink(i.pageLink);e.fields.$pageLink.html(h)})}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row.js' */
(function(b,a){Roadmap.BarRowView=Backbone.View.extend({className:"roadmap-bar-row",initialize:function(){a.bindAll(this,"_addEvents");this._addEvents();return this},attributes:function(){return{cid:this.cid}},_addEvents:function(){var c=this;this.$el.droppable({greedy:true,tolerance:"pointer",hoverClass:"roadmap-bar-drag-hover",activeClass:"roadmap-bar-drag-active",accept:".roadmap-bar",over:function(f,d){Roadmap.DragDrop.barDraggingOver[c.cid]=c;if(d.helper.data("isAddingNewRow")!==true){var g=b(this);g.closest(".roadmap-content").find(".new-row-placeholder").remove()}else{c.$el.removeClass("roadmap-bar-drag-hover")}},out:function(){var d=b(this);delete Roadmap.DragDrop.barDraggingOver[c.cid];d.closest(".roadmap-content").find(".new-row-placeholder").remove()},drop:function(g,f){var d=a.reject(Roadmap.DragDrop.barDraggingOver,function(e){return(typeof e==="object")}).length>0;if(!f.helper.hasClass("roadmap-bar-overlapped")&&!d){b(this).trigger("BarView.drop",[{$barViewHelper:f.helper,$barViewOriginal:f.draggable,$barRow:b(this)},f])}}})},isEmptyRow:function(){return this.$el.is(":empty")}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/bar/bar-row-new.js' */
(function(b,a){Roadmap.BarRowNewView=Backbone.View.extend({className:"new-bar-row",overlayTop:3,margin:5,events:{drop:"_onDrop",dropover:"_onDropOver",dropout:"_onDropOut"},initialize:function(){a.bindAll(this,"render","_addEvent");return this},render:function(){this.$el.append(Confluence.Templates.Roadmap.newRowLine());this._addEvent();this._setSizePosition();return this},_addEvent:function(){this.$el.droppable({accept:".roadmap-bar",tolerance:"pointer",hoverClass:"new-bar-row-hover"})},_setSizePosition:function(){var f=this.options.$barRow;var c=this.options.renderBottom===false?(this.margin*-1):f.height();var e=f.index()===0;var d=(e)?this.overlayTop+this.margin:this.overlayTop;this.$el.css({top:f.position().top+c-d,width:f.width()})},_onDrop:function(d,c){this.$el.trigger("BarView.drop",[{barRowNewView:this},c])},_onDropOver:function(d,c){this.$el.trigger("BarRowNew.dropover",[this,c])},_onDropOut:function(d,c){this.$el.trigger("BarRowNew.dropout",[this,c])}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.LaneDialogView=b.extend({events:{"click #delete-button":"_onDeleteClick","click #rename-button":"_onRenameClick","click #add-bar-button":"_onAddBarClick"},initialize:function(){a.bindAll(this,"_onHide");this.options.dialogOptions={width:this._getDialogWidth(),hideCallback:this._onHide};b.prototype.initialize.call(this,this.options)},_getContent:function(d){var g=this.options.lane.model.get("color").lane;d.html(Confluence.Templates.Roadmap.laneDialog({canDelete:this.options.canDelete,colors:Roadmap.COLORS,laneColor:g}));this.$el.find(".aui-button").tooltip({gravity:"s"});var e=this;var f=this.$el.find("#lane-color-picker .color-item");f.click(function(i){i.preventDefault();var h=Roadmap.COLORS[f.index(this)];if(h.lane!=g){e.options.changeColor(h)}})},_getDialogWidth:function(){var e=29;var f=51;var d=2;if(this.options.canDelete){d++}return d*e+f},_onDeleteClick:function(){this.options.deleteLane();this.remove()},_onRenameClick:function(){if(!this._laneRenameDialog){this._laneRenameDialog=new Roadmap.LaneRenameDialogView({trigger:this.options.trigger,lane:this.options.lane})}this._laneRenameDialog.show();this.hide()},_onAddBarClick:function(){this.options.addBar();this.remove()},_onHide:function(){c("#lane-color-picker").hide();b.prototype._onHide.call(this)}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane-dialog/lane-rename-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.LaneRenameDialogView=b.extend({events:{"click .rename-button":"_onRenameButtonClick","keyup .lane-title":"_onChangeLaneTitle"},initialize:function(){this.options.dialogOptions={width:this._getDialogWidth()};b.prototype.initialize.call(this,this.options)},_getContent:function(d){d.html(Confluence.Templates.Roadmap.laneRenameDialog({laneTitle:this.options.trigger.text()}));this.controls={$renameButton:this.$el.find(".rename-button"),$laneTitle:this.$el.find(".lane-title")}},_getDialogWidth:function(){return 315},_onChangeLaneTitle:function(d){var f=c.trim(this.controls.$laneTitle.val());if(!f){this.controls.$renameButton.disable()}else{this.controls.$renameButton.enable();if(d.which==AJS.$.ui.keyCode.ENTER){this.controls.$renameButton.click()}}},_onShow:function(d){this.controls.$laneTitle.select()},_onRenameButtonClick:function(d){d.preventDefault();this.hide();var e=this.controls.$laneTitle.val();this.options.lane.renameTitle(e)}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.MarkerDialogView=b.extend({events:{"click #rename-button":"_onRenameButtonClick","click #delete-button":"_onDeleteButtonClick"},initialize:function(){this.options.dialogOptions={width:60};b.prototype.initialize.call(this,this.options)},_getContent:function(d){d.html(Confluence.Templates.Roadmap.markerDialog());this.$el.find(".aui-button.aui-button-compact").tooltip({gravity:"s"})},_onRenameButtonClick:function(){if(!this._markerRenameDialog){this._markerRenameDialog=new Roadmap.MarkerRenameDialogView({trigger:this.options.trigger,marker:this.options.marker})}this._markerRenameDialog.show();this.hide()},_onDeleteButtonClick:function(){this.options.marker.removeMarker();this.hide()}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker-dialog/marker-rename-dialog.js' */
(function(c,a){var b=Roadmap.InlineDialogView;Roadmap.MarkerRenameDialogView=b.extend({events:{"click .rename-button":"_onSaveButtonClick","keyup .marker-title":"_onChangeMarkerTitle"},initialize:function(){this.options.dialogOptions={width:315};b.prototype.initialize.call(this,this.options)},_getContent:function(d){d.html(Confluence.Templates.Roadmap.markerRenameDialog({markerTitle:this.options.marker.model.get("title")}));this.controls={$renameButton:this.$el.find(".rename-button"),$title:this.$el.find(".marker-title")}},_onChangeMarkerTitle:function(d){var f=c.trim(this.controls.$title.val());if(!f){this.controls.$renameButton.disable()}else{this.controls.$renameButton.enable();if(d.which==AJS.$.ui.keyCode.ENTER){this.controls.$renameButton.click()}}},_onShow:function(d){this.controls.$title.select()},_onSaveButtonClick:function(d){d.preventDefault();this.hide();this.options.marker.renameTitle(this.controls.$title.val())}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/lane.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.LaneView=Backbone.View.extend({tagName:"div",className:"roadmap-lane",events:{"click .roadmap-lane-title":"_showDialog","BarView.drop":"_onBarDropped","BarRowNew.dropover":"_onBarRowNewDropover","BarRowNew.dropout":"_onBarRowNewDropout"},attributes:function(){return{cid:this.cid}},initialize:function(){a.bindAll(this,"render","renameTitle","updateRowIndex","removeEmptyRow","cleanLaneAfterDrop","_deleteLane","_updateLaneHeight","_renderComplete","_deleteBar","_addBar","_changeColor","addDefaultBarRow");this._barViews=[];this._barRowViews=[];this.listenTo(this.model.get("bars"),"add",function(d){var c=this._newBarRowView();var e=this._newBarView(d);c.$el.append(e.render().$el);this._$laneContent.append(c.$el);this._barViews.push(e);this.$el.trigger("BarView.add",e);a.defer(this._updateLaneHeight)})},render:function(){var c=this;this.$el.append(Confluence.Templates.Roadmap.lane({title:this.model.get("title"),color:this.model.get("color")}));Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),1);var d=this.model.get("bars").models;d=a.sortBy(d,function(e){return e.attributes.rowIndex});a.each(d,function(e){var f=c._newBarView(e);c._barViews.push(f)});this._renderBars();a.defer(this._renderComplete);return this},_renderComplete:function(){this._updateLaneHeight()},renameTitle:function(c){this.model.set("title",c);this.$el.find(".roadmap-lane-title").attr("title",c);this.$el.find(".title-inner").html(AJS.escapeHtml(c));this._updateLaneHeight()},_updateLaneHeight:function(){var d=this.$el.find(".title-inner");d.hide();var c=this._$laneContent.outerHeight();d.width(c-2*Roadmap.LANE_PADDING);d.show()},_barBeforeResize:function(e,k){var l=e.$el;var g=Math.ceil(l.outerWidth()-l.width());var j;if(k=="left"){var f=this._getNearestBarView(e,k);var c=f==null?0:f.position().left+f.width()+g;var d=l.position().left-c;j=l.width()+d}else{var i=this._getNearestBarView(e,k);var h=i==null?this._getLaneContentWidth()-g:i.position().left-g;j=h-l.position().left}e.updateMaxWidth(j-Roadmap.BAR_MARGIN)},_renderBars:function(){var c=this;this._$laneContent=this.$el.find(".roadmap-lane-content");var d={};a.each(this._barViews,function(f){var g="row-"+f.model.get("rowIndex");var e=d[g];if(!e){e=c._newBarRowView(f.model.get("rowIndex"));d[g]=e}e.$el.append(f.render().$el);c._$laneContent.append(e.$el)})},_newBarRowView:function(){var c=new Roadmap.BarRowView();this._barRowViews.push(c);return c},_newBarView:function(c){var d=new Roadmap.BarView({model:c,lane:this,color:this.model.get("color"),timelineView:this.options.timelineView,deleteBar:this._deleteBar});d.on("beforeResize",a.bind(this._barBeforeResize,this));return d},_getNearestBarView:function(d,e){var f=a.filter(d.options.lane._barViews,function(g){return g.model.get("rowIndex")===d.model.get("rowIndex")});var c=null;if(e=="left"){a.each(f,function(g){if(g.$el.position().left<d.$el.position().left&&(c==null||g.$el.position().left>c.$el.position().left)){c=g}})}else{a.each(f,function(g){if(g.$el.position().left>d.$el.position().left&&(c==null||g.$el.position().left<c.$el.position().left)){c=g}})}return c!=null?c.$el:null},_getLaneContentWidth:function(){return this.$el.find(".roadmap-lane-content").width()},_showDialog:function(){this._laneDialog&&this._laneDialog.remove();this._laneDialog=this._createLaneDialog();this._laneDialog.show()},_createLaneDialog:function(){return new Roadmap.LaneDialogView({trigger:this.$el.find(".title-outer"),canDelete:this.options.canDelete,deleteLane:this._deleteLane,addBar:this._addBar,changeColor:this._changeColor,lane:this})},_onBarDropped:function(i,k,l){var n=!!k.barRowNewView;var f=l.draggable.data("View");var m=f.model;var h=f.options.lane;var j=(h.cid===this.cid);var g=this.model.get("bars");var o=l.position.left;var d=this.options.timelineView.getBarStartDate(o);if(j&&g.models.length===1&&n){return}f.updatePositionLeft(o);f.updateColor(this.model.get("color"));m.attributes.startDate=d;if(n){var c=this._newBarRowView();k.barRowNewView.$el.replaceWith(c.$el);f.appendTo(c.$el)}else{f.appendTo(k.$barRow)}l.helper.remove();if(!j){f.options.lane.removeEmptyRow();g._byId[m.id]=m;this._barViews.push(f);f.updateDeleteBar(this._deleteBar);h.model.get("bars").remove(m);g.models.push(m);h._barViews.splice(a.indexOf(h._barViews,f),1);this.updateRowIndex(h.$el);f.options=a.extend(f.options,{color:this.model.get("color"),lane:this});h._updateLaneHeight()}this.removeEmptyRow();this.updateRowIndex(this.$el);this._updateLaneHeight()},updateRowIndex:function(c){c.find(".roadmap-bar-row").each(function(e,d){b(d).find('.roadmap-bar:not(".roadmap-bar-clone")').each(function(h,f){var g=b(f).data("View");if(g){g.model.attributes.rowIndex=e}})})},removeEmptyRow:function(){var c=0;a.each(this._barRowViews,function(d){if(d.isEmptyRow()){d.remove();c++}});return !!c},cleanLaneAfterDrop:function(){this._$laneContent.find(".roadmap-bar-drag-active").removeClass("roadmap-bar-drag-active");this._$laneContent.find(".new-row-placeholder").remove()},_deleteLane:function(){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.$el.trigger("Lane.delete",this)},updateDeleteStatus:function(c){if(this._laneDialog){this._laneDialog.remove();delete this._laneDialog}this.options.canDelete=c},_deleteBar:function(c){this.model.get("bars").remove(c.model);this._barViews.splice(a.indexOf(this._barViews,c),1);c.remove();if(this.removeEmptyRow()){this.updateRowIndex(this.$el);this._updateLaneHeight();this.$el.trigger("BarRowView.remove")}},_addBar:function(){var c=this.model.get("bars");var e=this.options.timelineView.model;var f=moment(e.get("startDate"));var d=e.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?f.startOf("month"):f.startOf("isoWeek");c.add(new Roadmap.Bar({rowIndex:this.model.getNumberOfRows(),startDate:d.toDate()}))},_changeColor:function(c){Confluence.Roadmap.ColorHelper.adjustColorCount(this.model.get("color"),-1);this.model.set("color",c);Confluence.Roadmap.ColorHelper.adjustColorCount(c,1);this.$el.find(".roadmap-lane-title").css({"background-color":c.lane,color:c.text});a.each(this._barViews,function(d){d.updateColor(c)})},addNewBarRow:function(h){var g=this._$laneContent.find(".roadmap-bar-row");var c=[];var d=function(){g.each(function(){var k=b(this);var j=k.index()===0;if(j){var l=new Roadmap.BarRowNewView({$barRow:k,renderBottom:false});k.before(l.render().$el);c.push(l)}var i=new Roadmap.BarRowNewView({$barRow:k});k.after(i.render().$el);c.push(i)})};if(g.length==0){this.addDefaultBarRow()}else{var e=g.find(".roadmap-bar");if(e.length>0){var f=(e.length>0)&&(e.length==1)&&(e.attr("cid")===h.attr("cid"));if(!f){d()}}}return c},addDefaultBarRow:function(){var c=this._newBarRowView();this._$laneContent.append(c.$el)},_onBarRowNewDropover:function(f,d,c){if(!a.isEmpty(Roadmap.DragDrop.barDraggingOver)){a.each(Roadmap.DragDrop.barDraggingOver,function(e){e.$el&&e.$el.removeClass("new-bar-row-hover roadmap-bar-drag-hover")})}Roadmap.DragDrop.barDraggingOver[d.cid]=d;c.helper.removeClass("roadmap-bar-overlapped");c.helper.data("isAddingNewRow",true)},_onBarRowNewDropout:function(f,d,c){c.helper.data("isAddingNewRow",false);delete Roadmap.DragDrop.barDraggingOver[d.cid];a.each(Roadmap.DragDrop.barDraggingOver,function(e){if(typeof e==="string"){c.helper.addClass("roadmap-bar-overlapped")}else{if(e.className==="roadmap-bar-row"&&c.helper.data("isAddingNewRow")!==true){e.$el.addClass("roadmap-bar-drag-hover")}}})}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/marker.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.MarkerView=Backbone.View.extend({className:"vertical-line",events:{dragstop:"_onDragStop",dragstart:"_onDragStart"},initialize:function(){a.bindAll(this,"render","updateHeight","renameTitle","_renderComplete","_onMarkerClick")},render:function(){var d=this.options.roadmap._timelineView.model;var c;if(d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){c=Confluence.Roadmap.Helper.getPosXOnMonthTimeline(d.attributes,this.model.get("markerDate"))}else{c=Confluence.Roadmap.Helper.getPosXOnWeekTimeline(d.attributes,this.model.get("markerDate"))}if(c<0||c>this.options.roadmap._timelineView.$el.width()){return false}this.$el.css({left:(c+Roadmap.LANE_TITLE_WIDTH)+"px"});this.$el.append(Confluence.Templates.Roadmap.marker({title:this.model.get("title")}));this.updateHeight(this.options.roadmap._getLaneHeight());a.defer(this._renderComplete);return this},_renderComplete:function(){this._setupMarkerDragging();this.$el.click(this._onMarkerClick);this.$el.find(".marker-title").ellipsis({row:Roadmap.MARKER_TITLE_LINE})},_setupMarkerDragging:function(){this.$el.draggable({axis:"x",zIndex:4013,containment:".roadmap-frame-content",cursor:"move"})},_onDragStop:function(g,f){var c=f.position.left-Roadmap.LANE_TITLE_WIDTH;var d=this.options.roadmap._timelineView.model.attributes;var h;if(d.displayOption===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH){h=Confluence.Roadmap.Helper.getMonthStartDateByPosition(d,c)}else{h=Confluence.Roadmap.Helper.getWeekStartDateByPosition(d,c)}this.model.set("markerDate",h)},_onDragStart:function(d,c){this.options.roadmap.hideDialog()},_onMarkerClick:function(c){if(!b(c.target).hasClass("marker-title")){return}this._markerDialog&&this._markerDialog.remove();this._markerDialog=this._createMarkerDialog();this._markerDialog.show()},_createMarkerDialog:function(){return new Roadmap.MarkerDialogView({trigger:this.$el.find(".marker-title"),marker:this})},updateHeight:function(c){this.$el.height(c+Roadmap.MARKER_HEIGHT_PADDING)},renameTitle:function(d){this.model.set("title",d);var c=this.$el.find(".marker-title");c.attr("title",d);c.html(AJS.escapeHtml(d)).ellipsis({row:Roadmap.MARKER_TITLE_LINE})},removeMarker:function(){this.model.collection.remove(this.model);this.remove()}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-view-resources', location = 'view/roadmap-editor/roadmap.js' */
(function(b,a){window.Roadmap=window.Roadmap||{};Roadmap.RoadmapEditorView=Backbone.View.extend({className:"roadmap-editor-container",events:{"BarView.add":"_onAddBar","BarView.dragstart":"_onBarDragstart","BarView.dragstop":"_onBarDragstop","BarView.drop":"_onBarDropped","LaneView.drop":"_onBarDropped","Lane.delete":"_onDeleteLane","BarRowView.remove":"_onBarRowViewRemove","sortstart .roadmap-content":"_onSortStart","sortstop .roadmap-content":"_onSortStop",remove:"_onRemove"},initialize:function(){a.bindAll(this,"render");this.listenTo(this.model.get("lanes"),"add",function(c){var d=new Roadmap.LaneView({model:c,timelineView:this._timelineView,canDelete:true});if(this._laneViews.length===1){this._laneViews[0].updateDeleteStatus(true)}this._laneViews.push(d);this.$roadmapContent.append(d.render().$el);this._updateTimelineColumnHeight();this._scrollToBottom()});this.listenTo(this.model.get("markers"),"add",function(c){var d=new Roadmap.MarkerView({model:c,roadmap:this});this.$roadmapMarker.append(d.render().$el);this._markerViews.push(d)});this.listenTo(this.model.get("timeline"),"change",function(){if(this._isTimelineChanged()){this._calculateMinWidthOfABar();this._timelineView.update();this._timelineColumnView.update();this.$roadmapContent.empty();a.each(this._laneViews,function(c){c.remove()});this._laneViews=[];this._renderLanes();this.$roadmapMarker.empty();this._markerViews=[];this._renderMarkers();this._updateDragArea()}})},render:function(){this.$el.html(Confluence.Templates.Roadmap.roadmapEditor());this._calculateMinWidthOfABar();this._initVariables();this._renderToolbar();this._renderTimeline();this._renderLanes();this._renderMarkers();this._renderTimelineColumn();this._updateDragArea();return this},_calculateMinWidthOfABar:function(){Roadmap.barMinWidth=this.model.get("timeline").get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?Roadmap.MONTH_BAR_MIN_WIDTH:Roadmap.WEEK_BAR_MIN_WIDTH},_initVariables:function(){this.$roadmapContainer=this.$el.find("#roadmap-container");this.$roadmapTimeline=this.$roadmapContainer.find(".roadmap-frame");this.$roadmapContent=this.$roadmapContainer.find(".roadmap-content");this.$roadmapMarker=this.$roadmapContainer.find(".roadmap-marker");this._timelineView=new Roadmap.TimelineView({model:this.model.get("timeline")});this._timelineColumnView=new Roadmap.TimelineColumnView({model:this.model.get("timeline")});this._laneViews=[];this._markerViews=[]},_renderTimeline:function(){this.$roadmapTimeline.prepend(this._timelineView.render().$el)},_renderTimelineColumn:function(){this._updateTimelineColumnHeight();this.$roadmapTimeline.append(this._timelineColumnView.render().$el)},_renderMarkers:function(){var c=this;this.model.get("markers").each(function(d){var e=new Roadmap.MarkerView({model:d,roadmap:c});c.$roadmapMarker.append(e.render().$el);c._markerViews.push(e)})},_renderLanes:function(){Confluence.Roadmap.ColorHelper.resetColorCounts();var d=this;this._updateLaneWidth();var c=this.model.get("lanes").models.length>1;this.model.get("lanes").each(function(e){var f=new Roadmap.LaneView({model:e,timelineView:d._timelineView,canDelete:c});d._laneViews.push(f);d.$roadmapContent.append(f.render().$el)});this._setupLaneReordering()},_onAddBar:function(d,c){this._updateTimelineColumnHeight();var e=c.$el;if(!this._isInViewScreen(e)){this._scrollToBar(e)}},_renderToolbar:function(){var d=b("#"+this.options.dialogId+" .dialog-page-body");d.find(".roadmap-toolbar").remove();var c=new Roadmap.ToolbarView({model:this.model,timelineView:this._timelineView});d.prepend(c.render().$el)},_getTimelineWidth:function(){return this.$roadmapTimeline.find(".roadmap-frame-title").width()},_getLaneHeight:function(){return this.$roadmapContent.height()},_updateLaneWidth:function(){this.$roadmapContent.width(this._getTimelineWidth()+Roadmap.LANE_TITLE_WIDTH)},_scrollToBottom:function(){this.options.roadmapPopup.scrollTop(this._getLaneHeight())},_isInViewScreen:function(c){return b.inviewport(c,{threshold:-100})},_scrollToBar:function(c){this.options.roadmapPopup.scrollTop(c.parent().position().top);this.options.roadmapPopup.scrollLeft(0)},_onBarDropped:function(){this._updateTimelineColumnHeight()},_onDeleteLane:function(d,c){this.model.get("lanes").remove(c.model);this._laneViews.splice(a.indexOf(this._laneViews,c),1);c.remove();this._updateTimelineColumnHeight();if(this._laneViews.length===1){this._laneViews[0].updateDeleteStatus(false)}},_onBarRowViewRemove:function(){this._updateTimelineColumnHeight()},_updateTimelineColumnHeight:function(){var c=this._getLaneHeight();this._timelineColumnView.updateHeight(c);a.each(this._markerViews,function(d){d.updateHeight(c)})},hideDialog:function(){b("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").hide()},removeDialog:function(){b("#inline-dialog-roadmap-dialog, #inline-dialog-timeline-options").remove()},_onBarDragstart:function(f,d){var c=this;this.hideDialog();this._updateDragArea();this._barRowNewViewList=[];a.each(this._laneViews,function(e){c._barRowNewViewList.push(e.addNewBarRow(d.helper))})},_updateDragArea:function(){var c=this.$roadmapContainer.find(".roadmap-drag-area");c.css(this._timelineColumnView.getSizeAndPosition())},_onBarDragstop:function(){a.each(a.flatten(this._barRowNewViewList),function(c){c.remove()});delete this._barRowNewViewList;a.each(this._laneViews,function(c){c.removeEmptyRow()})},_setupLaneReordering:function(){this.$roadmapContent.sortable({axis:"y",cursor:"move",handle:".roadmap-lane-title",opacity:0.3,placeholder:"roadmap-lane lane-sorting-placeholder",helper:function(d,c){return b(c).clone().addClass("lane-sorting-hepler")}})},_onSortStart:function(d,c){this.hideDialog();this._timelineColumnView.$el.hide();c.placeholder.css({height:Math.min(c.helper.height(),100),width:c.helper.width()}).html(Confluence.Templates.Roadmap.lane(Roadmap.TRANSPARENT_LANE));c.helper.find(".roadmap-lane-content").css({width:c.helper.width()-(c.helper.find(".roadmap-lane-title").outerWidth()+c.helper.find(".roadmap-separate-content").outerWidth())})},_onSortStop:function(h,g){this._timelineColumnView.$el.show();var d=g.item.attr("cid");var f=a.find(this._laneViews,function(e){return e.cid===d});var c=f.model;var i=this.model.get("lanes");i.remove(c);i.models.splice(g.item.index(),0,c);i._byId[c.cid]=c},_onRemove:function(){this.$roadmapTimeline.remove()},_isMonthYearChanged:function(){var d=function(f,e){if(f.getMonth()!==e.getMonth()||f.getYear()!==e.getYear()){return true}return false};var c=this.model.get("timeline");return d(c._previousAttributes.startDate,c.attributes.startDate)||d(c._previousAttributes.endDate,c.attributes.endDate)},_isWeekChanged:function(){var c=function(l,k){var j=moment(l);var i=moment(k);return j.get("year")===i.get("year")&&j.isoWeek()===i.isoWeek()};var d=this.model.get("timeline");var g=d._previousAttributes.startDate;var h=d.attributes.startDate;var f=d._previousAttributes.endDate;var e=d.attributes.endDate;return !(c(g,h)&&c(f,e))},_isTimelineChanged:function(){var d=this.model.get("timeline");var c=d.changed.displayOption;if(c){this.model.updateDurationUnit(d.get("displayOption"))}else{c=d.get("displayOption")===Roadmap.TIMELINE_DISPLAY_OPTION.MONTH?this._isMonthYearChanged():this._isWeekChanged()}return c},resize:function(){this._updateLaneWidth();this._updateTimelineColumnHeight();this.$roadmapContent.css({top:this.$roadmapTimeline.find(".roadmap-column-title:first").innerHeight()})}})})(AJS.$,window._);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.viewport.js' */
(function(a){a.belowthefold=function(c,d){var b=a(window).height()+a(window).scrollTop();return b<=a(c).offset().top-d.threshold};a.abovethetop=function(b,c){var d=a(window).scrollTop();return d>=a(b).offset().top+a(b).height()-c.threshold};a.rightofscreen=function(c,d){var b=a(window).width()+a(window).scrollLeft();return(b<=a(c).offset().left-d.threshold)||a(c).offset().left<0};a.leftofscreen=function(b,c){var d=a(window).scrollLeft();return d>=a(b).offset().left+a(b).width()-c.threshold};a.inviewport=function(b,c){return !a.rightofscreen(b,c)&&!a.leftofscreen(b,c)&&!a.belowthefold(b,c)&&!a.abovethetop(b,c)};a.extend(a.expr[":"],{"below-the-fold":function(c,d,b){return a.belowthefold(c,{threshold:0})},"above-the-top":function(c,d,b){return a.abovethetop(c,{threshold:0})},"left-of-screen":function(c,d,b){return a.leftofscreen(c,{threshold:0})},"right-of-screen":function(c,d,b){return a.rightofscreen(c,{threshold:0})},"in-viewport":function(c,d,b){return a.inviewport(c,{threshold:0})}})})(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'lib/jquery.ellipsis.min.js' */
/*! jQuery ellipsis - v1.1.1 - 2014-02-23
* https://github.com/STAR-ZERO/jquery-ellipsis
* Copyright (c) 2014 Kenji Abe; Licensed MIT */
!function(a){a.fn.ellipsis=function(b){var c={row:1,onlyFullWords:!1,"char":"...",callback:function(){},position:"tail"};return b=a.extend(c,b),this.each(function(){var c=a(this),d=c.text(),e=d,f=e.length,g=c.height();c.text("a");var h=parseFloat(c.css("lineHeight"),10),i=c.height(),j=h>i?h-i:0,k=j*(b.row-1)+i*b.row;if(k>=g)return c.text(d),void b.callback.call(this);var l=1,m=0,n=d.length;if("tail"===b.position){for(;n>l;)m=Math.ceil((l+n)/2),c.text(d.slice(0,m)+b["char"]),c.height()<=k?l=m:n=m-1;d=d.slice(0,l),b.onlyFullWords&&(d=d.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d+=b["char"]}else if("middle"===b.position){for(var o=0;n>l;)m=Math.ceil((l+n)/2),o=Math.max(f-m,0),c.text(e.slice(0,Math.floor((f-o)/2))+b["char"]+e.slice(Math.floor((f+o)/2),f)),c.height()<=k?l=m:n=m-1;o=Math.max(f-l,0);var p=e.slice(0,Math.floor((f-o)/2)),q=e.slice(Math.floor((f+o)/2),f);b.onlyFullWords&&(p=p.replace(/[\u00AD\w\uac00-\ud7af]+$/,"")),d=p+b["char"]+q}c.text(d),b.callback.call(this)}),this}}(jQuery);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/md5.js' */
var hexcase=0;var b64pad="";function hex_md5(a){return rstr2hex(rstr_md5(str2rstr_utf8(a)))}function b64_md5(a){return rstr2b64(rstr_md5(str2rstr_utf8(a)))}function any_md5(a,b){return rstr2any(rstr_md5(str2rstr_utf8(a)),b)}function hex_hmac_md5(a,b){return rstr2hex(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function b64_hmac_md5(a,b){return rstr2b64(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(b)))}function any_hmac_md5(a,c,b){return rstr2any(rstr_hmac_md5(str2rstr_utf8(a),str2rstr_utf8(c)),b)}function md5_vm_test(){return hex_md5("abc").toLowerCase()=="900150983cd24fb0d6963f7d28e17f72"}function rstr_md5(a){return binl2rstr(binl_md5(rstr2binl(a),a.length*8))}function rstr_hmac_md5(c,f){var e=rstr2binl(c);if(e.length>16){e=binl_md5(e,c.length*8)}var a=Array(16),d=Array(16);for(var b=0;b<16;b++){a[b]=e[b]^909522486;d[b]=e[b]^1549556828}var g=binl_md5(a.concat(rstr2binl(f)),512+f.length*8);return binl2rstr(binl_md5(d.concat(g),512+128))}function rstr2hex(c){try{hexcase}catch(g){hexcase=0}var f=hexcase?"0123456789ABCDEF":"0123456789abcdef";var b="";var a;for(var d=0;d<c.length;d++){a=c.charCodeAt(d);b+=f.charAt((a>>>4)&15)+f.charAt(a&15)}return b}function rstr2b64(c){try{b64pad}catch(h){b64pad=""}var g="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";var b="";var a=c.length;for(var f=0;f<a;f+=3){var k=(c.charCodeAt(f)<<16)|(f+1<a?c.charCodeAt(f+1)<<8:0)|(f+2<a?c.charCodeAt(f+2):0);for(var d=0;d<4;d++){if(f*8+d*6>c.length*8){b+=b64pad}else{b+=g.charAt((k>>>6*(3-d))&63)}}}return b}function rstr2any(m,c){var b=c.length;var l,f,a,n,e;var k=Array(Math.ceil(m.length/2));for(l=0;l<k.length;l++){k[l]=(m.charCodeAt(l*2)<<8)|m.charCodeAt(l*2+1)}var h=Math.ceil(m.length*8/(Math.log(c.length)/Math.log(2)));var g=Array(h);for(f=0;f<h;f++){e=Array();n=0;for(l=0;l<k.length;l++){n=(n<<16)+k[l];a=Math.floor(n/b);n-=a*b;if(e.length>0||a>0){e[e.length]=a}}g[f]=n;k=e}var d="";for(l=g.length-1;l>=0;l--){d+=c.charAt(g[l])}return d}function str2rstr_utf8(c){var b="";var d=-1;var a,e;while(++d<c.length){a=c.charCodeAt(d);e=d+1<c.length?c.charCodeAt(d+1):0;if(55296<=a&&a<=56319&&56320<=e&&e<=57343){a=65536+((a&1023)<<10)+(e&1023);d++}if(a<=127){b+=String.fromCharCode(a)}else{if(a<=2047){b+=String.fromCharCode(192|((a>>>6)&31),128|(a&63))}else{if(a<=65535){b+=String.fromCharCode(224|((a>>>12)&15),128|((a>>>6)&63),128|(a&63))}else{if(a<=2097151){b+=String.fromCharCode(240|((a>>>18)&7),128|((a>>>12)&63),128|((a>>>6)&63),128|(a&63))}}}}}return b}function str2rstr_utf16le(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode(b.charCodeAt(c)&255,(b.charCodeAt(c)>>>8)&255)}return a}function str2rstr_utf16be(b){var a="";for(var c=0;c<b.length;c++){a+=String.fromCharCode((b.charCodeAt(c)>>>8)&255,b.charCodeAt(c)&255)}return a}function rstr2binl(b){var a=Array(b.length>>2);for(var c=0;c<a.length;c++){a[c]=0}for(var c=0;c<b.length*8;c+=8){a[c>>5]|=(b.charCodeAt(c/8)&255)<<(c%32)}return a}function binl2rstr(b){var a="";for(var c=0;c<b.length*32;c+=8){a+=String.fromCharCode((b[c>>5]>>>(c%32))&255)}return a}function binl_md5(p,k){p[k>>5]|=128<<((k)%32);p[(((k+64)>>>9)<<4)+14]=k;var o=1732584193;var n=-271733879;var m=-1732584194;var l=271733878;for(var g=0;g<p.length;g+=16){var j=o;var h=n;var f=m;var e=l;o=md5_ff(o,n,m,l,p[g+0],7,-680876936);l=md5_ff(l,o,n,m,p[g+1],12,-389564586);m=md5_ff(m,l,o,n,p[g+2],17,606105819);n=md5_ff(n,m,l,o,p[g+3],22,-1044525330);o=md5_ff(o,n,m,l,p[g+4],7,-176418897);l=md5_ff(l,o,n,m,p[g+5],12,1200080426);m=md5_ff(m,l,o,n,p[g+6],17,-1473231341);n=md5_ff(n,m,l,o,p[g+7],22,-45705983);o=md5_ff(o,n,m,l,p[g+8],7,1770035416);l=md5_ff(l,o,n,m,p[g+9],12,-1958414417);m=md5_ff(m,l,o,n,p[g+10],17,-42063);n=md5_ff(n,m,l,o,p[g+11],22,-1990404162);o=md5_ff(o,n,m,l,p[g+12],7,1804603682);l=md5_ff(l,o,n,m,p[g+13],12,-40341101);m=md5_ff(m,l,o,n,p[g+14],17,-1502002290);n=md5_ff(n,m,l,o,p[g+15],22,1236535329);o=md5_gg(o,n,m,l,p[g+1],5,-165796510);l=md5_gg(l,o,n,m,p[g+6],9,-1069501632);m=md5_gg(m,l,o,n,p[g+11],14,643717713);n=md5_gg(n,m,l,o,p[g+0],20,-373897302);o=md5_gg(o,n,m,l,p[g+5],5,-701558691);l=md5_gg(l,o,n,m,p[g+10],9,38016083);m=md5_gg(m,l,o,n,p[g+15],14,-660478335);n=md5_gg(n,m,l,o,p[g+4],20,-405537848);o=md5_gg(o,n,m,l,p[g+9],5,568446438);l=md5_gg(l,o,n,m,p[g+14],9,-1019803690);m=md5_gg(m,l,o,n,p[g+3],14,-187363961);n=md5_gg(n,m,l,o,p[g+8],20,1163531501);o=md5_gg(o,n,m,l,p[g+13],5,-1444681467);l=md5_gg(l,o,n,m,p[g+2],9,-51403784);m=md5_gg(m,l,o,n,p[g+7],14,1735328473);n=md5_gg(n,m,l,o,p[g+12],20,-1926607734);o=md5_hh(o,n,m,l,p[g+5],4,-378558);l=md5_hh(l,o,n,m,p[g+8],11,-2022574463);m=md5_hh(m,l,o,n,p[g+11],16,1839030562);n=md5_hh(n,m,l,o,p[g+14],23,-35309556);o=md5_hh(o,n,m,l,p[g+1],4,-1530992060);l=md5_hh(l,o,n,m,p[g+4],11,1272893353);m=md5_hh(m,l,o,n,p[g+7],16,-155497632);n=md5_hh(n,m,l,o,p[g+10],23,-1094730640);o=md5_hh(o,n,m,l,p[g+13],4,681279174);l=md5_hh(l,o,n,m,p[g+0],11,-358537222);m=md5_hh(m,l,o,n,p[g+3],16,-722521979);n=md5_hh(n,m,l,o,p[g+6],23,76029189);o=md5_hh(o,n,m,l,p[g+9],4,-640364487);l=md5_hh(l,o,n,m,p[g+12],11,-421815835);m=md5_hh(m,l,o,n,p[g+15],16,530742520);n=md5_hh(n,m,l,o,p[g+2],23,-995338651);o=md5_ii(o,n,m,l,p[g+0],6,-198630844);l=md5_ii(l,o,n,m,p[g+7],10,1126891415);m=md5_ii(m,l,o,n,p[g+14],15,-1416354905);n=md5_ii(n,m,l,o,p[g+5],21,-57434055);o=md5_ii(o,n,m,l,p[g+12],6,1700485571);l=md5_ii(l,o,n,m,p[g+3],10,-1894986606);m=md5_ii(m,l,o,n,p[g+10],15,-1051523);n=md5_ii(n,m,l,o,p[g+1],21,-2054922799);o=md5_ii(o,n,m,l,p[g+8],6,1873313359);l=md5_ii(l,o,n,m,p[g+15],10,-30611744);m=md5_ii(m,l,o,n,p[g+6],15,-1560198380);n=md5_ii(n,m,l,o,p[g+13],21,1309151649);o=md5_ii(o,n,m,l,p[g+4],6,-145523070);l=md5_ii(l,o,n,m,p[g+11],10,-1120210379);m=md5_ii(m,l,o,n,p[g+2],15,718787259);n=md5_ii(n,m,l,o,p[g+9],21,-343485551);o=safe_add(o,j);n=safe_add(n,h);m=safe_add(m,f);l=safe_add(l,e)}return Array(o,n,m,l)}function md5_cmn(h,e,d,c,g,f){return safe_add(bit_rol(safe_add(safe_add(e,h),safe_add(c,f)),g),d)}function md5_ff(g,f,k,j,e,i,h){return md5_cmn((f&k)|((~f)&j),g,f,e,i,h)}function md5_gg(g,f,k,j,e,i,h){return md5_cmn((f&j)|(k&(~j)),g,f,e,i,h)}function md5_hh(g,f,k,j,e,i,h){return md5_cmn(f^k^j,g,f,e,i,h)}function md5_ii(g,f,k,j,e,i,h){return md5_cmn(k^(f|(~j)),g,f,e,i,h)}function safe_add(a,d){var c=(a&65535)+(d&65535);var b=(a>>16)+(d>>16)+(c>>16);return(b<<16)|(c&65535)}function bit_rol(a,b){return(a<<b)|(a>>>(32-b))};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor.js' */
AJS.toInit(function(h){var e,d,a,c,f;var g="~~~~~";AJS.MacroBrowser.setMacroJsOverride("roadmap",{opener:function(m){var o=function(t,r,s,u){var q=s?s.split(g):[];var p=r?r.split(g):[];if(!_.isEmpty(q)){h.ajax({type:"POST",contentType:"application/json",url:AJS.contextPath()+"/rest/roadmap/1.0/extractPageLinks",data:JSON.stringify({wikiLinks:_.object(q,p),roadmapSpace:AJS.Meta.get("space-key")}),success:function(v){_.each(t.lanes,function(w){_.chain(w.bars).filter(function(x){return _.contains(q,x.id)}).each(function(x){if(v[x.id]){x.pageLink=v[x.id]}})});u&&u()},error:function(v){AJS.log(v);u&&u()}})}else{u&&u()}},n=function(q){var r=[];var p=[];q.lanes.forEach(function(s){s.bars.forEach(function(t){if(!_.isEmpty(t.pageLink)){var u=t.pageLink.wikiLink.replace(/[\][]/g,"");r.push(_.escape(u));p.push(t.id)}})});return{pageLinks:r.join(g),mapLinks:p.join(g)}};if(m.params&&m.params.timeline!=="true"){var j="roadmap-deprecation-dialog";var k=h(Confluence.Templates.Roadmap.deprecationDialog({id:j}));AJS.dialog2(k).on("hide",function(){h("#"+j).remove()}).on("show",function(){h("#dialog-close-button",k).click(function(p){p.preventDefault();AJS.dialog2("#"+j).hide()})}).show();return false}var i;var l=function(){var u=function(w){var v=w.target||w.srcElement;if(w.keyCode===AJS.keyCode.ENTER&&h.browser.msie&&v.nodeName==="INPUT"){return false}else{if(w.keyCode===AJS.keyCode.ESCAPE&&e.isVisible()){w.preventDefault()}else{if(w.keyCode===AJS.keyCode.BACKSPACE&&e.isVisible()&&!(v.nodeName==="INPUT"||v.nodeName==="TEXTAREA")){w.preventDefault()}}}};var q="confluence-roadmap-dialog";var t="roadmap-popup-panel";if(typeof e=="undefined"){e=new AJS.Dialog({width:"90%",height:"90%",closeOnOutsideClick:false,id:q,keypressListener:u});d=h("#"+q);d.css({marginTop:"",marginLeft:"",top:"5%",left:"5%"});e.addHeader("Insert Roadmap Planner");e.addPanel("Roadmap Planner",Confluence.Templates.Roadmap.roadmapPopupPanel({roadmapPopupPanelId:t}),"roadmap-editor-popup",1);a=d.find(".roadmap-editor-popup");e.scrollTop=function(v){a.scrollTop(v)};e.scrollLeft=function(v){a.scrollLeft(v)};e.addSubmit("Insert",function(){c.removeDialog();var w=c.model.toMacroData();var x=encodeURIComponent(JSON.stringify(w));var y=hex_md5(x);var z=n(w);var v={timeline:"true",source:x,hash:y,title:encodeURIComponent(w.title),pagelinks:z.pageLinks,maplinks:z.mapLinks};tinymce.confluence.macrobrowser.macroBrowserComplete({name:"roadmap",params:v});c.remove();e.hide();if(f){Confluence.Roadmap.Analytics.createRoadmap(w)}else{Confluence.Roadmap.Analytics.editRoadmap(w)}});e.addCancel("Cancel",function(){c.removeDialog();c.remove();e.hide()})}e.show();var p=h("#"+t);var r=p.find(".roadmap-view");if(!r.length){r=h('<div class="roadmap-view"/>');p.append(r)}var s=new Roadmap.Roadmap(i,{parse:true});c=new Roadmap.RoadmapEditorView({model:s,dialogId:q,el:r,roadmapPopup:e});c.render();b();window.roadmapEditor=e};if(m.params&&m.params.source){f=false;i=JSON.parse(decodeURIComponent(m.params.source));o(i,m.params.pagelinks,m.params.maplinks,l)}else{f=true;Confluence.Roadmap.Analytics.insertRoadmap();l()}}});function b(){setTimeout(function(){if(d&&d.is(":visible")){var k=d.height(),j=d.find(".dialog-title").outerHeight(),l=d.find(".dialog-button-panel").outerHeight(),i=d.find("#roadmap-editor-toolbar").outerHeight(),m=d.find(".dialog-panel-body");m.css("height",k-j-l-i)}},0)}h(window).resize(function(){b();c&&c.resize()})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-roadmap-plugin:roadmap-editor-resources', location = 'editor/roadmap-editor-config.js' */
(function(){window.Roadmap=window.Roadmap||{};Roadmap.COLORS=[{lane:"#f6c342",bar:"#fadb8e",text:"#594300"},{lane:"#3b7fc4",bar:"#6c9fd3",text:"#ffffff"},{lane:"#d04437",bar:"#dc7369",text:"#ffffff"},{lane:"#8eb021",bar:"#aac459",text:"#ffffff"},{lane:"#ea632b",bar:"#ef8a60",text:"#ffffff"},{lane:"#654982",bar:"#8c77a1",text:"#ffffff"},{lane:"#f15c75",bar:"#f58598",text:"#ffffff"},{lane:"#815b3a",bar:"#a1846b",text:"#ffffff"}];Roadmap.TIMELINE_DISPLAY_OPTION={MONTH:"MONTH",WEEK:"WEEK"};Roadmap.SHORT_DATE_FORMAT="YYYY-MM-DD";Roadmap.TWO_YY_SHORT_DATE_FORMAT="YY-MM-DD";Roadmap.DATE_FORMAT="YYYY-MM-DD HH:mm:ss";Roadmap.WEEK_FORMAT="DD-MMM";Roadmap.MONTH_FORMAT="MMM";Roadmap.TIMELINE_YEARS_LIMIT=5;Roadmap.LANE_TITLE_WIDTH=45;Roadmap.MARKER_HEIGHT_PADDING=10;Roadmap.MARKER_TITLE_LINE=2;Roadmap.LANE_PADDING=11;Roadmap.BAR_PADDING=8;Roadmap.BAR_MARGIN=1;Roadmap.BAR_BORDER=1;Roadmap.MONTH_WIDTH=101;Roadmap.WEEK_WIDTH=101;Roadmap.EXTRA_SPACE_AROUND=Roadmap.BAR_PADDING*2+Roadmap.BAR_BORDER*2;Roadmap.MONTH_BAR_MIN_WIDTH=Roadmap.MONTH_WIDTH/4-Roadmap.EXTRA_SPACE_AROUND;Roadmap.WEEK_BAR_MIN_WIDTH=Roadmap.WEEK_WIDTH-Roadmap.EXTRA_SPACE_AROUND;Roadmap.barMinWidth=Roadmap.MONTH_BAR_MIN_WIDTH;Roadmap.TRANSPARENT_LANE={title:"",color:{lane:"#ffffff",bar:"#ffffff",text:"#ffffff"}};Roadmap.DragDrop={};Roadmap.BarDialog={MAX_LENGTH_TITLE:100,MAX_LENGTH_DESCRIPTION:150};Roadmap.getDefaultRoadmapData=function(){var a=moment(new Date()).hours(0).minutes(0).seconds(0).milliseconds(0).toDate();var b=moment(a).add(11,"months").toDate();return{title:"Roadmap Planner",timeline:{startDate:new Date(a),endDate:b,displayOption:Roadmap.TIMELINE_DISPLAY_OPTION.MONTH},lanes:[{title:"Lane 1",color:Roadmap.COLORS[0],bars:[{title:"Bar 1",description:"This is the first bar.",startDate:new Date(a.setDate(1)),duration:2,rowIndex:0},{title:"Bar 2",description:"This is the second bar.",startDate:new Date(a),duration:1,rowIndex:1}]},{title:"Lane 2",color:Roadmap.COLORS[1],bars:[{title:"Bar 3",description:"This is the third bar.",startDate:a,duration:2.5,rowIndex:0}]}],markers:[{title:"Marker 1",markerDate:moment(a).date(15).toDate()}]}}})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:paste-resources', location = 'js/clipboard-access.js' */
(function(){AJS.toInit(function(f){var d={initializeEditor:function(){AJS&&AJS.Rte&&AJS.Rte.BootstrapManager?AJS.Rte.BootstrapManager.addOnInitCallback(function(){var a=AJS.Rte.getEditor();a?window.MutationObserver&&!f.browser.webkit?(new MutationObserver(function(a){for(var b=0;b<a.length;b++){var c=a[b];if(c.addedNodes.length)for(var e=0;e<c.addedNodes.length;e++)if("img"===c.addedNodes[e].localName){setTimeout(d.pasteFromDataURL,0);return}}})).observe(a.getDoc(),{childList:!0,subtree:!0}):a.onPaste.add(function(a,
b){if(d.onPaste(b))return!0;tinymce.dom.Event.cancel(b);return!1}):AJS.log("Could not getEditor from adapter")}):AJS.log("Could not initialize pasteHandler on Confluence.Editor")},pasteFromDataURL:function(){var a=f('img[src^="data:image"]:not(".editor-inline-macro")',tinymce.activeEditor.getDoc());f.each(a,function(){for(var a=this.src.substring(22,this.src.length),b=3*a.length/4,c=0,e=a.length-1;"="==a[e];e--)c++;AJS.Confluence.Uploader.upload([d.createUploadFile(a,b-c,"base64")])});a.remove()},
onPaste:function(a){return a&&a.clipboardData?d.pasteFromEvent(a):!0},showClipboardAccessError:function(){(new AJS.Dialog({width:400,closeOnOutsideClick:!0})).addPanel("alert",f("<div />",{text:"Your browser does not support pasting images from the clipboard."})).addButton("OK",function(a){a.remove()}).show().updateHeight()},pasteFromEvent:function(a){if(a&&a.clipboardData){if(a.clipboardData.items){a=a.clipboardData.items[0];if(!a||"file"!=a.kind)return!0;a=a.getAsFile();
a=d.createUploadFile(a,a.size);AJS.Confluence.Uploader.upload([a]);return!1}setTimeout(function(a){var b=f("img[src^='webkit-fake-url://']",tinymce.activeEditor.getDoc());b.length&&(b.remove(),a.showClipboardAccessError())},0,this)}return!0},createUploadFile:function(a,d,b){var c=new Date,e=c.getMonth()+1;return{fileName:"image"+c.getFullYear()+"-"+e+"-"+c.getDate()+" "+c.getHours()+":"+c.getMinutes()+":"+c.getSeconds()+".png",fileSize:d,slice:function(b,c){return a.slice(b,b+c)},getAsBinary:function(){return a},
getData:function(){return a},encoding:b}}};d.initializeEditor(f);return d})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-confluence', location = 'js/autoconvert/transformers/confluencepaste.js' */
(function(){AJS.bind("init.rte",function(){tinymce.plugins.Autoconvert.autoConvert.addHandler(function(c,a,d){if(a=(a=c.authority===document.location.host)&&(!AJS.contextPath()||0===c.path.indexOf(AJS.contextPath()))){var a=AJS.contextPath()?c.path.substring(AJS.contextPath().length+1):c.path.substring(1),a=decodeURIComponent(a).split("/"),b;c.queryKey=c.queryKey||{};var e=function(a,b){return!b.anchor||0===b.anchor.indexOf("comment-")?a:a+"#"+b.anchor.substring(b.anchor.indexOf("-")+1)};c.queryKey.focusedCommentId?
(b="$"+c.queryKey.focusedCommentId,b=e(b,c)):c.queryKey.pageId?(b="$"+c.queryKey.pageId,b=e(b,c)):"display"===a[0]?2===a.length&&0===a[1].indexOf("~")?b=a[1]:3===a.length?(b=a[1]+":"+a[2].replace(/\+/g," "),b=e(b,c)):4===a.length&&"status"===a[1]?b="$"+a[3]:6===a.length&&(b=a[1]+":/"+a[2]+"/"+a[3]+"/"+a[4]+"/"+a[5].replace(/\+/g," "),b=e(b,c)):"users"==a[0]&&(2==a.length&&"viewuserprofile.action"==a[1]?b="~"+c.queryKey.username:2==a.length&&"viewmyprofile.action"==a[1]&&(b="~"+AJS.Meta.get("remote-user")));
b?tinymce.plugins.Autoconvert.getHtmlFromWikiMarkup("["+b+"]",function(a){d(AJS.$(a).children()[0])},function(){d()}):d()}else d()})})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-youtu.be-rewrite', location = 'js/autoconvert/transformers/youtube.js' */
(function(){AJS.bind("init.rte",function(){tinymce.plugins.Autoconvert.autoConvert.addHandler(function(a,c,b){a.host.match(".*youtu.be.*")?(a="http://youtube.com/watch?v="+a.path.substr(1),b(AJS.$(c).attr("href",a).html(a))):b()})})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-skitch', location = 'js/autoconvert/transformers/skitchpaste.js' */
(function(){AJS.bind("init.rte",function(){AJS.Editor.SkitchPaste={pasteHandler:function(b,d,c){"www.skitch.com"==b.host||"skitch.com"==b.host?AJS.$.get(AJS.params.contextPath+"/rest/autoconvert/1.0/skitchembed?url="+b.source,function(a){a&&a.url?c(AJS.$('<img class="confluence-embedded-image confluence-external-resource" src="'+a.url+'" data-image-src="'+a.url+'"/>')[0]):c()}):c()}};tinymce.plugins.Autoconvert.autoConvert.addHandler(AJS.Editor.SkitchPaste.pasteHandler)})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-cloudapp', location = 'js/autoconvert/transformers/cloudapppaste.js' */
(function(){AJS.bind("init.rte",function(){AJS.Editor.CloudAppPaste={pasteHandler:function(d,c,b){"cl.ly"==d.host?AJS.$.get(AJS.params.contextPath+"/rest/autoconvert/1.0/cloudappembed?resource="+d.path.substr(1),function(a){if(a)switch(a.item_type){case "image":a=AJS.escapeHtml(a.content_url);b(AJS.$('<img class="confluence-embedded-image confluence-external-resource" src="'+a+'" data-image-src="'+a+'"/>')[0]);break;case "bookmark":c.text(a.name),c.attr("href",AJS.escapeHtml(a.redirect_url)),b(c)}else b()}):
b()}};tinymce.plugins.Autoconvert.autoConvert.addHandler(AJS.Editor.CloudAppPaste.pasteHandler)})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-openphoto', location = 'js/autoconvert/transformers/openphoto.js' */
(function(){AJS.bind("init.rte",function(){AJS.Editor.OpenPhotoPaste={pasteHandler:function(b,a,c){var d=b.host.indexOf("openphoto.me"),a=b.directory;-1!==d&&0!==d?(b=b.host.substr(0,d-1),a=a.substr(a.indexOf("photo/")+6),a=a.substr(0,a.indexOf("/")),AJS.$.get(AJS.params.contextPath+"/rest/autoconvert/1.0/openphotoembed?user="+b+"&photo="+a,function(a){a&&200==a.code?(a=AJS.escapeHtml(a.result.path600x600),c(AJS.$('<img class="confluence-embedded-image confluence-external-resource" src="'+a+'" data-image-src="'+
a+'"/>')[0])):c()})):c()}};tinymce.plugins.Autoconvert.autoConvert.addHandler(AJS.Editor.OpenPhotoPaste.pasteHandler)})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-widget-connector', location = 'js/autoconvert/transformers/widgetpaste.js' */
AJS.bind("init.rte",function(){var d=[/youtube.com\/watch\?/,/vimeo.com\/[0-9]+/,/maps.google(.[a-z]+)+\/maps/,/[^\.]\.wufoo\.com\/(?:forms|reports)/];tinymce.plugins.Autoconvert.autoConvert.addHandler(function(a,b,c){a=decodeURI(a.source);for(b=0;b<d.length;b++)if(a.match(d[b])){tinymce.plugins.Autoconvert.convertMacroToDom({name:"widget",params:{url:a}},c,c);return}c()})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-widget-connector', location = 'js/autoconvert/transformers/flickrpaste.js' */
(function(){AJS.bind("init.rte",function(){var d=/^\/photos\/tags\/[^/]+/,e=/^\/photos\/[^/]+\/sets\/[0-9]+/,f=/^\/photos\/[^/]+\/[0-9]+/;tinymce.plugins.Autoconvert.autoConvert.addHandler(function(c,a,b){c.host.match(/flickr.com/)?(a=decodeURIComponent(c.path),a.match(d)||a.match(e)||a.match(f)?(macro={name:"widget",params:{url:decodeURI(c.source)}},tinymce.plugins.Autoconvert.convertMacroToDom(macro,b,b)):b()):b()})})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-shortcut-links', location = 'js/autoconvert/transformers/shortcutlinks.js' */
(function(){AJS.bind("init.rte",function(){var e=[],h;h=AJS.contextPath()?AJS.contextPath():"";tinymce.plugins.Autoconvert.autoConvert.addHandler(function(a,c,f){if(a.source===c.text())for(var g=0;g<e.length;g++){var b=e[g],d=a.source.match(b.regex);if(d){a=d[1];if(b.defaultAlias){b=b.defaultAlias.replace(/%s/,a);f(AJS.$(c).text(b));return}f(AJS.$(c).text(a));return}}f()});setTimeout(function(){AJS.$.ajax({url:h+"/rest/autoconvert/latest/shortcutlinkconfigurations",type:"GET",dataType:"json",success:function(a){e=
a.configurations;for(a=0;a<e.length;a++){var c=e[a];try{var f=c,g=RegExp,b;var d=c.expandedValue;b=0<=d.indexOf("%s")?d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&").replace("%s","(.*)"):d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+"(.*)";f.regex=new g(b)}catch(h){console.log("Failed to generated regex for "+c)}}},error:function(a){console.log("Failed to load shortcut link configurations "+a.statusText)}})},0)})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-paste:autoconvert-google-redirect', location = 'js/autoconvert/transformers/google-redirect-convert.js' */
(function(){AJS.bind("init.rte",function(){tinymce.plugins.Autoconvert.autoConvert.addHandler(function(a,b,c){a.host.match(/google.*/)&&"/url"===a.path&&a.queryKey&&a.queryKey.url?(a=decodeURIComponent(a.queryKey.url),b=AJS.$(b),b.attr("href",a),b.attr("data-mce-href",a),b.text(a),c(b)):c()})})})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-sortable-tables:ConfluenceSortableTablesEditorPlugin', location = 'js/editor_plugin_src.js' */
(function(c){tinymce.create("tinymce.plugins.ConfluenceSortableTablesPlugin",{init:function(d){var b=function(d,b,g){c(".tablesorter",g.node).each(function(d,b){var a=c(b).find("thead"),e,f;1===a.length&&(a=a[0],"THEAD"===a.nodeName&&1===a.childNodes.length&&(f=a.removeChild(a.childNodes[0]),e=c(b).find("tbody")[0],b.removeChild(a),e.insertBefore(f,e.childNodes[0])))})};d.onInit.add(function(){c(document).bind("postPaste",b)});d.onRemove.add(function(){c(document).unbind("postPaste",b)})},getInfo:function(){return{longname:"ConfluenceSortableTablesPlugin",
author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("confluencesortabletablesplugin",tinymce.plugins.ConfluenceSortableTablesPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.macros.advanced:editor_includemacro', location = 'com/atlassian/confluence/plugins/macros/advanced/js/include-macro.js' */
AJS.bind("init.rte",function(){var b=AJS.Meta.get("context-path"),d=AJS.Meta.get("content-id"),c="plugins/servlet/confluence/include-page-macro/goto",a=function(e){var j=AJS.$(e),f=j.attr("data-macro-default-parameter"),h=b+"/"+c+"?location="+f+"&contentId="+d,g=(AJS.$.browser&&AJS.$.browser.msie)?"_blank":"confluence-goto-link-include-macro-"+e.id,i=window.open(h,g);if(i){i.focus()}};AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("goto-page",function(g,f){a(f)})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout', location = 'js/pagelayout/page-layout.soy' */
// This file was automatically generated from page-layout.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.Templates == 'undefined') { Confluence.Templates = {}; }
if (typeof Confluence.Templates.PageLayout == 'undefined') { Confluence.Templates.PageLayout = {}; }


Confluence.Templates.PageLayout.contentLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="contentLayout"></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.PageLayout.cellLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cell"><div class="innerCell"></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.PageLayout.smallCellLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cell aside"><div class="innerCell"></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.PageLayout.headerLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="header"><div class="innerCell"></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.PageLayout.footerLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="footer"><div class="innerCell"></div></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.PageLayout.columnLayout = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="columnLayout"></div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.PageLayout.emptyLayout2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="contentLayout2">');
  Confluence.Templates.PageLayout.emptySection2(null, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.PageLayout.emptySection2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="columnLayout single" data-layout="single">');
  Confluence.Templates.PageLayout.cell2({type: 'normal'}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.PageLayout.newSection2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="columnLayout single" data-layout="single">');
  Confluence.Templates.PageLayout.cell2({type: 'normal'}, output);
  output.append('</div>');
  return opt_sb ? '' : output.toString();
};


Confluence.Templates.PageLayout.cell2 = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="cell ', soy.$$escapeHtml(opt_data.type), '" data-type="', soy.$$escapeHtml(opt_data.type), '"><div class="innerCell">', (opt_data.content) ? opt_data.content : '', '</div></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout', location = 'js/pagelayout/tinymce-page-layout.js' */
(function(e){function i(a){a=e(a.getBody());if(a.children(".contentLayout").length)return!1;a.children(".contentLayout2");return!0}var h=function(a){var j=e("#pagelayout-menu"),d=e(".icon-check",j);h=function(a){var b=d.not(".hidden"),a=d.siblings("."+a.name).siblings();b.addClass("hidden");a.removeClass("hidden")};h(a)};tinymce.create("tinymce.plugins.PageLayoutPlugin",{init:function(a){function j(){i(a)||tinymce.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(b.getLayout())||tinymce.webkit||
AJS.Rte.editorFocus(a)}function d(){tinymce.isGecko&&setTimeout(function(){a.focus();a.dom.getRoot().focus()},1)}function g(){var f=e("#pagelayout-menu").parent(),c=e("#page-layout-2-group");i(a)?(f.addClass("hidden"),c.removeClass("hidden"),b=new tinymce.plugins.PageLayoutPlugin.PageLayout2(a),tinymce.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&e(a.getBody()).attr("contenteditable","true")):(f.removeClass("hidden"),c.addClass("hidden"),b=new tinymce.plugins.PageLayoutPlugin.PageLayout(a),
tinymce.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(b.getLayout())?b.body.attr("contenteditable","true"):d(),h(b.getLayout()))}var b;this.ed=a;"comment"!==AJS.Meta.get("content-type")&&(a.onInit.add(function(){a.undoManager.clear();a.undoManager.add();g();AJS.bind("rte-ready",function(){var f=e('[contenteditable="true"]',a.getBody()),c=!1!==AJS.Meta.get("editor-auto-focus");f.attr("contenteditable","false");f.attr("contenteditable","true");c&&AJS.Rte.editorFocus(a)});a.selection.onSetContent.add(j);
i(a)&&a.undoManager.onUndo.add(function(){tinymce.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody()&&b.body.attr("contenteditable","true");d()})}),e("#pagelayout-menu").delegate("li.dropdown-item a","click",function(){a.execCommand("mcePageLayout",!1,tinymce.plugins.PageLayoutPlugin.PageLayout.getLayoutOptions(this))}),a.addCommand("mcePageLayoutInitialize",function(){a.undoManager.add();b.createInitialLayoutIfNone()}),a.addCommand("mcePageLayout",function(f,c){a.undoManager.add();b.setLayout(c);
h(b.getLayout())}),a.addCommand("mcePageLayoutAddSection",function(f,c){a.undoManager.add();b.addSection&&b.addSection(c&&c.section)}),a.addCommand("mcePageLayoutChangeSection",function(f,c){a.undoManager.add();b.changeSection&&b.changeSection(c&&c.layout,c&&c.section)}),a.addCommand("mcePageLayoutRemoveSection",function(f,c){a.undoManager.add();b.removeSection&&b.removeSection(c&&c.section)}),a.addCommand("mcePageLayoutMoveSectionUp",function(f,c){a.undoManager.add();b.moveSectionUp&&b.moveSectionUp(c&&
c.section)}),a.addCommand("mcePageLayoutMoveSectionDown",function(f,c){a.undoManager.add();b.moveSectionDown&&b.moveSectionDown(c&&c.section)}),a.onSetContent.add(g),a.onClick.add(function(a,c){var b=e(c.target);b.is("div.cell")&&b.children(".innerCell").focus();if(tinymce.isWebKit&&(c.target===a.getBody()||c.target===a.getBody().parentNode))b=b.find(".innerCell"),b.length&&(a.execCommand("selectAll"),b=c.target!==a.getBody(),a.selection.collapse(b))}),!tinymce.isIE9&&a.onKeyUp.add(function(a,b){var d=
b.keyCode;if(8!=d&&46!=d)return!0;d=a.selection.getRng(!0).startContainer;if(e(d).closest(".contentLayout,.contentLayout2",a.getBody()).length&&(d=e(d).closest(".innerCell"))&&d.length&&a.dom.isEmpty(d.clone()[0]))d.html('<p><br data-mce-bogus="1"></p>'),a.selection.select(d[0],!0),a.selection.collapse(!0)}))},execCommand:function(a){if("selectAll"===a){var a=this.ed,e=a.getBody(),d,g;if("true"==a.dom.getAttrib(e,"contenteditable"))return!1;d=a.dom.select(".innerCell",e);e=d[0];d=d[d.length-1];g=
a.dom.createRng();g.setStart(e,0);g.setEnd(d,d.childNodes.length);a.selection.setRng(g);return!0}return!1},getInfo:function(){return{longname:"Page Layout Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",infourl:"http://www.atlassian.com",version:"1.0"}}});tinymce.PluginManager.add("pagelayoutplugin",tinymce.plugins.PageLayoutPlugin)})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout', location = 'js/pagelayout/page-layout.js' */
(function(d){tinymce.plugins.PageLayoutPlugin.PageLayout=function(a){this.editor=a;this.body=d(a.getBody());a=d(".contentLayout",this.body);a.length&&(k(a),l(a,this.body,this.editor),this.editor.undoManager.add())};tinymce.plugins.PageLayoutPlugin.PageLayout.DEFAULT_LAYOUT={name:"pagelayout-none",columns:0};tinymce.plugins.PageLayoutPlugin.PageLayout.prototype.setLayout=function(a){var c;c=d(".contentLayout",this.body);if(tinymce.plugins.PageLayoutPlugin.PageLayout.getLayoutOptions(c).name!==a.name){AJS.trigger("analyticsEvent",
{name:"PageLayoutEvent.pageLayoutChanged",data:{name:a.name}});if(1===c.length)c=c.clone();else{var e=this.editor;c=this.body;var b=Confluence.Templates.PageLayout.contentLayout(),e=e.dom.create("div");e.innerHTML=b;c=d(e).children().html(c.html())}k(c);var b=c,e=d(".columnLayout > .cell",b).length,g=a.name,h=a.columns,f;if(0==e){f=b.html();for(b.html(Confluence.Templates.PageLayout.columnLayout());e!==h.length;)m(b),e++}g=g.substring(g.indexOf("-")+1);g=g.substring(0,Math.max(0,g.indexOf("-"))||
void 0);d(".columnLayout",b).attr("class","columnLayout "+g+"Columns");if(h)for(d(".columnLayout > .cell",b).each(function(a,b){void 0!==h[a]&&d(b).attr("class","cell "+h[a])});e!==h.length;)if(e<h.length)m(b),e++;else{var g=d(".columnLayout .cell:nth-child("+e+") .innerCell",b),o=d(".columnLayout > .cell:nth-child("+(e-1)+") .innerCell",b),p=i(g);o.append(p);g.parent().remove();e--}else{var j="";d(".columnLayout > .cell",b).each(function(){j+=i(d(".innerCell",this))});d(".columnLayout",b).replaceWith(j)}f&&
n(b).html(f);a.header?(f=c,d(".header",f).length||f.prepend(Confluence.Templates.PageLayout.headerLayout())):(b=c,f=d(".header",b),b=n(b),e=i(d(".innerCell",f)),b.length?(b.prepend(e),f.remove()):f.replaceWith(e));a.footer?(f=c,d(".footer",f).length||f.append(Confluence.Templates.PageLayout.footerLayout())):(b=c,f=d(".footer",b),b=d(".columnLayout > .cell:last-child .innerCell",b),e=i(d(".innerCell",f)),b.length?(b.append(e),f.remove()):f.replaceWith(e));tinymce.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody(a)?
(c=c.contents().unwrap(),this.body.attr("contenteditable","true")):(l(c,this.body,this.editor),c.attr("data-atlassian-layout",JSON.stringify(a)));this.body.empty().append(c);tinymce.isIE&&this.editor.dom.setRoot();f=this.editor;a=f.selection;c=a.getRng(!0);b=d('[contenteditable="true"]',f.getBody());b.length?(f.focus(),b[0].focus(),f=b.children()[0],c.setStart(f,0),c.setEnd(f,0),a.setRng(c)):f.focus()}};tinymce.plugins.PageLayoutPlugin.PageLayout.prototype.getLayout=function(){var a=d(".contentLayout",
this.body);return a.length&&a.attr("data-atlassian-layout")?JSON.parse(a.attr("data-atlassian-layout")):tinymce.plugins.PageLayoutPlugin.PageLayout.DEFAULT_LAYOUT};tinymce.plugins.PageLayoutPlugin.PageLayout.getLayoutOptions=function(a){return(a=(a.jquery?a:d(a)).attr("data-atlassian-layout"))?JSON.parse(a):tinymce.plugins.PageLayoutPlugin.PageLayout.DEFAULT_LAYOUT};tinymce.plugins.PageLayoutPlugin.PageLayout.needsContentEditableBody=function(a){return!(a.header||a.footer||a.columns)};var i=function(a){a=
a.jquery?a:d(a);if(a.length)for(var c=a[0].childNodes,e=0;e<c.length;e++){var b=c[e];if(!("P"==b.nodeName&&1==b.childNodes.length&&"BR"==b.firstChild.nodeName))return a.html()}return""},k=function(a){for(var c,e,a=d(".cell, .header, .footer",a),b=0,g=a.length;b<g;b++)c=d(a[b]),e=c.html(),d(".innerCell",c).length||(c.removeAttr("contenteditable"),c.html('<div class="innerCell">'+e+"</div>"))},l=function(a,c,e){c.attr("contenteditable","false");var b=tinymce.isIE9?"<p></p>":"<p><br /></p>";d(".innerCell",
a).each(function(){var a=d(this);a.attr("contenteditable","true");a.children().length||a.append(b)});tinymce.isIE&&c.delegate(".innerCell","focus.pageLayout",function(){e.dom.settings.root_element=this})},n=function(a){return d(".columnLayout > .cell:first-child .innerCell",a)},m=function(a){return d(".columnLayout",a).append(Confluence.Templates.PageLayout.cellLayout())}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout', location = 'js/pagelayout/page-layout-2.js' */
(function(f){function o(a,b,c,d){var g=a.find(".cell"),h=g.length,i=f(),k=b.cells.length,m=[],l=[],e,j;a.attr("class","columnLayout");a.addClass(b.id);a.attr("data-layout",b.id);e=0;for(j=h;e<j;e++)l=g.eq(e).detach(),m.push(q(l.children(".innerCell")));e=0;for(j=k;e<j;e++)i=i.add(Confluence.Templates.PageLayout.cell2({type:b.cells[e].type||""}));if(h<=k)l=m;else{l=m.slice(0,k);e=k;for(j=h;e<j;e++)l[k-1]+=m[e]}a.prepend(i);e=0;for(j=k;e<j;e++)i.eq(e).find(".innerCell").html(l[e]);n(a,c,d)}var r=tinymce.isIE9?
"<p></p>":"<p><br /></p>";tinymce.plugins.PageLayoutPlugin.PageLayout2=function(a){this.editor=a;this.body=f(a.getBody());a=this.body.find(".contentLayout2");a.length&&(n(a,this.body,this.editor),this.editor.undoManager.add())};tinymce.plugins.PageLayoutPlugin.PageLayout2.prototype.addSection=function(a){var b=this,c=f(Confluence.Templates.PageLayout.newSection2()),d=a||h(this.body,this.editor,!0);if(d.length){var g=tinymce.plugins.PageLayoutPlugin.PageLayout2.Layouts.get(d.attr("data-layout"));this.editor.undoManager.ignore(function(){o(c,
g,b.body,b.editor);d.after(c)});i(this.editor,c);AJS.trigger("editor.page-layout.add-section",{section:c})}else this.createInitialLayoutIfNone()};tinymce.plugins.PageLayoutPlugin.PageLayout2.prototype.changeSection=function(a,b){var c=this;tinymce.plugins.PageLayoutPlugin.PageLayout2.isPageLayout()||this.createInitialLayoutIfNone();var d=b||h(this.body,this.editor,!1);if(d.length){var g=tinymce.plugins.PageLayoutPlugin.PageLayout2.Layouts.get(d.attr("data-layout"));this.editor.undoManager.ignore(function(){o(d,
a,c.body,c.editor)});i(this.editor,d);AJS.trigger("editor.page-layout.change-layout",{section:d,originalLayout:g,currentLayout:a})}};tinymce.plugins.PageLayoutPlugin.PageLayout2.prototype.removeSection=function(a){if(tinymce.plugins.PageLayoutPlugin.PageLayout2.isPageLayout()){var a=a||h(this.body,this.editor,!0),b=a.next(),c=a.prev(),d;b.length?(d=b,a.remove()):c.length?(d=c,a.remove()):(a.closest(".contentLayout2").remove(),a=this.body.find(".contentLayout2").find(".columnLayout").first(),a.length?
d=a:(a=this.editor,a.getBody().setAttribute("contenteditable",!0),a.setContent("<p></p>"),p(a),a=f("#rte-button-pagelayout-2"),a.hasClass("active")&&a.click()));d&&d.length&&i(this.editor,d);AJS.trigger("editor.page-layout.remove-section",{})}};tinymce.plugins.PageLayoutPlugin.PageLayout2.prototype.moveSectionUp=function(a){if(tinymce.plugins.PageLayoutPlugin.PageLayout2.isPageLayout()){var a=a||h(this.body,this.editor,!0),b=a.prev();b.length&&(a.detach(),b.before(a),i(this.editor,a));AJS.trigger("editor.page-layout.move-section-up",
{section:a})}};tinymce.plugins.PageLayoutPlugin.PageLayout2.prototype.moveSectionDown=function(a){if(tinymce.plugins.PageLayoutPlugin.PageLayout2.isPageLayout()){var a=a||h(this.body,this.editor,!0),b=a.next();b.length&&(a.detach(),b.after(a),i(this.editor,a));AJS.trigger("editor.page-layout.move-section-down",{section:a})}};tinymce.plugins.PageLayoutPlugin.PageLayout2.prototype.createInitialLayoutIfNone=function(){if(!tinymce.plugins.PageLayoutPlugin.PageLayout2.isPageLayout()){var a=f(Confluence.Templates.PageLayout.emptyLayout2()),
b=a.find(".innerCell"),c=this.body.children().detach();b.append(c);this.body.append(a);n(a,this.body,this.editor);p(this.editor)}};tinymce.plugins.PageLayoutPlugin.PageLayout2.isPageLayout=function(){return!!f(AJS.Rte.getEditor().getBody()).find("div.contentLayout2").length};tinymce.plugins.PageLayoutPlugin.PageLayout2.needsContentEditableBody=function(){return!tinymce.plugins.PageLayoutPlugin.PageLayout2.isPageLayout()};tinymce.plugins.PageLayoutPlugin.PageLayout2.Layouts=[{id:"single",name:"Single column section",
cells:[{type:"normal"}]},{id:"two-equal",name:"Two column section",cells:[{type:"normal"},{type:"normal"}]},{id:"two-left-sidebar",name:"Two column section with left side-bar",cells:[{type:"aside"},{type:"normal"}]},{id:"two-right-sidebar",name:"Two column section with right side-bar",cells:[{type:"normal"},{type:"aside"}]},{id:"three-equal",name:"Three column section",cells:[{type:"normal"},{type:"normal"},
{type:"normal"}]},{id:"three-with-sidebars",name:"Three column section with side-bars",cells:[{type:"sidebars"},{type:"normal"},{type:"sidebars"}]}];tinymce.plugins.PageLayoutPlugin.PageLayout2.Layouts.get=function(a){for(var b=tinymce.plugins.PageLayoutPlugin.PageLayout2.Layouts,c=0,d=b.length;c<d;c++)if(b[c].id===a)return b[c];return null};tinymce.plugins.PageLayoutPlugin.PageLayout2.Layouts.findNearestSection=function(a){var b=AJS.Rte.getEditor(),c=f(b.getBody());return h(c,
b,a)};var q=function(a){a=f(a);if(a.length)for(var b=a[0].childNodes,c=0;c<b.length;c++){var d=b[c];if(!("P"==d.nodeName&&1==d.childNodes.length&&"BR"==d.firstChild.nodeName))return a.html()}return""},h=function(a,b,c){b=f(b.selection.getRng(!0).startContainer).closest(".columnLayout");!b.length&&c&&(b=a.find(".columnLayout").last());return b},n=function(a,b,c){b.attr("contenteditable","false");f(".innerCell",a).each(function(){var a=f(this);a.attr("contenteditable","true");a.children().length||a.append(r)});
tinymce.isIE&&b.delegate(".innerCell","focus.pageLayout",function(){c.dom.settings.root_element=this})},p=function(a){var b=a.selection,c=b.getRng(!0),d=f('[contenteditable="true"]',a.getBody());d.length?(a.focus(),d[0].focus(),a=d.children()[0],c.setStart(a,0),c.setEnd(a,0),b.setRng(c)):a.focus()},i=function(a,b){var c=a.selection,d=c.getRng(!0),g=b.find('[contenteditable="true"]').first(),f=g.children();f.length?(a.focus(),g[0].focus(),g=f[0],d.setStart(g,0),d.setEnd(g,0),c.setRng(d),AJS.Rte.showElement(g)):
a.focus()}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-page-layout:pagelayout', location = 'js/pagelayout/tinymce-page-layout-toolbar.js' */
(function(d){function f(b){var b=b||tinymce.plugins.PageLayoutPlugin.PageLayout2.Layouts.findNearestSection(),a=b.attr("data-layout"),b=d("#rte-toolbar-row-pl2-toolbar").find(".layouts button"),a=b.find(".pl2-layout-"+a).closest(".aui-button");a.hasClass("active")||(b.filter(".active").removeClass("active"),a.addClass("active"))}"comment"!==AJS.Meta.get("content-type")&&AJS.$(document).bind("initContextToolbars.Toolbar",function(b,a){var g=AJS.$(document),j=d("#page-layout-2"),c=d("#rte-button-pagelayout-2");
a.addCommand("mcePageLayoutsToolbar",function(){c.hasClass("active")?g.trigger("removeContextToolbarRow.Toolbar",{id:"pl2-toolbar",animate:!0}):(g.trigger("createContextToolbarRow.Toolbar",{id:"pl2-toolbar",buttons:Confluence.Editor.PageLayoutToolbar.Buttons,topToolbar:!0,animate:!0}),f(),a.execCommand("mcePageLayoutInitialize"));c.toggleClass("active")});c.click(function(k){k.preventDefault();j.hasClass("disabled")||a.execCommand("mcePageLayoutsToolbar",!1,null)});a.onNodeChange.add(function(a,b,
c){a=d(c).closest(".columnLayout");f(a)});for(var h=tinymce.plugins.PageLayoutPlugin.PageLayout2.Layouts,i=[],e=0,l=h.length;e<l;e++)(function(b){i.push(new Confluence.Editor.Toolbar.Components.Button({text:b.name,iconClass:"icon-fat pl2-layout-"+b.id,click:function(){a.execCommand("mcePageLayoutChangeSection",!1,{layout:b})}}))})(h[e]);Confluence.Editor.PageLayoutToolbar={Buttons:[new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({triggerText:"Add section",
id:"add-layout-section",tooltip:"Add a new section below",iconClass:"pl2-layout-add-section",click:function(){a.execCommand("mcePageLayoutAddSection")}}),new Confluence.Editor.Toolbar.Components.Button({triggerText:"Remove section",id:"remove-layout-section",tooltip:"Remove the current section",iconClass:"pl2-layout-remove-section",click:function(){a.execCommand("mcePageLayoutRemoveSection")}})]),new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({triggerText:"Move up",
id:"move-up-layout-section",tooltip:"Move section up",iconClass:"pl2-layout-move-section-up",click:function(){a.execCommand("mcePageLayoutMoveSectionUp")}}),new Confluence.Editor.Toolbar.Components.Button({triggerText:"Move down",id:"move-down-layout-section",tooltip:"Move section down",iconClass:"pl2-layout-move-section-down",click:function(){a.execCommand("mcePageLayoutMoveSectionDown")}})]),
new Confluence.Editor.Toolbar.Components.Group(i,{id:"pagelayout2-toolbar",text:"Apply layout",groupClass:"layouts"}),new Confluence.Editor.Toolbar.Components.Group([new Confluence.Editor.Toolbar.Components.Button({text:"Close toolbar",iconClass:"icon-close",click:function(){a.execCommand("mcePageLayoutsToolbar",!1,null)}})],{groupClass:"close"})],Events:[]}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-editor', location = 'js/editor_plugin_src.js' */
(function(b){var c=/^\u200b?(\[)$/;AJS.bind("confluence.editor.registerHandlers",function(n,m){if(!AJS.Rte.Support.inlineTasks()){return}var k=m.handlerManager,j=m.ed,l=m.createHandler;k.registerHandler("]".charCodeAt(0),l(c,function(){j.plugins.lists.applyList("UL","OL","inline-task-list",{attributesOnItems:{"data-inline-task-id":""},placeholderText:"Type your task here, using \"@\" to assign to a user and \"//\" to select a due date"})},true))});function e(j){j.plugins.lists.applyList=_.bind(_.wrap(j.plugins.lists.applyList,function(k){k.apply(this,Array.prototype.slice.call(arguments,1));g(j)}),j.plugins.lists)}function g(j,l){if(!(tinymce.isIE8||tinymce.isIE11||tinymce.isGecko||tinymce.isWebKit)){return}var k=l||b(d(j));if(k.height()===0||tinymce.isIE8){k.append("&nbsp;");(tinymce.isWebKit||tinymce.isIE8)&&j.selection.setCursorLocation(k[0],0)}}function h(m,k){var j,n,l;if(tinymce.isGecko){l=k.getBoundingClientRect();j=m.pageX-(l.left+tinymce.DOM.getViewPort(tinymce.activeEditor.getWin()).x);n=m.pageY-(l.top+tinymce.DOM.getViewPort(tinymce.activeEditor.getWin()).y)}else{if(tinymce.isIE8){j=m.offsetX-k.offsetLeft;n=m.offsetY-k.offsetTop}else{j=m.offsetX;n=m.offsetY}}return j>=3&&j<=14&&n>=3&&n<=14}function i(j,m){var k=m.target;if(k.tagName!=="LI"){return}var l=j.dom.getParent(k,"ul,ol");if(l.tagName==="UL"&&j.dom.hasClass(l,"inline-task-list")){if(h(m,k)){if(j.dom.hasClass(k,"checked")){j.dom.removeClass(k,"checked")}else{j.dom.addClass(k,"checked")}}}}function d(k){var l=k.selection.getStart();var j=(l&&l.tagName&&l.tagName.toUpperCase()==="LI")?l:k.dom.getParent(l,"li");return j}function a(k,l){if(l.keyCode===tinymce.VK.ENTER&&!l.shiftKey){var j=d(k);if(j){var m=b(j);if(k.dom.hasClass(j.parentNode,"inline-task-list")){m.removeClass("checked").attr("data-inline-task-id","")}else{m.removeClass("checked").removeAttr("data-inline-task-id")}g(k,m)}}}function f(k,l){var j=d(k);if(j){var m=b(j);if(k.dom.hasClass(j.parentNode,"inline-task-list")){m.find("font").contents().unwrap()}}}tinymce.create("tinymce.plugins.ConfluenceTaskListPlugin",{init:function(j,k){e(j);j.onClick.add(i);j.onKeyUp.add(a);if(tinymce.isIE){j.onKeyUp.add(f)}},getInfo:function(){return{longname:"Confluence Task List Plugin",author:"Atlassian",authorurl:"http://www.atlassian.com",version:tinymce.majorVersion+"."+tinymce.minorVersion}}});tinymce.PluginManager.add("confluencetasklist",tinymce.plugins.ConfluenceTaskListPlugin);AJS.Editor.Adapter.addTinyMcePluginInit(function(j){j.plugins+=",confluencetasklist"})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-editor', location = 'js/inline-tasks-rte.js' */
(function(c){function a(e){var d=c(e).find("li[data-inline-task-id]");d.each(function(){var g=c(this),f=g.parent();if(!f.is("ul")){f.wrapInner('<ul class="inline-task-list"/>')}else{if(!f.hasClass("inline-task-list")){f.addClass("inline-task-list")}}})}function b(e){a(e);var g=AJS.Meta.get("content-type"),f=c(e).find("ul.inline-task-list"),d=f.find("> li");if(g=="comment"){d.removeClass("checked").removeAttr("data-inline-task-id");f.removeClass("inline-task-list")}else{d.attr("data-pasted-task","true")}}c(document).bind("postPaste",function(f,d,g){b(g.node)})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/de.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(b){function a(e,d,c,g){var f={m:["eine Minute","einer Minute"],h:["eine Stunde","einer Stunde"],d:["ein Tag","einem Tag"],dd:[e+" Tage",e+" Tagen"],M:["ein Monat","einem Monat"],MM:[e+" Monate",e+" Monaten"],y:["ein Jahr","einem Jahr"],yy:[e+" Jahre",e+" Jahren"]};return d?f[c][0]:f[c][1]}return b.lang("de",{months:"Januar_Februar_Mrz_April_Mai_Juni_Juli_August_September_Oktober_November_Dezember".split("_"),monthsShort:"Jan._Febr._Mrz._Apr._Mai_Jun._Jul._Aug._Sept._Okt._Nov._Dez.".split("_"),weekdays:"Sonntag_Montag_Dienstag_Mittwoch_Donnerstag_Freitag_Samstag".split("_"),weekdaysShort:"So._Mo._Di._Mi._Do._Fr._Sa.".split("_"),weekdaysMin:"So_Mo_Di_Mi_Do_Fr_Sa".split("_"),longDateFormat:{LT:"H:mm [Uhr]",L:"DD.MM.YYYY",LL:"D. MMMM YYYY",LLL:"D. MMMM YYYY LT",LLLL:"dddd, D. MMMM YYYY LT"},calendar:{sameDay:"[Heute um] LT",sameElse:"L",nextDay:"[Morgen um] LT",nextWeek:"dddd [um] LT",lastDay:"[Gestern um] LT",lastWeek:"[letzten] dddd [um] LT"},relativeTime:{future:"in %s",past:"vor %s",s:"ein paar Sekunden",m:a,mm:"%d Minuten",h:a,hh:"%d Stunden",d:a,dd:a,M:a,MM:a,y:a,yy:a},ordinal:"%d.",week:{dow:1,doy:4}})}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/es.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(c){var b="ene._feb._mar._abr._may._jun._jul._ago._sep._oct._nov._dic.".split("_"),a="ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_");return c.lang("es",{months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),monthsShort:function(d,e){if(/-MMM-/.test(e)){return a[d.month()]}else{return b[d.month()]}},weekdays:"domingo_lunes_martes_mircoles_jueves_viernes_sbado".split("_"),weekdaysShort:"dom._lun._mar._mi._jue._vie._sb.".split("_"),weekdaysMin:"Do_Lu_Ma_Mi_Ju_Vi_S".split("_"),longDateFormat:{LT:"H:mm",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY LT",LLLL:"dddd, D [de] MMMM [de] YYYY LT"},calendar:{sameDay:function(){return"[hoy a la"+((this.hours()!==1)?"s":"")+"] LT"},nextDay:function(){return"[maana a la"+((this.hours()!==1)?"s":"")+"] LT"},nextWeek:function(){return"dddd [a la"+((this.hours()!==1)?"s":"")+"] LT"},lastDay:function(){return"[ayer a la"+((this.hours()!==1)?"s":"")+"] LT"},lastWeek:function(){return"[el] dddd [pasado a la"+((this.hours()!==1)?"s":"")+"] LT"},sameElse:"L"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un da",dd:"%d das",M:"un mes",MM:"%d meses",y:"un ao",yy:"%d aos"},ordinal:"%d",week:{dow:1,doy:4}})}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/fr.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(a){return a.lang("fr",{months:"janvier_fvrier_mars_avril_mai_juin_juillet_aot_septembre_octobre_novembre_dcembre".split("_"),monthsShort:"janv._fvr._mars_avr._mai_juin_juil._aot_sept._oct._nov._dc.".split("_"),weekdays:"dimanche_lundi_mardi_mercredi_jeudi_vendredi_samedi".split("_"),weekdaysShort:"dim._lun._mar._mer._jeu._ven._sam.".split("_"),weekdaysMin:"Di_Lu_Ma_Me_Je_Ve_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd D MMMM YYYY LT"},calendar:{sameDay:"[Aujourd'hui ] LT",nextDay:"[Demain ] LT",nextWeek:"dddd [] LT",lastDay:"[Hier ] LT",lastWeek:"dddd [dernier ] LT",sameElse:"L"},relativeTime:{future:"dans %s",past:"il y a %s",s:"quelques secondes",m:"une minute",mm:"%d minutes",h:"une heure",hh:"%d heures",d:"un jour",dd:"%d jours",M:"un mois",MM:"%d mois",y:"un an",yy:"%d ans"},ordinal:function(b){return b+(b===1?"er":"")},week:{dow:1,doy:4}})}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/ja.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(a){return a.lang("ja",{months:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),monthsShort:"1_2_3_4_5_6_7_8_9_10_11_12".split("_"),weekdays:"______".split("_"),weekdaysShort:"______".split("_"),weekdaysMin:"______".split("_"),longDateFormat:{LT:"Ahm",L:"YYYY/MM/DD",LL:"YYYYMD",LLL:"YYYYMDLT",LLLL:"YYYYMDLT dddd"},meridiem:function(b,d,c){if(b<12){return""}else{return""}},calendar:{sameDay:"[] LT",nextDay:"[] LT",nextWeek:"[]dddd LT",lastDay:"[] LT",lastWeek:"[]dddd LT",sameElse:"L"},relativeTime:{future:"%s",past:"%s",s:"",m:"1",mm:"%d",h:"1",hh:"%d",d:"1",dd:"%d",M:"1",MM:"%d",y:"1",yy:"%d"}})}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/lib/lang/en-gb.js' */
(function(a){if(typeof define==="function"&&define.amd){define(["moment"],a)}else{if(typeof exports==="object"){module.exports=a(require("../moment"))}else{a(window.moment)}}}(function(a){return a.lang("en-gb",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"HH:mm",L:"DD/MM/YYYY",LL:"D MMMM YYYY",LLL:"D MMMM YYYY LT",LLLL:"dddd, D MMMM YYYY LT"},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(e){var c=e%10,d=(~~(e%100/10)===1)?"th":(c===1)?"st":(c===2)?"nd":(c===3)?"rd":"th";return e+d},week:{dow:1,doy:4}})}));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/inline-tasks-util.js' */
(function(a){var b=window.Confluence||{};b.InlineTasks=b.InlineTasks||{};b.InlineTasks.Util={NODE_TYPE:{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12},KEY:{BACKSPACE:8,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,INS:45,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESCAPE:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46,META:91},addContentEditableIfApplicable:function(d){var c=a(d);c.attr({contenteditable:false,"class":"non-editable",onselectstart:"return false;"});tinymce.isIE&&c.attr({contenteditable:true,unselectable:"on",oncontrolselect:"return false;"})}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:date-helper-js-resources', location = '/js/dateutil.js' */
var Confluence=window.Confluence||{};Confluence.InlineTasks=Confluence.InlineTasks||{};Confluence.InlineTasks.DateUtil=(function(b,a){a={PATTERN_INSERTING:"DD-MM-YYYY",PATTERN_LOZENGE:"DD MMM YYYY",PATTERN_INSIDE_TIME_ELE:"YYYY-MM-DD",convertDateIntoHtml:function(e,f,g,h){if(!h){h=a.PATTERN_INSERTING}if(!g){g=""}if(!f){f="<time>"}var c=b("<div>"),d="",i=e.format(h);if(f.indexOf("time")>=0){d=b(f,{datetime:e.format(a.PATTERN_INSIDE_TIME_ELE)});Confluence.InlineTasks.Util.addContentEditableIfApplicable(d);g&&d.attr("class",g);d.text(i)}else{d=b(f);g&&d.attr("class",g);d.text(i)}c.append(d);return c.html()},insertDateIntoCurrentCursor:function(f,d,l,k,m){var i=tinyMCE.activeEditor,j=a.convertDateIntoHtml(f,d,l,k),e=b(j,i.getDoc())[0],g=tinymce.confluence.NodeUtils.replaceSelection(e);if(m){i.execCommand("mceInsertContent",false,m,{skip_undo:true})}var c=b(i.selection.getRng(true).startContainer).closest("li[data-inline-task-id]").length?"task":"page";var h={context:c,trigger:"character"};AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.added",data:h});return g},parse:function(d,e){if(!e){e=a.PATTERN_INSIDE_TIME_ELE}var c=moment(b.trim(d),e,true);return c.isValid()?c:null},format:function(c,d){if(!d){d=a.PATTERN_INSIDE_TIME_ELE}return c?c.format(d):null},guessPartialDate:function(c,g){if(c==null){return null}c=b.trim(c.replace(/[-\.\/]/g,"-"));var f=c.split("-"),e=moment().format(g).split("-");for(var d=0;d<3;d++){if(!f[d]){f[d]=e[d]}if(/^\d$/.test(f[d])){f[d]="0"+f[d]}}return a.parse(f.join("-"),g)},datepicker:{POSITION_ABOVE:true,POSITION_BELOW:false,POSITION_RIGHT:true,POSITION_LEFT:false,dropDownStillFitsVertically:function(d,e,c){if(d===this.POSITION_ABOVE){return e.above>=c}return e.below>=c},dropDownStillFitsHorizontally:function(d,e,c){if(d===this.POSITION_RIGHT){return e.right>=c}return e.left>=c},getPreferredHorizontalPosition:function(d,c){if(d.right>=c){return this.POSITION_RIGHT}else{if(d.left>=c){return this.POSITION_LEFT}}return d.right>d.left?this.POSITION_RIGHT:this.POSITION_LEFT},getPreferredVerticalPosition:function(d,c){if(d.below>=c){return this.POSITION_BELOW}else{if(d.above>=c){return this.POSITION_ABOVE}}return d.below>d.above?this.POSITION_BELOW:this.POSITION_ABOVE},calculateDatepickerPosition:function(c){var d=this;return function(f,o){var l,p,r,i,j,s=16,u=0,e,h,k,m,n=AJS.Rte.getEditorFrame();AJS.Position.spaceLeftRight=function(z,y){var x=y.position().left;return{left:x,right:b(z).width()-x}};l=AJS.Position.spaceAboveBelow(n,c);p=AJS.Position.spaceLeftRight(n,c);j=AJS.Rte.Content.offset(c);e=f.outerHeight(true);h=f.outerWidth(true);k=e+s;m=h+u;var w=d.POSITION_BELOW;var v=d.POSITION_RIGHT;if(w){if(!d.dropDownStillFitsVertically(w,l,k)){w=null}}if(!w){w=d.getPreferredVerticalPosition(l,k)}if(v){if(!d.dropDownStillFitsHorizontally(v,p,k)){v=null}}v=d.getPreferredHorizontalPosition(p,m);if(w===d.POSITION_ABOVE){r=j.top-e-s}else{r=j.top+c.height()+s}if(v===d.POSITION_RIGHT){i=j.left-u}else{i=(j.left+c.outerWidth())-h}var t={top:r,left:i};var g=(v==d.POSITION_RIGHT)?c.outerWidth()/2:h-c.outerWidth()/2;if((g<0)||(g>h)){g=(h/10)}var q={left:g,top:(w===d.POSITION_ABOVE)?e:-s/2};return{displayAbove:w,popupCss:t,arrowCss:q}}},getHintTextOfDatePicker:function(c){return c?"Select a due date for this task.":"Select a date."},create:function(k){var j=k.$attachTo,d=k.$positionTo,c=k.startDate,i=k.onSelect,e=k.isSetDueDate;var h=b("<input>").attr("type","date").addClass("aui-date-picker").css("display","none");var g=h.datePicker({overrideBrowserDefault:true,dateFormat:"yy-mm-dd",languageCode:AJS.Meta.get("user-locale")&&AJS.Meta.get("user-locale").split("_")[0],position:this.calculateDatepickerPosition(d),onSelect:function(l){i(a.parse(l));f()},hint:this.getHintTextOfDatePicker(e)});var f=function(){g&&g.destroyPolyfill&&g.destroyPolyfill();h&&h.remove();b(".aui-datepicker-dialog").remove();g=null;h=null};g.show();g.setDate(a.format(c));b(".aui-datepicker-dialog .aui-datepicker-hint").addClass(e?"set-duedate":"set-date");j.before(h);return{die:function(){f()},show:function(){g.show()},hide:function(){g.hide()},getContainer:function(){return h},setDate:function(m){var l=a.guessPartialDate(m,a.PATTERN_INSERTING);AJS.debug("Set date: "+m);l&&g.setDate(a.format(l))},placeDatePicker:function(){var m=AJS.InlineDialog.current;var l=m&&m.popup;l&&l.refresh()}}}}};return a}(AJS.$,Confluence.InlineTasks.DateUtil||{}));AJS.toInit(function(){var b=function(g,d,f){if(d&&d.toLowerCase()==="en_us"){return"MM"+f+"DD"+f+"YYYY"}var e=_.uniq(g.replace(/[^MDY]/g,"").split(""));return e.join(f).replace("D","DD").replace("M","MM").replace("Y","YYYY")};var c=AJS.Meta.get("user-locale");if(c){moment.lang(c.split("_")[0].toLowerCase())}var a=AJS.Meta.get("user-date-pattern");if(a){Confluence.InlineTasks.DateUtil.PATTERN_LOZENGE=a.toUpperCase();Confluence.InlineTasks.DateUtil.PATTERN_INSERTING=b(a.toUpperCase(),c,"-");Confluence.InlineTasks.DateUtil.PATTERN_INSERTING_ALTERNATE=b(a.toUpperCase(),c,"/")}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete-help-dialog.js' */
AJS.toInit(function(){if(!(Confluence.KeyboardShortcuts&&Confluence.KeyboardShortcuts.Autoformat)){return}Confluence.KeyboardShortcuts.Autoformat.push({action:"//",context:"autoformat.autocomplete",description:"Date"})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/autocomplete-manager.js' */
(function(d){var e=window.Confluence||{};e.Editor=e.Editor||{};e.Editor.AutoComplete=e.Editor.AutoComplete||{};var b=e.InlineTasks.Util.KEY,a=e.InlineTasks.DateUtil,c=e.Editor.AutoComplete;c.SETTING_DEFAULT={leadingChar:"",isDataValid:function(f){return false},backWords:0,onBeforeDie:function(){},onAfterStart:function(){},onScroll:function(){}};c.Manager=function(f){this.ed=AJS.Rte.getEditor();this.settings=d.extend({},c.SETTING_DEFAULT,f);this.log=AJS.debug;this.control=null};c.Manager.prototype={start:function(f){this.log("startAutoComplete - Started");var g=d.extend({},this.settings,f);this.control=e.Editor.Autocompleter.Control(this.ed,g);if(!this.control){return false}this.attachEventsToControl();g.onAfterStart&&g.onAfterStart({date:f.date,isTriggerFromOrphan:f.isTriggerFromOrphan?true:false});return true},attachEventsToControl:function(){var i=this,l=i.control,h=i.log,g=i.settings;if(typeof this.settings.onBeforeDie==="function"){var k=this.control.die;this.control.die=function(){i.settings.onBeforeDie.apply(i.control,arguments);if(i.dateInserted()){k.apply(i.control,[true]);AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.killed"})}else{k.apply(i.control,arguments)}}}var f=_.bind(_.throttle(i.settings.onScroll,40),this);var j={onBeforeKey:function(m,n){if(m.keyCode!==b.ESCAPE&&m.keyCode!==b.ENTER){i.control&&i.control.getContainer().addClass("isDirty")}if(m.keyCode===b.DOWN||m.keyCode===b.UP||m.keyCode===b.ENTER){tinymce.dom.Event.cancel(m);return false}if(m.keyCode===b.ESCAPE||m.keyCode===b.TAB||m.keyCode===b.BACKSPACE&&!n){h("autoCompleteControl.onBeforeKey - killing autoCompleteControl");this.die(m.keyCode===b.BACKSPACE);return false}return true},onKeyPress:function(p,q){var n=AJS.$.browser.msie?p.keyCode:p.which;if(p.keyCode===b.ENTER){tinymce.dom.Event.cancel(p);return false}var o=String.fromCharCode(n),m=AJS.indexOf(this.settings.endChars,o);if(m>=0){h("autoCompleteControl.onKeyPress - caught autocomplete-closing char - character");l.die()}return true},onAfterKey:function(o,p){var n=d("#autocomplete-trigger",i.control.getContainer()),m=n.text();if(n.length>0&&m!==i.settings.leadingChar){h("after","dying because of: trigger text is modified");i.reset();return false}if(o.keyCode===b.ENTER){if(g.isDataValid(p)){l.update(p)}else{h("autoCompleteControl.onAfterKey - closing autocomplete due to invalid data - "+p);l.die(false)}return false}if(i.dateInserted()&&(p.length>10)&&(!a.parse(p,[a.PATTERN_INSERTING,a.PATTERN_INSERTING_ALTERNATE]))){i.reset();return false}if(o.keyCode===b.SPACE){i.reset();return false}return true},onDeath:function(){i.reset()},onScroll:function(){if(!i.isAlive()){return}f()}};d.extend(l,j)},isAlive:function(){return this.control&&!this.control.dying},reset:function(){if(!this.control){return}this.control.die();this.control=null},dateInserted:function(f){if(f===true){return this.control.getContainer().addClass("hasDateInserted")}else{if(f===false){return this.control.getContainer().removeClass("hasDateInserted")}else{return this.control.getContainer().hasClass("hasDateInserted")}}},dirty:function(f){if(f===true){return this.control.getContainer().addClass("isDirty")}else{return this.control.getContainer().hasClass("isDirty")}},reattach:function(){var f=e.Editor.Autocompleter.Control.removeOrphanedControl();if(f&&f.leadingChar===this.settings.leadingChar){this.reset();return this.start({backWords:1,isTriggerFromOrphan:true})}return false}}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:editor-autocomplete-date-js', location = '/js/editor-plugin/date-autocomplete.js' */
(function(h,e){var q="dateautocomplete",m="tinymce.plugins.DateAutocomplete",p="mceConfInsertDateAutocomplete",k="//";var r=Confluence.InlineTasks.Util,n=r.NODE_TYPE,d=r.KEY,a=Confluence.InlineTasks.DateUtil,g=null,o=null,b=false,i=e.dom.TreeWalker;var j={initDateAutoCompleteObject:function(s){if(!Confluence.Editor.Autocompleter){Confluence.Editor.Autocompleter=e.confluence.Autocompleter}Confluence.Editor.Autocompleter.Settings[k]={ch:k,endChars:[],update:function(w,v){o.picker.die();var u=(v==a.PATTERN_INSERTING.toLowerCase())?moment():a.guessPartialDate(v,a.PATTERN_INSERTING);u&&a.insertDateIntoCurrentCursor(u,"<time>","",a.PATTERN_LOZENGE,"&nbsp;");if(o.dateInserted()){AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.used"})}o.reset();s.undoManager.add()}};var t={leadingChar:k,isDataValid:function(u){return !o.dirty()||a.guessPartialDate(u,a.PATTERN_INSERTING)!=null},onBeforeDie:function(){o.picker&&o.picker.die();if(o.control){var u=h(o.control.getContainer());if(!o.dirty()){u.find("#autocomplete-search-text").remove()}}},onAfterStart:function(v){if(v&&v.date){j.fillPlaceholderDateAutoComplete(s,v.date,true);o.dirty(true);o.dateInserted(true)}else{if(v&&!v.isTriggerFromOrphan){j.fillPlaceholderDateAutoComplete(s,a.PATTERN_INSERTING.toLowerCase(),false);o.dateInserted(false)}}var u=o.control.text();var w=a.guessPartialDate(u,a.PATTERN_INSERTING)||moment();j.bindDatePickerToAutoComplete(w)},onScroll:function(){o.picker&&o.picker.placeDatePicker()}};o=new Confluence.Editor.AutoComplete.Manager(t)},activateDateAutocomplete:function(u,t){if(!o.isAlive()){var s=o.start(t);if(!s){g.execCommand("mceInsertContent",false,k,{skip_undo:true});return false}}},bindDatePickerToAutoComplete:function(v){var s=o.control&&o.control.getContainer();if(!s.length){return}s.addClass("date-autocomplete");s.find("#autocomplete-search-text span").addClass("inserting");var u=function(w){o.control.update(w.format(a.PATTERN_INSERTING))},t=j.isInsideTaskAndFirstTimeNode(s);o.picker=a.datepicker.create({$attachTo:s,$positionTo:s,startDate:v,onSelect:u,isSetDueDate:t})},fillPlaceholderDateAutoComplete:function(t,w,v){var s=o.control.getContainer().find("#autocomplete-search-text span");s.text(AJS.Rte.HIDDEN_CHAR+w);var u=t.dom.createRng();u.setStart(s[0].firstChild,1);u.setEnd(s[0].firstChild,w.length+1);v&&u.collapse(false);t.selection.setRng(u)},autocompleteDoubleSlash:function(x,w){var u=w.handlerManager,t=w.ed,v=w.createHandler;var s=v(/(?:\s|\xA0|^|\ufeff|\u200b)(\/)$/,function(){t.execCommand(p,false,{},{skip_undo:true})},true,"#autocomplete");u.registerHandler("/".charCodeAt(0),s)},registerTriggerDoubleSlash:function(s){s.addCommand(p,j.activateDateAutocomplete);AJS.bind("confluence.editor.registerHandlers",this.autocompleteDoubleSlash)},isTimeNode:function(s){return s&&s.nodeType===n.ELEMENT_NODE&&s.tagName.toLowerCase()==="time"},getTimeNodeAtCursor:function(s){if(!s){s=g}var t=s.selection.getNode();if(j.isTimeNode(t)){return t}t=s.selection.getStart();if(j.isTimeNode(t)){return t}t=s.selection.getEnd();if(j.isTimeNode(t)){return t}},makeTimeNodesUnEditable:function(s){s.each(function(){var t=h(this);if(h.trim(t.text())===""){t.remove()}e.isWebKit&&t.remove("br.Apple-interchange-newline");r.addContentEditableIfApplicable(this)})},wrapTimeNodesWithHiddenChar:function(s){s.each(function(){var t=h(this);if(!this.previousSibling||this.previousSibling.nodeType!==n.TEXT_NODE||this.previousSibling.nodeValue===""){t.before(AJS.Rte.HIDDEN_CHAR)}if(!this.nextSibling||this.nextSibling.nodeType!==n.TEXT_NODE||this.previousSibling.nodeValue===""){t.after(AJS.Rte.HIDDEN_CHAR)}})},putCursorAtEdge:function(t,v,s){s=!!s;if(s){if(!v.nextSibling||v.nextSibling.nodeType!==n.TEXT_NODE){h(v).after(t.dom.doc.createTextNode(""))}}else{if(!v.previousSibling||v.previousSibling.nodeType!==n.TEXT_NODE){h(v).before(t.dom.doc.createTextNode(""))}}var u=t.selection.dom.createRng();u.selectNode(s?v.nextSibling:v.previousSibling);u.collapse(s);t.selection.setRng(u)},findFirstTimeNodeInClosestBlock:function(t,y,v){var x=new i(y,t.getBody());var w=y,u=0;do{if(u==1&&j.isTimeNode(y)){return y}var s=v?y.previousSibling:y.nextSibling;if(y!==w&&s&&(t.dom.isBlock(y)||t.dom.isBlock(s))){u++}}while((y=v?x.next():x.prev())&&u<2)},findFirstTimeNodeNearby:function(s,w,t){var v=w;var u=new i(w,s.getBody());do{if(j.isTimeNode(w)){return w}if(s.dom.isBlock(w)||(w!==v&&w.nodeType===n.TEXT_NODE&&w.nodeValue!=="")){return}}while(w=t?u.next():u.prev())},convertInvalidTimeNodeToPlainText:function(s){s.each(function(){var v=h(this);var t=v.attr("datetime");var u=a.parse(t);if(!u){v.before(v.text());v.remove()}})},isInsideTaskAndFirstTimeNode:function(t){var s=h(t),u=s.closest("ul.inline-task-list > li[data-inline-task-id]");if(!u.length){return false}return u.find("time, span.date-autocomplete")[0]===s[0]}};var c={handleRemoveDateLozenge:function(t,z){var y=z.keyCode;if(y!==d.BACKSPACE&&y!==d.DELETE){return}var w=(y===d.DELETE),s=t.selection.getRng(true),u=s.startContainer,v=u;if(u.nodeType==n.TEXT_NODE&&(w?s.startOffset!=u.nodeValue.length:s.startOffset!=0)){return}if(u.nodeType===n.ELEMENT_NODE){if(w){v=(u.childNodes.length===s.startOffset)?u:u.childNodes.item(s.startOffset)}else{v=(s.startOffset===0)?u:u.childNodes.item(s.startOffset-1)}}var x=j.findFirstTimeNodeNearby(t,v,w);x&&t.dom.remove(x)},handleClickingDateLozenge:function(x,A){var u=h(A.target);if(!u.is("time")){return}var s=(u.closest("li[data-inline-task-id]").length)?"task":"page";var v={mode:"editor",context:s};AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.clicked",data:v});var D=u.closest("body");var z=function(){AJS.Rte.unbindScroll("date-lozenge-date-picker");y.die()};D.one("keydown click",z);var C=function(F){var G=F.format(a.PATTERN_INSIDE_TIME_ELE);var E=F.format(a.PATTERN_LOZENGE);if(G!==u.attr("datetime")){var H={context:s};AJS.trigger("analyticsEvent",{name:"confluence-spaces.date.changed",data:H})}u.attr("datetime",G);u.text(E);D.unbind("keydown click",z)};var t=a.parse(u.attr("datetime")),w=j.isInsideTaskAndFirstTimeNode(u),y=a.datepicker.create({$attachTo:u,$positionTo:u,startDate:t,onSelect:C,isSetDueDate:w});var B=_.bind(_.throttle(function(){if(y&&AJS.Rte.isAnyPartShown(u)){y.placeDatePicker()}else{z()}},40),this);AJS.Rte.bindScroll("date-lozenge-date-picker",B)},handleTypingDate:function(t,v){var u=v.keyCode;if(u===d.UP||u===d.DOWN||u===d.LEFT||u===d.RIGHT||u===d.HOME||u===d.END||u===d.PAGEDOWN||u===d.PAGEUP||v.metaKey||v.ctrlKey||v.altKey){return}if(o.control&&o.picker){var s=o.control.text();o.picker.setDate(s)}},handleOnLoadContent:function(s){var u=h(s.dom.doc),t=u.find("time");j.makeTimeNodesUnEditable(t);j.wrapTimeNodesWithHiddenChar(t)},handlePostPaste:function(t,s,u){j.convertInvalidTimeNodeToPlainText(h(u.node).find("time"))},handlePostPasteContent:function(u,s,v){var t=h(v.node).find("time");j.makeTimeNodesUnEditable(t)},handlePrePasteContent:function(t,s,u){if(j.getTimeNodeAtCursor(g)){u.content="";return false}},fixWhenUpDownNavOnList:function(t,z){var v=z.keyCode;if(v!==d.UP&&v!==d.DOWN){return}var s=t.selection.getRng(true),u=s.startContainer,w=u,x=v===d.DOWN;if(u.nodeType===n.ELEMENT_NODE){if(x){w=(u.childNodes.length===s.startOffset)?u:u.childNodes.item(s.startOffset)}else{w=(s.startOffset===0)?u:u.childNodes.item(s.startOffset-1)}}var y=j.findFirstTimeNodeInClosestBlock(t,w,x);if(y){j.wrapTimeNodesWithHiddenChar(h(y))}},preventCursorInsideDateLozenge:function(t,s,v){var u=(v.nodeType===n.TEXT_NODE)?v.parentNode:v;if(j.isTimeNode(u)){if(b||t.selection.getRng().startOffset>1){j.putCursorAtEdge(t,u,true)}else{j.putCursorAtEdge(t,u,false)}}},handleUndoRedo:function(){o&&o.reattach()}};var f={init:function(s){j.initDateAutoCompleteObject(s);j.registerTriggerDoubleSlash(s);g=s;s.onContextMenu.add(function(){o.reset()});s.onSetContent.add(c.handleOnLoadContent);s.onClick.add(c.handleClickingDateLozenge);s.onKeyUp.add(c.handleTypingDate);if(e.isWebKit){s.onKeyDown.add(c.fixWhenUpDownNavOnList);s.onInit.add(function(){h(document).bind("postPaste",c.handlePostPasteContent)});s.onRemove.add(function(){h(document).unbind("postPaste",c.handlePostPasteContent)})}s.onKeyUp.add(function(y,A){b=(A.keyCode===d.RIGHT);var x=y.selection.getRng(true);var w=x.commonAncestorContainer;var z=!!w&&w.data;if(!!z&&!AJS.$(w).closest("pre,.text-placeholder").length){var B=String.prototype.slice.apply(z,[-11]);if((A.keyCode>=48&&A.keyCode<=57)||(A.keyCode>=96&&A.keyCode<=105)){var t=/(^| )\d{2}[\/\-]\d{2}[\/\-]\d{4}$/;var v=String.prototype.slice.apply(z,[-10]);if(t.test(z)&&a.parse(v,[a.PATTERN_INSERTING,a.PATTERN_INSERTING_ALTERNATE])){var u=x.commonAncestorContainer;x.setStart(u,x.endOffset-v.length);y.undoManager.add();y.undoManager.beforeChange();y.selection.setRng(x);y.execCommand("mceConfInsertDateAutocomplete",false,{date:v},{skip_undo:true});AJS.trigger("analyticsEvent",{name:"confluence-spaces.tasks.daterecognition.triggered"})}}}});if(e.isGecko){s.onKeyDown.add(c.handleRemoveDateLozenge);s.onInit.add(function(){h(document).bind("prePaste",c.handlePrePasteContent)});s.onRemove.add(function(){h(document).unbind("prePaste",c.handlePrePasteContent)})}if(e.isWebKit||e.isGecko){s.onNodeChange.add(c.preventCursorInsideDateLozenge)}s.onUndo.add(c.handleUndoRedo);s.onRedo.add(c.handleUndoRedo);s.onInit.add(function(){h(document).bind("postPaste",c.handlePostPaste)});s.onRemove.add(function(){h(document).unbind("postPaste",c.handlePostPaste);AJS.unbind("confluence.editor.registerHandlers",j.autocompleteDoubleSlash)})},getInfo:function(){return{longname:"Insert Date Autocomplete",author:"Atlassian",authorurl:"http://www.atlassian.com",version:e.majorVersion+"."+e.minorVersion}}};function l(){e.create(m,f);e.PluginManager.add(q,e.plugins.DateAutocomplete);AJS.Rte.BootstrapManager.addTinyMcePluginInit(function(s){s.plugins+=","+q})}l()})(AJS.$,tinymce);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-overlay', location = 'js/drag-and-drop-overlay.js' */
define("conf/confluence-drag-and-drop/drag-and-drop-overlay",["ajs","jquery"],function(h,d){var f;return{bindFileDragOverlay:function(c){var g=c.$dragZone,e=c.$overlayZone||g.eq(0),i=c.isTransparent||!1,j=c.zIndex||1;g.on("dragover",function(a){a=a.originalEvent.dataTransfer.types;if(-1!==d.inArray("Files",a)&&(!d.browser.mozilla||-1!==d.inArray("application/x-moz-file",a))){var a=!!i,b;if(!f){var c=h.DragAndDrop.Templates.dragOverlay();f=d(c)}b=f;b.parent()[0]!==e[0]&&(b.toggleClass("dnd-overlay-transparent",
a),a=getComputedStyle(e[0]),b.css({"z-index":j}),b.css({"margin-left":"-"+a.paddingLeft,"margin-top":"-"+a.paddingTop,width:e.innerWidth()+"px",height:e.innerHeight()+"px"}).prependTo(e),b.off("dragleave").on("dragleave",function(a){(!a.relatedTarget||!d.contains(b[0],a.relatedTarget))&&b.remove()}),b.off("drop").on("drop",function(){b.remove()}))}})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:image-dialog-client', location = 'js/insert-dialog-upload-controller.js' */
(function(d,c){var b=function(a){this.messageHandler=null;this.context=a;a=this.getForm();AJS.Meta.getBoolean("can-attach-files")||a.remove()};b.prototype.getForm=function(){return d("form",this.context.baseElement)};b.prototype.pack=function(){};b.prototype.displayErrors=function(a){this.getMessageHandler().displayMessages(a);a=this.getMessageHandler().getMessageContainer().find("ul");a.toggleClass("one-message",1===a.find("li").length);a.closest(".aui-message").append("<span class='aui-icon icon-warning'></span>");
this.pack()};b.prototype.clearErrors=function(){this.getMessageHandler().clearMessages();this.pack()};b.prototype.getMessageHandler=function(){this.messageHandler||(this.messageHandler=AJS.MessageHandler({baseElement:d(".aui-message",this.context.baseElement)}));return this.messageHandler};c.DragAndDrop=c.DragAndDrop||{};c.DragAndDrop.UploadClientController=b})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:image-dialog-client', location = 'js/image-dialog-client.js' */
(function(i,f){var h=function(){this._workIdToBytesUploaded={};this._totalBytes=0};h.prototype={update:function(a,b,e){a in this._workIdToBytesUploaded||(this._totalBytes+=e);this._workIdToBytesUploaded[a]=b},percentComplete:function(){var a=0;i.each(this._workIdToBytesUploaded,function(b,e){a+=e});return Math.round(100*a/this._totalBytes)}};var g=function(a){this.urlHandleUpload="/plugins/drag-and-drop/upload.action";this.pageId=parseInt(AJS.Meta.get("page-id"),10);this.draftId=parseInt(AJS.Meta.get("draft-id"),
10);this.dragAndDropEntityId=AJS.Meta.get("drag-and-drop-entity-id");this.spaceKey=AJS.Meta.get("space-key")||"";this.atlToken=AJS.Meta.get("atl-token");this.base=/^\w+:\/\/[^\/?#]+/.exec(location.href);this.metaMaxFileSize=AJS.Meta.get("global-settings-attachment-max-size");this.errors=[];this.batchProgress=new h;this.attachmentPanelComponent=a.attachmentPanelComponent;this.dropZone=a.dropZone;this.browserButtonId=a.browserButtonId;this.uploader=null;this.isUploadUsingDragAndDrop=!1;var b=this;i(this.dropZone).bind("drop",
function(){b.isUploadUsingDragAndDrop=!0})};g.prototype.createPlupload=function(){var a=this,b=new plupload.Uploader({runtimes:"html5",dragdrop:!0,drop_element:a.dropZone,browse_button:a.browserButtonId,multipart:!1,stop_propagation:!0,max_file_size:parseInt(a.metaMaxFileSize,10),inputFileClazz:"file-library-input-file"});b.init();b.bind("Started",function(e,c){a.errors=[];a.attachmentPanelComponent.clearErrors();a.batchProgress=new h;require(["conf/confluence-drag-and-drop/analytics/files-upload-analytics"],
function(e){e.triggerEvent(a.isUploadUsingDragAndDrop?"confluence.insert-files-dialog.drag-and-drop":"confluence.insert-files-dialog.upload",c);a.isUploadUsingDragAndDrop=!1})});b.bind("FilesAdded",function(e,c){function b(c,e){for(var d=0;d<e.length;d++)if(e[d].status===plupload.FAILED)c.removeFile(e[d]);else{var f=_.find(c.files,function(a){return a.name===e[d].name&&a.id!==e[d].id});f&&c.removeFile(f);a.metaMaxFileSize>e[d].size&&a.attachmentPanelComponent.addPreviewImage(e[d])}c.start()}0<c.length&&
(a.attachmentPanelComponent.getNoFileContainer().hide(),AJS.UploadUtils.filterFiles(e,c,b))});b.bind("BeforeUpload",function(e,c){var d=a.base+f.getContextPath()+a.urlHandleUpload,b={},g=c.name.substr(c.name.lastIndexOf(".")+1);a.pageId?b.pageId=a.pageId:b.draftId=a.draftId;a.dragAndDropEntityId&&(b.dragAndDropEntityId=a.dragAndDropEntityId);b.filename=c.name;b.size=c.size;b.minorEdit=!0;b.spaceKey=a.spaceKey;b.mimeType=plupload.mimeTypes[g.toLowerCase()]||AJS.DragAndDropUtils.defaultMimeType;b.atl_token=
a.atlToken;e.settings.url=plupload.buildUrl(d,b);a.batchProgress=new h});b.bind("UploadProgress",function(b,c){a.batchProgress.update(c.id,c.loaded,c.size);a.attachmentPanelComponent.setUploadInProgress(a.batchProgress.percentComplete()/100,c.id)});b.bind("FileUploaded",function(b,c,d){b.getFile(c.id)?(b=JSON.parse(d.response).data.id,a.attachmentPanelComponent.attachmentUploaded(c.id,b)):a.attachmentPanelComponent.attachmentUploadingCancelled(c.id)});b.bind("Error",function(b,c){var d="";if(c.response){try{d=
AJS.$.parseJSON(c.response).actionErrors[0]}catch(f){d=c.message}AJS.trigger("analyticsEvent",{name:"confluence.image-dialog.upload.error.server-unknown"})}else{var d=c.message,g=c.file.name;c.code===plupload.FILE_SIZE_ERROR?(d=AJS.DragAndDropUtils.niceSize(a.metaMaxFileSize).toString(),d=AJS.format("{0} is too big to upload. Files must be less than {1}.",g,d),AJS.trigger("analyticsEvent",{name:"confluence.image-dialog.upload.error.file-size"})):c.code===AJS.UploadUtils.ErrorCode.FILE_IS_A_FOLDER_ERROR&&(d=
AJS.format("Cannot upload {0} - it might be a folder or an unsupported file type.",g),AJS.trigger("analyticsEvent",{name:"confluence.image-dialog.upload.error.file-type"}))}a.attachmentPanelComponent.displayErrors([d]);a.errors.push(d)});require(["conf/confluence-drag-and-drop/drag-and-drop-overlay"],function(b){b.bindFileDragOverlay({$dragZone:i(a.dropZone),zIndex:3005})});return b};g.prototype.init=function(){this.uploader=this.createPlupload()};g.prototype.cancelUpload=function(a){(a=this.uploader.getFile(a))&&
this.uploader.removeFile(a)};if("undefined"!==typeof DragnDropSupport&&DragnDropSupport.hasXhrSupport&&f.Editor&&f.Editor.FileDialog)f.Editor.FileDialog.eventListener.on("AttachmentsPanelView.render",function(a){a.getUploaderController=function(){return new f.DragAndDrop.UploadClientController(a.context)}});AJS.toInit(function(){if(f.Editor&&f.Editor.ImageDialog){var a=f.Editor.ImageDialog.beforeShowListeners,b=f.Editor.ImageDialog.findPanelComponentById("attachments");a&&a.push(function(){if(b){var a=
b.getPanelElement();if(a.length&&"undefined"!==typeof DragnDropSupport&&DragnDropSupport.hasXhrSupport&&AJS.Meta.getBoolean("can-attach-files")){var c=new g({dropZone:a[0],browserButtonId:"upload-files-button",attachmentPanelComponent:b});c.init();f.Editor.FileDialog.eventListener.on("uploadingfile.cancelled",function(a){c.cancelUpload(a)})}}else AJS.debug("Do not support Attachment Panel and Drag-Drop in Insert Image Dialog (ex: in creating Template)")})}});f.DragAndDrop=f.DragAndDrop||{};f.DragAndDrop.UploadClient=
g})(AJS.$,Confluence||{});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-tip', location = 'js/drag-and-drop-tip.js' */
AJS.toInit(function(b){function f(c,a){"true"===a&&(c.append(AJS.DragAndDrop.Templates.dragAndDropTip()),c.find(".attach-tip-discovery .close-tip").on("click",function(a){a.preventDefault();b(this).closest(".attach-tip-discovery").remove();c.sizeToFit();b.ajax({url:Confluence.getContextPath()+"/rest/drag-and-drop/1/tip/disable",type:"POST",dataType:"json",success:function(){d.setItem(e,!1)}})}))}var e="show-drag-and-drop-tip",d=Confluence.storageManager("confluence-editor");Confluence.Editor.ImageDialog.beforeShowListeners.push(function(){var c=
b("#attached-files");if(AJS.Meta.getBoolean("can-attach-files")&&AJS.DragAndDropUtils.hasXhrSupport){var a=d.getItem(e);null===a?b.ajax({url:Confluence.getContextPath()+"/rest/drag-and-drop/1/tip/setting",dataType:"json",success:function(b){a=(!1!==b).toString();d.setItem(e,a);f(c,a)}}):f(c,a)}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-editor', location = 'js/editor.js' */
require(["ajs","jquery","conf/confluence-drag-and-drop/analytics/files-upload-analytics","conf/confluence-drag-and-drop/drag-and-drop-overlay"],function(a,q,n,o){a.toInit(function(l){var e,p=/^\w+:\/\/[^\/?#]+/.exec(location.href),m=!1;a.Rte.BootstrapManager.addOnInitCallback(function(){var j=a.Rte.getEditor().getBody().parentNode;a.DragAndDropUtils.init(function(i){if(i){var i=document.getElementById("fileuploadShim"),k=!1;i||(i=document.createElement("div"),i.setAttribute("id","fileuploadShim"),
document.body.appendChild(i));jQuery.browser.mozilla&&-1<jQuery.browser.version.indexOf("1.9.2")&&j.addEventListener("drop",function(a){a.stopPropagation()},!1);var c=new plupload.Uploader({runtimes:"html5",dragdrop:!0,drop_element:j,browse_button:i.getAttribute("id"),multipart:!1,max_file_size:+a.Meta.get("global-settings-attachment-max-size")});e||(e=new a.DragAndDropProgressDialog);c.init();c.bind("Started",function(a,b){n.triggerEvent("confluence.editor.files.drag-and-drop",b)});c.bind("FilesAdded",
function(h,b){a.UploadUtils.filterFiles(h,b,function(a,b){for(var d=0;d<b.length;d++){var h=b[d];h.status!==plupload.FAILED&&e.render({workId:h.id,status:h.status,file:h})}c.start()})});c.bind("BeforeUpload",function(h,b){if(a.Meta.get("content-type")==="template"){h.stop();if(!m){var f=new a.Dialog(450,180);f.addHeader("Not Supported");f.addSubmit("Ok",function(){f.remove()});f.addPanel("Panel 1","panel1");f.getCurrentPanel().html("\u003cp\u003eAttachments are not supported in Templates.\u003c/p\u003e \u003cp\u003eFiles may be attached to a Page, and added as an image via the Insert menu.\u003c/p\u003e");
f.show();m=true}}else{var g=p+Confluence.getContextPath()+"/plugins/drag-and-drop/upload.action",d={},c=a.Meta.get("page-id");if(c)d.pageId=c;var i=a.Meta.get("draft-id");if(c==0&&i>0)d.draftId=i;if(c=a.Meta.get("drag-and-drop-entity-id"))d.dragAndDropEntityId=c;c=b.name.substr(b.name.lastIndexOf(".")+1);d.filename=b.name;d.size=b.size;d.minorEdit=true;d.spaceKey=a.Meta.get("space-key")||"";d.mimeType=plupload.mimeTypes[c.toLowerCase()]||a.DragAndDropUtils.defaultMimeType;d.atl_token=a.Meta.get("atl-token");
d.contentType=a.Meta.get("content-type");d.isVFMSupported=!!a.MacroBrowser.getMacroMetadata("view-file");h.settings.url=plupload.buildUrl(g,d);e.cancelListeners.push(function(b,c){var d=h.getFile(c.workId);d&&h.removeFile(d);e.renderInfo(c.workId,"File was manually removed from the queue.")});e.show()}});c.bind("UploadProgress",function(a,b){e.renderUpdateToBytesUploaded(b.id,b.loaded,b.size);e.hideCloseButton()});l.browser.mozilla&&plupload.addEvent(j,"dragenter",function(a){k=a.rangeParent&&
a.rangeOffset!=void 0?{startElement:a.rangeParent,startOffset:a.rangeOffset}:false});c.bind("FileUploaded",function(c,b,f){if(f.status){if(f.response)try{var g=a.$.parseJSON(f.response);k&&l(k.startElement.parentNode).closest('[contenteditable="true"]',j).length&&tinymce.activeEditor.selection.setCursorLocation(k.startElement,k.startOffset);g.htmlForEditor.substr(0,4)==="<img"?tinymce.confluence.ImageUtils.insertImagePlaceholder(g.htmlForEditor):a.Rte.getEditor().execCommand("mceInsertContent",false,
g.htmlForEditor,{skip_focus:true})}catch(d){a.log("FileUploaded threw an exception "+d)}e.renderComplete(b.id)}else e.renderError(b.id,"The server is not responding. Please check that it is running.")});c.bind("Error",function(c,b){var f,g;if(b.response){try{f=a.$.parseJSON(b.response);g=f.actionErrors[0]}catch(d){g=d.name==="SyntaxError"?"Invalid response received from the server.":b.message}e.renderError(b.file.id,g);a.trigger("analyticsEvent",{name:"confluence.editor.upload.error.server-unknown"})}else{g=
b.message;if(b.code===plupload.FILE_SIZE_ERROR){g=a.format("is too big to upload. Files must be less than {0}.",a.DragAndDropUtils.niceSize(a.Meta.get("global-settings-attachment-max-size")));a.trigger("analyticsEvent",{name:"confluence.editor.upload.error.file-size"})}else if(b.code===a.UploadUtils.ErrorCode.FILE_IS_A_FOLDER_ERROR){g="might be a folder or an unsupported file type.";a.trigger("analyticsEvent",{name:"confluence.editor.upload.error.file-type"})}e.render({workId:b.file.id,status:b.file.status,
file:b.file,errorMessage:g});if(!e.isVisible()){e.show();e.showCloseButton()}}});c.bind("UploadComplete",function(){if(!c.total.queued){c.stop();e.showCloseButton();e.hasErrors()||setTimeout(function(){e.hide();e.clearRenderOutput();a.Rte.BookmarkManager.restoreBookmark()},1E3)}});a.Confluence.Uploader=c;a.Confluence.EditorUploadProgressDialog=e;o.bindFileDragOverlay({$dragZone:l(j).add("#toolbar ~ #editor-precursor"),$overlayZone:l("#rte"),isTransparent:!0})}})})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drag-and-drop-for-editor', location = 'js/link-dialog-drop-zone.js' */
AJS.toInit(function(a){AJS.bind("dialog-shown.link-browser",function(){a.browser.msie||AJS.DragAndDropUtils.bindDrop(a("#insert-link-dialog")[0],function(a){a.preventDefault();a.stopPropagation()})})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.drag-and-drop:drop-zone-for-image-dialog', location = 'js/image-dialog-drop-zone.js' */
AJS.toInit(function(b){if(AJS.DragAndDropUtils.hasXhrSupport)if(AJS.Meta.get("remote-user")){var c=Confluence.Editor.ImageDialog.findPanelComponentById("attachments");c?b(c).bind("afterThumbnail",function(c,d){if(!d.find(".image-dialog-drop-zone-container").length){var e=b("<li/>").addClass("attached-image"),a=b("<div/>").addClass("image-dialog-drop-zone-container image-container");b("<div/>").addClass("drop-zone-image").attr("title","Drop files here to attach them").appendTo(a);b("<div/>").addClass("drop-zone-text").text("Drop Here").appendTo(a);
a.appendTo(e);d.prepend(e);b.browser.msie||(AJS.DragAndDropUtils.bindDragEnter(a[0],function(){a.addClass("drop-zone-on-hover")}),AJS.DragAndDropUtils.bindDragOver(a[0],function(){a.addClass("drop-zone-on-hover")}),AJS.DragAndDropUtils.bindDragLeave(a[0],function(){a.removeClass("drop-zone-on-hover")}))}}):AJS.log("Skipping image attachment drop-zone - no Image Dialog attachment panel")}else AJS.debug("Skipping image attachment drop-zone for anonymous user creating new content");else AJS.debug("Browser doesn't have XHR upload support. Skipping image dialog drop zone..")});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-comments:strip-inline-comment-marker', location = 'editor/paste-handler.js' */
(function(a){AJS.bind("init.rte",function(){a(document).unbind("postPaste",b).bind("postPaste",b);tinymce.activeEditor&&tinymce.activeEditor.onRemove.add(function(){a(document).unbind("postPaste",b)});function b(d,e,c){if(c&&c.node){a(".inline-comment-marker",c.node).contents().unwrap()}}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.profile-picture:profile-picture-editor_resources', location = 'js/profile-picture.js' */
AJS.bind("init.rte", function() {
    AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("viewProfile", function(e, macroNode) {
        var $macroDiv = AJS.$(macroNode);

        var params = {};
        if ($macroDiv.attr("data-macro-parameters")) {
            AJS.$.each($macroDiv.attr("data-macro-parameters").split("|"), function(idx, item) {
                var param = item.split("=");
                params[param[0]] = param[1];
            });
        }
        window.open(AJS.Confluence.getBaseUrl() + "/display/~" + params["user"]);
    });
});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = 'templates/view-file-macro-editor.soy' */
// This file was automatically generated from view-file-macro-editor.soy.
// Please don't edit this file by hand.

if (typeof Confluence == 'undefined') { var Confluence = {}; }
if (typeof Confluence.ViewFileMacro == 'undefined') { Confluence.ViewFileMacro = {}; }
if (typeof Confluence.ViewFileMacro.Templates == 'undefined') { Confluence.ViewFileMacro.Templates = {}; }
if (typeof Confluence.ViewFileMacro.Templates.Editor == 'undefined') { Confluence.ViewFileMacro.Templates.Editor = {}; }


Confluence.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="view-file-property-panel-header"><span class="file-name"><span class="aui-icon aui-icon-small ', soy.$$escapeHtml(opt_data.fileIcon), '"></span>', soy.$$escapeHtml(opt_data.fileName), '</span></div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-properties-panel.js' */
define("vfm/components/view-file-macro-properties-panel",["jquery","underscore","ajs","confluence","confluence/jsUri","tinymce","vfm/view-file-macro-utils",],function(d,x,f,l,m,b,r){var t="view-file";var a="macro-placeholder-property-panel-edit-button";var y="macro-placeholder-property-panel-remove-button";var c="placeholder/unknown-attachment";var i="data-macro-parameters";var q={"view-file-size-small":"150","view-file-size-medium":"250","view-file-size-large":"400"};var h=[{className:"macro-property-panel-view-file-size-small",text:"",tooltip:"Small thumbnail",click:j},{className:"macro-property-panel-view-file-size-medium",text:"",tooltip:"Medium thumbnail",click:j},{className:"macro-property-panel-view-file-size-large",text:"",tooltip:"Large thumbnail",click:j},null,{className:"macro-property-panel-view-file-convert-to-link",text:"Show as link",tooltip:"Show as link",click:g}];function u(E,B){var F=x.find(Object.keys(q),function(G){return q[G]===B});if(F){for(var A=0,D=E.length;A<D;A++){var z=E[A];var C=z.className.replace(" selected","");if(C.indexOf("macro-property-panel-"+F)!==-1){C+=" selected"}z.className=C}}}function s(A){var B=x.reject(A,function(C){return C.className.indexOf(a)>-1||C.className.indexOf(y)>-1});A.splice(0,A.length);for(var z=0;z<B.length;z++){A.push(B[z])}}function k(A,z){var B=d(A);B.attr("height",z);var C=B.attr("src");if(o(C)){B.attr("src",p(B.attr("src"),z));B.attr("data-mce-src",p(B.attr("data-mce-src"),z));if(b.isGecko){f.Rte.getEditor().execCommand("mceRepaint",false)}}v(B,z);b.activeEditor.undoManager.add()}function o(z){return(z!=null&&z.indexOf("/servlet/view-file-macro/placeholder")>=0)}function p(B,z){var A=new m(B);if(A.getQueryParamValue("height")!==""){A.replaceQueryParam("height",z)}return A.toString()}function w(C){var z=C.attr(i);var D=[];var A="";for(var B=0;B<z.length;B++){var E=z[B];if(E==="\\"){A+=E;if(B+1!==z.length){A+=z[++B]}}else{if(E==="|"){D.push(A);A=""}else{A+=E}}}D.push(A);return D}function v(C,A){var B="height="+A;var E=w(C);var D=e(C,"height");if(D){var z=x.indexOf(E,"height="+D);E[z]=B}else{E.push(B)}C.attr(i,E.join("|"))}function e(B,z){var C=w(B);var A=x.find(C,function(D){return(D.indexOf(z+"=")>=0)});return A?A.split("=")[1]:null}function j(B,z){if(d(B).attr("class").indexOf("selected")!==-1){return}f.Confluence.PropertyPanel.destroy();var C=Object.keys(q);var D=d(B).attr("class");for(var A=0;A<C.length;A++){if(D.indexOf(C[A])!==-1){k(z,q[C[A]]);d(z).click();f.trigger("analyticsEvent",{name:"confluence.view-file.resize."+C[A].substring(C[A].lastIndexOf("-")+1,C[A].length)});return}}}function g(B,z){f.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-link-trigger"});f.Confluence.PropertyPanel.destroy();A(z);function A(C){var E=r.getParameterByName(d(C).attr("src"),"attachmentId");var D=f.REST.makeUrl("attachment/"+E+".json");d.ajax({type:"GET",url:D,contentType:"application/json; charset=utf-8",dataType:"json"}).success(function(H){var F=l.Link.fromREST(H);var G=F.insert();b.activeEditor.undoManager.add();b.activeEditor.focus();G.click()})}}function n(){f.bind("created.property-panel",function(I,G){var J=d(G.anchor);var C=J.attr("data-macro-name");if(C!==t){return}var D=l.ViewFileMacro.Templates.Editor.viewFilePropertyPanelHeader;var E=e(J,"name");var B=r.getParameterByName(J.attr("src"),"mimeType");var A=f.Confluence.FileTypesUtils.getAUIIconFromMime(B);var z=d(D({fileName:E,fileIcon:A}));d(G.panel).find(".aui-property-panel").prepend(z);if(G.shouldFlip){var F=d(G.panel).find(".aui-tip-parent");var H=parseInt(F.css("top"),10);F.css("top",H+z.outerHeight(true))}})}return{init:function(){f.Confluence.PropertyPanel.Macro.registerInitHandler(function(G,D,z){s(D);var E=d(G);var B=E.attr("data-mce-src");if(B&&B.indexOf(c)>-1){return}for(var A=0,C=h.length;A<C;A++){D.push(h[A])}var F=E.attr("height");if(!F){F=(f.Meta.get("content-type")==="comment")?r.DEFAULT_HEIGHT_IN_COMMENT:r.DEFAULT_HEIGHT}u(D,F)},t);n()}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/view-file-macro-link-properties-panel.js' */
define("vfm/components/view-file-macro-link-properties-panel",["jquery","ajs","tinymce","vfm/view-file-macro-utils"],function(g,b,e,a){var c="view-file";function f(h){if(h){var k=g(h);var i=k.attr("data-linked-resource-type");var j=k.attr("data-linked-resource-content-type");return b.MacroBrowser.getMacroMetadata(c)&&i==="attachment"&&!(j&&j.indexOf("image")===0)}return false}function d(h){var i=b.REST.makeUrl("attachment/"+g(h).attr("data-linked-resource-id")+".json");g.ajax({type:"GET",url:i,contentType:"application/json; charset=utf-8",dataType:"json"}).success(function(k){var n={name:k.fileName};if(b.Data.get("content-id")!==k.ownerId){n.page=k.parentTitle;n.space=k.space.key;if(k.parentContentType==="blogpost"){var l=k.createdDate.date.split("-");n.date=l[0]+"/"+l[1]+"/"+l[2].substring(0,2)+"/"}}n.height=(b.Meta.get("content-type")==="comment")?a.DEFAULT_HEIGHT_IN_COMMENT:a.DEFAULT_HEIGHT;var j={contentId:b.Meta.get("content-id")||"0",macro:{name:c,params:n}};var m=e.confluence.MacroUtils.insertMacro(j,h);m.done(function(o){g(o).click()})})}return{init:function(){b.bind("link-property-panel-buttons.created",function(j,k){var i=k.buttons;var h=k.link;if(f(h)){i.push({className:"link-property-panel-convert-to-thumbnail-button",text:"Show as thumbnail",tooltip:"Show as thumbnail",click:function(){b.Confluence.PropertyPanel.destroy();d(h);b.trigger("analyticsEvent",{name:"confluence.view-file.convert.to-thumbnail-trigger"})}})}})}}});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/components/vfm-editor-poller.js' */
define("vfm/components/vfm-editor-poller",["ajs","jquery","underscore","tinymce","vfm/view-file-macro-utils","vfm/services/conversion-service"],function(k,e,m,p,q,c){var o;var l=false;var d={};var f=q.THUMBNAIL_POLLING_PERIOD;var h=q.THUMBNAIL_POLLING_BACKOFF_RATIO;function a(){if(!p.activeEditor||!l){return}var s=e("img[data-macro-name='view-file'][src*='thumbnailStatus="+q.THUMBNAIL_STATUS_IN_PROGRESS+"'][data-thumbnail-status!='"+q.THUMBNAIL_STATUS_ERROR+"']",p.activeEditor.dom.doc);if(s.length>0){var r=false;s.each(function(){var u=e(this);var w=u.attr("src");var v=q.getParameterByName(w,"attachmentId");var t=q.getParameterByName(w,"version");if(!d[v]||d[v].version!==t){d[v]={version:t};r=true}});if(r){j()}c.postThumbnailConversionResults(d).then(function(t){if(!p.activeEditor||!l){return}m.each(t,function(x,y){if(!d[y]){return}var w=e("img[data-macro-name='view-file'][src*='attachmentId="+y+"']",p.activeEditor.dom.doc);var v=d[y].version;w.attr("data-thumbnail-status",x);if(x===q.THUMBNAIL_STATUS_CONVERTED){var u=w.attr("src");var z=c.getThumbnailUrl(y,v);z=q.addParamsToUrl(z,{attachmentId:y,mimeType:q.getParameterByName(u,"mimeType")});w.attr("src",z);delete d[y]}else{if(x===q.THUMBNAIL_STATUS_ERROR){delete d[y]}}});if(!m.isEmpty(d)){n()}else{j()}i()})}else{if(s.length===0){j();i()}}}function n(){f=f*h}function j(){f=q.THUMBNAIL_POLLING_PERIOD}function i(){l=true;if(o){clearTimeout(o)}o=setTimeout(a,f)}function g(){if(o){clearTimeout(o);o=undefined}l=false;d={};j()}var b={startPolling:i,stopPolling:g};return b});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-view-file-macro:view-file-macro-editor-resources', location = '/js/vfm-editor.js' */
require(["ajs","tinymce","vfm/components/view-file-macro-properties-panel","vfm/components/view-file-macro-link-properties-panel","vfm/components/vfm-editor-poller"],function(a,d,b,c,e){a.toInit(function(){a.MacroBrowser.setMacroJsOverride("view-file",{opener:function(f){}});b.init();c.init()});d.create("tinymce.plugins.ViewFilePoller",{init:function(f){a.bind("rte-ready",function(){e.startPolling()});a.bind("rte-destroyed",function(){e.stopPolling()})}});d.PluginManager.add("viewFilePoller",d.plugins.ViewFilePoller);a.Rte.BootstrapManager.addTinyMcePluginInit(function(f){f.plugins+=",viewFilePoller"})},undefined,true);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-editor-iframe.js' */
AJS.bind("gliffy.init.rte",function(a){(function(c){var d=function(n){var o=[];var k=function(p){o.forEach(function(q){q(p)})};var f=c(window.parent.window);var j=f.get(0).history;if(j&&j.pushState&&Confluence&&Confluence.Editor&&Confluence.Editor.Drafts&&Confluence.Editor.Drafts.unloadMessage){var e=Confluence.Editor.Drafts.unloadMessage;Confluence.Editor.Drafts.unloadMessage=function(){return};var i,m;var g=false,h=false;var l="#GliffyDiagramEdit";j.pushState({},"",l);o.push(function(p){if(p.userCancelled){if(g){j.pushState({},"",l)}}else{if(!g){h=true;j.back()}n.editor.hide();if(g){j.pushState({},"","");i()}}g=false});i=function(){f.off("unload",i);f.off("popstate",m);n.editor.html5Editor.postCloseCallback=null;Confluence.Editor.Drafts.unloadMessage=e};f.on("unload",i);m=function(p){if(!n.editor.hidden){g=true;n.editor.html5Editor.close()}else{if(h){h=false;j.pushState({},"","");i()}}};f.on("popstate",m)}o.push(function(p){AJS.trigger("gliffy.confluence.inlineEditorClosed")});if(n.gonContent){n.editor.html5Editor.open({jsonObj:n.gonContent,dirty:true})}else{if(n.template.category=="com.gliffy.templates.blank"){n.editor.html5Editor.create(null,n.template.panels)}else{if(n.template.category=="com.gliffy.diagram"){if(n.attachmentVersion&&n.attachmentVersion>0){n.editor.html5Editor.open({url:AJS.format("/diagrams/{0}?version={1}",n.attachmentId,n.attachmentVersion)})}else{n.editor.html5Editor.open({url:AJS.format("/diagrams/{0}",n.attachmentId)})}}else{if(n.template.category=="com.gliffy.transform.diagram"){n.editor.html5Editor.open({url:AJS.format("/templates/transform/{0}",n.template.name),dirty:true})}else{n.editor.html5Editor.open({url:AJS.format("/templates/{0}",n.template.name),useShapeStyles:false,dirty:true})}}}}n.editor.show();GLIFFY.confluence.fixEditorFocus();n.editor.html5Editor.postCloseCallback=k};var b=function(f){var f=c.extend({diagramName:null,template:{category:"com.gliffy.templates.blank",name:"com.gliffy.template.blank"},attachmentId:null,panels:null},f);f.editor.loadedCallback=function(){d(f)};var e;if(f.ownerPageId){e=AJS.format("{0}/plugins/gliffy/editor.action?ceoid={1}&inline=true&pageId={2}&attachmentVersion={3}&originalAttachmentVersion={4}&name={5}",AJS.Confluence.getContextPath(),f.ownerPageId,f.referencePageId,f.attachmentVersion||0,f.originalAttachmentVersion||0,encodeURIComponent(f.diagramName))}else{e=AJS.format("{0}/plugins/gliffy/editor.action?ceoid={1}",AJS.Confluence.getContextPath(),Confluence.Editor.getContentId())}if(!f.editor.obj){c("body").append(c('<div class="gliffy-spinner gliffy-spinner-icon"></div><div class="gliffy-spinner gliffy-spinner-bg"></div>'));f.editor.obj=c("<iframe />",{src:e,id:"gliffy-editor"}).css({position:"absolute",width:"100%",height:"100%",top:0,left:0,border:0}).appendTo("body")}else{f.editor.obj.attr("src",e);d(f)}};AJS.bind("gliffy.confluence.launchInlineEditor",function(f,e){b(e)});AJS.bind("gliffy.confluence.launchEditorWithGonData",function(g,f){try{if(GLIFFY._confluence.macroDialog){GLIFFY._confluence.macroDialog.hide()}}catch(h){console.log("Error hiding Gliffy macro dialog on gliffy.confluence.launchEditorWithGonData: "+h)}b({editor:GLIFFY._confluence.editor,gonContent:f})});AJS.bind("gliffy.confluence.launchTemplate",function(i,h,g,f){try{if(GLIFFY._confluence.macroDialog){GLIFFY._confluence.macroDialog.hide()}}catch(j){console.log("Error hiding Gliffy macro dialog on gliffy.confluence.launchTemplate: "+j)}b({editor:GLIFFY._confluence.editor,template:{category:h,name:g,panels:f}})});AJS.bind("gliffy.confluence.addGliffyDiagramToPage",function(h,g,f){try{if(GLIFFY._confluence.macroDialog){GLIFFY._confluence.macroDialog.hide()}}catch(i){console.log("Error hiding Gliffy macro dialog on gliffy.confluence.addGliffyDiagramToPage: "+i)}var j={contentId:Confluence.Editor.getContentId(),macro:{name:"gliffy",params:{name:f,blueprint:g},defaultParameterValue:"",body:""}};GLIFFY.confluence.insertMacro(j)})}(AJS.$))});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/PromiseJS.js' */
(function(g){var d={Pending:"Pending",Resolved:"Resolved",Rejected:"Rejected"};if(!Array.prototype.forEach){Array.prototype.forEach=function(l,k){for(var j=0,h=this.length;j<h;++j){if(j in this){l.call(k,this[j],j,this)}}}}function e(){var i=this,j=[],h=[],n=[],m=d.Pending,l;function k(){var o=this;o.success=function(p){if(m===d.Resolved){p.call(o,l)}else{j.push(p)}return o};o.fail=function(p){if(m===d.Rejected){p.call(o,l)}else{h.push(p)}return o};o.progress=function(p){n.push(p);return o};o.always=function(p){return o.success(p).fail(p)};o.then=function(q,p){return o.success(q).fail(p)};o.isPending=function(){return m===d.Pending};o.isResolved=function(){return m===d.Resolved};o.isRejected=function(){return m===d.Rejected};o.value=function(){return l}}i.promise=new k();i.resolve=function(o){if(m===d.Pending){m=d.Resolved;l=o;j.forEach(function(p){p.call(i.promise,l)})}};i.reject=function(o){if(m===d.Pending){m=d.Rejected;l=o;h.forEach(function(p){p.call(i.promise,l)})}};i.notify=function(){if(m===d.Pending){n.forEach(function(o){o.call(i.promise)})}}}function b(h){return Object.prototype.toString.call(h)==="[object Array]"}function a(l){var h=b(l)?l:Array.prototype.slice.call(arguments,0),j=h.length,i=0,k=new e();h.forEach(function(m){m.always(function(){i+=1;if(i===j){k.resolve(h)}})});return k.promise}function c(i,h,j){if(i.length===0){h.resolve(j)}else{var k=i[0].call();k.always(function(){c(Array.prototype.slice.call(i,1),h,j.concat([k]))})}}function f(j){var h=b(j)?j:Array.prototype.slice.call(arguments,0),i=new e();if(h.length===0){i.resolve()}else{c(h,i,[])}return i.promise}g.PromiseJS={Deferred:e,when:a,chain:f};if(typeof exports!=="undefined"){exports.PromiseJS=g.PromiseJS}}((function(){return this}.call())));
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-utils.js' */
(function(b){var a=setInterval(function(){if(AJS.Rte&&AJS.Rte.getEditor()){clearInterval(a);AJS.trigger("gliffy.init.rte")}},500);AJS.bind("init.rte",function(){clearInterval(a);AJS.trigger("gliffy.init.rte")})}(AJS.$));AJS.bind("gliffy.init.rte",function(a){(function(c){window.GLIFFY=window.GLIFFY||{};GLIFFY._confluence=GLIFFY._confluence||{};GLIFFY._confluence.gvars={gliffyApiEndpoint:AJS.format("{0}/rest/gliffy/1.0",AJS.Confluence.getContextPath()),isAutoSearchOn:true,spaces:[]};GLIFFY._confluence.utils={getMacroParams:function(f){var e={};var d=f.data&&f.data("macro-parameters");d=d||(f.dataset&&f.dataset.macroParameters);if(d){c.each(d.split("|"),function(g,h){var i=h.split("=");e[i[0]]=i[1]})}return e},getUrlVars:function(){var g=[],f;var d=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var e=0;e<d.length;e++){f=d[e].split("=");g.push(f[0]);g[f[0]]=decodeURIComponent(f[1])}return g},parseError:function(g){if(g.responseText!=null){try{var d=c.parseJSON(g.responseText);return(d.message!=null)?d.message:g.responseText}catch(f){return g.responseText}}return""},analyticsEvent:function(e,d){c(window).trigger(e+".gliffyAnalytics",d)},getAnalyticsLabel:function(){return"none"},getAnalyticsProduct:function(){return"Confluence"},getAnalyticsLicense:function(){return c("meta[name=gliffy-license-type]").attr("content")},getAnalyticsNumUsers:function(){return parseInt(c("meta[name=gliffy-license-quantity]").attr("content"))},initAnalytics:function(){var e=GLIFFY._confluence.utils.getAnalyticsLabel(),d;d=new PromiseJS.Deferred();c.ajax({url:AJS.format("{0}/rest/gliffy/1.0/properties/com.gliffy.integration.confluence.ANALYTICS_OFF",Confluence.getContextPath()),type:"GET",cache:false,success:function(f){if(f["com.gliffy.integration.confluence.ANALYTICS_OFF"]!==true){GLIFFY._confluence.utils.analyticsEvent("init",{accountType:"google",accountID:"UA-248648-8"});GLIFFY._confluence.utils.analyticsEvent("setLabel",{label:e});GLIFFY._confluence.utils.analyticsEvent("setCustomVariables",{product:GLIFFY._confluence.utils.getAnalyticsProduct(),license:GLIFFY._confluence.utils.getAnalyticsLicense(),numUsers:(GLIFFY._confluence.utils.getAnalyticsNumUsers()+" Users")})}d.resolve(f)},error:function(h,f,g){AJS.log("Error determining if analytics is available",g);d.reject(h)},dataType:"json"});return d.promise}};var b=function(){var e=function(){if(AJS.Rte.getEditorFrame){c(AJS.Rte.getEditorFrame()).focus()}var h=c("#gliffy-editor")[0];if(h){h.contentWindow.focus()}};var g=tinymce.confluence.NodeUtils.replaceNode;var f=function(n,j){var l=tinymce.confluence.NodeUtils,h=tinymce.activeEditor,m=l.getDoc(),i=c(j,m),k=c(n,m);return c.Deferred(function(){var o=this;if(i.is("img")){i[0].onload=function(){AJS.log("replaceNode: new node's src has been loaded by the browser.");this.onload=null;o.resolve(this)};if(c.browser.opera){i[0].src=i.attr("src")}setTimeout(function(){o.resolve(i[0])},3000);m.createDocumentFragment().appendChild(i[0])}else{o.resolve(i[0])}}).done(function(o){k.replaceWith(o)}).promise()};var d=function(i,k){var h,j={contentId:Confluence.Editor.getContentId(),macro:{name:"gliffy",params:"",defaultParameterValue:"",body:""}};if(c.browser.msie&&AJS.$.Deferred){tinymce.confluence.NodeUtils.replaceNode=f}AJS.Rte.BookmarkManager.restoreBookmark();h=tinymce.confluence.MacroUtils.insertMacro(c.extend(true,j,i),k);if(h&&h.then){h.then(function(){if(c.browser.msie){tinymce.confluence.NodeUtils.replaceNode=g}},function(){if(c.browser.msie){tinymce.confluence.NodeUtils.replaceNode=g}})}AJS.log("insert gliffy macro");e();return h};return{getMacroParams:GLIFFY._confluence.utils.getMacroParams,insertMacro:d,fixEditorFocus:e,updateMacros:function(h){var i=c(AJS.Rte.getEditor().dom.select(".editor-inline-macro")).filter(function(j){return c(this).data("macro-name")===h});i.each(function(k,m){var n=c(this);var l=GLIFFY._confluence.utils.getMacroParams(n);var j=c.toJSON({contentId:Confluence.Editor.getContentId(),macro:{name:n.data("macro-name"),params:l,body:"",defaultParameterValue:""}});c.ajax({type:"POST",contentType:"application/json; charset=utf-8",url:Confluence.getContextPath()+"/rest/tinymce/1/macro/placeholder",data:j,dataType:"text",success:function(o){n.after(o);n.remove()}})})}}};GLIFFY.confluence=b()}(AJS.$))});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-propertyPanel.js' */
AJS.bind("gliffy.init.rte",function(a){(function(e){function b(o,n){e(window).trigger(o+".gliffyAnalytics",n)}e.ajax({url:AJS.Confluence.getContextPath()+"/rest/gliffy/1.0/properties/com.gliffy.integration.confluence.ANALYTICS_OFF",type:"GET",cache:false,success:function(n){if(n["com.gliffy.integration.confluence.ANALYTICS_OFF"]!==true){b("init",{accountType:"google",accountID:"UA-248648-8",optPageName:"viewer",debug:false});b("setCustomVariables",{product:"Confluence",license:GLIFFY._confluence.utils.getAnalyticsLicense(),numUsers:GLIFFY._confluence.utils.getAnalyticsNumUsers()})}},error:function(p,n,o){},dataType:"json"});var f=function(q){AJS.Rte.BookmarkManager.storeBookmark();if(q.params&&q.params.name&&q.params.name.length>0){if(AJS.Meta.get("form-name")==="createpagetemplate"||AJS.Meta.get("form-name")==="editpagetemplate"){var n=new AJS.Dialog({width:450,height:250,id:"gliffy-no-editing-template-message",closeOnOutsideClick:true});n.addHeader("Gliffy in Page Templates").addPanel("SinglePanel","","gliffy-no-editing-template-content");e(".gliffy-no-editing-template-content").html("Gliffy diagrams cannot be edited in page templates.  Please edit the diagram from the page where it is attached and changes will be reflected here.");n.addCancel("Close",function(){n.hide()});n.show()}else{if(q.params.blueprint){AJS.trigger("gliffy.confluence.launchTemplate",[q.params.blueprint,q.params.name])}else{if(q.params.attachmentId){AJS.trigger("gliffy.confluence.launchTemplate",["com.gliffy.transform.diagram",q.params.attachmentId])}else{if(q.params.page&&q.params.name&&!q.params.pageid){if(q.params.space==null){q.params.space=AJS.Meta.get("space-key")}var o=AJS.format("{0}/ceo/find/space/{1}/page/{2}/name/{3}",GLIFFY._confluence.gvars.gliffyApiEndpoint,encodeURIComponent(q.params.space),encodeURIComponent(q.params.page),encodeURIComponent(q.params.name));e.ajax({type:"GET",url:o,dataType:"json",cache:false,success:function(r){q.params.pageid=r.id;delete q.params.space;delete q.params.page;AJS.Rte.BookmarkManager.storeBookmark();var s={contentId:Confluence.Editor.getContentId(),macro:{name:"gliffy",params:q.params,defaultParameterValue:"",body:""}};GLIFFY.confluence.insertMacro(s);require("gliffy/confluence/editor/editorLauncher").launchEditorFromEditPage({editor:GLIFFY._confluence.editor,diagramName:q.params.name,ownerPageId:q.params.pageid,referencePageId:q.params.pageid,attachmentId:r.attachmentId,attachmentVersion:r.attachmentVersion,template:{category:"com.gliffy.diagram"}})},error:function(t,r,s){alert(GLIFFY._confluence.utils.parseError(t))}})}else{if(q.params.pageid==null){q.params.pageid=Confluence.Editor.getContentId()}var p=AJS.format("{0}/ceo/{1}/diagrams/{2}/permission",GLIFFY._confluence.gvars.gliffyApiEndpoint,q.params.pageid,encodeURIComponent(q.params.name));e.ajax({type:"GET",url:p,dataType:"json",cache:false,success:function(r){var s=parseInt(q.params.version)||0;require("gliffy/confluence/editor/editorLauncher").launchEditorFromEditPage({editor:GLIFFY._confluence.editor,diagramName:q.params.name,ownerPageId:q.params.pageid,referencePageId:Confluence.Editor.getContentId(),attachmentVersion:s,attachmentId:r.attachmentId,template:{category:"com.gliffy.diagram"}})},error:function(t,r,s){alert(GLIFFY._confluence.utils.parseError(t))}})}}}}}else{AJS.trigger("gliffy.confluence.showMacroDialog")}};AJS.MacroBrowser.setMacroJsOverride("gliffy",{opener:f});var j=function(n){var o=confirm("'Delete' will remove the macro and the Gliffy XML/Image attachments from the page.\n\nAre you sure you want to do this?");if(o){var s=AJS.$(n);var r=GLIFFY._confluence.utils.getMacroParams(s);var p=(r.pageId==null)?Confluence.Editor.getContentId():r.pageId;var q=AJS.format("{0}/ceo/{1}/diagrams/{2}",GLIFFY._confluence.gvars.gliffyApiEndpoint,p,encodeURIComponent(r.name));e.ajax({url:q,type:"DELETE",success:function(u,v,t){AJS.Confluence.PropertyPanel.destroy();AJS.Rte.getEditor().execCommand("mceConfRemoveMacro",n)},error:function(u,v,t){alert(GLIFFY._confluence.utils.parseError(u))}})}};var c=function(n,p){var q=AJS.$(n);AJS.Rte.getEditor().selection.select(q[0]);AJS.Rte.BookmarkManager.storeBookmark();var o=GLIFFY._confluence.utils.getMacroParams(q);if(p==="O"||p==="L"){delete o.size}else{o.size=p}var r={contentId:Confluence.Editor.getContentId(),macro:{name:"gliffy",params:o,defaultParameterValue:"",body:""}};GLIFFY.confluence.insertMacro(r,q[0])};var m=function(n){var p=AJS.$(n);AJS.Rte.getEditor().selection.select(p[0]);AJS.Rte.BookmarkManager.storeBookmark();var o=GLIFFY._confluence.utils.getMacroParams(p);o.border=="true"?delete o.border:o.border="true";var q={contentId:Confluence.Editor.getContentId(),macro:{name:"gliffy",params:o,defaultParameterValue:"",body:""}};GLIFFY.confluence.insertMacro(q,p[0])};var d=function(p){var r=e(".gliffy-more-panel").data("more-params");var n=e(".gliffy-more-panel").data("macroNode");var u=e("#gliffy-dialog-more-size-field");var o=e.trim(u.val());if(o.length===0){o=""}var s=function(v){if("T"===v||"S"===v||"M"===v||"L"===v||"O"===v||""===v){return true}var w=parseInt(v);if(isNaN(w)){return false}return w>=150&&w<=3000};if(s(o)){(""===o)?delete r.size:r.size=o}else{e("#gliffy-dialog-more-size-error-field").text("Invalid input (150 min, 3000 max)");return false}var q=e("#gliffy-dialog-more-chrome-field").val();("full"===q)?delete r.chrome:r.chrome=q;r.html5=e(".gliffy-dialog-interactive-viewer-checkbox").is(":checked");if(r.html5){delete r.html5}var t={contentId:Confluence.Editor.getContentId(),macro:{name:"gliffy",params:r,defaultParameterValue:"",body:""}};GLIFFY.confluence.insertMacro(t,n);p.remove()};var i=function(n,o){return{size:(n.size==null)?"":n.size,chromeOptions:[{key:"full",value:"Full"},{key:"min",value:"None"}],selectedChromeOption:(n.chrome==null)?"full":n.chrome,html5Viewer:(n.html5===undefined||n.html5===null)?true:n.html5=="true",isHtml5ViewerDisabledByAdmin:o}};var l=function(q,o,n){var p=new AJS.Dialog(340,380,"gliffy-dialog-more");p.addHeader("Additional Options","");p.addPanel("More Panel",gliffySoy.macro.dialog.morePropertyPanel(n),"gliffy-more-panel",0);e(".gliffy-more-panel").data("more-params",q).data("macroNode",o);p.addButton("Update",d,"gliffy-more-update");p.addCancel("Cancel",function(r){AJS.Rte.BookmarkManager.restoreBookmark();r.remove()});p.show()};var k=function(n){var p=AJS.$(n);AJS.Rte.getEditor().selection.select(p[0]);AJS.Rte.BookmarkManager.storeBookmark();var o=GLIFFY._confluence.utils.getMacroParams(p);e.ajax({url:AJS.Confluence.getContextPath()+"/rest/gliffy/1.0/properties/com.gliffy.integration.confluence.HTML5_OFF",type:"GET",cache:false,success:function(r){var q=i(o,r["com.gliffy.integration.confluence.HTML5_OFF"]);l(o,n,q)},error:function(r){var q=i(o,false);l(o,n,q)}})};var h=function(s,r,o){e("#gliffy-version-dialog-information").text("");var p=+e("#gliffy-dialog-version-field").val();var t=s.allVersionInformation[p-1];if(p===0){t=s.allVersionInformation[s.allVersionInformation.length-1]}if(t){e("#gliffy-version-dialog-information").text(t)}e("#gliffy-diagram-preview").attr("href",AJS.Confluence.getContextPath()+"/rest/gliffy/1.0/diagrams/preview?name="+encodeURIComponent(r)+"&pageId="+o+"&version="+p);e("#gliffy-diagram-thumbnail").attr("src",AJS.Confluence.getContextPath()+"/rest/gliffy/1.0/diagrams/thumbnail?name="+encodeURIComponent(r)+"&pageId="+o+"&version="+p);var n=p;if(p===0){n=s.allVersionInformation.length}var q=e("#gliffy-diagram-thumbnail");if(q.previewer){e(q).previewer({src:e("#gliffy-diagram-preview").attr("href"),type:"image/png",title:"v"+n,zindex:10000}).closest("a").attr("href","#").click(function(u){u.preventDefault()})}else{e("#gliffy-diagram-preview").fancybox({type:"image",showCloseButton:true,hideOnOverlayClick:true,hideOnContentClick:true,title:"v"+n})}};var g=function(r){b("trackEvent",{category:"viewer",action:"showVersionPinningDialog"});var n=function(w){if(!e(w.target).closest("#gliffy-version-dialog").length){e(document).off("click",n);u.remove()}};e(document).on("click",n);var s=AJS.$(r);var t=GLIFFY._confluence.utils.getMacroParams(s);var p=t.pageid||AJS.Meta.get("page-id");var u=new AJS.Dialog({width:340,height:430,id:"gliffy-version-dialog",closeOnOutsideClick:false});u.addHeader("Version");u.addPanel("Panel 1","<div/>","gliffy-version-body");u.addLink("Cancel",function(w){e(document).off("click",n);w.remove()},"#");u.show();var o=AJS.$("#gliffy-version-dialog");var q=require("GliffySpinner");var v=new q(o.get(0),{radius:50,color:"#666"});v.start();e.ajax({url:AJS.Confluence.getContextPath()+"/rest/gliffy/1.0/diagrams/allVersionInformation",type:"GET",data:{name:t.name,pageId:p},success:function(x){v.stop();var w=[{key:"0",value:"Latest"}];for(var y=x.numRevisions;y>0;y--){w.push({key:""+y,value:"v"+y})}var z={versions:w,selectedVersion:t.version||0,allVersionInformation:x.revisions.map(function(A){return A.lastModifiedFriendly+" by "+A.creator}).reverse()};e(".gliffy-version-body").html(gliffySoy.macro.dialog.versionPropertyPanel(z));u.addButton("Update",function(A){b("trackEvent",{category:"viewer",action:"pinToNewVersion"});var B=e("#gliffy-dialog-version-field").val();t.version=parseInt(B);if(t.version===0){delete t.version}var C={contentId:Confluence.Editor.getContentId(),macro:{name:"gliffy",params:t,defaultParameterValue:"",body:""}};e(document).off("click",n);GLIFFY.confluence.insertMacro(C,r);A.remove()});u.gotoPanel(0);h(z,t.name,p);e("#gliffy-dialog-version-field").change(function(){h(z,t.name,p)})},error:function(A,w,x){v.stop();e("#gliffy-version-dialog").remove();if(A.status===404){var y=new AJS.Dialog({width:340,height:190,id:"gliffy-version-dialog",closeOnOutsideClick:true});var z={pageUnsavedMessage:"Sorry, version information is not available until the Confluence page has been saved."};y.addPanel("Diagram Version Selection",gliffySoy.macro.dialog.noSaveDialog(z),"gliffy-version-body");y.addButton("Close",function(B){B.remove()});y.gotoPanel(0);y.show()}}})};e("form[name='gliffy-more-form']").live("submit",function(){return false});AJS.bind("created.property-panel",function(p,n){var o=e(n.anchor);if(o.data("macro-name")==="gliffy"){var q=GLIFFY._confluence.utils.getMacroParams(o);if(q.border&&q.border){n.panel.find(".macro-property-panel-gliffy-button-image-border").addClass("selected")}if(q.size){switch(q.size){case"300":n.panel.find(".macro-property-panel-gliffy-button-image-small").addClass("selected");break;case"600":n.panel.find(".macro-property-panel-gliffy-button-image-medium").addClass("selected");break;case"1200":n.panel.find(".macro-property-panel-gliffy-button-image-large").addClass("selected");break;default:break}}else{n.panel.find(".macro-property-panel-gliffy-button-image-original").addClass("selected")}}});AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-small",function(o,n){c(n,"300")});AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-medium",function(o,n){c(n,"600")});AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-large",function(o,n){c(n,"1200")});AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-original",function(o,n){c(n,"O")});AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-image-border",function(o,n){m(n)});AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-more",function(o,n){k(n)});AJS.Confluence.PropertyPanel.Macro.registerButtonHandler("gliffy-button-version",function(o,n){g(n)})}(AJS.$))});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-html5-analytics.min.js' */
(function(){(function(c){
/*!! Simple JavaScript Inheritance
     * By John Resig http://ejohn.org/
     * MIT Licensed.
     * http://ejohn.org/blog/simple-javascript-inheritance
     *
     */
var d=false,g=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/;var a=function(){};a.extend=function(n){var m=this.prototype;d=true;var l=new this();d=false;for(var k in n){l[k]=typeof n[k]=="function"&&typeof m[k]=="function"&&g.test(n[k])?(function(o,p){return function(){var r=this._super;this._super=m[o];var q=p.apply(this,arguments);this._super=r;return q}})(k,n[k]):n[k]}function j(){if(!(this instanceof j)){return new j(arguments)}if(!d&&this.init){this.init.apply(this,arguments)}}j.prototype=l;j.prototype.constructor=j;j.extend=arguments.callee;return j};var e=a.extend({init:function(){},setAccount:function(){},trackEvent:function(){},trackPageView:function(){},logEvents:function(){},setLabel:function(){},runFuncIfAnalyticsExists:function(){}});var h=a.extend({__eventsRemaining:0,__maxEvents:0,__regenInterval:-1,__functionQueue:null,abort:function(){clearInterval(this.__regenInterval)},init:function(l){var k=c.extend({eventBucket:9,regen:1,per:1100},l),j=this;j.__eventsRemaining=k.eventBucket;j.__maxEvents=k.eventBucket;j.__functionQueue=[];j.__regenInterval=setInterval(function(){j.__eventsRemaining=Math.min(k.eventBucket,j.__eventsRemaining+k.regen);j.__runEvents()},k.per)},__runEvents:function(){var j=this,k;while(j.__eventsRemaining>0&&j.__functionQueue.length>0){k=j.__functionQueue.shift();k.func.apply(this,k.args);j.__eventsRemaining--}},addFunction:function(k,j){this.__functionQueue.push({func:k,args:j});this.__runEvents()}});var f=e.extend({_loaded:false,_trackerID:"",_logEvents:false,_logger:null,_activeLabel:null,_optPageName:null,_eventThrottler:null,_eventWarningCtr:450,_customVariableIndices:null,_canLog:function(){return this._logger!==null&&this._logEvents===true},init:function(m,o,l,k){var n,p=document.createElement("script"),j=this;this._optPageName=o;if(k===undefined){k=false}p.type="text/javascript";p.async=true;p.src=("https:"===document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/"+(k?"u/ga_debug.js":"ga.js");n=document.getElementsByTagName("script")[0];n.parentNode.insertBefore(p,n);this._trackerID=m;this._eventWarningCtr=450;p.onreadystatechange=function(){if(this.readyState==="complete"){j._scriptLoaded();if(l){l()}}};p.onload=function(){j._scriptLoaded();if(l){l()}};j._customVariableIndices={product:1,license:2,numUsers:3};j._eventThrottler=new h()},loaded:function(){return this._loaded},setAccount:function(j){this._push(["_setAccount",j])},setLabel:function(j){this._activeLabel=j},setCustomVariables:function(m,l,j){var k=3;if(m){this._push(["_setCustomVar",this._customVariableIndices.product,"product",m,k])}this._push(["_setCustomVar",this._customVariableIndices.license,"license",l,k]);this._push(["_setCustomVar",this._customVariableIndices.numUsers,"numUsers",j,k])},trackEvent:function(l,m,n,j,k){n=n===undefined?null:n;j=j===undefined?null:j;k===undefined?null:k;if(n===null&&this._activeLabel!==null){n=this._activeLabel}this._push(["_trackEvent",l,m,n,j,k]);if(--this._eventWarningCtr===0){this._push(["_trackEvent","warning","eventsExceed450",n,null,null])}if(l==="lzxclient"){this._push(["_trackPageview","/lzxEvent/"+m])}},trackPageView:function(){if(this._optPageName){this._push(["_trackPageview",this._optPageName])}else{this._push(["_trackPageview"])}},logEvents:function(j,k){this._logEvents=j;this._logger=k},_scriptLoaded:function(){this._loaded=true;this._push(["_setDomainName","none"]);this.setAccount(this._trackerID);this.trackPageView()},_push:function(j){var k=this;this._eventThrottler.addFunction(function(){if(typeof _gaq!="undefined"){_gaq.push(j);if(k._canLog()){k._logger.log("ANALYTICS: "+j.join(", "))}}})},runFuncIfAnalyticsExists:function(j){if(j){j()}}});var b=a.extend({_analytics:null,_queuedEvents:null,init:function(){var j=this;j._queuedEvents=[];c(window).bind("init.gliffyAnalytics",function(l,m){var k=c.extend({},{accountType:"none",accountID:"UA-248648-8",debug:false,optPageName:null},m);if(!j._analytics){switch(k.accountType){case"google":j._analytics=new f(k.accountID,k.optPageName,function(){var n;while(n=j._queuedEvents.shift()){c(window).trigger(n[0]+".gliffyAnalytics",n[1])}},k.debug);break}}});c(window).bind("trackEvent.gliffyAnalytics",function(l,m){var k=c.extend({},{category:"",action:"",label:null,value:null,non_interaction:null},m);if(j._analytics&&j._analytics.loaded()){j._analytics.trackEvent(k.category,k.action,k.label,k.value,k.non_interaction)}else{j._queuedEvents.push(["trackEvent",m])}});c(window).bind("setLabel.gliffyAnalytics",function(l,m){var k=c.extend({},{label:null},m);if(j._analytics&&j._analytics.loaded()){j._analytics.setLabel(k.label)}else{j._queuedEvents.push(["setLabel",m])}});c(window).bind("logEvents.gliffyAnalytics",function(l,m){var k=c.extend({},{logEvents:false,logger:null},m);if(j._analytics&&j._analytics.loaded()){j._analytics.logEvents(k.logEvents,k.logger)}else{j._queuedEvents.push(["logEvents",m])}});c(window).bind("setCustomVariables.gliffyAnalytics",function(l,m){var k=c.extend({},{product:null,license:"none",numUsers:0},m);if(j._analytics&&j._analytics.loaded()){j._analytics.setCustomVariables(k.product,k.license,k.numUsers)}else{j._queuedEvents.push(["setCustomVariables",m])}});c(window).bind("runFuncIfAnalyticsExists.gliffyAnalytics",function(l,m){var k=c.extend({},{func:null},m);if(j._analytics){j._analytics.runFuncIfAnalyticsExists(k.func)}})}});var i=new b()}(jQuery))}());
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-editor-html5.js' */
AJS.bind("gliffy.init.rte",function(a){(function(b){GLIFFY._confluence.editor={obj:null,parentOverflow:null,isHtml5:true,loadedCallback:null,show:function(){b("#gliffy-editor").css("top",b(document).scrollTop());this.obj.parent().css("overflow","hidden");if(GLIFFY._confluence.editor.hidden){if(b.browser.msie){GLIFFY._confluence.editor.obj.css("visibility","visible")}else{GLIFFY._confluence.editor.obj.show()}GLIFFY._confluence.editor.hidden=false}GLIFFY._confluence.editor.html5Editor.focus();b("#gliffy-close").show();b("#gliffy-load-buttons").hide()},hide:function(){if(!GLIFFY._confluence.editor.hidden){GLIFFY._confluence.editor.html5Editor.blur();if(b.browser.msie){GLIFFY._confluence.editor.obj.css("visibility","hidden")}else{GLIFFY._confluence.editor.obj.hide()}GLIFFY._confluence.editor.hidden=true}b("#gliffy-close").hide();b("#gliffy-load-buttons").show();this.obj.parent().css({overflow:this.parentOverflow})},hidden:false,html5Editor:null,loaded:function(c){GLIFFY._confluence.editor.html5Editor=c;this.parentOverflow=b("#gliffy-editor").parent().css("overflow");b(".gliffy-spinner").remove();if(this.loadedCallback){this.loadedCallback()}},hideSpinner:function(){b(".gliffy-spinner").remove()}}}(AJS.$))});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte-macro.js' */
AJS.bind("gliffy.init.rte",function(a){(function(h){var e,k,l,i,m,g,f=false;var d=require("GliffySpinner");var j;var c;function b(o,n){h(window).trigger(o+".gliffyAnalytics",n)}k=function(n){this.name=n};k.prototype.isTemplateCategory=function(){return false};k.prototype.getName=function(){return this.name};k.prototype.getPanelLink=function(){return gliffySoy.macro.dialog.panelLink({key:this.getName(),title:this.getPanelText()})};k.prototype.getTemplate=function(){return""};k.prototype.getPanelText=function(){return""};k.prototype.primaryAction=function(p,o,q){p.preventDefault();p.stopPropagation();var n=o.find(".gliffy-content .gliffy-template.gliffy-active");AJS.trigger("createpagetemplate",[n.data("category"),n.data("name")])};k.prototype.getPrimaryButtonText=function(){return""};k.prototype.setup=function(n){};k.prototype.teardown=function(n){};e=function(){};e.prototype=new k("create");e.prototype.getTemplate=function(){return gliffySoy.macro.dialog.createPanel()};e.prototype.primaryAction=function(s,r,u){s.preventDefault();s.stopPropagation();var q=r.find(".gliffy-content .gliffy-template.gliffy-active"),p=q.data("name"),o=q.data("panels"),n,t;n=p!=="blank";t=o?"blank_"+o:"blank";b("trackEvent",{category:"panelCreate",action:n?"recent":t});if(o){if(o==="basic"){o=["com.gliffy.libraries.flowchart.flowchart_v1.default","com.gliffy.libraries.basic.basic_v1.default","com.gliffy.libraries.swimlanes.swimlanes_v1.default","com.gliffy.libraries.images"]}else{if(o==="flowchart"){o=["com.gliffy.libraries.flowchart.flowchart_v1.default","com.gliffy.libraries.basic.basic_v1.default","com.gliffy.libraries.swimlanes.swimlanes_v1.default","com.gliffy.libraries.images"]}else{if(o==="software"){o=["com.gliffy.libraries.uml.uml_v2.class","com.gliffy.libraries.uml.uml_v2.sequence","com.gliffy.libraries.uml.uml_v2.activity","com.gliffy.libraries.uml.uml_v2.state_machine","com.gliffy.libraries.uml.uml_v2.deployment","com.gliffy.libraries.uml.uml_v2.component","com.gliffy.libraries.uml.uml_v2.use_case","com.gliffy.libraries.erd.erd_v1.default","com.gliffy.libraries.basic.basic_v1.default","com.gliffy.libraries.images"]}else{if(o==="bpmn"){o=["com.gliffy.libraries.flowchart.flowchart_v1.default","com.gliffy.libraries.basic.basic_v1.default","com.gliffy.libraries.bpmn.bpmn_v1.events","com.gliffy.libraries.bpmn.bpmn_v1.activities","com.gliffy.libraries.bpmn.bpmn_v1.data_artifacts","com.gliffy.libraries.bpmn.bpmn_v1.gateways","com.gliffy.libraries.bpmn.bpmn_v1.connectors","com.gliffy.libraries.swimlanes.swimlanes_v1.default","com.gliffy.libraries.images"]}else{if(o==="network"){o=["com.gliffy.libraries.network.network_v4.rack","com.gliffy.libraries.network.network_v4.business","com.gliffy.libraries.network.network_v4.home","com.gliffy.libraries.basic.basic_v1.default","com.gliffy.libraries.images"]}else{if(o==="ui"){o=["com.gliffy.libraries.ui.ui_v3.containers_content","com.gliffy.libraries.ui.ui_v3.navigation","com.gliffy.libraries.ui.ui_v3.forms_controls","com.gliffy.libraries.ui.ui_v3.icon_symbols","com.gliffy.libraries.ui.ui_v2.forms_components","com.gliffy.libraries.ui.ui_v2.content","com.gliffy.libraries.ui.ui_v2.miscellaneous","com.gliffy.libraries.basic.basic_v1.default","com.gliffy.libraries.images"]}else{if(o==="venn"){o=["com.gliffy.libraries.venn.outline.default","com.gliffy.libraries.venn.flat.default","com.gliffy.libraries.venn.radial.default","com.gliffy.libraries.basic.basic_v1.default","com.gliffy.libraries.images"]}else{if(o==="org"){o=["com.gliffy.libraries.flowchart.flowchart_v1.default","com.gliffy.libraries.basic.basic_v1.default","com.gliffy.libraries.images"]}}}}}}}}}AJS.trigger("gliffy.confluence.launchTemplate",[q.data("category"),p,o])};e.prototype.getPanelText=function(){return "Create a New Diagram"};e.prototype.getPrimaryButtonText=function(n){return "Create"};e.prototype.setup=function(o){var p={matchAll:true,sort:"modified",order:"descending",index:0,results:50,filterByUser:true},n=false;h.ajax({url:GLIFFY._confluence.gvars.gliffyApiEndpoint+"/diagrams.json",dataType:"json",data:p,cache:false,success:function(q){n=true;j.stop();o.find(".gliffy-content .gliffy-recent-results").append(gliffySoy.macro.dialog.searchResults({diagrams:q.diagrams,rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint}))},error:function(q){n=true;j.stop();o.find(".gliffy-content .gliffy-recent-results").append(gliffySoy.macro.dialog.searchResults({diagrams:[],rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint}))}});j=new d(o.find(".gliffy-content .gliffy-recent-results").get(0),{radius:25,color:"#666",inline:true});setTimeout(function(){if(!n){j.start()}},100)};e.prototype.teardown=function(n){};m=function(n,q,p){var o=this;this.insertOnly=n||false;this.message=q||null;this.blueprint=p||false;this.spaces=[{longName:"All Spaces",shortName:""}];this.sort=[{longName:"Last Modified",shortName:"modified"},{longName:"Title",shortName:"title"},{longName:"Created",shortName:"created"}];this.name="insert";this.view="grid";this.query="";h.ajax({type:"GET",url:AJS.format("{0}/rest/gliffy/1.0/spaces/legacy.json",Confluence.getContextPath()),dataType:"json",cache:false,success:function(s){for(var r=0;r<s.categoryList.length;r++){o.spaces.push(s.categoryList[r])}},error:function(t,r,s){AJS.log("space service unavailable "+r)}})};m.prototype=new k();m.prototype.constructor=m;m.prototype.getTemplate=function(){return gliffySoy.macro.dialog.insertPanel({query:this.query,insertOnly:this.insertOnly,message:this.message})};m.prototype.getPanelText=function(){return "Search for a Diagram"};m.prototype.getPrimaryButtonText=function(){if(this.insertOnly){return "Insert Diagram"}else{return "Use as a Template"}};m.prototype.scroll=function(q,p){var n=this,o=(new Date()).getTime();if(!n.__tempTime){n.__scrolling=true;n.__tempTime=o}else{if(o-n.__tempTime>200&&!n.__scrolling){n.__scrolling=true;n.__tempTime=o}}clearTimeout(n.__scrollTimeout);n.__scrollTimeout=setTimeout(function(){if(n.__scrolling){n.__scrolling=false;n.scrollEnd(q,p)}},200)};m.prototype.scrollEnd=function(p,n){var q=h("#gliffy-macro-dialog .gliffy-placeholder"),o;if(q.length>0&&this.isScrolledIntoView(q)){o=q.data();q.remove();this.search(n,o.index,o.results)}};m.prototype.isScrolledIntoView=function(q){var o=h("#gliffy-macro-dialog .gliffy-content"),s=0,r=s+o.height(),n=h(q).offset().top-o.offset().top,p=n+h(q).height();return(p>=s&&p<=r)||(n>=s&&n<=r)};m.prototype.search=function(o,t,q){var w=o.find(".gliffy-space-dropdown").data("value"),r=o.find(".gliffy-sort-dropdown").data("value"),s=o.find(".gliffy-sort-dropdown").data("order")||false,p,n={title:"ascending",created:"descending",modified:"descending"},x={title:"descending",created:"ascending",modified:"ascending"},y=this,v=y.query,u;if(!q||!t){q=20;t=0}p={query:encodeURIComponent(v),index:t,results:q,spaceKey:w,sort:r,order:(s)?x[r]:n[r]};h.ajax({url:GLIFFY._confluence.gvars.gliffyApiEndpoint+"/diagrams.json",dataType:"json",data:p,cache:false,success:function(A){u=o.find(".gliffy-content .gliffy-search-results");if(t===0){u.empty()}if(y.view==="grid"){u.append(gliffySoy.macro.dialog.searchResults({diagrams:A.diagrams,rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint,index:t,results:q}))}else{u.append(gliffySoy.macro.dialog.listSearchResults({diagrams:A.diagrams,rootApi:GLIFFY._confluence.gvars.gliffyApiEndpoint,index:t,results:q}))}for(var z=0;z<A.diagrams.length;z++){h(".gliffy-template[data-name='"+A.diagrams[z].attachmentId+"']").data("diagram",A.diagrams[z])}}})};m.prototype.setup=function(p){var n=this,o;p.find(".button-container-right").append(gliffySoy.macro.dialog.insertPanelCheckbox({insertOnly:n.insertOnly,blueprint:n.blueprint}));p.find(".gliffy-toggle-checkbox").change(function(s){var r=h(this).is(":checked"),q=p.find(".gliffy-button.gliffy-primary");if(r){q.text("Insert Diagram")}else{q.text(n.getPrimaryButtonText())}b("trackEvent",{category:"panelSearchToggleInsert",action:r})});o=p.find(".gliffy-question-link").click(function(){return false});if(o.tooltip){o.tooltip({live:false,gravity:"s",title:"data-tooltip",delayIn:500,delayOut:0,offset:5})}else{o.attr("title",o.data("tooltip"))}p.delegate("table.gliffy-list-search-results tr","click.gliffy-row-highlight",function(r){var s=h(this),q=s.find(".gliffy-template");if(q.length>0){p.find("table .gliffy-active").removeClass("gliffy-active");s.addClass("gliffy-active");q.addClass("gliffy-active")}});p.delegate("table.gliffy-list-search-results tr","dblclick.gliffy-row-highlight",function(r){var s=h(this),q=s.find(".gliffy-template");if(q.length>0){n.primaryAction(r,p)}});p.find(".gliffy-insert-search-form").append(gliffySoy.macro.dialog.insertDropdown({items:this.spaces,label:"",name:"gliffy-space-dropdown"}));p.find(".gliffy-insert-search-form").append(gliffySoy.macro.dialog.insertDropdown({items:this.sort,label:"Sort by:",name:"gliffy-sort-dropdown"}));p.find(".gliffy-insert-search-form").append(gliffySoy.macro.dialog.listGridToggle({view:n.view==="grid"?"gliffy-icon-grid":"gliffy-icon-list"}));p.find(".gliffy-list-grid-toggle").click(function(){var q=h(this);if(n.view==="grid"){q.removeClass("gliffy-icon-grid").addClass("gliffy-icon-list");n.view="list"}else{q.removeClass("gliffy-icon-list").addClass("gliffy-icon-grid");n.view="grid"}b("trackEvent",{category:"panelSearchToggleGridList",action:n.view});n.search(p)});p.find(".gliffy-btn.gliffy-dropdown,.gliffy-btn.gliffy-dropdown-toggle").click(function(q){q.preventDefault();q.stopPropagation();h(this).closest(".gliffy-btn-group").find("ul.gliffy-dropdown-menu").toggle()});p.bind("click.gliffy-btn-dropdown",function(){p.find(".gliffy-btn.gliffy-dropdown,.gliffy-btn.gliffy-dropdown-toggle");p.find("ul.gliffy-dropdown-menu:visible").hide()});p.find("ul.gliffy-dropdown-menu li").click(function(t){t.preventDefault();t.stopPropagation();var u=h(this),s=u.find("a").text(),q=u.find("a").data("value"),r=u.closest(".gliffy-btn-group");r.find("button.gliffy-dropdown").text(s);if(r.data("value")===q){r.data("order",!(r.data("order")==true))}else{r.data("value",q);r.data("order",false)}r.find("ul.gliffy-dropdown-menu").toggle();n.search(p)});p.find(".gliffy-insert-search").keyup(function(q){clearTimeout(n.timeout);n.query=h.trim(p.find(".gliffy-insert-search").val());n.timeout=setTimeout(function(){n.search(p)},500)}).keydown(function(q){if(q.which===13){q.preventDefault();n.query=h.trim(p.find(".gliffy-insert-search").val());n.search(p)}});p.find(".gliffy-insert-search-form").submit(function(q){q.stopPropagation();q.preventDefault()});p.find(".gliffy-content").scroll(function(q){n.scroll(q,p)});n.search(p)};m.prototype.teardown=function(n){n.find(".gliffy-toggle-insert").remove();n.unbind("click.gliffy-row-highlight");n.unbind("dblclick.gliffy-row-highlight");n.unbind("click.gliffy-btn-dropdown");n.find(".gliffy-content").unbind("scroll")};m.prototype.primaryAction=function(n,p,t){var v=p.find(".gliffy-content .gliffy-template.gliffy-active"),s=p.find(".gliffy-toggle-checkbox"),u,q,r=t.isFromBlueprint();n.preventDefault();n.stopPropagation();if(v.length>0){if(this.insertOnly||s.is(":checked")||r){q=v.data("diagram");if(q){u={};u.name=q.name;if(r){u.attachmentId=q.attachmentId}if(Confluence.Editor.getContentId()!=q.pageId){u.pageid=q.pageId}AJS.Rte.BookmarkManager.storeBookmark();var o={contentId:Confluence.Editor.getContentId(),macro:{name:"gliffy",params:u,defaultParameterValue:"",body:""}};GLIFFY.confluence.insertMacro(o);GLIFFY._confluence.macroDialog.hide();b("trackEvent",{category:"panelSearch",action:"insert"})}}else{b("trackEvent",{category:"panelSearch",action:"create"});AJS.trigger("gliffy.confluence.launchTemplate",[v.data("category"),v.data("name")])}}};i=function(){var n=this;this.name="import";this.transformers=[];h.ajax({url:GLIFFY._confluence.gvars.gliffyApiEndpoint+"/transform/config.json",type:"GET",cache:false,dataType:"json",success:function(p){AJS.log("gliffy-transform service available");for(var o=0;o<p.transformers.length;o++){AJS.log("supports "+p.transformers[o].name);n.transformers.push(p.transformers[o])}},error:function(){AJS.log("gliffy-transform service unavailable.");n.transformers=[{name:"Gliffy XML",ext:"gxml"}]}})};i.prototype=new k();i.prototype.constructor=i;i.prototype.getTemplate=function(){return gliffySoy.macro.dialog.importPanel({contextPath:AJS.Confluence.getContextPath()})};i.prototype.primaryAction=function(o,n,p){};i.prototype.getPanelText=function(){return "Import a Diagram"};i.prototype.isExtensionSupported=function(n){return h.grep(this.transformers,function(o){if(o.ext==="gliffy,gon"){return"gon"===n||"gliffy"===n}else{return o.ext===n}}).length>0};i.prototype.setupFormSubmit=function(s){var o=h("#gliffy-create-import-error"),p=h("#gliffy-import-wait"),r=h("#gliffy-import-file"),t=h("#gliffy-create-import-form"),n=this,u,q;s.find("#gliffy-create-import-form").ajaxForm({type:"POST",timeout:180000,beforeSubmit:function(){try{q=AJS.Meta.get("atl-token");if(q){h("#gliffy-security-token").val(q)}}catch(v){}u=r.val().split(".").pop();if(!n.submitting&&n.isExtensionSupported(u)){b("trackEvent",{category:"import",action:u});o.empty();c=new d(p.get(0),{radius:10,color:"#666",inline:true});c.start();n.submitting=true;return true}else{AJS.messages.error("#gliffy-create-import-error",{title:"The file type is not supported for importing:"+" "+u});return false}},success:function(y){n.submitting=false;c.stop();t.each(function(){this.reset()});var x=h.parseJSON(y);var v=x.gon;try{AJS.trigger("gliffy.confluence.launchEditorWithGonData",v);GLIFFY._confluence.macroDialog.hide()}catch(w){o.empty();AJS.messages.error("#gliffy-create-import-error",{title:"Sorry, we could not import your file."})}},error:function(v){console.error(v);n.submitting=false;c.stop();t.each(function(){this.reset()});AJS.messages.error("#gliffy-create-import-error",{title:"Sorry, we could not import your file."})}})};i.prototype.setup=function(o){var n=this;o.find(".gliffy-button.gliffy-primary").hide();o.find("#gliffy-file-type-gxml").click(function(){o.find(".gliffy-import-help-container").empty().append(gliffySoy.macro.dialog.importGliffyHelpPanel({contextPath:AJS.Confluence.getContextPath()}));return false});o.find("#gliffy-file-type-gon").click(function(){o.find(".gliffy-import-help-container").empty().append(gliffySoy.macro.dialog.importGliffyGonHelpPanel({contextPath:AJS.Confluence.getContextPath()}));return false});o.find("#gliffy-file-type-vdx").click(function(){o.find(".gliffy-import-help-container").empty().append(gliffySoy.macro.dialog.importVisioHelpPanel());return false});o.find("#gliffy-import-file").bind("change.gliffyImportPanel",function(){h(this).closest("form").submit()});n.setupFormSubmit(o)};i.prototype.teardown=function(n){n.find(".gliffy-button.gliffy-primary").show()};l=function(n){this.category=n;this.name=n.uid||n.id};l.prototype=new k();l.prototype.constructor=l;l.prototype.primaryAction=function(r,p,s){r.preventDefault();r.stopPropagation();var o=p.find(".gliffy-content .gliffy-template.gliffy-active"),n=o.data("name"),q=o.data("category");b("trackEvent",{category:"panel."+q,action:n});AJS.trigger("gliffy.confluence.launchTemplate",[q,n])};l.prototype.isTemplateCategory=function(){return true};l.prototype.getTemplate=function(){return gliffySoy.macro.dialog.templatePanel({category:this.category.uid,templates:this.category.templates,contextPath:AJS.Confluence.getContextPath()})};l.prototype.getPanelText=function(){return this.category.desc};l.prototype.getPrimaryButtonText=function(n){return "Create"};g=function(n){this.category=n;this.name=n.uid||n.id};g.prototype=new k();g.prototype.constructor=l;g.prototype.isTemplateCategory=function(){return true};g.prototype.getTemplate=function(){return gliffySoy.macro.dialog.templatePanel({category:this.category.uid,templates:this.category.templates,contextPath:AJS.Confluence.getContextPath()})};g.prototype.getPanelText=function(){return this.category.desc.charAt(0).toUpperCase()+this.category.desc.slice(1)};g.prototype.getPrimaryButtonText=function(n){return "Create"};g.prototype.setup=function(n){};g.prototype.teardown=function(n){};g.prototype.primaryAction=function(p,o,q){p.preventDefault();p.stopPropagation();var n=o.find(".gliffy-content .gliffy-template.gliffy-active");b("trackEvent",{category:"macro",action:"addToConfluenceTemplate"});AJS.trigger("gliffy.confluence.addGliffyDiagramToPage",[n.data("category"),n.data("name")])};GLIFFY._confluence.macroDialog={initialized:false,panels:{},primaryActions:{},primaryButtonText:{},canCreateAttachmentPromise:null,panelState:null,setPanelState:function(n){this.panelState=n},getPanelState:function(){return this.panelState},setActivePanelLink:function(n){this.baseDialog.find("li.gliffy-active").removeClass("gliffy-active");n.addClass("gliffy-active")},setActiveTemplate:function(n){this.baseDialog.find(".gliffy-content .gliffy-template.gliffy-active").removeClass("gliffy-active");n.addClass("gliffy-active")},registerPrimaryAction:function(n){this.primaryActions[n.getName()]=n;if(n.getPrimaryButtonText()){this.primaryButtonText[n.getName()]=n.getPrimaryButtonText()}},updatePrimaryButtonText:function(n){this.baseDialog.find(".gliffy-button.gliffy-primary").text(this.primaryButtonText[n])},bindPrimaryButtonClick:function(){var n=this;this.baseDialog.delegate(".gliffy-button.gliffy-primary","click",function(o){if(n.getPanelState()){n.primaryActions[n.getPanelState()].primaryAction(o,n.baseDialog,n)}})},bindSecondaryButtonClick:function(){var n=this;this.baseDialog.delegate(".gliffy-button.gliffy-secondary","click",function(o){o.preventDefault();n.hide()})},bindBlanketClick:function(){var n=this;this.blanket.click(function(){n.hide()})},bindPanelLinkClick:function(){var n=this;h(this.baseDialog).delegate("ul.gliffy-panel-links li","click",function(q){q.preventDefault();q.stopPropagation();var p=h(this),o=p.data("key");if(o){n.renderPanel(n.panels[o])}})},bindTemplateElementClick:function(){var n=this;h(this.baseDialog).delegate(".gliffy-content .gliffy-template","click",function(o){o.preventDefault();n.setActiveTemplate(h(this))});h(this.baseDialog).delegate(".gliffy-content .gliffy-template","dblclick",function(o){o.preventDefault();if(n.getPanelState()){n.primaryActions[n.getPanelState()].primaryAction(o,n.baseDialog,n)}})},registerPanel:function(n){this.panels[n.getName()]=n;n.insertedPanelLink=h(n.getPanelLink());if(n.isTemplateCategory()){this.baseDialog.find(".gliffy-sidebar-templates ul").append(n.insertedPanelLink)}else{this.baseDialog.find(".gliffy-sidebar-panels ul.gliffy-panel-links").append(n.insertedPanelLink)}this.registerPrimaryAction(n)},renderPanel:function(n){if(this.getPanelState()){this.panels[this.getPanelState()].teardown(this.baseDialog)}this.baseDialog.find(".gliffy-content").empty().append(n.getTemplate());this.setActivePanelLink(n.insertedPanelLink);this.updatePrimaryButtonText(n.getName());this.setPanelState(n.getName());n.setup(this.baseDialog)},populateTemplateCategories:function(n){var o=this;h.ajax({url:GLIFFY._confluence.gvars.gliffyApiEndpoint+"/templateLibraries/com.gliffy.template_library.default",type:"GET",cache:false,success:function(r,u,t){if(n===g){var s={desc:"Blank",template:[{desc:"Blank",uid:"com.gliffy.template.blank",previewLocation:"",templateLocation:""}],uid:"com.gliffy.templates.blank"};r.categories.unshift(s)}for(var p=0;p<r.categories.length;p++){var q=r.categories[p];o.registerPanel(new n(q))}},error:function(p){o.baseDialog.find(".gliffy-sidebar-templates").remove()}})},init:function(){this.canCreateAttachmentPromise=this.canCreateAttachments()},canCreateAttachments:function(){var o=new PromiseJS.Deferred(),n=Confluence.Editor.getContentId(),p;if(n==="0"){o.reject("Please save the page before creating a diagram.")}else{h.ajax({type:"GET",url:AJS.format("{0}/ceo/{1}/permission",GLIFFY._confluence.gvars.gliffyApiEndpoint,n),dataType:"json",cache:false,success:function(){o.resolve()},error:function(q){if(q.status===402){p="License Error. Please contact your Administrator."}else{if(q.status===404){p="No create permission or you are not logged in."}else{p="Error. Please contact your Administrator."}}o.reject(p)}})}return o.promise},isFromBlueprint:function(){return AJS.Meta.get("form-name")==="createpagetemplate"||AJS.Meta.get("form-name")==="editpagetemplate"},setupButtons:function(){this.bindPrimaryButtonClick();this.bindSecondaryButtonClick();this.bindBlanketClick();this.bindPanelLinkClick();this.bindTemplateElementClick()},buildDialog:function(){var q,o=this,p,n,r;r=GLIFFY._confluence.utils.initAnalytics();this.blanket=h(gliffySoy.macro.dialog.blanket());if(this.isFromBlueprint()){r.then(function(){b("trackEvent",{category:"macroInit",action:"blueprint"})});o.baseDialog=h(gliffySoy.macro.dialog.base({insertOnly:false}));o.populateTemplateCategories(g);n=new m(true,"",true);o.registerPanel(n);o.setupButtons();o.renderPanel(n);o.blanket.appendTo("body");o.baseDialog.appendTo("body");o.initialized=true}else{this.canCreateAttachmentPromise.then(function(){r.then(function(){b("trackEvent",{category:"macroInit",action:"normal"})});o.baseDialog=h(gliffySoy.macro.dialog.base({insertOnly:false}));o.populateTemplateCategories(l);p=[new e(),new i(),new m()];for(q=0;q<p.length;q++){o.registerPanel(p[q])}o.setupButtons();o.renderPanel(p[0]);o.blanket.appendTo("body");o.baseDialog.appendTo("body");o.initialized=true},function(s){r.then(function(){b("trackEvent",{category:"macroInit",action:"noAttachPermissions"})});o.baseDialog=h(gliffySoy.macro.dialog.base({insertOnly:true}));n=new m(true,s);o.registerPanel(n);o.setupButtons();o.renderPanel(n);o.blanket.appendTo("body");o.baseDialog.appendTo("body");o.initialized=true})}},show:function(){if(!this.initialized){this.buildDialog()}else{var o=(h("body").height()-h("#gliffy-macro-dialog").height())/2;var n=20;if(o<n){if(window.navigator.userAgent.indexOf("Trident")!=-1){h("body").css("overflow-y","scroll")}h("#gliffy-macro-dialog").css("top",n);h("#gliffy-macro-dialog").css("margin-top",0)}this.blanket.show();this.baseDialog.show()}},hide:function(){if(this.initialized){var n=(h("body").height()-h("#gliffy-macro-dialog").height())/2;if(window.navigator.userAgent.indexOf("Trident")!=-1){h("body").css("overflow-y","hidden");window.scrollTo(0,0)}this.blanket.hide();this.baseDialog.hide()}}};GLIFFY._confluence.macroDialog.init()}(AJS.$))});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = 'js/gliffy-rte.js' */
AJS.bind("gliffy.init.rte",function(a){(function(e){AJS.log("AJS.version="+AJS.version);AJS.bind("gliffy-insert-macro",function(l,k){setTimeout(function(){GLIFFY.confluence.insertMacro(k)},2000)});AJS.bind("gliffy-update-macros",function(k){GLIFFY._confluence.editor.hide();GLIFFY.confluence.updateMacros("gliffy")});var g=AJS.Rte.getEditor();g.onNodeChange.add(function(l,q,o,k,m){var n=e(l.getBody());var p=n.find("[data-macro-name=gliffy]");if(p.length===0){n.find(".gliffy-placeholder-text").parent().parent().remove()}});g.onBeforeGetContent.addToTop(function(k,l){if(l.save){e(k.getBody()).find(".gliffy-placeholder-text").parent().parent().remove()}});var b=function(k){k.show();k.gotoPanel(0,0)};var j=function(l,k){if(GLIFFY._confluence.gvars.spaces.length<1){e.ajax({type:"GET",url:AJS.format("{0}/rest/gliffy/1.0/spaces/legacy.json",Confluence.getContextPath()),dataType:"json",cache:false,success:function(m){GLIFFY._confluence.gvars.spaces=m.categoryList;e(".gliffy-space-dropdown").append(gliffySoy.macro.dialog.spaceOptions({spaces:m.categoryList}));b(l);if(k){k()}},error:function(o,m,n){AJS.log("space service unavailable "+m);b(l)}})}else{b(l)}};AJS.bind("gliffy.confluence.showMacroDialog",function(k,l){AJS.Rte.getEditor().selection.setContent("");AJS.Rte.BookmarkManager.storeBookmark();GLIFFY._confluence.macroDialog.show();return false});e("#gliffy").click(function(){AJS.trigger("gliffy.confluence.showMacroDialog")});var c=GLIFFY._confluence.utils.getUrlVars();if(c.showGliffyMacro){var g=AJS.Rte.getEditor();var f=g.dom.create("p");var d=e(g.getBody());var i=d.find("p:first");if(i.length>0){i.before(f)}else{d.prepend(f)}g.dom.add(f,"p",{"class":"gliffy-caret"});g.focus();g.selection.select(g.dom.select("p.gliffy-caret")[0]);var h=g.selection.getBookmark();g.selection.moveToBookmark(h);g.dom.remove(g.dom.select("p.gliffy-caret")[0]);AJS.trigger("gliffy.confluence.showMacroDialog",{createDiagramType:c.createDiagramType})}}(AJS.$))});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.gliffy.integration.confluence:gliffy-rte-html5-resources', location = '/templates/gliffy-rte.soy' */
// This file was automatically generated from gliffy-rte.soy.
// Please don't edit this file by hand.

if (typeof gliffySoy == 'undefined') { var gliffySoy = {}; }
if (typeof gliffySoy.macro == 'undefined') { gliffySoy.macro = {}; }
if (typeof gliffySoy.macro.dialog == 'undefined') { gliffySoy.macro.dialog = {}; }


gliffySoy.macro.dialog.blanket = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="gliffy-macro-blanket"></div>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.base = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="gliffy-macro-dialog"><div class="gliffy-header"><div class="gliffy-logo"></div></div><div class="gliffy-dialog-body"><div class="gliffy-sidepanel"><div class="gliffy-sidebar-panels"><ul class="gliffy-panel-links"></ul></div>', (opt_data.insertOnly != true) ? '<div class="gliffy-sidebar-templates"><ul class="gliffy-panel-links"><li class="gliffy-panel-title"><b>' + soy.$$escapeHtml("Start with a Gliffy Template") + '</b></li></ul></div>' : '', '</div><div class="gliffy-content"></div><div class="gliffy-clear"></div><div class="gliffy-footer"><div class="button-container-left"></div><div class="button-container-right"><ul class="gliffy-button-list"><li><a class="gliffy-button gliffy-primary" href="#">', soy.$$escapeHtml("Create"), '</a></li><li><a class="gliffy-button gliffy-secondary" href="#">', soy.$$escapeHtml("Cancel"), '</a></li></ul></div><div class="gliffy-clear"></div></div></div></div>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.panelLink = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li ', (opt_data.active == true) ? 'class="gliffy-active"' : '', '  data-key="', soy.$$escapeHtml(opt_data.key), '"><a href="#">', soy.$$escapeHtml(opt_data.title), '</a></li>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.templatePanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.category == 'com.gliffy.templates.blank') {
    output.append('<div class="gliffy-template gliffy-active" data-category="com.gliffy.templates.blank" data-name="com.gliffy.template.blank"><div class="gliffy-image-placeholder"/><span>', soy.$$escapeHtml("Blank"), '</span></div>');
  } else {
    var templateList33 = opt_data.templates;
    var templateListLen33 = templateList33.length;
    for (var templateIndex33 = 0; templateIndex33 < templateListLen33; templateIndex33++) {
      var templateData33 = templateList33[templateIndex33];
      output.append('<div data-category="', soy.$$escapeHtml(opt_data.category), '" data-name="', soy.$$escapeHtml(templateData33.uid), '" class="gliffy-template ', (templateIndex33 == 0) ? 'gliffy-active' : '', '"><div class="gliffy-image-placeholder" style="background-image:url(\'', soy.$$escapeHtml(opt_data.contextPath), '/rest/gliffy/1.0', soy.$$escapeHtml(templateData33.thumbnailLocation), '\')" /><span>', soy.$$escapeHtml(templateData33.desc), '</span></div>');
    }
  }
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.createPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="gliffy-blank-container"><div class="gliffy-template gliffy-active" data-category="com.gliffy.templates.blank" data-panels="basic" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-basic"/><span>', soy.$$escapeHtml("Basic"), '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="bpmn" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-bpmn"/><span>', soy.$$escapeHtml("Flowchart \x26 BPMN"), '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="software" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-uml"/><span>', soy.$$escapeHtml("Software Design: UML \x26 ERD"), '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="network" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-network"/><span>', soy.$$escapeHtml("Network"), '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="ui" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-wireframe"/><span>', soy.$$escapeHtml("Wireframe"), '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="org" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-org"/><span>', soy.$$escapeHtml("Org Chart"), '</span></div><div class="gliffy-template" data-category="com.gliffy.templates.blank" data-panels="venn" data-name="com.gliffy.template.blank" ><div class="gliffy-image-placeholder gliffy-symbol-venn"/><span>', soy.$$escapeHtml("Venn Diagram"), '</span></div><div class="gliffy-template" data-category="com.gliffy.template.mindmap_blank" data-panels="mindmap" data-name="com.gliffy.template.mindmap_blank" ><div class="gliffy-image-placeholder gliffy-symbol-mindmap"/><span>', soy.$$escapeHtml("Mind Map"), '</span></div><div class="gliffy-clear"></div></div><div class="gliffy-recent-container"><div class="gliffy-recent-title">', soy.$$escapeHtml("Use a Recent Diagram as a Template"), '</div><div class="gliffy-recent-results"><div class="gliffy-spinner-container"></div></div></div>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.searchResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  if (opt_data.diagrams.length > 0) {
    var diagramList73 = opt_data.diagrams;
    var diagramListLen73 = diagramList73.length;
    for (var diagramIndex73 = 0; diagramIndex73 < diagramListLen73; diagramIndex73++) {
      var diagramData73 = diagramList73[diagramIndex73];
      output.append('<div data-category="com.gliffy.transform.diagram" data-name="', soy.$$escapeHtml(diagramData73.attachmentId), '" class="gliffy-template"><div class="gliffy-image-placeholder" style="background-image:url(\'', soy.$$escapeHtml(opt_data.rootApi), soy.$$escapeHtml(diagramData73.urls.thumbnail), '\')" /><span>', soy.$$escapeHtml(diagramData73.name), '</span></div>');
    }
    output.append((opt_data.results == opt_data.diagrams.length) ? '<div class="gliffy-placeholder" data-index="' + soy.$$escapeHtml(opt_data.index + opt_data.results) + '" data-results="' + soy.$$escapeHtml(opt_data.results) + '"></div>' : '');
  } else {
    output.append('<div style="text-indent:7.5px;">', soy.$$escapeHtml("No Diagrams Found"), '</div>');
  }
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.listGridToggle = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<span class="gliffy-list-grid-toggle ', soy.$$escapeHtml(opt_data.view), '"></span>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.listSearchResults = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table class="gliffy-list-search-results">', (opt_data.index == 0) ? '<thead><tr><th class="gliffy-table-column-diagram"><div class="gliffy-background-f0"></div></th><th class="gliffy-table-column-space">' + soy.$$escapeHtml("Space") + '</th><th class="gliffy-table-column-date">' + soy.$$escapeHtml("Last Modified") + '</th></tr></thead>' : '', '<tbody>');
  if (opt_data.diagrams.length > 0) {
    var diagramList110 = opt_data.diagrams;
    var diagramListLen110 = diagramList110.length;
    for (var diagramIndex110 = 0; diagramIndex110 < diagramListLen110; diagramIndex110++) {
      var diagramData110 = diagramList110[diagramIndex110];
      output.append('<tr><td><div data-category="com.gliffy.transform.diagram" data-name="', soy.$$escapeHtml(diagramData110.attachmentId), '" class="gliffy-template"><div class="gliffy-image-placeholder" style="background-image:url(\'', soy.$$escapeHtml(opt_data.rootApi), soy.$$escapeHtml(diagramData110.urls.thumbnail), '\')" /></div><div class="gliffy-diagram-list-info">', soy.$$escapeHtml(diagramData110.name), '<div class="gliffy-list-label">', soy.$$escapeHtml("Last Modified by"), ' ', soy.$$escapeHtml(diagramData110.lastModifier), '</div></div></td><td>', soy.$$escapeHtml(diagramData110.spaceName), '</td><td>', soy.$$escapeHtml(diagramData110.lastModifiedFriendly), '</td></tr>');
    }
  } else {
    output.append('<tr><td><div style="text-indent:7.5px;">', soy.$$escapeHtml("No Diagrams Found"), '</div></td><td></td><td></td></tr>');
  }
  output.append('</tbody></table>', (opt_data.results == opt_data.diagrams.length) ? '<div class="gliffy-placeholder" data-index="' + soy.$$escapeHtml(opt_data.index + opt_data.results) + '" data-results="' + soy.$$escapeHtml(opt_data.results) + '"></div>' : '');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.insertPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div><form class="gliffy-insert-search-form"><input class="gliffy-insert-search" type="text" placeholder="', soy.$$escapeHtml("Search for a diagram"), '" value="', soy.$$escapeHtml(opt_data.query), '"></form>', (opt_data.message != null) ? '<div class="gliffy-warning-message"><div class="aui-message closeable shadowed warning"><p class="title"><span class="aui-icon icon-generic"></span><strong>' + soy.$$escapeHtml("Sorry, you cannot create new diagrams but you may insert existing ones.") + '</strong></p><p>' + soy.$$escapeHtml(opt_data.message) + '</p></div></div>' : '', '<div class="gliffy-search-results ', (opt_data.insertOnly == true) ? 'gliffy-no-border' : '', '"></div></div>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.insertPanelCheckbox = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form class="gliffy-toggle-insert">', (opt_data.blueprint != true) ? '<input class="gliffy-toggle-checkbox" type="checkbox" ' + ((opt_data.insertOnly == true) ? 'checked disabled' : '') + '/><span>' + soy.$$escapeHtml("Link to Original Diagram") + '</span><a class="gliffy-question-link" href="#" data-tooltip="' + soy.$$escapeHtml("Select this option to link and display the original diagram. Modifications to the original will be reflected in linked locations.") + '"><span class="gliffy-question-icon"></span></a>' : '', '</form>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.insertDropdown = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append((opt_data.label.length > 0) ? '<span class="gliffy-dropdown-label">' + soy.$$escapeHtml(opt_data.label) + '</span>' : '', '<div class="gliffy-btn-group ', soy.$$escapeHtml(opt_data.name), '" data-value="', soy.$$escapeHtml(opt_data.items[0].shortName), '"><button class="gliffy-btn gliffy-dropdown">', soy.$$escapeHtml(opt_data.items[0].longName), '</button><button class="gliffy-btn gliffy-dropdown-toggle"><span class="gliffy-caret"></span></button><ul class="gliffy-dropdown-menu">');
  var itemList185 = opt_data.items;
  var itemListLen185 = itemList185.length;
  for (var itemIndex185 = 0; itemIndex185 < itemListLen185; itemIndex185++) {
    var itemData185 = itemList185[itemIndex185];
    output.append('<li><a href="#" data-value="', soy.$$escapeHtml(itemData185.shortName), '">', soy.$$escapeHtml(itemData185.longName), '</a></li>');
  }
  output.append('</ul></div>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.importPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div id="gliffy-upload-attachment"><form id="gliffy-create-import-form" class="aui" method="post" enctype="multipart/form-data" action="', soy.$$escapeHtml(opt_data.contextPath), '/rest/gliffy/1.0/diagrams/import"><fieldset class="inline"><div class="field gliffy-import-field-group"><input class="gliffy-import-text-input" type="text" placeholder="', soy.$$escapeHtml("Upload a file from your computer"), '"/><a class="gliffy-import-browse">', soy.$$escapeHtml("Browse"), '</a><div class="gliffy-file-input-wrapper"><input type="file" name="file" id="gliffy-import-file" class="gliffy-file-upload"/></div><input id="gliffy-security-token" type="hidden" name="atl_token" value="" /><span id="gliffy-import-wait"></span><div class="gliffy-clear"></div><div id="gliffy-create-import-error" class="error gliffy-import-description"></div><div class="gliffy-create-import-type-description">', soy.$$escapeHtml("The following file types are supported [click each for more info]:"), '</div><div id="gliffy-create-import-types" class="gliffy-create-import-types"><ul><li><a id="gliffy-file-type-gon" href="#">', soy.$$escapeHtml("Gliffy Diagram"), ' (.gliffy, .gon)</a></li><li><a id="gliffy-file-type-gxml" href="#">', soy.$$escapeHtml("Gliffy Diagram"), ' (.gxml)</a></li><li><a id="gliffy-file-type-vdx" href="#">', soy.$$escapeHtml("Visio Diagram"), ' (.vsdx, .vdx)</a></li></ul></div></div></fieldset></form><div class="#gliffy-create-import-error"></div><div class="gliffy-import-help-container"></div></div>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.importGliffyHelpPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="gliffy-help-image"><img src="', soy.$$escapeHtml(opt_data.contextPath), '/download/resources/com.gliffy.integration.confluence/icons/gliffy_online_file_menu.png"/><p><sup>*</sup> ', soy.$$escapeHtml("Gliffy Online File Menu"), '</p></div><div class="gliffy-help-text"><p>', soy.$$escapeHtml("The import dialog supports the import of Gliffy Diagrams (.gxml) that are exported from the Gliffy Editor."), '</p><p>', soy.$$escapeHtml("This allows you to import a diagram from any Gliffy product be it the Gliffy JIRA Plugin, Gliffy Online *, or even from another Confluence page."), '</p><p>', soy.$$escapeHtml("From the Gliffy Editor, navigate to the \x27file\x27 menu and choose \x27Export as Gliffy XML\x27."), '</p><div class="aui-message warning shadowed"><p class="title"><span class="aui-icon icon-warning"></span><strong>', soy.$$escapeHtml("Using Gliffy Diagrams Attached to a Confluence Page or JIRA Issue"), '</strong></p><p>', soy.$$escapeHtml("Gliffy Diagrams downloaded as an attachment from a Confluence Page or JIRA Issue are not guaranteed to work, unless it was exported using the method described above."), '</p><p>', soy.$$escapeHtml("An easy way to tell if your diagram will import is to look for the \x3ccode\x3e.gxml\x3c/code\x3e extension in your filename."), '</p></div></div>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.importGliffyGonHelpPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="gliffy-help-image"><img src="', soy.$$escapeHtml(opt_data.contextPath), '/download/resources/com.gliffy.integration.confluence/icons/gliffy_export_file_menu.png"/><p><sup>*</sup> ', soy.$$escapeHtml("Gliffy HTML5 File Menu"), '</p></div><div class="gliffy-help-text"><p>', soy.$$escapeHtml("The import dialog supports the import of Gliffy Diagrams (.gon) that are exported from the Gliffy HTML5 Editor."), '</p><p>', soy.$$escapeHtml("From the Gliffy HTML5 Editor, navigate to the \x27File\x27 menu and choose \x27Export as Gliffy\x27."), '</p><div class="aui-message info" style="width: 440px;"><p class="title"><span class="aui-icon icon-info"></span><strong>', soy.$$escapeHtml("Gliffy HTML5 files are fully portable!"), '</strong></p><p>', soy.$$escapeHtml("You can download a Gliffy HTML5 diagram directly from the attachments page. Make sure your diagram is of this content type:"), '</p><p><code>', soy.$$escapeHtml("application/gliffy+json"), '</code></p><p>', soy.$$escapeHtml("Just attach the diagram to any Confluence page, and you can immediately use \x27Insert Diagram\x27 from the macro dialog to show it on your wiki page.  No importing is necessary!"), '</p></div></div>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.importVisioHelpPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div class="gliffy-help-text"><span id="gliffy-visio-description-spinner"></span><p id="gliffy-visio-description">', soy.$$escapeHtml("The import dialog supports the import of Visio diagrams (.vsdx, .vdx) that are saved from Microsoft Visio."), '</p><h3 id="gliffy-import-visio-prep">', soy.$$escapeHtml("Preparing the Visio File"), '</h3><ol><li>', soy.$$escapeHtml("In Visio, open the file that you want to import into Gliffy."), '</li><li>', soy.$$escapeHtml("If this file has multiple worksheets, select the worksheet that you want to export."), '</li><li>', soy.$$escapeHtml("Select File \x3e Save As."), '</li><li>', soy.$$escapeHtml("Choose either \x22Visio Drawing (*.vsdx)\x22 or \x22XML Drawing (*.vdx)\x22."), '</li><li>', soy.$$escapeHtml("Save the file."), '</li></ol><h3 id="gliffy-import-visio-reduce-size">', soy.$$escapeHtml("Reducing the Visio File Size (Optional)"), '</h3><ol><li>', soy.$$escapeHtml("Load the file into Visio."), '</li><li>', soy.$$escapeHtml("Select File \x3e Info."), '</li><li>', soy.$$escapeHtml("Click on the button \x22Reduce File Size\x22 and check the boxes."), '</li><li>', soy.$$escapeHtml("Save the file."), '</li></ol><div class="aui-message warning shadowed"><p class="title"><span class="aui-icon icon-warning"></span><strong>', soy.$$escapeHtml("Missing Shapes"), '</strong></p><div class="gliffy-import-missing-shape"></div><p>', soy.$$escapeHtml("If you see a shape like the image on the right then you have encountered a shape that the importer was not able to convert. The most common reason for this occurs when using 3rd party symbols or Visio clip art. Feel free to contact support if you experience these at"), ' <a href="mailto:support@gliffy.com">support@gliffy.com</a>.</p></div></div>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.spaceOptions = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  var spaceList276 = opt_data.spaces;
  var spaceListLen276 = spaceList276.length;
  for (var spaceIndex276 = 0; spaceIndex276 < spaceListLen276; spaceIndex276++) {
    var spaceData276 = spaceList276[spaceIndex276];
    output.append('<option value="', soy.$$escapeHtml(spaceData276.shortName), '">', soy.$$escapeHtml(spaceData276.longName), '</option>');
  }
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.searchResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<table><thead><tr class="gliffy-data-table-header"><th class="gliffy-title-field">', soy.$$escapeHtml("Title"), '</th><th class="gliffy-space-field">', soy.$$escapeHtml("Space"), '</th><th class="gliffy-last-modified-field">', soy.$$escapeHtml("Last Modified"), '</th></tr></thead><tbody>');
  var diagramList291 = opt_data.diagrams;
  var diagramListLen291 = diagramList291.length;
  if (diagramListLen291 > 0) {
    for (var diagramIndex291 = 0; diagramIndex291 < diagramListLen291; diagramIndex291++) {
      var diagramData291 = diagramList291[diagramIndex291];
      output.append('<tr data-attachment-id="', soy.$$escapeHtml(diagramData291.attachmentId), '" data-name="', soy.$$escapeHtml(diagramData291.name), '" data-page-id="', soy.$$escapeHtml(diagramData291.pageId), '" data-version="', soy.$$escapeHtml(diagramData291.version), '" ', (diagramIndex291 == 0) ? 'class="gliffy-selected"' : '', '><td class="gliffy-title-field">', soy.$$escapeHtml(diagramData291.name), '</td><td class="gliffy-space-field">', soy.$$escapeHtml(diagramData291.spaceName), '</td><td class="gliffy-last-modified-field">', soy.$$escapeHtml(diagramData291.lastModifiedFriendly), '</td></tr>');
    }
  } else {
    output.append('<tr data-empty="true"><td>', soy.$$escapeHtml("No results"), '</td></tr>');
  }
  output.append('</tbody></table>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.importResult = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<ul id="gliffy-import-list" class="gliffy-image-list">');
  var attachmentList319 = opt_data.attachments;
  var attachmentListLen319 = attachmentList319.length;
  if (attachmentListLen319 > 0) {
    for (var attachmentIndex319 = 0; attachmentIndex319 < attachmentListLen319; attachmentIndex319++) {
      var attachmentData319 = attachmentList319[attachmentIndex319];
      gliffySoy.macro.dialog.importResultItem({attachment: attachmentData319, contextPath: opt_data.contextPath}, output);
    }
  } else {
    output.append('<li id="gliffy-import-empty" data-empty="true"><span>', soy.$$escapeHtml("No results"), '</span></li>');
  }
  output.append('</ul>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.importResultItem = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<li class="gliffy-attached-image" data-attachment-id="', soy.$$escapeHtml(opt_data.attachment.attachmentId), '" data-name="', soy.$$escapeHtml(opt_data.attachment.name), '" data-page-id="', soy.$$escapeHtml(opt_data.attachment.pageId), '" data-version="', soy.$$escapeHtml(opt_data.attachment.version), '"><div class="gliffy-image-container"><img width="100" height="100" title="', soy.$$escapeHtml(opt_data.attachment.name), '" src="', soy.$$escapeHtml(opt_data.contextPath), '/rest/gliffy/1.0', soy.$$escapeHtml(opt_data.attachment.urls.thumbnail), '" class="thumbnail"/></div><span class="caption filename">', soy.$$escapeHtml(opt_data.attachment.name), '</span><span class="caption owner-title">', soy.$$escapeHtml(opt_data.attachment.lastModifiedFriendly), '</span></li>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.morePropertyPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui top-label" name="gliffy-more-form"><fieldset><div class="field-group"><label for="gliffy-dialog-more-size-field">', soy.$$escapeHtml("Size"), '</label><input id="gliffy-dialog-more-size-field" name="gliffy-dialog-more-size-field" class="text" type="text" value="', soy.$$escapeHtml(opt_data.size), '"/><div id="gliffy-dialog-more-size-error-field" class="error"></div><div class="description">', soy.$$escapeHtml("### (width in #px), T (140px), S (1/3), M (2/3), L | \x27 \x27 (1/1)"), '</div></div><div class="field-group"><label for="gliffy-dialog-more-chrome">', soy.$$escapeHtml("Viewer Toolbar"), '</label><select name="gliffy-chrome" id="gliffy-dialog-more-chrome-field">');
  var chromeOptionList359 = opt_data.chromeOptions;
  var chromeOptionListLen359 = chromeOptionList359.length;
  for (var chromeOptionIndex359 = 0; chromeOptionIndex359 < chromeOptionListLen359; chromeOptionIndex359++) {
    var chromeOptionData359 = chromeOptionList359[chromeOptionIndex359];
    output.append((chromeOptionData359.key == opt_data.selectedChromeOption) ? '<option value="' + soy.$$escapeHtml(chromeOptionData359.key) + '" selected="selected">' + soy.$$escapeHtml(chromeOptionData359.value) + '</option>' : '<option value="' + soy.$$escapeHtml(chromeOptionData359.key) + '">' + soy.$$escapeHtml(chromeOptionData359.value) + '</option>');
  }
  output.append('</select><div class="description">', soy.$$escapeHtml("\x22Full\x22 displays Edit/Zoom controls"), '</div></div>', (! opt_data.isHtml5ViewerDisabledByAdmin) ? '<div class="field-group"><input class="gliffy-dialog-interactive-viewer-checkbox" type="checkbox" ' + ((opt_data.html5Viewer == true) ? 'checked' : '') + '/><span>' + soy.$$escapeHtml("Interactive HTML5 Viewer") + '</span><div class="description">' + soy.$$escapeHtml("Fall back to PNG image when disabled") + '</div></div>' : '', '</fieldset></form>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.versionPropertyPanel = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<form action="#" method="post" class="aui top-label" name="gliffy-version-form"><fieldset><div class="field-group"><div class="description">', soy.$$escapeHtml("Select which diagram version to pin to the page."), '</div><select name="gliffy-version" id="gliffy-dialog-version-field">');
  var versionList393 = opt_data.versions;
  var versionListLen393 = versionList393.length;
  for (var versionIndex393 = 0; versionIndex393 < versionListLen393; versionIndex393++) {
    var versionData393 = versionList393[versionIndex393];
    output.append((versionData393.key == opt_data.selectedVersion) ? '<option value="' + soy.$$escapeHtml(versionData393.key) + '" selected="selected">' + soy.$$escapeHtml(versionData393.value) + '</option>' : '<option value="' + soy.$$escapeHtml(versionData393.key) + '">' + soy.$$escapeHtml(versionData393.value) + '</option>');
  }
  output.append('</select><div id="gliffy-version-dialog-information" class="description"></div><a id="gliffy-diagram-preview"><img id="gliffy-diagram-thumbnail"></a></div></fieldset></form>');
  return opt_sb ? '' : output.toString();
};


gliffySoy.macro.dialog.noSaveDialog = function(opt_data, opt_sb) {
  var output = opt_sb || new soy.StringBuilder();
  output.append('<div>', soy.$$escapeHtml(opt_data.pageUnsavedMessage), '</div>');
  return opt_sb ? '' : output.toString();
};

} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.extra.widgetconnector:twitter-autoconvert-webresources', location = 'com/atlassian/confluence/extra/widgetconnector/js/autoconvert-twitter.js' */
(function(){AJS.bind("init.rte",function(){var A=/^\/(.*?)\/status\/([^/]+\/?$)/,C=/^\/(.*?)\/statuses\/([^/]+\/?$)/,B=function(H,G,D){var E,I,F;
if(H.host.match(/^twitter.com/)){if(E=decodeURI(H.path).match(A)){I=H.protocol+"://twitter.com/"+E[1]+"/status/"+E[2]
}else{if(E=decodeURI(H.path).match(C)){I=H.protocol+"://twitter.com/"+E[1]+"/statuses/"+E[2]
}}if(I){F={name:"widget",params:{url:I}};
tinymce.plugins.Autoconvert.convertMacroToDom(F,D,D)
}else{D()
}}else{D()
}};
tinymce.plugins.Autoconvert.autoConvert.addHandler(B)
})
})();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'confluence.macros.core:macro-browser-smart-fields', location = 'javascript/confluence-core-macro-fields.js' */
(function(){AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("multimedia","swf avi mov mp4 mpeg mpg wmv wma mp3 ram rm".split(" "))})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.adaptavist.confluence.theme.engine:web-item-macro-resource', location = 'engine/webui/web-item.js' */
AJS.toInit(function(f){var e={"sections":{"page.view.selection/action-panel":{"key":"page.view.selection/action-panel","name":"User selection action panel","items":[{"key":"create-inline-comment","name":"Create inline comment in Confluence","description":null},{"key":"create-JIRA-issue-summary","name":"Create issue in JIRA with summary","description":null},{"key":"quote-comment","name":"Quote in comment","description":null}]},"system.admin.global/conf-admin":{"key":"system.admin.global/conf-admin","name":"Confluence Administration","items":[{"key":"admin-plugins","name":"Add-on Administration","description":null},{"key":"administration","name":"Administration","description":null},{"key":"admin-user","name":"Users Administration","description":null}]},"system.admin.tasks/general":{"key":"system.admin.tasks/general","name":"Configuration","items":[{"key":"marketplaceAdminTask","name":"Checkout the Marketplace","description":""},{"key":"gliffy-plugin-admin-task-analytics","name":"web-item: admin task","description":""},{"key":"sitelogo-admin-task","name":null,"description":""}]},"system.admin/2JJTO7VWVUZLRG7OCRYIBNXXQXG60Z3Z-section":{"key":"system.admin/2JJTO7VWVUZLRG7OCRYIBNXXQXG60Z3Z-section","name":"CustomWare Reporting Plugin for Confluence Section","items":[{"key":"CJ1SGXHWQZH0FDRQKQ1K0LZAKNFY0EH0-license","name":"CustomWare Redirection Plugin for Confluence License","description":"CustomWare Redirection Plugin for Confluence License installation link."},{"key":"JT0BV3K5FJO3NLO6N0PHFYCMGI31YLON-license","name":"CustomWare Reporting Plugin for Confluence License","description":"CustomWare Reporting Plugin for Confluence License installation link."},{"key":"6RPTCWVO9U04WY7KBB3DCU2DJOGMWGFZ-license","name":"ServiceRocket Visibility Plugin for Confluence License","description":"ServiceRocket Visibility Plugin for Confluence License installation link."}]},"system.admin/adaptavist.theme.engine.admin.web-section":{"key":"system.admin/adaptavist.theme.engine.admin.web-section","name":"Admin Web Section","items":[{"key":"adaptavist.theme.creator.themeadmin.backup","name":"Backup","description":null},{"key":"adaptavist.theme.creator.themeadmin.edit-skins","name":"Edit Skins Webitem","description":null},{"key":"adaptavist.theme.creator.themeadmin.permissions","name":"Editor Permissions","description":null},{"key":"adaptavist.theme.engine.themeadmin.manage-spaces","name":"Manage Spaces","description":null},{"key":"adaptavist.theme.engine.themeadmin.rootspaceorder","name":"Root Space Order","description":null},{"key":"adaptavist.theme.creator.themeadmin.global-skin","name":"Select Global Skin","description":null},{"key":"adaptavist.theme.creator.themeadmin.standard-skin","name":"Standard Skin Admin Web Item","description":null}]},"system.admin/administration":{"key":"system.admin/administration","name":"Administration","items":[{"key":"admin.cluster-monitoring","name":null,"description":null},{"key":"advanced-search-manage-webui","name":"Advanced Search Configurations","description":"Advanced Search Congiration Management link."},{"key":"applinks-configure-accesslevel-application-links","name":null,"description":null},{"key":"applinks-configure-application-links","name":null,"description":null},{"key":"confluence-analytics-configuration-menu-item","name":"Analytics","description":null},{"key":"confluence-whitelist-report-menu-item","name":"Analytics Whitelists","description":null},{"key":"backup","name":"Backup and Restore","description":null},{"key":"cacheAdmin","name":"Cache Management","description":null},{"key":"confluence-custom-apps-manage-menu","name":"Custom Apps","description":null},{"key":"confluence-event-report-menu-item","name":"Event Report","description":null},{"key":"indexing","name":"Indexing","description":null},{"key":"license","name":"License Details","description":null},{"key":"loglevel","name":"Logging","description":null},{"key":"mailqueue","name":"Mail Queue","description":null},{"key":"scheduledjobs","name":"Scheduled Jobs","description":null},{"key":"stp-confluence-link","name":"Support Tools","description":"Open the Support Tools Plugin."},{"key":"systeminfo","name":"System Information","description":null},{"key":"calendaradminwebitem","name":"Web Item to link to the calendar administration page","description":"A Calendar link which allows access to the manangement interface."}]},"system.admin/configuration":{"key":"system.admin/configuration","name":"Configuration","items":[{"key":"attachmentstoragesetup","name":"Attachment Storage","description":null},{"key":"configurecaptcha","name":"Captcha","description":null},{"key":"language","name":"Configure Language","description":null},{"key":"dailybackup","name":"Daily Backup","description":null},{"key":"external-gadget","name":"External Gadgets","description":null},{"key":"generalconfiguration","name":"General Configuration","description":null},{"key":"globaltemplates","name":"Global Templates","description":null},{"key":"conf-menu-item","name":"Hipchat Admin","description":"Link to hipchat server linking page"},{"key":"importtemplates","name":"Import Templates Menu Item","description":null},{"key":"mailservers","name":"Mail Servers","description":null},{"key":"managereferers","name":"Manage Referrers","description":null},{"key":"notificationQueueAdminLink","name":"Notification Queue Link","description":null},{"key":"notificationservers","name":"Notification Servers","description":null},{"key":"confluence-plm-admin-menu","name":"Plugin License Manager","description":null},{"key":"daily-summary-admin-item","name":"Recommended Updates Admin","description":"Link to the recommended updates email admin page."},{"key":"shortcuts","name":"Shortcut Links","description":null},{"key":"atlassian-source-editor-admin-menu","name":"Source Editor","description":null},{"key":"myworkserviceselectorlink","name":null,"description":null},{"key":"spacesconfiguration","name":"Spaces Configuration","description":null},{"key":"configurepdflanguagesupport","name":"UI for PDF Export Language Support","description":null},{"key":"usermacros","name":"User Macros","description":null},{"key":"webdavconfig","name":"WebDAV Config Menu Item","description":null}]},"system.admin/gliffy-admin-section":{"key":"system.admin/gliffy-admin-section","name":"web-section: Administration","items":[{"key":"gliffy-admin-all-diagrams","name":"web-item: All Gliffy Diagrams","description":null},{"key":"gliffy-admin-config","name":"web-item: Configuration","description":null},{"key":"gliffy-admin-license","name":"web-item: License","description":null}]},"system.admin/global":{"key":"system.admin/global","name":null,"items":[{"key":"fecru-analytics-configuration-menu-item","name":"Analytics","description":""}]},"system.admin/lookandfeel":{"key":"system.admin/lookandfeel","name":"Look and Feel","items":[{"key":"theme","name":"Choose Theme","description":null},{"key":"colourscheme","name":"Colour Scheme","description":null},{"key":"customhtml","name":"Custom HTML","description":null},{"key":"defaultspacelogo","name":"Default Space Logo","description":null},{"key":"layouts","name":"Layouts","description":null},{"key":"sitelogo","name":"Site Logo","description":null},{"key":"stylesheet","name":"Stylesheet","description":null},{"key":"globalconfigpdflayout","name":"UI for PDF Export Configuration in Admin Console","description":null}]},"system.admin/marketplace_confluence":{"key":"system.admin/marketplace_confluence","name":"Add-ons","items":[{"key":"confluence-upm-marketplace-menu","name":"Atlassian Marketplace","description":null},{"key":"confluence-upm-osgi-menu","name":"OSGi","description":null},{"key":"confluence-upm-manage-menu","name":"Plugin Manager","description":null},{"key":"confluence-upm-purchased-addons-menu","name":"Purchased Add-ons","description":null}]},"system.admin/scroll-epub-global-web-section":{"key":"system.admin/scroll-epub-global-web-section","name":"Global Web-Section","items":[{"key":"scroll-epub-global-export-schemes-item","name":"Global Export Schemes Web-Item","description":null},{"key":"scroll-epub-resouce-loading-config-item","name":"Resource Loading Configuration Web-Item","description":null},{"key":"scroll-epub-marketplace-license-item","name":"Scroll Marketplace License Web-Item","description":null}]},"system.admin/security":{"key":"system.admin/security","name":"Security","items":[{"key":"confluence-user-directories-web-item","name":"Confluence administration menu item","description":null},{"key":"defaultspaceperms","name":"Default Space Permissions","description":null},{"key":"perms","name":"Global Permissions","description":null},{"key":"groups","name":"Groups","description":null},{"key":"securityconfiguration","name":"Security Configuration","description":null},{"key":"users","name":"Users","description":null},{"key":"confluence-whitelist","name":"Whitelist","description":null}]},"system.comment.action/primary":{"key":"system.comment.action/primary","name":"Primary Comment Actions","items":[{"key":"comment-date","name":"Comment Date","description":null},{"key":"edit-comment","name":"Edit Comment","description":null},{"key":"remove-comment","name":"Remove Comment","description":null},{"key":"reply-comment","name":"Reply Comment","description":null},{"key":"delete-all-comments-link-comment-link","name":"deleteAllCommentsLink","description":""}]},"system.comment.action/secondary":{"key":"system.comment.action/secondary","name":"Secondary Comment Actions","items":[{"key":"comment-permalink","name":"Comment Permalink","description":null},{"key":"view-comment-storage","name":"View Comment Storage Format Link","description":null}]},"system.content.action/marker":{"key":"system.content.action/marker","name":null,"items":[{"key":"pagefavourite","name":"Favourite","description":null}]},"system.content.action/modify":{"key":"system.content.action/modify","name":null,"items":[{"key":"copy-page","name":"Copy Page Link","description":null},{"key":"adaptavist.theme.engine.content.copytoblog","name":"Copy to blog web-item","description":null},{"key":"move-page","name":"Move Link","description":null},{"key":"remove.branch","name":"Remove Branch","description":null},{"key":"remove-page","name":"Remove Link","description":null},{"key":"adaptavist.trimcomments.webitem","name":"Trim comments web-item","description":null},{"key":"treecopy-action-web-ui","name":"treecopy-action-web-ui","description":"Copies the page including all descendants."}]},"system.content.action/primary":{"key":"system.content.action/primary","name":null,"items":[{"key":"view-attachments","name":"Attachments Tab","description":null},{"key":"page-permissions","name":"Page Permissions Link","description":null},{"key":"view-history","name":"View History Link","description":null}]},"system.content.action/secondary":{"key":"system.content.action/secondary","name":null,"items":[{"key":"link-to-page","name":"Link to this page","description":null},{"key":"scroll-epub-exporter-launcher","name":"Scroll EPUB Exporter Menu Item","description":null},{"key":"betterpdfpage","name":"UI for Page PDF Export","description":null},{"key":"view-information","name":"View Info Link","description":null},{"key":"view-page-api-link","name":"View Page API Link","description":"Link to REST API for this piece of Content"},{"key":"view-source","name":"View Source Link","description":null},{"key":"source-editor-view-storage","name":"View Storage Format Link","description":null},{"key":"view-in-hierarchy-page","name":"View in Hierarchy","description":null},{"key":"view-resolved-comments","name":"View resolved comments","description":null},{"key":"word-export","name":"Word Export Link","description":null},{"key":"delete-all-comments-link","name":"deleteAllCommentsLink","description":""}]},"system.content.add/page":{"key":"system.content.add/page","name":null,"items":[{"key":"add-attachments","name":"Add Page Attachment(s)","description":null},{"key":"add-comment","name":"Add Page Comment Link","description":null}]},"system.content.add/space":{"key":"system.content.add/space","name":null,"items":[{"key":"add-blogpost","name":"Create News","description":null},{"key":"add-page-with-parent","name":"Create Page","description":null},{"key":"add-page-with-parent-template","name":"Create Page from template","description":null},{"key":"gliffy-add-diagram-link","name":"web-item: Add Menu","description":"Add diagram web item in the system.content.add/space location. (Only displayed if user has page edit permission)"}]},"system.content.button":{"key":"system.content.button","name":null,"items":[{"key":"edit-page","name":"Edit Tab","description":null},{"key":"share","name":"Share","description":null},{"key":"view","name":"View Content","description":null},{"key":"watch","name":"Watch","description":null}]},"system.content.metadata":{"key":"system.content.metadata","name":null,"items":[{"key":"content-metadata-attachments","name":"Attachments","description":null},{"key":"content-metadata-page-restrictions","name":"Page Restrictions Apply","description":null}]},"system.create.dialog/content":{"key":"system.create.dialog/content","name":null,"items":[{"key":"blueprint-item-ditaa","name":null,"description":""},{"key":"blueprint-item-graphviz","name":null,"description":""},{"key":"blueprint-item-jcckit","name":null,"description":""},{"key":"blueprint-item-plantuml","name":null,"description":""},{"key":"blueprint-item-salt","name":null,"description":""},{"key":"blueprint-item-uml","name":null,"description":""},{"key":"create-blank-page","name":null,"description":""},{"key":"create-blog-post","name":null,"description":""},{"key":"decisions-blueprint-item","name":null,"description":""},{"key":"file-list-item","name":null,"description":""},{"key":"jirareports-item","name":null,"description":""},{"key":"kb-how-to-item","name":"Knowledge Base How-To Article","description":""},{"key":"kb-troubleshooting-item","name":"Knowledge Base Troubleshooting Article","description":""},{"key":"gliffy-blueprint-item-main","name":"web-item: blueprint","description":"Confluence 5.1+"},{"key":"meeting-notes-item","name":null,"description":""},{"key":"requirements-item","name":null,"description":""},{"key":"retrospectives-item","name":null,"description":""},{"key":"sharelinks-blueprint-item","name":null,"description":""},{"key":"task-report-blueprint-item","name":null,"description":""}]},"system.create/global":{"key":"system.create/global","name":null,"items":[{"key":"create-space","name":"Create Space Link","description":null},{"key":"create-status","name":"Create Status Link","description":null},{"key":"create-user","name":"Create User Link","description":null}]},"system.create/page":{"key":"system.create/page","name":null,"items":[{"key":"create-attachment","name":"Create Page Attachment(s)","description":null},{"key":"create-comment","name":"Create Page Comment Link","description":null}]},"system.create/space":{"key":"system.create/space","name":null,"items":[{"key":"add-blogpost","name":"Create News","description":null},{"key":"add-page-with-parent","name":"Create Page","description":null},{"key":"add-page-with-parent-template","name":"Create Page from template","description":null}]},"system.editor.action/insert":{"key":"system.editor.action/insert","name":"Inserting Content","items":[{"key":"edit-image","name":"Insert Image","description":null},{"key":"edit-macro","name":"Insert/Edit Macro","description":null}]},"system.editor.featured.macros.default":{"key":"system.editor.featured.macros.default","name":null,"items":[{"key":"editor-featured-macro-gallery","name":"Insert Menu Link - Gallery Macro","description":"Displays a Gallery Macro link in the TinyMCE Insert menu"},{"key":"editor-featured-macro-info","name":"Insert Menu Link - Info Macro","description":"Displays an Info Macro link in the TinyMCE Insert menu."},{"key":"editor-insertmention","name":"Insert Menu Link - Insert Mention","description":"Displays an Insert Mention link in the TinyMCE Insert menu."},{"key":"editor-featured-macro-jira","name":"Insert Menu Link - JIRA issue","description":"Displays an insert JIRA issue link in the tinymce insert menu"},{"key":"editor-featured-macro-status","name":"Insert Menu Link - Status Macro","description":"Displays an insert status macro link in the tinymce insert menu"},{"key":"editor-featured-macro-toc","name":"Insert Menu Link - Table of Contents Macro","description":"Displays a Table of Contents Macro link in the TinyMCE Insert menu"},{"key":"editor-featured-macro-gliffy","name":"web-item: Insert Menu","description":"Inserts a new Gliffy Diagram macro"}]},"system.editor.link.browser.tabs":{"key":"system.editor.link.browser.tabs","name":null,"items":[{"key":"link-browser-tab-advanced","name":"Link Browser Tab - Advanced","description":"Displays an Advanced tab in the Link Browser."},{"key":"link-browser-tab-files","name":"Link Browser Tab - Files","description":"Displays a Files tab in the Link Browser."},{"key":"link-browser-tab-recentlyviewed","name":"Link Browser Tab - Recently Viewed","description":"Displays a Recently Viewed tab in the Link Browser."},{"key":"link-browser-tab-search","name":"Link Browser Tab - Search","description":"Displays a Search tab in the Link Browser."},{"key":"link-browser-tab-weblink","name":"Link Browser Tab - Web Link","description":"Displays a Web Link tab in the Link Browser."}]},"system.editor.savebar.buttons.primary":{"key":"system.editor.savebar.buttons.primary","name":null,"items":[{"key":"editor-save","name":"Generic Editor Save Button","description":null}]},"system.header/left":{"key":"system.header/left","name":null,"items":[{"key":"header-create-link","name":"Header Create Link","description":null},{"key":"header-people-link","name":"Header People Link","description":null},{"key":"header-spaces-link","name":"Header Spaces Link","description":null},{"key":"siteDarkFeatures","name":"Site Dark Features","description":null}]},"system.header/right":{"key":"system.header/right","name":null,"items":[{"key":"sidebar-splitter","name":"Show or Hide Sidebar","description":null},{"key":"userDarkFeatures","name":"User Dark Features","description":null}]},"system.header/workday-non-public":{"key":"system.header/workday-non-public","name":null,"items":[{"key":"confluenceCommonHeaderIcon","name":"Confluence Header Icon","description":null}]},"system.help/pages":{"key":"system.help/pages","name":null,"items":[{"key":"confluence-about","name":"About Confluence","description":null},{"key":"gadget-directory","name":"Available Gadgets","description":null},{"key":"confluence-help","name":"Confluence Help","description":null},{"key":"feedbuilder","name":"Feed Builder in the Help menu","description":null},{"key":"keyboard-shortcuts-dialog-help-menu","name":"Keyboard Shortcuts Dialog","description":null},{"key":"whats-new-item-help-menu","name":"What\'s New Browse Menu Item","description":null}]},"system.profile.actions/primary":{"key":"system.profile.actions/primary","name":"Actions performed on a particular user","items":[{"key":"favourite-user-personal-space","name":"Favourite user\'s personal space","description":null},{"key":"follow-user","name":"Follow User","description":null},{"key":"personalspace","name":"Personal Space","description":null},{"key":"stop-favourite-user-personal-space","name":"Remove favourite user\'s personal space","description":null},{"key":"unfollow-user","name":"Unfollow User","description":null}]},"system.profile.edit/user-administion":{"key":"system.profile.edit/user-administion","name":"Administer User","items":[{"key":"profile-administer-user","name":"Administer User","description":null}]},"system.profile.edit/user.profile.section":{"key":"system.profile.edit/user.profile.section","name":"Your Profile","items":[{"key":"editprofilepicture","name":"Edit Profile Picture","description":null}]},"system.settings.edit/gadget-user-settings":{"key":"system.settings.edit/gadget-user-settings","name":"Gadget User Settings","items":[{"key":"oauth-access-tokens","name":"OAuth Access Tokens","description":null}]},"system.settings.edit/yoursettings":{"key":"system.settings.edit/yoursettings","name":"Your Settings","items":[{"key":"changepassword","name":"Change Password","description":null},{"key":"editeditorpreferences","name":"Edit Editor Settings","description":null},{"key":"editemailpreferences","name":"Edit Email Settings","description":null},{"key":"confluenceSettingsWebItem","name":"Notification Settings","description":null}]},"system.space":{"key":"system.space","name":null,"items":[{"key":"space-administration","name":"Admin Tab","description":null},{"key":"space-labels","name":"Label Tab","description":null},{"key":"space-mails","name":"Mail Tab","description":null},{"key":"space-blogposts","name":"News Tab","description":null},{"key":"space-pages","name":"Pages Tab","description":null},{"key":"space-operations","name":"Space Operations Tab","description":null}]},"system.space.admin/import":{"key":"system.space.admin/import","name":"Import","items":[{"key":"importpages","name":"Import Pages","description":null}]},"system.space.admin/integrations":{"key":"system.space.admin/integrations","name":"Integrations","items":[{"key":"hipchat2-space-configuration","name":"HipChat Space Configuration","description":"HipChat Space Configuration"}]},"system.space.admin/looknfeel":{"key":"system.space.admin/looknfeel","name":"Look and Feel","items":[{"key":"choosetheme","name":"Choose Theme","description":null},{"key":"colorscheme","name":"Color Scheme","description":null},{"key":"layouts","name":"Layouts","description":null},{"key":"spacelogo","name":"Space Logo","description":null},{"key":"stylesheet","name":"Stylesheet","description":null},{"key":"configpdflayout","name":"UI for PDF Export Configuration","description":null}]},"system.space.admin/mail-links":{"key":"system.space.admin/mail-links","name":"Mail","items":[{"key":"importmbox","name":"Import MBox","description":null},{"key":"mailaccounts","name":"Mail Accounts","description":null}]},"system.space.admin/scroll-epub-space-web-section":{"key":"system.space.admin/scroll-epub-space-web-section","name":"Space Web-Section","items":[{"key":"scroll-epub-space-export-schemes-item","name":"Space Admin Export Schemes Web-Item","description":null}]},"system.space.admin/security":{"key":"system.space.admin/security","name":"Security","items":[{"key":"applinks-configure-entity-links","name":null,"description":null},{"key":"permissionedpages","name":"Permissioned Pages","description":null},{"key":"spacepermissions","name":"Space Permissions","description":null}]},"system.space.admin/spaceops":{"key":"system.space.admin/spaceops","name":"Space Operations","items":[{"key":"com.atlassian.confluence.plugin.copyspace.copyspacelink","name":"Copy Space Link","description":null},{"key":"editspace","name":"Edit Space","description":null},{"key":"editspacelabels","name":"Edit Space Labels","description":null},{"key":"removespace","name":"Remove Space","description":null},{"key":"space-templates","name":"Templates Tab","description":null},{"key":"trash","name":"Trash","description":null},{"key":"com.atlassian.confluence.plugin.copyspace.visit.copier.link","name":"Visit Copied Space Link","description":null}]},"system.space.advanced/advanced":{"key":"system.space.advanced/advanced","name":"Advanced","items":[{"key":"space-attachments","name":"Attachments","description":null},{"key":"advanced.snippeterrorslink","name":"List Snippet Errors","description":null},{"key":"orphan","name":"Orphaned Pages","description":null},{"key":"spacedetails-personal","name":"Space (Personal) Details","description":null},{"key":"spacedetails","name":"Space Details","description":null},{"key":"undefined","name":"Undefined Pages","description":null}]},"system.space.advanced/exportsection":{"key":"system.space.advanced/exportsection","name":"Export","items":[{"key":"exporthtml","name":"Export Space HTML","description":null},{"key":"exportxml","name":"Export Space XML","description":null},{"key":"betterpdf","name":"UI for Space PDF Export","description":null}]},"system.space.advanced/subscribesection":{"key":"system.space.advanced/subscribesection","name":"Subscribe","items":[{"key":"rss","name":"Rss Feeds","description":null},{"key":"startwatchingblogs","name":"Start Watching Blogs","description":null},{"key":"startwatchingblogsonly","name":"Start Watching Blogs Only","description":null},{"key":"stopwatchingblogs","name":"Stop Watching Blogs","description":null},{"key":"startwatching","name":"Watching","description":null}]},"system.space.export/formats":{"key":"system.space.export/formats","name":"Export Formats section","items":[{"key":"export-format-html","name":"HTML Export Format","description":""},{"key":"export-format-xml","name":"XML Export Format","description":""}]},"system.space.sidebar/advanced-links":{"key":"system.space.sidebar/advanced-links","name":null,"items":[{"key":"space-tools-browse-pages","name":"Browse Pages","description":null},{"key":"space-tools-reorder-pages","name":"Reorder Pages","description":null}]},"system.space.sidebar/main-links":{"key":"system.space.sidebar/main-links","name":null,"items":[{"key":"spacebar-blogs","name":"Blogs","description":null},{"key":"spacebar-pages","name":"Pages","description":null},{"key":"spacebar-profile","name":"Profile","description":null}]},"system.space.tools/adaptavist.theme.engine.space.web-section":{"key":"system.space.tools/adaptavist.theme.engine.space.web-section","name":"ThemeBuilder","items":[{"key":"adaptavist.builder.space.edit-skins","name":"Edit Skins Space Webitem","description":null},{"key":"adaptavist.theme.engine.space.help","name":"Online User Guide (space)","description":null},{"key":"adaptavist.builder.space.select-skin","name":"Select Space Skin Webitem","description":null},{"key":"adaptavist.theme.engine.space.setparent","name":"Set parent space","description":null}]},"system.space.tools/contenttools":{"key":"system.space.tools/contenttools","name":"Content Tools","items":[{"key":"space-attachments","name":"Attachments","description":null},{"key":"browse","name":"Browse Pages","description":null},{"key":"export","name":"Export Space HTML","description":null},{"key":"importpages","name":"Import Pages","description":null},{"key":"orphan","name":"Orphaned Pages","description":null},{"key":"reorder","name":"Reorder Pages","description":null},{"key":"rss","name":"Rss Feeds","description":null},{"key":"space-templates-2","name":"Templates Tab","description":null},{"key":"trash","name":"Trash","description":null},{"key":"undefined","name":"Undefined Pages","description":null}]},"system.space.tools/integrations":{"key":"system.space.tools/integrations","name":"Integrations","items":[{"key":"applinks-configure-entity-links-2","name":null,"description":null},{"key":"hipchat2-space-configuration-2","name":"HipChat Space Configuration","description":"HipChat Space Configuration"},{"key":"import-mailbox","name":"Import MBox","description":null},{"key":"mailaccounts-tools","name":"Mail Accounts","description":null},{"key":"space-mails-tools","name":"Mail Tab","description":null}]},"system.space.tools/lookandfeel":{"key":"system.space.tools/lookandfeel","name":"Look & Feel","items":[{"key":"choosetheme","name":"Choose Theme","description":null},{"key":"colorscheme","name":"Color Scheme","description":null},{"key":"layouts","name":"Layouts","description":null},{"key":"stylesheet","name":"Stylesheet","description":null},{"key":"configpdflayout-2","name":"UI for PDF Export Configuration","description":null}]},"system.space.tools/overview":{"key":"system.space.tools/overview","name":"Overview","items":[{"key":"removespace","name":"Remove Space","description":null},{"key":"spacedetails-personal","name":"Space (Personal) Details","description":null},{"key":"spacedetails","name":"Space Details","description":null}]},"system.space.tools/permissions":{"key":"system.space.tools/permissions","name":"Permissions","items":[{"key":"permissionedpages","name":"Permissioned Pages","description":null},{"key":"spacepermissions","name":"Space Permissions","description":null}]},"system.space.tools/scroll-epub-space-tools-web-section":{"key":"system.space.tools/scroll-epub-space-tools-web-section","name":"Space Web-Section","items":[{"key":"scroll-epub-space-tools-export-schemes-item","name":"Space Tools Export Schemes Web-Item","description":null}]},"system.user.concise/user-concise":{"key":"system.user.concise/user-concise","name":"Concise User Items","items":[{"key":"administration","name":"Administration","description":null},{"key":"logout","name":"Logout Link","description":null},{"key":"settings","name":"Settings","description":null},{"key":"update-status-concise-menu-item","name":"Update Status Menu Item - Concise Theme","description":"Concise theme Menu Item to go to the Status Updates page of the user profile"},{"key":"user-history","name":"User History","description":null}]},"system.user.hover/secondary":{"key":"system.user.hover/secondary","name":"Secondary actions","items":[{"key":"follow-tab","name":"Follow Tab","description":null},{"key":"personal-space","name":"Personal Space","description":null},{"key":"user-profile","name":"Profile","description":null},{"key":"user-status-hover","name":"Status Updates Page User Hover Menu Item","description":"Menu Item on the user hover to go the Status Updates page of the user profile"},{"key":"user-blog","name":"User Personal Blog","description":null}]},"system.user/anonymous":{"key":"system.user/anonymous","name":"Anonymous User Actions","items":[{"key":"login","name":"Login Link","description":null},{"key":"signup","name":"Signup Link","description":null}]},"system.user/user-content":{"key":"system.user/user-content","name":null,"items":[{"key":"drafts","name":"Drafts Tab","description":null},{"key":"user-favourites","name":"Favourites Tab","description":null},{"key":"follow","name":"Follow","description":null},{"key":"my-tasks-menu-item","name":"My Tasks","description":"User Menu Item to go to the My Tasks page of the user profile"},{"key":"confluence-upm-requests-menu","name":"Requested Add-ons","description":null},{"key":"settings","name":"Settings Tab","description":null},{"key":"list-status-updates-menu-item","name":"Status Updates User Menu Item","description":"User Menu Item to go to the Status Updates page of the user profile"},{"key":"user-profile","name":"User Profile","description":null},{"key":"user-watches","name":"Watches Tab","description":null}]},"system.user/user-operations":{"key":"system.user/user-operations","name":null,"items":[{"key":"logout","name":"Logout Link","description":null}]},"system.user/user-preferences":{"key":"system.user/user-preferences","name":null,"items":[{"key":"create-personal-space","name":"Create Personal Space","description":null},{"key":"personal-space","name":"Personal Space","description":null},{"key":"user-history","name":"User History","description":null}]},"system.user/user-status":{"key":"system.user/user-status","name":null,"items":[{"key":"update-status-menu-item","name":"Update Status User Menu Item","description":"User Menu Item to Update Status"}]}}};function d(j){var m=f(Confluence.Templates.MacroBrowser.macroParameterSelect()),i=f("select",m),k=f('<input type="hidden"/>').appendTo(m);i.attr("multiple",j).bind("change",function(){if(j){k.val((i.val()||[]).join(" ")).change()}else{k.val(i.val()).change()}});var l={setValue:function(n){var o=f.trim(n);k.val(o);i.val(o.split(/\s+/))}};return AJS.MacroBrowser.Field(m,k,l)}function a(i){i.options.length=0}function c(i,k,j){i.options[i.options.length]=new Option(k+((j==null)?"":" ("+j+")"),k)}var h;function g(i){b(i)}function b(i){if(h){a(h);if(i&&e.sections[i]){f.each(e.sections[i].items,function(j,k){c(h,k.key,k.name)})}f(h).change()}}AJS.MacroBrowser.setMacroJsOverride("web-item",{fields:{string:{section:function(){var j=d(false),i=f("select",j.paramDiv)[0];f.each(e.sections,function(k,l){c(i,l.key,l.name)});f("select",j.paramDiv).on("change",function(k){g(f(k.target).val())});return j},item:function(){var j=d(false),i=f("select",j.paramDiv)[0];h=i;return j}}},beforeParamsSet:function(i){g(i.section);return i}});AJS.MacroBrowser.setMacroJsOverride("web-section",{fields:{string:{location:function(){var j=d(false),i=f("select",j.paramDiv)[0];c(i,"*","adaptavist.theme.engine.macros.websection.all");f.each(e.sections,function(k,l){c(i,l.key,l.name)});return j}}}})});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.ext.newcode-macro-plugin:code-macro-editor', location = '/scripts/code-macro-languages.js' */
(function(d){var b=function(){};b.prototype.fields={string:{language:function(h,f){var g=d(Confluence.Templates.MacroBrowser.macroParameterSelect());var e=d("select",g);if(f==null){f={}}f.setValue=function(k){var j=e.find("option[value='"+k+"']");if(j.length==0){var i=d("<option/>");i.val(k);i.text(k);e.append(i)}};a(e);return new AJS.MacroBrowser.Field(g,e,f)}}};AJS.MacroBrowser.Macros.code=new b();function a(e){c(function(g){if(!g.length){AJS.log("Configured code macro languages result was not in the expected format.");return}var f=e.val();e.empty();e.append(d("<option/>").attr("value",""));d.each(g,function(h,j){var i=d("<option />");i.val(j.aliases[0]);i.text(j.friendlyName);e.append(i)});e.val(f)},function(g,h,f){AJS.log("Failed to retrieve syntax highlighters from Confluence "+h+" - "+f)})}function c(f,e){AJS.$.ajax({async:true,url:AJS.params.contextPath+"/plugins/newcode/getlanguages.action",dataType:"json",timeout:10000,error:function(h,i,g){if(e&&typeof(e)=="function"){e(h,i,g)}},success:function(g){if(f&&typeof(f)=="function"){f(g)}}})}})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'de.griffel.confluence.plugins.plant-uml:macro-browser-fields', location = 'js/macro.js' */
AJS.MacroBrowser.activateSmartFieldsAttachmentsOnPage("svg",["svg","svgz"]);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.confluence-inline-tasks:inline-tasks-macro-browser', location = 'js/inline-tasks-macro-browser.js' */
(function(b){var a={"space-and-page":function(i,e){e=e||{};var c=i.multiple?true:false;var f=i.multiple?"autocomplete-multi-space-and-page":"autocomplete-space-and-page";var h=b(Confluence.Templates.MacroBrowser.macroParameter());var d=AJS.$("input[type='text']",h);d.addClass(f).attr("data-none-message","Not found");if(i.required){d.keyup(AJS.MacroBrowser.processRequiredParameters)}var g=_.extend({},{manualInit:true,multiple:c,orgElement:d},e);d.auiSelect2(Confluence.UI.Components.SpacePagePicker.build(g));e.setValue=function(j){Confluence.UI.Components.SpacePagePicker.setValue(j,d)};return AJS.MacroBrowser.Field(h,d,e)}};AJS.MacroBrowser.setMacroJsOverride("tasks-report-macro",{fields:{string:{spaceAndPage:function(d){var c={inputSpaceId:"macro-param-spaces",inputSpaceName:"macro-param-spaces",inputPageId:"macro-param-pages",inputPageName:"macro-param-pages"};return a["space-and-page"](d,c)}}}})})(AJS.$);
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/rpc.js' */
var gadgets=gadgets||{};gadgets.rpc=function(){var CALLBACK_NAME="__cb";var DEFAULT_NAME="";var FE_G2C_CHANNEL="__g2c_rpc";var FE_C2G_CHANNEL="__c2g_rpc";var services={};var iframePool=[];var relayUrl={};var useLegacyProtocol={};var authToken={};var callId=0;var callbacks={};var setup={};var sameDomain={};var params={};if(gadgets.util){params=gadgets.util.getUrlParameters()}authToken[".."]=params.rpctoken||params.ifpctok||0;function getRelayChannel(){return typeof window.postMessage==="function"?"wpm":typeof document.postMessage==="function"?"dpm":navigator.product==="Gecko"?"fe":"ifpc"}function setupChannel(){if(relayChannel==="dpm"||relayChannel==="wpm"){window.addEventListener("message",function(packet){try{if(typeof packet==="object"&&typeof packet.data==="string"){process(gadgets.json.parse(packet.data))}}catch(e){if(AJS.debug){var origin=packet&&packet.origin?packet.origin:"unknown origin";AJS.log("Error processing gadget rpc message from '"+origin+"': "+e)}}},false)}}var relayChannel=getRelayChannel();setupChannel();services[DEFAULT_NAME]=function(){throw new Error("Unknown RPC service: "+this.s)};services[CALLBACK_NAME]=function(callbackId,result){var callback=callbacks[callbackId];if(callback){delete callbacks[callbackId];callback(result)}};function setupFrame(frameId){if(setup[frameId]){return }if(relayChannel==="fe"){try{var frame=document.getElementById(frameId);frame[FE_G2C_CHANNEL]=function(args){process(gadgets.json.parse(args))}}catch(e){}}setup[frameId]=true}function encodeLegacyData(args){var stringify=gadgets.json.stringify;var argsEscaped=[];for(var i=0,j=args.length;i<j;++i){argsEscaped.push(encodeURIComponent(stringify(args[i])))}return argsEscaped.join("&")}function process(rpc){if(rpc&&typeof rpc.s==="string"&&typeof rpc.f==="string"&&rpc.a instanceof Array){if(authToken[rpc.f]){if(authToken[rpc.f]!=rpc.t){if(AJS.debug){console.log("Invalid auth token received for operation: "+rpc.s)}return }}if(rpc.c){rpc.callback=function(result){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}var result=(services[rpc.s]||services[DEFAULT_NAME]).apply(rpc,rpc.a);if(rpc.c&&typeof result!="undefined"){gadgets.rpc.call(rpc.f,CALLBACK_NAME,null,rpc.c,result)}}}function callFrameElement(targetId,serviceName,from,rpcData,callArgs){try{if(from!=".."){var fe=window.frameElement;if(typeof fe[FE_G2C_CHANNEL]==="function"){if(typeof fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]!=="function"){fe[FE_G2C_CHANNEL][FE_C2G_CHANNEL]=function(args){process(gadgets.json.parse(args))}}fe[FE_G2C_CHANNEL](rpcData);return }}else{var frame=document.getElementById(targetId);if(typeof frame[FE_G2C_CHANNEL]==="function"&&typeof frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL]==="function"){frame[FE_G2C_CHANNEL][FE_C2G_CHANNEL](rpcData);return }}}catch(e){}callIfpc(targetId,serviceName,from,rpcData,callArgs)}function callIfpc(targetId,serviceName,from,rpcData,callArgs){var relay=gadgets.rpc.getRelayUrl(targetId);if(!relay){throw new Error("No relay file assigned for IFPC")}var src=null;if(useLegacyProtocol[targetId]){src=[relay,"#",encodeLegacyData([from,callId,1,0,encodeLegacyData([from,serviceName,"","",from].concat(callArgs))])].join("")}else{src=[relay,"#",targetId,"&",from,"@",callId,"&1&0&",encodeURIComponent(rpcData)].join("")}emitInvisibleIframe(src)}function emitInvisibleIframe(src){var iframe;for(var i=iframePool.length-1;i>=0;--i){var ifr=iframePool[i];try{if(ifr&&(ifr.recyclable||ifr.readyState==="complete")){ifr.parentNode.removeChild(ifr);if(window.ActiveXObject){iframePool[i]=ifr=null;iframePool.splice(i,1)}else{ifr.recyclable=false;iframe=ifr;break}}}catch(e){}}if(!iframe){iframe=document.createElement("iframe");iframe.style.border=iframe.style.width=iframe.style.height="0px";iframe.style.visibility="hidden";iframe.style.position="absolute";iframe.onload=function(){this.recyclable=true};iframePool.push(iframe)}iframe.src=src;setTimeout(function(){document.body.appendChild(iframe)},0)}function callSameDomain(target,rpc){if(typeof sameDomain[target]==="undefined"){sameDomain[target]=false;var targetEl=null;if(target===".."){targetEl=parent}else{targetEl=frames[target]}try{sameDomain[target]=targetEl.gadgets.rpc.receiveSameDomain}catch(e){}}if(typeof sameDomain[target]==="function"){sameDomain[target](rpc);return true}return false}if(gadgets.config){function init(config){if(config.rpc.parentRelayUrl.substring(0,7)==="http://"){relayUrl[".."]=config.rpc.parentRelayUrl}else{var params=document.location.search.substring(0).split("&");var parentParam="";for(var i=0,param;param=params[i];++i){if(param.indexOf("parent=")===0){parentParam=decodeURIComponent(param.substring(7));break}}relayUrl[".."]=parentParam+config.rpc.parentRelayUrl}useLegacyProtocol[".."]=!!config.rpc.useLegacyProtocol}var requiredConfig={parentRelayUrl:gadgets.config.NonEmptyStringValidator};gadgets.config.register("rpc",requiredConfig,init)}return{register:function(serviceName,handler){if(serviceName==CALLBACK_NAME){throw new Error("Cannot overwrite callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot overwrite default service:"+" use registerDefault")}services[serviceName]=handler},unregister:function(serviceName){if(serviceName==CALLBACK_NAME){throw new Error("Cannot delete callback service")}if(serviceName==DEFAULT_NAME){throw new Error("Cannot delete default service:"+" use unregisterDefault")}delete services[serviceName]},registerDefault:function(handler){services[""]=handler},unregisterDefault:function(){delete services[""]},call:function(targetId,serviceName,callback,var_args){++callId;targetId=targetId||"..";if(callback){callbacks[callId]=callback}var from="..";if(targetId===".."){from=window.name}var rpc={s:serviceName,f:from,c:callback?callId:0,a:Array.prototype.slice.call(arguments,3),t:authToken[targetId]};if(callSameDomain(targetId,rpc)){return }var rpcData=gadgets.json.stringify(rpc);var channelType=relayChannel;if(useLegacyProtocol[targetId]){channelType="ifpc"}switch(channelType){case"dpm":var targetDoc=targetId===".."?parent.document:frames[targetId].document;targetDoc.postMessage(rpcData);break;case"wpm":var targetWin=targetId===".."?parent:frames[targetId];targetWin.postMessage(rpcData,relayUrl[targetId]);break;case"fe":callFrameElement(targetId,serviceName,from,rpcData,rpc.a);break;default:callIfpc(targetId,serviceName,from,rpcData,rpc.a);break}},getRelayUrl:function(targetId){return relayUrl[targetId]},setRelayUrl:function(targetId,url,opt_useLegacy){relayUrl[targetId]=url;useLegacyProtocol[targetId]=!!opt_useLegacy},setAuthToken:function(targetId,token){authToken[targetId]=token;setupFrame(targetId)},getRelayChannel:function(){return relayChannel},receive:function(fragment){if(fragment.length>4){process(gadgets.json.parse(decodeURIComponent(fragment[fragment.length-1])))}},receiveSameDomain:function(rpc){rpc.a=Array.prototype.slice.call(rpc.a);window.setTimeout(function(){process(rpc)},0)}}}();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/util.js' */
Function.prototype.inherits=function(parentCtor){function tempCtor(){}tempCtor.prototype=parentCtor.prototype;this.superClass_=parentCtor.prototype;this.prototype=new tempCtor();this.prototype.constructor=this};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/json.js' */
var gadgets=gadgets||{};gadgets.json=function(){function f(n){return n<10?"0"+n:n}Date.prototype.toJSON=function(){return[this.getUTCFullYear(),"-",f(this.getUTCMonth()+1),"-",f(this.getUTCDate()),"T",f(this.getUTCHours()),":",f(this.getUTCMinutes()),":",f(this.getUTCSeconds()),"Z"].join("")};var m={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(value){var a,i,k,l,r=/["\\\x00-\x1f\x7f-\x9f]/g,v;switch(typeof value){case"string":return r.test(value)?'"'+value.replace(r,function(a){var c=m[a];if(c){return c}c=a.charCodeAt();return"\\u00"+Math.floor(c/16).toString(16)+(c%16).toString(16)})+'"':'"'+value+'"';case"number":return isFinite(value)?String(value):"null";case"boolean":case"null":return String(value);case"object":if(!value){return"null"}a=[];if(typeof value.length==="number"&&!(value.propertyIsEnumerable("length"))){l=value.length;for(i=0;i<l;i+=1){a.push(stringify(value[i])||"null")}return"["+a.join(",")+"]"}for(k in value){if(value.hasOwnProperty(k)){if(typeof k==="string"){v=stringify(value[k]);if(v){a.push(stringify(k)+":"+v)}}}}return"{"+a.join(",")+"}"}}return{stringify:stringify,parse:function(text){if(/^[\],:{}\s]*$/.test(text.replace(/\\["\\\/b-u]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))){return eval("("+text+")")}return false}}}();
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.gadgets.embedded:gadget-core-resources', location = 'js/gadgets-core.js' */
var gadgets=gadgets||{};gadgets.error={};gadgets.error.SUBCLASS_RESPONSIBILITY="subclass responsibility";gadgets.error.TO_BE_DONE="to be done";gadgets.log=function(message){if(window.console&&console.log){console.log(message)}else{var logEntry=document.createElement("div");logEntry.className="gadgets-log-entry";logEntry.innerHTML=message;document.body.appendChild(logEntry)}};gadgets.Extensible=function(){};gadgets.Extensible.prototype.setDependencies=function(dependencies){for(var p in dependencies){this[p]=dependencies[p]}};gadgets.Extensible.prototype.getDependencies=function(name){return this[name]};gadgets.UserPrefStore=function(){};gadgets.UserPrefStore.prototype.getPrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.UserPrefStore.prototype.savePrefs=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.DefaultUserPrefStore=function(){gadgets.UserPrefStore.call(this)};gadgets.DefaultUserPrefStore.inherits(gadgets.UserPrefStore);gadgets.DefaultUserPrefStore.prototype.getPrefs=function(gadget){};gadgets.DefaultUserPrefStore.prototype.savePrefs=function(gadget){};gadgets.GadgetService=function(){};gadgets.GadgetService.prototype.setHeight=function(elementId,height){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setTitle=function(gadget,title){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.GadgetService.prototype.setUserPref=function(id){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.IfrGadgetService=function(){gadgets.GadgetService.call(this);var service=this;gadgets.rpc.register("resize_iframe",function(){service.setHeight.apply(this,arguments)});gadgets.rpc.register("set_pref",function(){service.setUserPref.apply(this,arguments)});gadgets.rpc.register("set_title",function(){service.setTitle.apply(this,arguments)});gadgets.rpc.register("requestNavigateTo",function(){service.requestNavigateTo.apply(this,arguments)})};gadgets.IfrGadgetService.inherits(gadgets.GadgetService);gadgets.IfrGadgetService.prototype.setHeight=function(height){if(height>gadgets.container.maxheight_){height=gadgets.container.maxheight_}var element=document.getElementById(this.f);if(element){element.style.height=height+"px"}};gadgets.IfrGadgetService.prototype.requestNavigateTo=function(view,opt_params){var id=this.getGadgetIdFromModuleId(this.f);var url=this.getUrlForView(view);if(opt_params){var paramStr=JSON.stringify(opt_params);if(paramStr.length>0){url+="&appParams="+encodeURIComponent(paramStr)}}if(url&&document.location.href.indexOf(url)==-1){document.location.href=url}};gadgets.IfrGadgetService.prototype.getUrlForView=function(view){if(view==="canvas"){return"/canvas"}else{if(view==="profile"){return"/profile"}else{return null}}};gadgets.IfrGadgetService.prototype.getGadgetIdFromModuleId=function(moduleId){return parseInt(moduleId.match(/_([0-9]+)$/)[1],10)};gadgets.LayoutManager=function(){};gadgets.LayoutManager.prototype.getGadgetChrome=function(gadget){throw Error(gadgets.error.SUBCLASS_RESPONSIBILITY)};gadgets.StaticLayoutManager=function(){gadgets.LayoutManager.call(this)};gadgets.StaticLayoutManager.inherits(gadgets.LayoutManager);gadgets.StaticLayoutManager.prototype.setGadgetChromeIds=function(gadgetChromeIds){this.gadgetChromeIds_=gadgetChromeIds};gadgets.StaticLayoutManager.prototype.getGadgetChrome=function(gadget){var chromeId=this.gadgetChromeIds_[gadget.id];return chromeId?document.getElementById(chromeId):null};gadgets.FloatLeftLayoutManager=function(layoutRootId){gadgets.LayoutManager.call(this);this.layoutRootId_=layoutRootId};gadgets.FloatLeftLayoutManager.inherits(gadgets.LayoutManager);gadgets.FloatLeftLayoutManager.prototype.getGadgetChrome=function(gadget){var layoutRoot=document.getElementById(this.layoutRootId_);if(layoutRoot){var chrome=document.createElement("div");chrome.className="gadgets-gadget-chrome";chrome.style.cssFloat="left";layoutRoot.appendChild(chrome);return chrome}else{return null}};
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
;try {
/* module-key = 'com.atlassian.confluence.plugins.gadgets:macro-browser-for-gadgetsplugin', location = 'script/gadget-macro-browser.js' */
AJS.toInit(function(a){var b={};b.postPreview=function(h,d){var f=h.contentWindow.AJS;var c={};var k=a("#macro-param-div-preferences input").val().split("&");for(var j=0,o=k.length;j<o;j++){var g=k[j].split("=");try{c[decodeURI(g[0])]=decodeURI(g[1])}catch(l){}}if(d.needsConfig&&f){var m=!!c.isConfigured;if(!m){var n=a("#macro-browser-dialog .dialog-button-panel .ok");a("#save-warning-span").addClass("gadget-not-configured-warning").text("Please complete the configuration in the preview area first").removeClass("hidden");n.prop("disabled",true)}}};b.beforeParamsSet=function(j,c){var h=j.preferences;if(!c&&h){var g=h.split("&");for(var d=0,f=g.length;d<f;d++){var e=g[d].split("=");j[decodeURI(e[0])]=decodeURI(e[1])}}return j};b.updateMacroParametersForPreview=function(c){c.forceWrite=true;return c};b.manipulateMarkup=function(f){if(AJS.MacroBrowser.gadgetPrefsChanged){var d=top.document.getElementById("macro-insert-container");var g=a("#macro-param-div-preferences input",d);var c="";for(var e in AJS.MacroBrowser.gadgetPrefs){if(c.length!=0){c+="&"}c=c+encodeURI(e)+"="+encodeURI(AJS.MacroBrowser.gadgetPrefs[e])}g.val(c)}};b.getMacroDetailsFromSelectedMacro=function(f,g){var c=g.params.url;for(var e=0,h=f.length;e<h;e++){var d=f[e];if(d.macroName===g.name&&d.gadgetUrl===c){return d}}};b.beforeParamsRetrieved=function(p,h,j){var s="";if(h.nonHiddenUserPrefs){var m=true;var d={},f=p.preferences;if(f){var n=f.split("&");for(var l=0,q=n.length;l<q;l++){var k=n[l].split("=");var o=decodeURI(k[0]);var r=decodeURI(k[1]);d[o]=r}}for(var e in j){d[e]=j[e]}var c=function(v,t,w){var x=v.formDetails.parameters;for(var u=0;u<x.length;u++){if(x[u].name==t){return w==x[u].defaultValue}}AJS.log("Unable to find matching param for "+t);return false};for(var g in d){if(!c(h,g,d[g])){if(!m){s+="&"}m=false;s=s+encodeURI(g)+"="+encodeURI(d[g])}}p.preferences=s}return p};AJS.MacroBrowser.setMacroJsOverride("gadget",b)});
} catch (err) {
    if (console && console.log && console.error) {
        console.log("Error running batched script.");
        console.error(err);
    }
}

;
